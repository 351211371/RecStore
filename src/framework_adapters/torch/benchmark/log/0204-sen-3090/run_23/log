WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 10:50:57.303279 28384 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_129', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=6, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [28384 sampler.py:454] Start PreSampling
WARNING [28384 sampler.py:532] Before construct renumbering_dict
WARNING [28384 sampler.py:555] PreSampling done
W20240204 10:51:02.906687 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 10:51:02.906883 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 10:51:02.906939 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 10:51:02.906981 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 10:51:02.907016 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 10:51:02.907065 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 10:51:02.907114 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 10:51:02.907158 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 10:51:02.907205 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 10:51:02.907246 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 10:51:02.907299 28384 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 10:51:02.907330 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 10:51:02.907367 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 10:51:02.907498 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 10:51:02.907536 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 10:51:02.907575 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 10:51:02.907619 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 10:51:02.907653 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 10:51:02.907697 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 10:51:02.907727 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 10:51:02.907758 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 10:51:02.907792 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 10:51:02.907830 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 10:51:02.907867 28384 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 10:51:02.907896 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 10:51:02.907929 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 10:51:02.907990 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 10:51:02.908025 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 10:51:02.908077 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 10:51:02.908125 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 10:51:02.908164 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 10:51:02.908197 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 10:51:02.908242 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 10:51:02.908274 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 10:51:02.908313 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 10:51:02.908354 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 10:51:02.908391 28384 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 10:51:02.908418 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 10:51:02.908445 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 10:51:02.908514 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 10:51:02.908557 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 10:51:02.908593 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 10:51:02.908627 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 10:51:02.908666 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 10:51:02.908704 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 10:51:02.908737 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 10:51:02.908771 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 10:51:02.908812 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 10:51:02.908854 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 10:51:02.908885 28384 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 10:51:02.908911 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 10:51:02.908941 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 10:51:02.909004 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 10:51:02.909049 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 10:51:02.909087 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 10:51:02.909121 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 10:51:02.909161 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 10:51:02.909193 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 10:51:02.909232 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 10:51:02.909277 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 10:51:02.909312 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 10:51:02.909349 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 10:51:02.909387 28384 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 10:51:02.909415 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 10:51:02.909441 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 10:51:02.909505 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 10:51:02.909539 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 10:51:02.909571 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 10:51:02.909602 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 10:51:02.909638 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 10:51:02.909677 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 10:51:02.909713 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 10:51:02.909751 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 10:51:02.909788 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 10:51:02.909830 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 10:51:02.909864 28384 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 10:51:02.909891 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 10:51:02.909917 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 10:51:02.909981 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 10:51:02.910020 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 10:51:02.910055 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 10:51:02.910092 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 10:51:02.910135 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 10:51:02.910169 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 10:51:02.910202 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 10:51:02.910240 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 10:51:02.910274 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 10:51:02.910306 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 10:51:02.910343 28384 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 10:51:02.910372 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 10:51:02.910398 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 10:51:02.910465 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 10:51:02.910508 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 10:51:02.910542 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 10:51:02.910573 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 10:51:02.910607 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 10:51:02.910651 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 10:51:02.910686 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 10:51:02.910725 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 10:51:02.910758 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 10:51:02.910799 28384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 10:51:02.910831 28384 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 10:51:02.910859 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 10:51:02.910887 28384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 10:51:03.148592 28384 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240204 10:51:03.179939 28384 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([  758,  1139,  1786,  ..., 11229, 10237,  5204]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.955 seconds
[Rank1] pid = 28835
[Rank2] pid = 28881
[Rank3] pid = 28974
[Rank4] pid = 29038
[Rank5] pid = 29102
[Rank6] pid = 29167
INFO [28384 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [28835 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [28881 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [28974 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [29038 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [29102 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [29167 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [29236 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [29167 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29236 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29038 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28881 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28974 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29102 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:51:05.866113 29103 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240204 10:51:05.866410 28975 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 10:51:05.866588 29300 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240204 10:51:05.867812 29170 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 10:51:05.867890 29039 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240204 10:51:05.868028 28911 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
INFO [28384 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28835 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:51:05.870682 29237 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 10:51:05.872203 28836 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 10:51:05.899825 29300 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100027a06000 7.629 MB
W20240204 10:51:05.899999 29300 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000281ab000 7.629 MB
W20240204 10:51:05.900084 29300 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10002894e000 1.49 GB
W20240204 10:51:05.900151 29300 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1000886d4000 1.49 GB
W20240204 10:51:05.900133 28975 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100087f31000 7.629 MB
W20240204 10:51:05.900213 29300 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:51:05.900332 28975 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000e7cb7000 7.629 MB
W20240204 10:51:05.900396 28975 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1000e845a000 1.49 GB
W20240204 10:51:05.900446 28975 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100147a3d000 1.49 GB
W20240204 10:51:05.900507 28975 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:51:05.903861 29300 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:51:05.903885 28975 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:51:05.916242 29039 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1001a7034000 7.629 MB
W20240204 10:51:05.916251 29103 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1001a77d7000 7.629 MB
W20240204 10:51:05.916368 29237 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1001a7f7a000 7.629 MB
W20240204 10:51:05.916464 28836 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1001a871d000 7.629 MB
W20240204 10:51:05.916520 29170 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1001a8ec0000 7.629 MB
W20240204 10:51:05.916585 28911 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1001a9663000 7.629 MB
W20240204 10:51:05.916718 29170 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1001a9e06000 7.629 MB
W20240204 10:51:05.916733 29039 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1001aa5a9000 7.629 MB
W20240204 10:51:05.916761 29237 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1001aad4c000 7.629 MB
W20240204 10:51:05.916782 28911 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1001ab4ef000 7.629 MB
W20240204 10:51:05.916802 29103 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1001abc92000 7.629 MB
W20240204 10:51:05.916813 29039 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1001ac435000 1.49 GB
W20240204 10:51:05.916832 29170 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10020ba18000 1.49 GB
W20240204 10:51:05.916849 29237 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10026affb000 1.49 GB
W20240204 10:51:05.916880 29039 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1002ca5de000 1.49 GB
W20240204 10:51:05.916898 29103 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10032a364000 1.49 GB
W20240204 10:51:05.916891 28836 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100329bc1000 7.629 MB
W20240204 10:51:05.916929 28911 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x100389947000 1.49 GB
W20240204 10:51:05.916950 29237 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1003e8f2a000 1.49 GB
W20240204 10:51:05.916960 29170 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10044850d000 1.49 GB
W20240204 10:51:05.916990 29103 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1004a7af0000 1.49 GB
W20240204 10:51:05.917024 29237 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:51:05.917045 28911 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1005070d3000 1.49 GB
W20240204 10:51:05.917054 29039 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:51:05.917055 29103 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:51:05.917063 29170 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:51:05.917088 28836 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1005666b6000 1.49 GB
W20240204 10:51:05.917140 28911 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:51:05.917173 28836 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1005c5c99000 1.49 GB
W20240204 10:51:05.917259 28836 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:51:05.928716 29237 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:51:05.928732 29039 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:51:05.928742 29103 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:51:05.928743 28836 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:51:05.928752 28911 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:51:05.928786 29170 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [28835 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [28881 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [29167 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [28974 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [29236 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [29102 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [29038 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 29236
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [28384 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 10:51:08.389923 29237 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 10:51:08.390543 29300 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:51:08.390667 29103 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:51:08.390796 28975 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:51:08.390944 28836 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:51:08.391057 29170 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:51:08.391183 29039 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:51:08.391345 28911 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 10:51:08.394590 29237 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 6,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 10:51:08.394752 29237 grad_base.h:184] Init GradProcessingBase done
I20240204 10:51:08.397524 29237 grad_async_v1.h:203] Use main thread to update emb.
W20240204 10:51:08.397578 29237 kg_controller.h:75] after init GradAsyncProcessing
I20240204 10:51:08.397588 29237 kg_controller.h:84] Construct KGCacheController done
E20240204 10:51:09.112715 28836 recstore.cc:66] init folly done
E20240204 10:51:09.112741 28911 recstore.cc:66] init folly done
E20240204 10:51:09.112756 29103 recstore.cc:66] init folly done
E20240204 10:51:09.112772 28975 recstore.cc:66] init folly done
E20240204 10:51:09.112772 29039 recstore.cc:66] init folly done
E20240204 10:51:09.113137 29300 recstore.cc:66] init folly done
E20240204 10:51:09.113186 29237 recstore.cc:66] init folly done
E20240204 10:51:09.113188 29170 recstore.cc:66] init folly done
I20240204 10:51:09.114156 29237 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 10:51:09.911172 28975 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 10:51:09.918350 29103 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:51:09.919867 29039 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:51:09.922435 29300 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:51:09.929059 28836 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:51:09.933300 29170 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:51:09.943658 28911 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:51:09.970132 29237 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 10:51:12.461782 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240204 10:51:12.586592 29848 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 945.209 us                | 10.450 ms                 |
| Forward                   | 4.026 ms                  | 667.989 ms                |
| Backward                  | 8.762 ms                  | 238.143 ms                |
| Optimize                  | 2.370 ms                  | 6.755 ms                  |
| BarrierTimeBeforeRank0    | 1.957 ms                  | 11.917 ms                 |
| AfterBackward             | 24.194 ms                 | 1.575 s                   |
| BlockToStepN              | 48.826 us                 | 80.482 ms                 |
| OneStep                   | 52.511 ms                 | 2.573 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:13.899065 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=16, pq.top=16
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.697 ms                  | 403.080 ms                |
| ProcessBack:UpdateCache   | 8.297 ms                  | 891.069 ms                |
| ProcessBack:UpsertPq      | 7.225 ms                  | 24.199 ms                 |
| ProcessOneStep            | 24.840 ms                 | 1.574 s                   |
| BlockToStepN              | 635.000 ns                | 112.025 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:14.935655 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=22, pq.top=22
W20240204 10:51:15.940764 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240204 10:51:16.972318 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=36, pq.top=36
W20240204 10:51:17.972012 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=42, pq.top=42
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.004 ms                  | 22.920 ms                 |
| Forward                   | 4.687 ms                  | 667.989 ms                |
| Backward                  | 8.802 ms                  | 238.143 ms                |
| Optimize                  | 1.997 ms                  | 6.755 ms                  |
| BarrierTimeBeforeRank0    | 101.112 us                | 11.917 ms                 |
| AfterBackward             | 27.528 ms                 | 1.575 s                   |
| BlockToStepN              | 90.925 ms                 | 163.491 ms                |
| OneStep                   | 142.715 ms                | 2.573 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:18.972013 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=48, pq.top=48
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.631 ms                  | 367.407 ms                |
| ProcessBack:UpdateCache   | 8.806 ms                  | 890.195 ms                |
| ProcessBack:UpsertPq      | 8.928 ms                  | 22.830 ms                 |
| ProcessOneStep            | 27.502 ms                 | 1.574 s                   |
| BlockToStepN              | 93.997 ms                 | 162.715 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:19.972007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=54, pq.top=54
W20240204 10:51:21.023015 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=60, pq.top=60
W20240204 10:51:22.023018 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240204 10:51:23.023006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=70, pq.top=70
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.473 ms                  | 21.325 ms                 |
| Forward                   | 4.687 ms                  | 18.961 ms                 |
| Backward                  | 8.760 ms                  | 20.831 ms                 |
| Optimize                  | 1.997 ms                  | 5.954 ms                  |
| BarrierTimeBeforeRank0    | 328.350 us                | 11.917 ms                 |
| AfterBackward             | 28.019 ms                 | 494.705 ms                |
| BlockToStepN              | 105.928 ms                | 165.046 ms                |
| OneStep                   | 157.765 ms                | 630.421 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:24.023006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.809 ms                  | 367.407 ms                |
| ProcessBack:UpdateCache   | 8.945 ms                  | 890.195 ms                |
| ProcessBack:UpsertPq      | 9.328 ms                  | 22.830 ms                 |
| ProcessOneStep            | 28.084 ms                 | 494.520 ms                |
| BlockToStepN              | 106.327 ms                | 165.799 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:25.023016 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=80, pq.top=80
W20240204 10:51:26.023006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240204 10:51:27.023007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240204 10:51:28.023015 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=94, pq.top=94
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.913 ms                  | 21.325 ms                 |
| Forward                   | 4.733 ms                  | 18.961 ms                 |
| Backward                  | 8.732 ms                  | 20.831 ms                 |
| Optimize                  | 1.965 ms                  | 5.954 ms                  |
| BarrierTimeBeforeRank0    | 739.002 us                | 11.917 ms                 |
| AfterBackward             | 28.144 ms                 | 494.705 ms                |
| BlockToStepN              | 118.348 ms                | 189.711 ms                |
| OneStep                   | 169.779 ms                | 630.421 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:29.059322 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.827 ms                  | 12.065 ms                 |
| ProcessBack:UpdateCache   | 8.945 ms                  | 11.221 ms                 |
| ProcessBack:UpsertPq      | 9.284 ms                  | 19.082 ms                 |
| ProcessOneStep            | 28.084 ms                 | 494.520 ms                |
| BlockToStepN              | 121.460 ms                | 189.579 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 19.570, sample: 0.337, forward: 1.066, backward: 1.157, update: 0.188
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 19.568, sample: 0.353, forward: 1.124, backward: 1.027, update: 0.182
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 19.579, sample: 0.320, forward: 1.060, backward: 1.005, update: 0.168
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 19.557, sample: 0.346, forward: 1.043, backward: 1.121, update: 0.188
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 19.561, sample: 0.334, forward: 1.057, backward: 0.643, update: 0.169
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 19.547, sample: 0.378, forward: 1.084, backward: 0.867, update: 0.180
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 19.572, sample: 0.333, forward: 1.066, backward: 1.126, update: 0.182
train_sampler.Prefill()
-------Step 0-------
tensor([ 2375,    71,  3603,  2456, 13194,  9589,   997,   446, 13896, 12600]) tensor([ 1786, 11288,  7359,  8304, 12341,  1126,   563,  3823,   529, 13311])
-------Step 1-------
tensor([ 2375,    71,  3603,  2456, 13194,  9589,   997,   446, 13896, 12600]) tensor([ 4898, 11320, 13820,  1600,   990,  7630, 14512, 11124,  6399, 13947])
-------Step 2-------
tensor([ 9416, 12088,  4008,  4795, 11783, 10636,  7558,    90,  7947,   871]) tensor([ 4115,  5594,  4789,  9671,  6601,  6500, 14327, 11608, 13945, 11604])
-------Step 3-------
tensor([ 9416, 12088,  4008,  4795, 11783, 10636,  7558,    90,  7947,   871]) tensor([10394,  7589,  5401,  8126,  5120,   714,  5953,  2334, 13424,  2513])
-------Step 4-------
tensor([   71, 13217, 11972,  4090,  6731,  3727,    79,  5217,  9282,  1105]) tensor([ 595, 1050, 5088, 2459, 3422, 2845,  446, 7527, 7287, 2110])
-------Step 5-------
tensor([   71, 13217, 11972,  4090,  6731,  3727,    79,  5217,  9282,  1105]) tensor([12392,  3589,  4415,  1928,  3582,   842,   793,  1190,  7723,  8470])
-------Step 6-------
tensor([ 1790, 10449,    34,    45,  9898,  2261,  6136,  8437, 10543,  9619]) tensor([12088,  3681,  7473,  4954,  6614, 10858,  3047,  6392,  7428, 13126])
-------Step 7-------
tensor([ 1790, 10449,    34,    45,  9898,  2261,  6136,  8437, 10543,  9619]) tensor([13700,  9864,  4960,  7461,  1387,  6319,  5252,  4142,   148, 13233])
-------Step 8-------
tensor([ 4395,  8375,  3710, 13465,    23,    78,  6984, 13084,    63,  2218]) tensor([ 6694,  4127,  3482,  8731,  3375, 14027, 11090,  1267, 11442,  3649])
-------Step 9-------
tensor([ 4395,  8375,  3710, 13465,    23,    78,  6984, 13084,    63,  2218]) tensor([13287,  3026,  9625,  8086, 14893, 14391, 14658, 11124,   672,  9528])
before start barrier
start train
[proc 0] 100 steps, total: 19.520, sample: 0.404, forward: 1.180, backward: 1.116, update: 0.211
W20240204 10:51:30.059006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240204 10:51:31.059015 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240204 10:51:32.090307 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=112, pq.top=112
W20240204 10:51:33.090006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=116, pq.top=116
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.646 ms                  | 22.920 ms                 |
| Forward                   | 4.776 ms                  | 18.961 ms                 |
| Backward                  | 8.732 ms                  | 20.831 ms                 |
| Optimize                  | 1.978 ms                  | 6.755 ms                  |
| BarrierTimeBeforeRank0    | 686.171 us                | 13.664 ms                 |
| AfterBackward             | 28.160 ms                 | 494.705 ms                |
| BlockToStepN              | 134.305 ms                | 204.992 ms                |
| OneStep                   | 185.680 ms                | 630.421 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:34.090005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=120, pq.top=120
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.863 ms                  | 12.220 ms                 |
| ProcessBack:UpdateCache   | 9.028 ms                  | 11.221 ms                 |
| ProcessBack:UpsertPq      | 9.332 ms                  | 19.082 ms                 |
| ProcessOneStep            | 28.120 ms                 | 494.520 ms                |
| BlockToStepN              | 135.674 ms                | 209.201 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:35.090020 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=124, pq.top=124
W20240204 10:51:36.090008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=128, pq.top=128
W20240204 10:51:37.090006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=132, pq.top=132
W20240204 10:51:38.113580 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=136, pq.top=136
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.646 ms                  | 24.190 ms                 |
| Forward                   | 4.724 ms                  | 18.961 ms                 |
| Backward                  | 8.747 ms                  | 20.831 ms                 |
| Optimize                  | 1.965 ms                  | 6.755 ms                  |
| BarrierTimeBeforeRank0    | 621.748 us                | 13.664 ms                 |
| AfterBackward             | 28.160 ms                 | 494.705 ms                |
| BlockToStepN              | 141.736 ms                | 236.844 ms                |
| OneStep                   | 200.649 ms                | 630.421 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.871 ms                  | 12.065 ms                 |
| ProcessBack:UpdateCache   | 8.994 ms                  | 11.142 ms                 |
| ProcessBack:UpsertPq      | 9.347 ms                  | 18.545 ms                 |
| ProcessOneStep            | 28.133 ms                 | 494.520 ms                |
| BlockToStepN              | 142.926 ms                | 259.492 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:39.143535 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240204 10:51:40.143019 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240204 10:51:41.143007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240204 10:51:42.143007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240204 10:51:43.143005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.575 ms                  | 22.996 ms                 |
| Forward                   | 4.724 ms                  | 13.183 ms                 |
| Backward                  | 8.720 ms                  | 17.924 ms                 |
| Optimize                  | 1.965 ms                  | 5.954 ms                  |
| BarrierTimeBeforeRank0    | 541.411 us                | 12.478 ms                 |
| AfterBackward             | 28.198 ms                 | 60.471 ms                 |
| BlockToStepN              | 153.496 ms                | 246.853 ms                |
| OneStep                   | 208.297 ms                | 327.384 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.901 ms                  | 12.065 ms                 |
| ProcessBack:UpdateCache   | 9.040 ms                  | 11.412 ms                 |
| ProcessBack:UpsertPq      | 9.347 ms                  | 18.545 ms                 |
| ProcessOneStep            | 28.133 ms                 | 60.421 ms                 |
| BlockToStepN              | 153.954 ms                | 247.169 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:44.143015 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=158, pq.top=158
W20240204 10:51:45.143007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=162, pq.top=162
W20240204 10:51:46.191892 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240204 10:51:47.191005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240204 10:51:48.191005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.509 ms                  | 22.996 ms                 |
| Forward                   | 4.733 ms                  | 13.183 ms                 |
| Backward                  | 8.717 ms                  | 17.924 ms                 |
| Optimize                  | 1.955 ms                  | 5.954 ms                  |
| BarrierTimeBeforeRank0    | 548.689 us                | 14.573 ms                 |
| AfterBackward             | 28.198 ms                 | 60.471 ms                 |
| BlockToStepN              | 160.201 ms                | 259.536 ms                |
| OneStep                   | 213.727 ms                | 334.976 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.901 ms                  | 11.773 ms                 |
| ProcessBack:UpdateCache   | 9.094 ms                  | 11.221 ms                 |
| ProcessBack:UpsertPq      | 9.344 ms                  | 16.533 ms                 |
| ProcessOneStep            | 28.168 ms                 | 60.421 ms                 |
| BlockToStepN              | 161.290 ms                | 259.492 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:49.250293 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240204 10:51:50.250008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240204 10:51:51.259646 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240204 10:51:52.259006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240204 10:51:53.259013 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.504 ms                  | 22.996 ms                 |
| Forward                   | 4.746 ms                  | 13.183 ms                 |
| Backward                  | 8.716 ms                  | 17.924 ms                 |
| Optimize                  | 1.948 ms                  | 5.954 ms                  |
| BarrierTimeBeforeRank0    | 697.271 us                | 16.968 ms                 |
| AfterBackward             | 28.198 ms                 | 60.471 ms                 |
| BlockToStepN              | 168.578 ms                | 259.536 ms                |
| OneStep                   | 225.900 ms                | 334.976 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.868 ms                  | 11.773 ms                 |
| ProcessBack:UpdateCache   | 9.173 ms                  | 11.416 ms                 |
| ProcessBack:UpsertPq      | 9.357 ms                  | 16.533 ms                 |
| ProcessOneStep            | 28.168 ms                 | 60.421 ms                 |
| BlockToStepN              | 169.737 ms                | 259.492 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:54.259004 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240204 10:51:55.259006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=198
[proc 7] 200 steps, total: 26.520, sample: 0.350, forward: 0.432, backward: 0.858, update: 0.171
[proc 5] 200 steps, total: 26.520, sample: 0.369, forward: 0.448, backward: 0.803, update: 0.184
[proc 2] 200 steps, total: 26.520, sample: 0.356, forward: 0.436, backward: 0.542, update: 0.170
[proc 3] 200 steps, total: 26.520, sample: 0.359, forward: 0.430, backward: 0.835, update: 0.175
[proc 6] 200 steps, total: 26.520, sample: 0.379, forward: 0.466, backward: 0.880, update: 0.182
[proc 1] 200 steps, total: 26.520, sample: 0.332, forward: 0.422, backward: 0.425, update: 0.165
[proc 4] 200 steps, total: 26.520, sample: 0.379, forward: 0.448, backward: 0.918, update: 0.183
[proc 0] 200 steps, total: 26.519, sample: 0.445, forward: 0.475, backward: 0.876, update: 0.198
W20240204 10:51:56.305516 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=202, pq.top=202
W20240204 10:51:57.305009 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240204 10:51:58.322165 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.473 ms                  | 22.996 ms                 |
| Forward                   | 4.743 ms                  | 13.183 ms                 |
| Backward                  | 8.717 ms                  | 20.831 ms                 |
| Optimize                  | 1.947 ms                  | 5.954 ms                  |
| BarrierTimeBeforeRank0    | 739.002 us                | 20.146 ms                 |
| AfterBackward             | 28.221 ms                 | 60.471 ms                 |
| BlockToStepN              | 180.933 ms                | 263.025 ms                |
| OneStep                   | 232.080 ms                | 334.976 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.863 ms                  | 11.773 ms                 |
| ProcessBack:UpdateCache   | 9.200 ms                  | 11.416 ms                 |
| ProcessBack:UpsertPq      | 9.363 ms                  | 16.533 ms                 |
| ProcessOneStep            | 28.193 ms                 | 60.421 ms                 |
| BlockToStepN              | 181.890 ms                | 262.974 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:51:59.322013 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240204 10:52:00.322010 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240204 10:52:01.336537 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240204 10:52:02.336009 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240204 10:52:03.336087 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.504 ms                  | 22.996 ms                 |
| Forward                   | 4.741 ms                  | 18.961 ms                 |
| Backward                  | 8.717 ms                  | 20.831 ms                 |
| Optimize                  | 1.937 ms                  | 5.954 ms                  |
| BarrierTimeBeforeRank0    | 739.002 us                | 20.146 ms                 |
| AfterBackward             | 28.198 ms                 | 60.471 ms                 |
| BlockToStepN              | 185.357 ms                | 280.343 ms                |
| OneStep                   | 236.613 ms                | 353.316 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.830 ms                  | 11.444 ms                 |
| ProcessBack:UpdateCache   | 9.213 ms                  | 11.412 ms                 |
| ProcessBack:UpsertPq      | 9.372 ms                  | 16.322 ms                 |
| ProcessOneStep            | 28.146 ms                 | 60.421 ms                 |
| BlockToStepN              | 185.340 ms                | 280.237 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:04.356361 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240204 10:52:05.356007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240204 10:52:06.387102 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240204 10:52:07.387008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240204 10:52:08.387025 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.475 ms                  | 22.996 ms                 |
| Forward                   | 4.730 ms                  | 18.961 ms                 |
| Backward                  | 8.714 ms                  | 20.831 ms                 |
| Optimize                  | 1.940 ms                  | 5.954 ms                  |
| BarrierTimeBeforeRank0    | 746.582 us                | 20.146 ms                 |
| AfterBackward             | 28.198 ms                 | 60.471 ms                 |
| BlockToStepN              | 189.362 ms                | 284.791 ms                |
| OneStep                   | 241.348 ms                | 353.316 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.827 ms                  | 11.444 ms                 |
| ProcessBack:UpdateCache   | 9.255 ms                  | 11.412 ms                 |
| ProcessBack:UpsertPq      | 9.386 ms                  | 16.322 ms                 |
| ProcessOneStep            | 28.193 ms                 | 60.421 ms                 |
| BlockToStepN              | 189.579 ms                | 284.741 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:09.387008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240204 10:52:10.387005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240204 10:52:11.387005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=252, pq.top=252
W20240204 10:52:12.387023 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240204 10:52:13.387012 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.509 ms                  | 22.920 ms                 |
| Forward                   | 4.733 ms                  | 13.183 ms                 |
| Backward                  | 8.717 ms                  | 20.623 ms                 |
| Optimize                  | 1.940 ms                  | 5.565 ms                  |
| BarrierTimeBeforeRank0    | 754.159 us                | 20.787 ms                 |
| AfterBackward             | 28.231 ms                 | 40.825 ms                 |
| BlockToStepN              | 191.385 ms                | 284.791 ms                |
| OneStep                   | 246.179 ms                | 351.616 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.825 ms                  | 11.444 ms                 |
| ProcessBack:UpdateCache   | 9.279 ms                  | 11.412 ms                 |
| ProcessBack:UpsertPq      | 9.402 ms                  | 16.322 ms                 |
| ProcessOneStep            | 28.208 ms                 | 40.778 ms                 |
| BlockToStepN              | 191.941 ms                | 290.520 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:14.387008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240204 10:52:15.387009 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240204 10:52:16.387009 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240204 10:52:17.387027 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240204 10:52:18.387009 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.537 ms                  | 22.920 ms                 |
| Forward                   | 4.730 ms                  | 13.183 ms                 |
| Backward                  | 8.720 ms                  | 20.623 ms                 |
| Optimize                  | 1.937 ms                  | 5.565 ms                  |
| BarrierTimeBeforeRank0    | 936.261 us                | 20.787 ms                 |
| AfterBackward             | 28.250 ms                 | 40.825 ms                 |
| BlockToStepN              | 197.512 ms                | 299.957 ms                |
| OneStep                   | 249.870 ms                | 358.696 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.803 ms                  | 11.287 ms                 |
| ProcessBack:UpdateCache   | 9.287 ms                  | 11.221 ms                 |
| ProcessBack:UpsertPq      | 9.440 ms                  | 16.160 ms                 |
| ProcessOneStep            | 28.227 ms                 | 40.778 ms                 |
| BlockToStepN              | 197.634 ms                | 299.910 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:19.387008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240204 10:52:20.417287 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240204 10:52:21.417006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240204 10:52:22.448877 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.538 ms                  | 23.431 ms                 |
| Forward                   | 4.718 ms                  | 13.183 ms                 |
| Backward                  | 8.720 ms                  | 20.623 ms                 |
| Optimize                  | 1.934 ms                  | 5.565 ms                  |
| BarrierTimeBeforeRank0    | 993.352 us                | 20.787 ms                 |
| AfterBackward             | 28.254 ms                 | 40.825 ms                 |
| BlockToStepN              | 202.420 ms                | 304.485 ms                |
| OneStep                   | 254.158 ms                | 372.014 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:23.448004 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=290, pq.top=290
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.797 ms                  | 11.287 ms                 |
| ProcessBack:UpdateCache   | 9.336 ms                  | 11.221 ms                 |
| ProcessBack:UpsertPq      | 9.450 ms                  | 16.897 ms                 |
| ProcessOneStep            | 28.228 ms                 | 40.778 ms                 |
| BlockToStepN              | 202.461 ms                | 304.429 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:24.448009 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240204 10:52:25.493077 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240204 10:52:26.509303 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=300, pq.top=300
[proc 1] 300 steps, total: 30.824, sample: 0.338, forward: 0.425, backward: 0.799, update: 0.180
[proc 4] 300 steps, total: 30.824, sample: 0.345, forward: 0.447, backward: 0.806, update: 0.172
[proc 6] 300 steps, total: 30.825, sample: 0.376, forward: 0.475, backward: 0.871, update: 0.179
[proc 3] 300 steps, total: 30.825, sample: 0.326, forward: 0.429, backward: 0.794, update: 0.177
[proc 5] 300 steps, total: 30.825, sample: 0.310, forward: 0.428, backward: 0.564, update: 0.165
[proc 7] 300 steps, total: 30.825, sample: 0.347, forward: 0.449, backward: 0.850, update: 0.169
[proc 2] 300 steps, total: 30.825, sample: 0.363, forward: 0.473, backward: 0.888, update: 0.186
[proc 0] 300 steps, total: 30.824, sample: 0.428, forward: 0.494, backward: 0.925, update: 0.194
W20240204 10:52:27.509019 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.553 ms                  | 23.431 ms                 |
| Forward                   | 4.718 ms                  | 13.183 ms                 |
| Backward                  | 8.720 ms                  | 20.623 ms                 |
| Optimize                  | 1.934 ms                  | 5.565 ms                  |
| BarrierTimeBeforeRank0    | 1.119 ms                  | 20.787 ms                 |
| AfterBackward             | 28.269 ms                 | 40.825 ms                 |
| BlockToStepN              | 207.708 ms                | 320.096 ms                |
| OneStep                   | 259.665 ms                | 399.039 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:28.509006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.780 ms                  | 11.287 ms                 |
| ProcessBack:UpdateCache   | 9.366 ms                  | 11.317 ms                 |
| ProcessBack:UpsertPq      | 9.467 ms                  | 16.953 ms                 |
| ProcessOneStep            | 28.242 ms                 | 40.778 ms                 |
| BlockToStepN              | 207.655 ms                | 320.478 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:29.509008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=308, pq.top=308
W20240204 10:52:30.509006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240204 10:52:31.509008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=314, pq.top=314
W20240204 10:52:32.524827 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=318, pq.top=318
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.575 ms                  | 23.431 ms                 |
| Forward                   | 4.713 ms                  | 18.961 ms                 |
| Backward                  | 8.720 ms                  | 20.623 ms                 |
| Optimize                  | 1.932 ms                  | 5.565 ms                  |
| BarrierTimeBeforeRank0    | 1.119 ms                  | 20.787 ms                 |
| AfterBackward             | 28.347 ms                 | 40.825 ms                 |
| BlockToStepN              | 209.304 ms                | 320.602 ms                |
| OneStep                   | 266.796 ms                | 400.612 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:33.524008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.777 ms                  | 11.287 ms                 |
| ProcessBack:UpdateCache   | 9.386 ms                  | 11.412 ms                 |
| ProcessBack:UpsertPq      | 9.495 ms                  | 16.953 ms                 |
| ProcessOneStep            | 28.312 ms                 | 40.778 ms                 |
| BlockToStepN              | 210.579 ms                | 320.478 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:34.569550 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=324, pq.top=324
W20240204 10:52:35.569006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240204 10:52:36.569007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240204 10:52:37.569015 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=333, pq.top=333
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.580 ms                  | 23.431 ms                 |
| Forward                   | 4.676 ms                  | 18.961 ms                 |
| Backward                  | 8.720 ms                  | 20.623 ms                 |
| Optimize                  | 1.931 ms                  | 5.565 ms                  |
| BarrierTimeBeforeRank0    | 1.186 ms                  | 20.787 ms                 |
| AfterBackward             | 28.326 ms                 | 40.825 ms                 |
| BlockToStepN              | 213.757 ms                | 324.968 ms                |
| OneStep                   | 270.057 ms                | 400.612 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:38.569005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=336, pq.top=336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.759 ms                  | 11.083 ms                 |
| ProcessBack:UpdateCache   | 9.397 ms                  | 11.317 ms                 |
| ProcessBack:UpsertPq      | 9.516 ms                  | 18.545 ms                 |
| ProcessOneStep            | 28.296 ms                 | 40.778 ms                 |
| BlockToStepN              | 213.703 ms                | 324.851 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:39.569006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240204 10:52:40.569006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=342, pq.top=342
W20240204 10:52:41.569007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240204 10:52:42.569015 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=348, pq.top=348
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.610 ms                  | 22.996 ms                 |
| Forward                   | 4.676 ms                  | 13.183 ms                 |
| Backward                  | 8.717 ms                  | 17.924 ms                 |
| Optimize                  | 1.922 ms                  | 3.984 ms                  |
| BarrierTimeBeforeRank0    | 1.259 ms                  | 20.787 ms                 |
| AfterBackward             | 28.347 ms                 | 40.474 ms                 |
| BlockToStepN              | 215.376 ms                | 332.829 ms                |
| OneStep                   | 272.936 ms                | 400.612 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:43.569005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=351, pq.top=351
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.759 ms                  | 11.083 ms                 |
| ProcessBack:UpdateCache   | 9.405 ms                  | 11.317 ms                 |
| ProcessBack:UpsertPq      | 9.532 ms                  | 19.082 ms                 |
| ProcessOneStep            | 28.296 ms                 | 40.446 ms                 |
| BlockToStepN              | 215.323 ms                | 328.407 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:44.569008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=354, pq.top=354
W20240204 10:52:45.569005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=358, pq.top=358
W20240204 10:52:46.570781 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=361, pq.top=361
W20240204 10:52:47.628062 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=364, pq.top=364
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.623 ms                  | 22.996 ms                 |
| Forward                   | 4.674 ms                  | 13.183 ms                 |
| Backward                  | 8.704 ms                  | 17.924 ms                 |
| Optimize                  | 1.915 ms                  | 3.984 ms                  |
| BarrierTimeBeforeRank0    | 1.384 ms                  | 20.834 ms                 |
| AfterBackward             | 28.352 ms                 | 40.474 ms                 |
| BlockToStepN              | 217.645 ms                | 332.829 ms                |
| OneStep                   | 275.190 ms                | 400.612 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:48.656369 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=367, pq.top=367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.737 ms                  | 11.083 ms                 |
| ProcessBack:UpdateCache   | 9.477 ms                  | 11.317 ms                 |
| ProcessBack:UpsertPq      | 9.566 ms                  | 19.082 ms                 |
| ProcessOneStep            | 28.325 ms                 | 40.446 ms                 |
| BlockToStepN              | 217.917 ms                | 332.732 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:49.656006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=370, pq.top=370
W20240204 10:52:50.657279 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=373, pq.top=373
W20240204 10:52:51.657006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=376, pq.top=376
W20240204 10:52:52.657006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=379, pq.top=379
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.623 ms                  | 22.996 ms                 |
| Forward                   | 4.656 ms                  | 13.183 ms                 |
| Backward                  | 8.696 ms                  | 17.924 ms                 |
| Optimize                  | 1.907 ms                  | 3.984 ms                  |
| BarrierTimeBeforeRank0    | 1.575 ms                  | 20.834 ms                 |
| AfterBackward             | 28.392 ms                 | 40.474 ms                 |
| BlockToStepN              | 220.342 ms                | 332.829 ms                |
| OneStep                   | 278.098 ms                | 400.612 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:53.657013 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=382, pq.top=382
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.721 ms                  | 10.935 ms                 |
| ProcessBack:UpdateCache   | 9.560 ms                  | 11.221 ms                 |
| ProcessBack:UpsertPq      | 9.575 ms                  | 19.082 ms                 |
| ProcessOneStep            | 28.342 ms                 | 40.446 ms                 |
| BlockToStepN              | 221.468 ms                | 332.732 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:54.657011 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240204 10:52:55.657006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=388, pq.top=388
W20240204 10:52:56.657006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240204 10:52:57.657007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=394, pq.top=394
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.624 ms                  | 22.996 ms                 |
| Forward                   | 4.643 ms                  | 13.183 ms                 |
| Backward                  | 8.683 ms                  | 17.924 ms                 |
| Optimize                  | 1.898 ms                  | 3.984 ms                  |
| BarrierTimeBeforeRank0    | 1.943 ms                  | 23.135 ms                 |
| AfterBackward             | 28.429 ms                 | 40.474 ms                 |
| BlockToStepN              | 224.976 ms                | 338.289 ms                |
| OneStep                   | 281.917 ms                | 403.789 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:52:58.657006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=397, pq.top=397
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.693 ms                  | 10.935 ms                 |
| ProcessBack:UpdateCache   | 9.611 ms                  | 11.317 ms                 |
| ProcessBack:UpsertPq      | 9.598 ms                  | 19.082 ms                 |
| ProcessOneStep            | 28.391 ms                 | 40.446 ms                 |
| BlockToStepN              | 225.626 ms                | 338.187 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 400 steps, total: 32.790, sample: 0.344, forward: 0.439, backward: 0.921, update: 0.180
[proc 4] 400 steps, total: 32.790, sample: 0.375, forward: 0.445, backward: 0.924, update: 0.179
[proc 0] 400 steps, total: 32.790, sample: 0.410, forward: 0.472, backward: 0.610, update: 0.180
[proc 3] 400 steps, total: 32.790, sample: 0.348, forward: 0.427, backward: 0.515, update: 0.164
[proc 6] 400 steps, total: 32.790, sample: 0.355, forward: 0.446, backward: 0.872, update: 0.180
[proc 1] 400 steps, total: 32.790, sample: 0.365, forward: 0.426, backward: 0.875, update: 0.177
[proc 7] 400 steps, total: 32.790, sample: 0.309, forward: 0.445, backward: 0.603, update: 0.170
[proc 2] 400 steps, total: 32.790, sample: 0.360, forward: 0.422, backward: 0.651, update: 0.171
W20240204 10:52:59.669453 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=401, pq.top=401
W20240204 10:53:00.700896 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=404, pq.top=404
W20240204 10:53:01.752468 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240204 10:53:02.798348 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=410, pq.top=410
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.646 ms                  | 22.996 ms                 |
| Forward                   | 4.643 ms                  | 13.183 ms                 |
| Backward                  | 8.673 ms                  | 17.924 ms                 |
| Optimize                  | 1.892 ms                  | 3.984 ms                  |
| BarrierTimeBeforeRank0    | 2.095 ms                  | 23.610 ms                 |
| AfterBackward             | 28.429 ms                 | 40.474 ms                 |
| BlockToStepN              | 228.744 ms                | 338.289 ms                |
| OneStep                   | 285.203 ms                | 403.789 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:03.798007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=412, pq.top=412
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 10.935 ms                 |
| ProcessBack:UpdateCache   | 9.694 ms                  | 11.317 ms                 |
| ProcessBack:UpsertPq      | 9.612 ms                  | 19.082 ms                 |
| ProcessOneStep            | 28.398 ms                 | 40.446 ms                 |
| BlockToStepN              | 228.838 ms                | 342.065 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:04.798017 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=415, pq.top=415
W20240204 10:53:05.798008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240204 10:53:06.798007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=420, pq.top=420
W20240204 10:53:07.798005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=423, pq.top=423
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.652 ms                  | 23.340 ms                 |
| Forward                   | 4.644 ms                  | 13.183 ms                 |
| Backward                  | 8.670 ms                  | 17.924 ms                 |
| Optimize                  | 1.894 ms                  | 3.984 ms                  |
| BarrierTimeBeforeRank0    | 2.122 ms                  | 23.610 ms                 |
| AfterBackward             | 28.429 ms                 | 40.474 ms                 |
| BlockToStepN              | 230.626 ms                | 357.227 ms                |
| OneStep                   | 289.368 ms                | 426.801 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:08.798005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=426, pq.top=426
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 10.935 ms                 |
| ProcessBack:UpdateCache   | 9.705 ms                  | 11.221 ms                 |
| ProcessBack:UpsertPq      | 9.627 ms                  | 18.866 ms                 |
| ProcessOneStep            | 28.402 ms                 | 40.446 ms                 |
| BlockToStepN              | 230.589 ms                | 357.055 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:09.798017 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240204 10:53:10.798007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=431, pq.top=431
W20240204 10:53:11.798008 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=434, pq.top=434
W20240204 10:53:12.798007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=437, pq.top=437
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.652 ms                  | 23.340 ms                 |
| Forward                   | 4.641 ms                  | 13.183 ms                 |
| Backward                  | 8.659 ms                  | 17.924 ms                 |
| Optimize                  | 1.889 ms                  | 3.984 ms                  |
| BarrierTimeBeforeRank0    | 2.472 ms                  | 23.625 ms                 |
| AfterBackward             | 28.429 ms                 | 40.474 ms                 |
| BlockToStepN              | 232.999 ms                | 357.227 ms                |
| OneStep                   | 291.840 ms                | 426.801 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:13.798007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=440, pq.top=440
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.675 ms                  | 10.935 ms                 |
| ProcessBack:UpdateCache   | 9.760 ms                  | 11.221 ms                 |
| ProcessBack:UpsertPq      | 9.643 ms                  | 18.866 ms                 |
| ProcessOneStep            | 28.398 ms                 | 40.446 ms                 |
| BlockToStepN              | 233.003 ms                | 357.055 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:14.798010 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=443, pq.top=443
W20240204 10:53:15.798017 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=446, pq.top=446
W20240204 10:53:16.798007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240204 10:53:17.811417 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=452, pq.top=452
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.646 ms                  | 22.996 ms                 |
| Forward                   | 4.636 ms                  | 13.183 ms                 |
| Backward                  | 8.652 ms                  | 17.728 ms                 |
| Optimize                  | 1.885 ms                  | 3.841 ms                  |
| BarrierTimeBeforeRank0    | 2.713 ms                  | 23.625 ms                 |
| AfterBackward             | 28.432 ms                 | 39.148 ms                 |
| BlockToStepN              | 235.264 ms                | 357.227 ms                |
| OneStep                   | 293.736 ms                | 416.569 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:18.811007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=454, pq.top=454
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.675 ms                  | 10.935 ms                 |
| ProcessBack:UpdateCache   | 9.793 ms                  | 11.329 ms                 |
| ProcessBack:UpsertPq      | 9.666 ms                  | 18.866 ms                 |
| ProcessOneStep            | 28.414 ms                 | 39.116 ms                 |
| BlockToStepN              | 235.546 ms                | 357.055 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:19.811007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240204 10:53:20.811020 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=460, pq.top=460
W20240204 10:53:21.811007 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=463, pq.top=463
W20240204 10:53:22.814332 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=466, pq.top=466
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.646 ms                  | 22.996 ms                 |
| Forward                   | 4.636 ms                  | 16.578 ms                 |
| Backward                  | 8.657 ms                  | 17.728 ms                 |
| Optimize                  | 1.885 ms                  | 3.841 ms                  |
| BarrierTimeBeforeRank0    | 2.472 ms                  | 23.625 ms                 |
| AfterBackward             | 28.472 ms                 | 40.462 ms                 |
| BlockToStepN              | 237.620 ms                | 357.227 ms                |
| OneStep                   | 295.820 ms                | 422.051 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:23.814006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=468, pq.top=468
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.679 ms                  | 11.083 ms                 |
| ProcessBack:UpdateCache   | 9.746 ms                  | 11.329 ms                 |
| ProcessBack:UpsertPq      | 9.677 ms                  | 19.771 ms                 |
| ProcessOneStep            | 28.446 ms                 | 40.435 ms                 |
| BlockToStepN              | 237.584 ms                | 359.784 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:24.814006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240204 10:53:25.814019 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240204 10:53:26.814006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=476, pq.top=476
W20240204 10:53:27.814006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=479, pq.top=479
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.661 ms                  | 22.996 ms                 |
| Forward                   | 4.643 ms                  | 16.578 ms                 |
| Backward                  | 8.659 ms                  | 17.728 ms                 |
| Optimize                  | 1.889 ms                  | 3.841 ms                  |
| BarrierTimeBeforeRank0    | 2.414 ms                  | 23.625 ms                 |
| AfterBackward             | 28.481 ms                 | 40.474 ms                 |
| BlockToStepN              | 240.250 ms                | 364.004 ms                |
| OneStep                   | 298.773 ms                | 436.124 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:28.814006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=481, pq.top=481
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 11.287 ms                 |
| ProcessBack:UpdateCache   | 9.730 ms                  | 11.317 ms                 |
| ProcessBack:UpsertPq      | 9.692 ms                  | 20.164 ms                 |
| ProcessOneStep            | 28.458 ms                 | 40.446 ms                 |
| BlockToStepN              | 240.182 ms                | 363.866 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:29.814005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=484, pq.top=484
W20240204 10:53:30.814010 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=486, pq.top=486
W20240204 10:53:31.814016 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=489, pq.top=489
W20240204 10:53:32.814006 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=492, pq.top=492
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.652 ms                  | 22.996 ms                 |
| Forward                   | 4.641 ms                  | 16.578 ms                 |
| Backward                  | 8.659 ms                  | 17.728 ms                 |
| Optimize                  | 1.889 ms                  | 3.841 ms                  |
| BarrierTimeBeforeRank0    | 2.377 ms                  | 23.625 ms                 |
| AfterBackward             | 28.494 ms                 | 40.474 ms                 |
| BlockToStepN              | 241.533 ms                | 376.805 ms                |
| OneStep                   | 301.324 ms                | 446.899 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:33.814005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=495, pq.top=495
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.685 ms                  | 11.287 ms                 |
| ProcessBack:UpdateCache   | 9.743 ms                  | 11.317 ms                 |
| ProcessBack:UpsertPq      | 9.702 ms                  | 20.820 ms                 |
| ProcessOneStep            | 28.463 ms                 | 40.446 ms                 |
| BlockToStepN              | 241.616 ms                | 376.683 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:53:34.814005 29237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=498, pq.top=498
[proc 3] 500 steps, total: 36.103, sample: 0.331, forward: 0.440, backward: 0.584, update: 0.165
[proc 2] 500 steps, total: 36.103, sample: 0.366, forward: 0.431, backward: 0.861, update: 0.178
[proc 4] 500 steps, total: 36.103, sample: 0.341, forward: 0.445, backward: 0.945, update: 0.178
[proc 5] 500 steps, total: 36.103, sample: 0.319, forward: 0.450, backward: 0.919, update: 0.174
[proc 6] 500 steps, total: 36.103, sample: 0.334, forward: 0.491, backward: 0.856, update: 0.184
[proc 7] 500 steps, total: 36.103, sample: 0.351, forward: 0.450, backward: 0.759, update: 0.172
[proc 1] 500 steps, total: 36.103, sample: 0.348, forward: 0.444, backward: 0.806, update: 0.174
[proc 0] 500 steps, total: 36.103, sample: 0.444, forward: 0.504, backward: 0.716, update: 0.191
Successfully xmh. training takes 145.75881242752075 seconds
before call kg_cache_controller.StopThreads()
W20240204 10:53:35.729001 29237 grad_async_v1.h:243] call StopThreads. PID = 28384
W20240204 10:53:35.729028 29237 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 10:53:35.738131 29237 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 10:53:35.738159 29237 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 10:53:35.762754 29237 grad_async_v1.h:264] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f8bafe44450>
