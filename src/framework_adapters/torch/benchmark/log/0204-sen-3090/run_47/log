WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 04:00:58.634502 29415 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_105', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=6, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [29415 sampler.py:454] Start PreSampling
WARNING [29415 sampler.py:532] Before construct renumbering_dict
WARNING [29415 sampler.py:555] PreSampling done
W20240205 04:21:16.697105 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 04:21:16.697276 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 04:21:16.697314 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 04:21:16.697355 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 04:21:16.697388 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 04:21:16.697427 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 04:21:16.697459 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 04:21:16.697499 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 04:21:16.697539 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 04:21:16.697566 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 04:21:16.697602 29415 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 04:21:16.697629 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 04:21:16.697654 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 04:21:16.697811 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 04:21:16.697849 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 04:21:16.697878 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 04:21:16.697921 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 04:21:16.697953 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 04:21:16.697995 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 04:21:16.698020 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 04:21:16.698050 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 04:21:16.698076 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 04:21:16.698112 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 04:21:16.698140 29415 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 04:21:16.698163 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 04:21:16.698184 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 04:21:16.698236 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 04:21:16.698268 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 04:21:16.698302 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 04:21:16.698331 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 04:21:16.698370 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 04:21:16.698402 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 04:21:16.698434 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 04:21:16.698467 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 04:21:16.698498 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 04:21:16.698527 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 04:21:16.698554 29415 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 04:21:16.698575 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 04:21:16.698596 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 04:21:16.698660 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 04:21:16.698693 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 04:21:16.698720 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 04:21:16.698746 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 04:21:16.698772 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 04:21:16.698807 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 04:21:16.698837 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 04:21:16.698872 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 04:21:16.698899 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 04:21:16.698937 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 04:21:16.698966 29415 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 04:21:16.698988 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 04:21:16.699012 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 04:21:16.699064 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 04:21:16.699096 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 04:21:16.699122 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 04:21:16.699154 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 04:21:16.699184 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 04:21:16.699218 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 04:21:16.699249 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 04:21:16.699276 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 04:21:16.699306 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 04:21:16.699344 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 04:21:16.699375 29415 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 04:21:16.699398 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 04:21:16.699424 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 04:21:16.699472 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 04:21:16.699504 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 04:21:16.699537 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 04:21:16.699564 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 04:21:16.699594 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 04:21:16.699625 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 04:21:16.699652 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 04:21:16.699683 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 04:21:16.699714 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 04:21:16.699743 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 04:21:16.699777 29415 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 04:21:16.699800 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 04:21:16.699826 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 04:21:16.699875 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 04:21:16.699916 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 04:21:16.699949 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 04:21:16.699976 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 04:21:16.700011 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 04:21:16.700044 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 04:21:16.700088 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 04:21:16.700116 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 04:21:16.700151 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 04:21:16.700184 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 04:21:16.700214 29415 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 04:21:16.700237 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 04:21:16.700259 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 04:21:16.700314 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 04:21:16.700351 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 04:21:16.700379 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 04:21:16.700412 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 04:21:16.700450 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 04:21:16.700484 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 04:21:16.700517 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 04:21:16.700548 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 04:21:16.700580 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 04:21:16.700610 29415 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 04:21:16.700644 29415 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 04:21:16.700666 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 04:21:16.700688 29415 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 04:21:17.148394 29415 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 04:29:52.838289 29415 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302721,  4302751,    91197,  ..., 67926497, 51699873,  4954667]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2236.395 seconds
[Rank1] pid = 30525
[Rank2] pid = 30622
[Rank3] pid = 30690
[Rank4] pid = 30762
[Rank5] pid = 30831
[Rank6] pid = 30899
INFO [29415 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [30525 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [30622 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [30690 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [30762 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [30831 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [30831 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [30762 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [30899 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [30966 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [30690 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [30622 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [30899 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [30966 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [30525 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 04:38:26.832741 30832 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
INFO [29415 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 04:38:26.834991 30763 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 04:38:26.835196 30526 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 04:38:26.835328 30623 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 04:38:26.834990 30691 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 04:38:26.834990 30900 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 04:38:26.834991 31030 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 04:38:26.835691 30967 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 04:38:26.924798 30832 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1020497ad000 7.629 MB
W20240205 04:38:26.925045 30832 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102049f50000 7.629 MB
W20240205 04:38:26.925129 30832 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10204a6f3000 1.49 GB
W20240205 04:38:26.925172 30832 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1020a9cd6000 1.49 GB
W20240205 04:38:26.925263 30832 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 04:38:26.945937 30900 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1021092bb000 7.629 MB
W20240205 04:38:26.945951 30691 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102109a5e000 7.629 MB
W20240205 04:38:26.946038 30967 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10210a203000 7.629 MB
W20240205 04:38:26.946051 30763 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10210a9a6000 7.629 MB
W20240205 04:38:26.946074 30623 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10210b8ec000 7.629 MB
W20240205 04:38:26.946070 30526 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10210b149000 7.629 MB
W20240205 04:38:26.946161 30832 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 04:38:26.946383 31030 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10210c091000 7.629 MB
W20240205 04:38:26.947846 30623 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10210cfd7000 7.629 MB
W20240205 04:38:26.947841 31030 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10210c834000 7.629 MB
W20240205 04:38:26.947883 30967 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10210d77c000 7.629 MB
W20240205 04:38:26.947901 30526 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210df1f000 7.629 MB
W20240205 04:38:26.947909 30900 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10210e6c2000 7.629 MB
W20240205 04:38:26.947918 30763 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10210ee65000 7.629 MB
W20240205 04:38:26.947983 30691 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10210f608000 7.629 MB
W20240205 04:38:26.948007 30967 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210fdab000 1.49 GB
W20240205 04:38:26.948022 30763 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10216f38e000 1.49 GB
W20240205 04:38:26.948047 30526 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021ce971000 1.49 GB
W20240205 04:38:26.948071 30967 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10228d537000 1.49 GB
W20240205 04:38:26.948069 30623 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10222df54000 1.49 GB
W20240205 04:38:26.948117 30763 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10234c0fd000 1.49 GB
W20240205 04:38:26.948112 30900 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1022ecb1a000 1.49 GB
W20240205 04:38:26.948127 31030 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1023ab6e0000 1.49 GB
W20240205 04:38:26.948173 30691 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10240acc3000 1.49 GB
W20240205 04:38:26.948181 30526 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10246a2a6000 1.49 GB
W20240205 04:38:26.948200 30623 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1024c9889000 1.49 GB
W20240205 04:38:26.948241 30900 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x102528e6c000 1.49 GB
W20240205 04:38:26.948283 30691 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10258844f000 1.49 GB
W20240205 04:38:26.948302 31030 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1025e7a32000 1.49 GB
W20240205 04:38:26.948443 30763 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 04:38:26.948436 31030 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 04:38:26.948534 30967 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 04:38:26.948554 30623 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 04:38:26.948557 30691 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 04:38:26.948565 30900 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 04:38:26.948567 30526 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 04:38:26.964635 30763 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 04:38:26.964637 30623 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 04:38:26.964638 30900 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 04:38:26.964649 31030 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 04:38:26.964644 30691 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 04:38:26.966624 30526 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 04:38:26.976819 30967 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [30966 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [30899 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 30966
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [29415 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [30831 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [30762 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [30525 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [30690 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [30622 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 04:39:17.112375 30623 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 04:39:17.112473 30763 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 04:39:17.112610 30967 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 04:39:17.112692 30691 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 04:39:17.112795 30526 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 04:39:17.112854 31030 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 04:39:17.112947 30900 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 04:39:17.113103 30832 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 04:39:17.115801 30967 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 6,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 04:39:17.116124 30967 grad_base.h:184] Init GradProcessingBase done
I20240205 04:39:29.939103 30967 grad_async_v2.h:42] Use main thread to update emb.
W20240205 04:39:29.939451 30967 kg_controller.h:78] after init GradAsyncProcessingV2
I20240205 04:39:29.939463 30967 kg_controller.h:84] Construct KGCacheController done
E20240205 04:39:30.729292 30691 recstore.cc:66] init folly done
E20240205 04:39:30.729336 31030 recstore.cc:66] init folly done
E20240205 04:39:30.729414 30832 recstore.cc:66] init folly done
E20240205 04:39:30.729583 30526 recstore.cc:66] init folly done
E20240205 04:39:30.729915 30967 recstore.cc:66] init folly done
E20240205 04:39:30.729981 30900 recstore.cc:66] init folly done
E20240205 04:39:30.730042 30623 recstore.cc:66] init folly done
E20240205 04:39:30.730726 30763 recstore.cc:66] init folly done
I20240205 04:39:30.731580 30967 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240205 04:39:48.930552 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 04:39:48.930948 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 04:39:50.177012 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 04:39:50.177145 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 141.280 us                | 350.537 us                |
+---------------------------+---------------------------+---------------------------+
W20240205 04:39:51.778424 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 04:39:51.795841 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 04:39:51.834235 30832 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 04:39:52.194468 31030 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 04:39:52.612008 30763 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 04:39:52.795023 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 04:39:52.850522 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
W20240205 04:39:53.968616 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 04:39:53.985188 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 04:39:54.012354 30623 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 04:39:54.825549 30967 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 04:39:54.985010 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
W20240205 04:39:55.244163 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240205 04:39:55.286903 30526 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 04:39:55.305956 30691 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 191.294 us                | 352.413 us                |
+---------------------------+---------------------------+---------------------------+
E20240205 04:39:56.257107 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 04:39:56.276166 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
I20240205 04:39:56.297752 30900 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.727 ms                  | 7.727 ms                  |
| Forward                   | 761.319 ms                | 761.319 ms                |
+---------------------------+---------------------------+---------------------------+
E20240205 04:39:58.547789 31165 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 04:39:58.650326 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240205 04:39:58.656774 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 04:39:59.547019 31568 parallel_pq_v2.h:79] insert failed, size(hashtable)=3219
W20240205 04:39:59.719583 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240205 04:39:59.767652 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240205 04:40:00.229058 30967 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=13, sample_step_cpp_seen_[rank]=12
E20240205 04:40:00.547009 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=855
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 255.980 us                | 847.416 us                |
| ProcessBack:Shuffle       | 8.504 ms                  | 331.401 ms                |
| ProcessBack:UpdateCache   | 10.067 ms                 | 669.336 ms                |
| ProcessBack:UpsertPq      | 24.813 ms                 | 113.306 ms                |
| ProcessOneStep            | 72.356 ms                 | 1.343 s                   |
| BlockToStepN              | 1.211 ms                  | 29.619 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:00.951156 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240205 04:40:01.547013 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=49
W20240205 04:40:01.918910 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240205 04:40:02.001426 31545 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.301 ms                  | 89.846 ms                 |
| Forward                   | 5.420 ms                  | 761.319 ms                |
| Backward                  | 4.999 ms                  | 182.161 ms                |
| Optimize                  | 2.483 ms                  | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 4.005 ms                  | 53.305 ms                 |
| AfterBackward             | 72.396 ms                 | 1.544 s                   |
| BlockToStepN              | 187.764 us                | 29.715 ms                 |
| OneStep                   | 137.500 ms                | 2.356 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 04:40:02.547158 31551 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 04:40:03.040128 31545 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
W20240205 04:40:03.063833 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=23, pq.top=23
E20240205 04:40:03.547010 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=31
W20240205 04:40:04.079586 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
E20240205 04:40:04.547012 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=71
W20240205 04:40:04.754468 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240205 04:40:05.099282 31545 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
E20240205 04:40:05.547013 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=246
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 475.213 us                | 12.306 ms                 |
| ProcessBack:Shuffle       | 8.766 ms                  | 297.549 ms                |
| ProcessBack:UpdateCache   | 10.518 ms                 | 668.581 ms                |
| ProcessBack:UpsertPq      | 38.184 ms                 | 118.171 ms                |
| ProcessOneStep            | 90.263 ms                 | 1.544 s                   |
| BlockToStepN              | 169.798 us                | 29.619 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:05.849838 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=38, pq.top=38
W20240205 04:40:06.276980 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 04:40:06.551028 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240205 04:40:06.621132 30967 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=42, sample_step_cpp_seen_[rank]=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.009 ms                  | 89.988 ms                 |
| Forward                   | 5.479 ms                  | 761.319 ms                |
| Backward                  | 4.977 ms                  | 182.161 ms                |
| Optimize                  | 2.655 ms                  | 5.237 ms                  |
| BarrierTimeBeforeRank0    | 2.814 ms                  | 122.464 ms                |
| AfterBackward             | 94.830 ms                 | 1.544 s                   |
| BlockToStepN              | 727.844 us                | 29.715 ms                 |
| OneStep                   | 135.699 ms                | 2.356 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:07.485482 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
E20240205 04:40:07.551003 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
W20240205 04:40:08.318764 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=45, pq.top=45
E20240205 04:40:08.551012 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=269
W20240205 04:40:08.571511 31545 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
W20240205 04:40:09.329860 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=54, pq.top=54
E20240205 04:40:09.551009 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=4237
W20240205 04:40:09.649348 31545 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 04:40:10.551016 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240205 04:40:10.685458 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 338.990 us                | 1.417 ms                  |
| ProcessBack:Shuffle       | 8.575 ms                  | 297.549 ms                |
| ProcessBack:UpdateCache   | 10.496 ms                 | 668.581 ms                |
| ProcessBack:UpsertPq      | 33.398 ms                 | 118.171 ms                |
| ProcessOneStep            | 96.085 ms                 | 1.343 s                   |
| BlockToStepN              | 740.766 us                | 18.852 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:11.023844 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=57, pq.top=57
E20240205 04:40:11.551007 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=998
W20240205 04:40:11.710633 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.917 ms                  | 89.988 ms                 |
| Forward                   | 5.472 ms                  | 21.641 ms                 |
| Backward                  | 4.939 ms                  | 6.701 ms                  |
| Optimize                  | 2.541 ms                  | 14.814 ms                 |
| BarrierTimeBeforeRank0    | 2.980 ms                  | 122.464 ms                |
| AfterBackward             | 96.129 ms                 | 1.344 s                   |
| BlockToStepN              | 783.030 us                | 18.957 ms                 |
| OneStep                   | 135.634 ms                | 1.565 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:12.181376 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=65, pq.top=65
E20240205 04:40:12.551020 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=4338
E20240205 04:40:12.737761 30967 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=69, sample_step_cpp_seen_[rank]=68
W20240205 04:40:12.841091 31545 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240205 04:40:13.557466 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 04:40:13.909476 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240205 04:40:14.045078 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=71, pq.top=71
E20240205 04:40:14.557026 31577 parallel_pq_v2.h:79] insert failed, size(hashtable)=4102
W20240205 04:40:14.994390 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
W20240205 04:40:15.131824 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=79, pq.top=79
E20240205 04:40:15.557011 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 473.328 us                | 11.165 ms                 |
| ProcessBack:Shuffle       | 8.786 ms                  | 44.128 ms                 |
| ProcessBack:UpdateCache   | 10.587 ms                 | 33.767 ms                 |
| ProcessBack:UpsertPq      | 36.863 ms                 | 113.306 ms                |
| ProcessOneStep            | 96.196 ms                 | 1.343 s                   |
| BlockToStepN              | 740.766 us                | 18.852 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:16.190448 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240205 04:40:16.562170 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 04:40:17.103300 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.646 ms                  | 90.624 ms                 |
| Forward                   | 5.444 ms                  | 21.641 ms                 |
| Backward                  | 5.036 ms                  | 8.403 ms                  |
| Optimize                  | 2.513 ms                  | 14.814 ms                 |
| BarrierTimeBeforeRank0    | 4.005 ms                  | 122.464 ms                |
| AfterBackward             | 97.910 ms                 | 1.344 s                   |
| BlockToStepN              | 910.210 us                | 18.957 ms                 |
| OneStep                   | 135.965 ms                | 1.565 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:17.209643 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240205 04:40:17.562019 31549 parallel_pq_v2.h:79] insert failed, size(hashtable)=19085
W20240205 04:40:18.212002 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240205 04:40:18.543579 31545 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240205 04:40:18.562098 31165 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240205 04:40:18.645198 31165 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=98, sample_step_cpp_seen_[rank]=97
E20240205 04:40:19.562021 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=203
W20240205 04:40:19.646483 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 28.145, sample: 1.846, forward: 1.249, backward: 0.962, update: 0.231
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 28.505, sample: 1.133, forward: 1.339, backward: 0.761, update: 0.230
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 27.727, sample: 1.138, forward: 1.328, backward: 0.947, update: 0.235
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 25.052, sample: 1.251, forward: 1.300, backward: 0.764, update: 0.248
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 25.033, sample: 1.517, forward: 1.336, backward: 0.794, update: 0.249
train_sampler.Prefill()
-------Step 0-------
tensor([   43104,    43125,    43163,    43184,  5693701,    91209, 44474207,
        17021208, 21896675,    43211]) tensor([ 5151274, 13796488, 55289696, 67512899, 19794668, 26563109, 39941640,
        79655327, 62696115, 31589826])
-------Step 1-------
tensor([   43104,    43125,    43163,    43184,  5693701,    91209, 44474207,
        17021208, 21896675,    43211]) tensor([62759495, 26822080, 10976013, 72049748, 76172046, 45114168, 79505356,
        53409314, 41022872, 12805245])
-------Step 2-------
tensor([  105917,   105940,   105960,    32393,   105992,   106013,   106042,
        23633766,   106063,   106085]) tensor([78844026, 22197673, 84125521, 45227450, 38957644, 30012830, 63054508,
        37983292, 14537640, 44356619])
-------Step 3-------
tensor([  105917,   105940,   105960,    32393,   105992,   106013,   106042,
        23633766,   106063,   106085]) tensor([53856916, 78192036, 32242857, 31657706, 70319557, 70488458, 33939908,
        15797191, 28367934,   679600])
-------Step 4-------
tensor([  165868, 39831119,   165888,   114478,   165915,   114504,   165941,
        32920602,   165965,   165988]) tensor([75023382,  9810594, 85752578, 17809449, 78168043, 46909071, 71887963,
        31105380, 76533977, 47997340])
-------Step 5-------
tensor([  165868, 39831119,   165888,   114478,   165915,   114504,   165941,
        32920602,   165965,   165988]) tensor([33158017, 71973849,   325687, 69548881, 53771200, 57375556, 15280065,
         9998469, 65280122, 41990553])
-------Step 6-------
tensor([  225450,    68119,   225478,   225501,    68148, 80275180,   225526,
          225544,   125649, 30274141]) tensor([13273175, 35238508, 33153772, 82715787, 31623652, 39993619, 22903896,
         6600575, 75047821, 74737046])
-------Step 7-------
tensor([  225450,    68119,   225478,   225501,    68148, 80275180,   225526,
          225544,   125649, 30274141]) tensor([22885679, 57047585, 63565812, 54036229, 74783844, 47600270, 49883680,
        61906252, 32953466, 35522933])
-------Step 8-------
tensor([  284148, 21361769,   284170,   135894,   284188,    85584,   284211,
          284230,   284255,   284282]) tensor([39774671, 26561549, 37411401,  1875098, 53945527, 73140780, 15825201,
        78869315,  1498530, 57433695])
-------Step 9-------
tensor([  284148, 21361769,   284170,   135894,   284188,    85584,   284211,
          284230,   284255,   284282]) tensor([57865569, 33792552, 13383361, 59717605,  9031496, 37893831, 23684678,
        33456843, 77232144, 73431803])
before start barrier
start train
[proc 0] 100 steps, total: 25.514, sample: 1.305, forward: 1.342, backward: 0.718, update: 0.337
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 24.042, sample: 1.184, forward: 1.320, backward: 0.900, update: 0.226
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 26.327, sample: 1.376, forward: 1.282, backward: 0.830, update: 0.233
W20240205 04:40:20.547261 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=102, pq.top=102
E20240205 04:40:20.562007 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=9065
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 321.046 us                | 2.658 ms                  |
| ProcessBack:Shuffle       | 9.002 ms                  | 44.128 ms                 |
| ProcessBack:UpdateCache   | 10.598 ms                 | 33.767 ms                 |
| ProcessBack:UpsertPq      | 35.245 ms                 | 135.667 ms                |
| ProcessOneStep            | 96.733 ms                 | 1.544 s                   |
| BlockToStepN              | 785.484 us                | 24.265 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:20.743332 31545 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240205 04:40:21.562013 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=6188
W20240205 04:40:21.648213 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240205 04:40:21.890168 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.466 ms                  | 90.624 ms                 |
| Forward                   | 5.538 ms                  | 21.641 ms                 |
| Backward                  | 5.101 ms                  | 8.403 ms                  |
| Optimize                  | 2.655 ms                  | 14.814 ms                 |
| BarrierTimeBeforeRank0    | 3.162 ms                  | 151.289 ms                |
| AfterBackward             | 96.788 ms                 | 1.544 s                   |
| BlockToStepN              | 879.645 us                | 24.345 ms                 |
| OneStep                   | 135.349 ms                | 1.663 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 04:40:22.562011 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=8843
W20240205 04:40:22.931298 31545 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
W20240205 04:40:23.349609 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=115, pq.top=115
E20240205 04:40:23.562008 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=625
W20240205 04:40:23.977707 31545 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
W20240205 04:40:24.399397 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=122, pq.top=122
E20240205 04:40:24.562008 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=34425
W20240205 04:40:25.012920 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240205 04:40:25.251379 30967 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=129, sample_step_cpp_seen_[rank]=128
E20240205 04:40:25.567924 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 446.311 us                | 7.445 ms                  |
| ProcessBack:Shuffle       | 8.894 ms                  | 38.975 ms                 |
| ProcessBack:UpdateCache   | 10.597 ms                 | 28.355 ms                 |
| ProcessBack:UpsertPq      | 33.398 ms                 | 132.056 ms                |
| ProcessOneStep            | 98.176 ms                 | 1.544 s                   |
| BlockToStepN              | 869.337 us                | 24.502 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:26.065142 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240205 04:40:26.567010 31165 parallel_pq_v2.h:79] insert failed, size(hashtable)=23258
W20240205 04:40:27.074075 31545 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.049 ms                  | 90.624 ms                 |
| Forward                   | 5.479 ms                  | 21.641 ms                 |
| Backward                  | 5.230 ms                  | 8.487 ms                  |
| Optimize                  | 2.600 ms                  | 14.814 ms                 |
| BarrierTimeBeforeRank0    | 2.800 ms                  | 151.289 ms                |
| AfterBackward             | 98.220 ms                 | 1.544 s                   |
| BlockToStepN              | 956.496 us                | 24.639 ms                 |
| OneStep                   | 135.965 ms                | 1.663 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:27.263289 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=137, pq.top=137
E20240205 04:40:27.567057 31562 parallel_pq_v2.h:79] insert failed, size(hashtable)=44432
W20240205 04:40:28.074177 31545 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
W20240205 04:40:28.263044 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=146, pq.top=146
E20240205 04:40:28.567014 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 04:40:29.170545 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
E20240205 04:40:29.567009 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=46347
W20240205 04:40:29.587682 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240205 04:40:30.184581 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240205 04:40:30.586043 31577 parallel_pq_v2.h:79] insert failed, size(hashtable)=41987
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 447.132 us                | 17.479 ms                 |
| ProcessBack:Shuffle       | 9.160 ms                  | 50.291 ms                 |
| ProcessBack:UpdateCache   | 10.777 ms                 | 28.355 ms                 |
| ProcessBack:UpsertPq      | 32.204 ms                 | 135.667 ms                |
| ProcessOneStep            | 97.358 ms                 | 1.343 s                   |
| BlockToStepN              | 940.180 us                | 24.502 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:30.762661 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240205 04:40:31.230974 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240205 04:40:31.358805 30967 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=161, sample_step_cpp_seen_[rank]=160
E20240205 04:40:31.586014 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=3758
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.908 ms                  | 89.988 ms                 |
| Forward                   | 5.479 ms                  | 17.270 ms                 |
| Backward                  | 5.438 ms                  | 8.403 ms                  |
| Optimize                  | 2.660 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 2.540 ms                  | 122.464 ms                |
| AfterBackward             | 97.405 ms                 | 1.344 s                   |
| BlockToStepN              | 1.109 ms                  | 29.715 ms                 |
| OneStep                   | 135.634 ms                | 1.565 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:32.238091 31545 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240205 04:40:32.586016 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=5212
W20240205 04:40:33.327417 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240205 04:40:33.552641 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=165, pq.top=165
E20240205 04:40:33.586016 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1149
W20240205 04:40:34.485756 31545 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
E20240205 04:40:34.586009 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=5273
W20240205 04:40:35.566882 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
E20240205 04:40:35.586009 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=10661
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 375.105 us                | 7.789 ms                  |
| ProcessBack:Shuffle       | 9.130 ms                  | 44.128 ms                 |
| ProcessBack:UpdateCache   | 10.864 ms                 | 25.940 ms                 |
| ProcessBack:UpsertPq      | 32.015 ms                 | 136.791 ms                |
| ProcessOneStep            | 97.188 ms                 | 1.544 s                   |
| BlockToStepN              | 1.092 ms                  | 33.432 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:36.220584 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=177, pq.top=177
E20240205 04:40:36.358006 31165 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=177, sample_step_cpp_seen_[rank]=176
W20240205 04:40:36.574615 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240205 04:40:36.586004 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=52626
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.908 ms                  | 89.988 ms                 |
| Forward                   | 5.584 ms                  | 21.641 ms                 |
| Backward                  | 5.507 ms                  | 8.487 ms                  |
| Optimize                  | 2.694 ms                  | 10.478 ms                 |
| BarrierTimeBeforeRank0    | 2.460 ms                  | 151.289 ms                |
| AfterBackward             | 97.405 ms                 | 1.544 s                   |
| BlockToStepN              | 1.233 ms                  | 33.524 ms                 |
| OneStep                   | 135.699 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:37.379412 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=183, pq.top=183
E20240205 04:40:37.586012 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=71290
W20240205 04:40:37.632359 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
W20240205 04:40:38.554816 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=191, pq.top=191
E20240205 04:40:38.587493 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 04:40:38.925313 31545 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 04:40:39.587011 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=3058
W20240205 04:40:39.976619 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240205 04:40:40.587010 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=3323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 351.765 us                | 4.785 ms                  |
| ProcessBack:Shuffle       | 9.090 ms                  | 44.128 ms                 |
| ProcessBack:UpdateCache   | 10.777 ms                 | 25.940 ms                 |
| ProcessBack:UpsertPq      | 31.869 ms                 | 144.650 ms                |
| ProcessOneStep            | 97.358 ms                 | 1.544 s                   |
| BlockToStepN              | 1.092 ms                  | 35.446 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 20.646, sample: 1.448, forward: 0.531, backward: 0.564, update: 0.232
[proc 0] 200 steps, total: 20.646, sample: 1.106, forward: 0.619, backward: 0.585, update: 0.314
[proc 7] 200 steps, total: 20.646, sample: 1.762, forward: 0.556, backward: 0.686, update: 0.218
[proc 5] 200 steps, total: 20.646, sample: 1.035, forward: 0.576, backward: 0.471, update: 0.224
[proc 6] 200 steps, total: 20.645, sample: 1.172, forward: 0.558, backward: 0.645, update: 0.229
[proc 2] 200 steps, total: 20.645, sample: 1.544, forward: 0.583, backward: 0.518, update: 0.232
[proc 1] 200 steps, total: 20.646, sample: 1.501, forward: 0.510, backward: 0.619, update: 0.232
[proc 4] 200 steps, total: 20.646, sample: 1.270, forward: 0.570, backward: 0.753, update: 0.224
W20240205 04:40:41.040536 31545 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
W20240205 04:40:41.112465 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=201, pq.top=201
E20240205 04:40:41.587011 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=51923
E20240205 04:40:41.796310 31165 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=207, sample_step_cpp_seen_[rank]=206
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.693 ms                  | 89.988 ms                 |
| Forward                   | 5.596 ms                  | 21.641 ms                 |
| Backward                  | 5.583 ms                  | 8.487 ms                  |
| Optimize                  | 2.660 ms                  | 10.478 ms                 |
| BarrierTimeBeforeRank0    | 2.802 ms                  | 151.289 ms                |
| AfterBackward             | 97.910 ms                 | 1.544 s                   |
| BlockToStepN              | 1.188 ms                  | 35.602 ms                 |
| OneStep                   | 135.965 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:42.286386 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240205 04:40:42.587013 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=3334
W20240205 04:40:43.334851 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240205 04:40:43.558737 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=209, pq.top=209
E20240205 04:40:43.587008 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=673
W20240205 04:40:44.355476 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
W20240205 04:40:44.558208 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=217, pq.top=217
E20240205 04:40:44.587007 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=37111
W20240205 04:40:45.548225 31545 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240205 04:40:45.595136 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 320.588 us                | 8.800 ms                  |
| ProcessBack:Shuffle       | 9.069 ms                  | 44.128 ms                 |
| ProcessBack:UpdateCache   | 10.781 ms                 | 25.940 ms                 |
| ProcessBack:UpsertPq      | 31.709 ms                 | 144.650 ms                |
| ProcessOneStep            | 97.358 ms                 | 1.589 s                   |
| BlockToStepN              | 1.117 ms                  | 38.940 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:46.548586 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240205 04:40:46.552280 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 04:40:46.595009 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.682 ms                  | 89.988 ms                 |
| Forward                   | 5.582 ms                  | 21.641 ms                 |
| Backward                  | 5.648 ms                  | 10.830 ms                 |
| Optimize                  | 2.698 ms                  | 10.478 ms                 |
| BarrierTimeBeforeRank0    | 2.783 ms                  | 151.289 ms                |
| AfterBackward             | 97.910 ms                 | 1.589 s                   |
| BlockToStepN              | 1.281 ms                  | 45.607 ms                 |
| OneStep                   | 135.965 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:47.565805 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=229, pq.top=229
E20240205 04:40:47.595018 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=37223
W20240205 04:40:47.599838 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240205 04:40:48.428819 31165 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=234, sample_step_cpp_seen_[rank]=233
E20240205 04:40:48.595008 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1149
W20240205 04:40:48.600450 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
W20240205 04:40:49.542222 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=235, pq.top=235
E20240205 04:40:49.595014 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=4245
W20240205 04:40:49.611359 31545 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240205 04:40:50.595010 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=214
W20240205 04:40:50.668251 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240205 04:40:50.683109 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 419.281 us                | 5.929 ms                  |
| ProcessBack:Shuffle       | 9.002 ms                  | 43.333 ms                 |
| ProcessBack:UpdateCache   | 10.920 ms                 | 25.316 ms                 |
| ProcessBack:UpsertPq      | 32.624 ms                 | 138.998 ms                |
| ProcessOneStep            | 97.865 ms                 | 1.589 s                   |
| BlockToStepN              | 1.117 ms                  | 45.505 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 04:40:51.602629 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 04:40:51.695753 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
W20240205 04:40:51.975546 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=247, pq.top=246
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.453 ms                  | 89.988 ms                 |
| Forward                   | 5.581 ms                  | 21.641 ms                 |
| Backward                  | 5.716 ms                  | 10.830 ms                 |
| Optimize                  | 2.715 ms                  | 10.478 ms                 |
| BarrierTimeBeforeRank0    | 2.775 ms                  | 151.289 ms                |
| AfterBackward             | 97.910 ms                 | 1.589 s                   |
| BlockToStepN              | 1.266 ms                  | 76.016 ms                 |
| OneStep                   | 135.965 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 04:40:52.602013 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=497
W20240205 04:40:52.731868 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
W20240205 04:40:53.319243 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=257, pq.top=257
E20240205 04:40:53.602010 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=40250
E20240205 04:40:53.605537 30967 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=259, sample_step_cpp_seen_[rank]=258
W20240205 04:40:53.901219 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240205 04:40:54.606552 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 04:40:54.947284 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240205 04:40:54.950580 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 04:40:55.606009 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=29834
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 353.353 us                | 6.581 ms                  |
| ProcessBack:Shuffle       | 9.002 ms                  | 43.333 ms                 |
| ProcessBack:UpdateCache   | 10.864 ms                 | 25.316 ms                 |
| ProcessBack:UpsertPq      | 32.637 ms                 | 138.998 ms                |
| ProcessOneStep            | 97.358 ms                 | 1.544 s                   |
| BlockToStepN              | 1.173 ms                  | 65.182 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:40:56.040078 31545 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
W20240205 04:40:56.071355 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=269, pq.top=269
E20240205 04:40:56.606012 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=107510
W20240205 04:40:57.045847 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.533 ms                  | 89.846 ms                 |
| Forward                   | 5.575 ms                  | 17.270 ms                 |
| Backward                  | 5.887 ms                  | 10.830 ms                 |
| Optimize                  | 2.694 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 2.347 ms                  | 145.107 ms                |
| AfterBackward             | 97.405 ms                 | 1.544 s                   |
| BlockToStepN              | 1.301 ms                  | 67.537 ms                 |
| OneStep                   | 136.629 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 04:40:57.606060 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=634
W20240205 04:40:58.087249 31545 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240205 04:40:58.234984 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=277, pq.top=277
E20240205 04:40:58.606009 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=34903
W20240205 04:40:59.246129 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240205 04:40:59.427695 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240205 04:40:59.606010 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=345
E20240205 04:40:59.794270 31165 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=288, sample_step_cpp_seen_[rank]=287
W20240205 04:41:00.579141 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240205 04:41:00.606005 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1986
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 426.049 us                | 7.567 ms                  |
| ProcessBack:Shuffle       | 9.055 ms                  | 43.333 ms                 |
| ProcessBack:UpdateCache   | 11.005 ms                 | 24.836 ms                 |
| ProcessBack:UpsertPq      | 32.331 ms                 | 138.537 ms                |
| ProcessOneStep            | 97.865 ms                 | 1.544 s                   |
| BlockToStepN              | 1.278 ms                  | 67.396 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:01.308269 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240205 04:41:01.587528 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240205 04:41:01.606032 31574 parallel_pq_v2.h:79] insert failed, size(hashtable)=42524
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.774 ms                  | 90.624 ms                 |
| Forward                   | 5.582 ms                  | 17.270 ms                 |
| Backward                  | 5.826 ms                  | 10.949 ms                 |
| Optimize                  | 2.694 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 2.347 ms                  | 145.107 ms                |
| AfterBackward             | 98.220 ms                 | 1.544 s                   |
| BlockToStepN              | 1.379 ms                  | 67.537 ms                 |
| OneStep                   | 137.151 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:02.516180 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 7] 300 steps, total: 21.605, sample: 1.555, forward: 0.546, backward: 0.695, update: 0.234
[proc 4] 300 steps, total: 21.604, sample: 0.998, forward: 0.552, backward: 0.718, update: 0.222
[proc 1] 300 steps, total: 21.604, sample: 1.057, forward: 0.516, backward: 0.550, update: 0.288
[proc 6] 300 steps, total: 21.604, sample: 1.023, forward: 0.593, backward: 0.701, update: 0.238
[proc 0] 300 steps, total: 21.605, sample: 1.194, forward: 0.551, backward: 0.745, update: 0.309
[proc 5] 300 steps, total: 21.605, sample: 1.024, forward: 0.600, backward: 0.444, update: 0.230
[proc 3] 300 steps, total: 21.605, sample: 1.298, forward: 0.543, backward: 0.723, update: 0.230
[proc 2] 300 steps, total: 21.604, sample: 1.348, forward: 0.571, backward: 0.499, update: 0.239
E20240205 04:41:02.606011 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=94146
W20240205 04:41:02.912875 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 04:41:03.606012 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=22
W20240205 04:41:03.947664 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
W20240205 04:41:04.396590 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=305, pq.top=305
E20240205 04:41:04.606012 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=35396
W20240205 04:41:05.035576 31545 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
W20240205 04:41:05.478127 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=312, pq.top=312
E20240205 04:41:05.606009 31568 parallel_pq_v2.h:79] insert failed, size(hashtable)=39585
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 430.859 us                | 12.216 ms                 |
| ProcessBack:Shuffle       | 9.109 ms                  | 43.333 ms                 |
| ProcessBack:UpdateCache   | 11.009 ms                 | 24.836 ms                 |
| ProcessBack:UpsertPq      | 33.317 ms                 | 138.537 ms                |
| ProcessOneStep            | 98.176 ms                 | 1.544 s                   |
| BlockToStepN              | 1.311 ms                  | 75.881 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:06.037947 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240205 04:41:06.519565 31165 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=319, sample_step_cpp_seen_[rank]=318
E20240205 04:41:06.606012 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=693
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.836 ms                  | 91.828 ms                 |
| Forward                   | 5.560 ms                  | 17.270 ms                 |
| Backward                  | 5.716 ms                  | 10.949 ms                 |
| Optimize                  | 2.655 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 2.540 ms                  | 145.107 ms                |
| AfterBackward             | 98.220 ms                 | 1.544 s                   |
| BlockToStepN              | 1.421 ms                  | 83.027 ms                 |
| OneStep                   | 137.600 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:07.231021 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240205 04:41:07.606031 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=5104
W20240205 04:41:08.241473 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240205 04:41:08.329592 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240205 04:41:08.606201 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 04:41:09.364612 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
W20240205 04:41:09.500663 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=329, pq.top=329
E20240205 04:41:09.606104 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
W20240205 04:41:10.504729 31545 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240205 04:41:10.606017 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=3860
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 435.920 us                | 7.967 ms                  |
| ProcessBack:Shuffle       | 9.100 ms                  | 40.768 ms                 |
| ProcessBack:UpdateCache   | 11.019 ms                 | 21.499 ms                 |
| ProcessBack:UpsertPq      | 33.167 ms                 | 137.700 ms                |
| ProcessOneStep            | 98.254 ms                 | 1.566 s                   |
| BlockToStepN              | 1.314 ms                  | 82.870 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 04:41:11.519011 30967 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=333, sample_step_cpp_seen_[rank]=332
E20240205 04:41:11.606020 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=3595
W20240205 04:41:11.687503 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
W20240205 04:41:11.899488 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=334, pq.top=334
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.774 ms                  | 91.828 ms                 |
| Forward                   | 5.538 ms                  | 17.270 ms                 |
| Backward                  | 5.694 ms                  | 10.949 ms                 |
| Optimize                  | 2.645 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 2.800 ms                  | 145.107 ms                |
| AfterBackward             | 98.928 ms                 | 1.589 s                   |
| BlockToStepN              | 1.452 ms                  | 83.027 ms                 |
| OneStep                   | 138.682 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 04:41:12.606153 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=37412
W20240205 04:41:12.885767 31545 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
W20240205 04:41:13.224990 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=343, pq.top=343
E20240205 04:41:13.606030 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=563
W20240205 04:41:14.049818 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240205 04:41:14.607101 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 04:41:14.867058 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=348, pq.top=348
W20240205 04:41:15.058475 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240205 04:41:15.607015 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 415.510 us                | 3.650 ms                  |
| ProcessBack:Shuffle       | 9.092 ms                  | 40.768 ms                 |
| ProcessBack:UpdateCache   | 11.005 ms                 | 21.499 ms                 |
| ProcessBack:UpsertPq      | 33.167 ms                 | 138.537 ms                |
| ProcessOneStep            | 99.395 ms                 | 1.566 s                   |
| BlockToStepN              | 1.386 ms                  | 75.881 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:16.058683 31545 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
W20240205 04:41:16.128931 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240205 04:41:16.607012 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=2013
E20240205 04:41:16.992399 30967 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=361, sample_step_cpp_seen_[rank]=360
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.774 ms                  | 91.828 ms                 |
| Forward                   | 5.564 ms                  | 10.315 ms                 |
| Backward                  | 5.640 ms                  | 10.830 ms                 |
| Optimize                  | 2.655 ms                  | 9.896 ms                  |
| BarrierTimeBeforeRank0    | 2.914 ms                  | 122.464 ms                |
| AfterBackward             | 100.345 ms                | 1.566 s                   |
| BlockToStepN              | 1.508 ms                  | 76.016 ms                 |
| OneStep                   | 141.010 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:17.283536 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 04:41:17.607023 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=6473
W20240205 04:41:18.441762 31545 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240205 04:41:18.607021 31578 parallel_pq_v2.h:79] insert failed, size(hashtable)=3700
W20240205 04:41:18.755300 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=362, pq.top=362
W20240205 04:41:19.498639 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
E20240205 04:41:19.607008 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=5533
W20240205 04:41:19.809160 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=370, pq.top=370
E20240205 04:41:20.607040 31558 parallel_pq_v2.h:79] insert failed, size(hashtable)=11112
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 570.367 us                | 15.865 ms                 |
| ProcessBack:Shuffle       | 9.114 ms                  | 40.768 ms                 |
| ProcessBack:UpdateCache   | 10.984 ms                 | 21.499 ms                 |
| ProcessBack:UpsertPq      | 32.858 ms                 | 138.537 ms                |
| ProcessOneStep            | 100.486 ms                | 1.589 s                   |
| BlockToStepN              | 1.423 ms                  | 82.870 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:20.817358 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240205 04:41:21.607017 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=5932
W20240205 04:41:21.844843 31545 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240205 04:41:21.903820 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=377, pq.top=377
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.774 ms                  | 91.828 ms                 |
| Forward                   | 5.534 ms                  | 10.315 ms                 |
| Backward                  | 5.610 ms                  | 10.830 ms                 |
| Optimize                  | 2.610 ms                  | 9.896 ms                  |
| BarrierTimeBeforeRank0    | 2.990 ms                  | 131.829 ms                |
| AfterBackward             | 100.534 ms                | 1.589 s                   |
| BlockToStepN              | 1.551 ms                  | 83.027 ms                 |
| OneStep                   | 141.097 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 04:41:22.607228 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 04:41:23.001853 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240205 04:41:23.022960 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240205 04:41:23.607388 31578 parallel_pq_v2.h:79] insert failed, size(hashtable)=43992
E20240205 04:41:23.619320 31165 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=389, sample_step_cpp_seen_[rank]=388
W20240205 04:41:24.166640 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240205 04:41:24.614189 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 04:41:24.983134 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=390, pq.top=390
W20240205 04:41:25.169696 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 04:41:25.614012 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=40239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 454.704 us                | 5.989 ms                  |
| ProcessBack:Shuffle       | 9.089 ms                  | 38.975 ms                 |
| ProcessBack:UpdateCache   | 10.989 ms                 | 17.844 ms                 |
| ProcessBack:UpsertPq      | 32.539 ms                 | 138.537 ms                |
| ProcessOneStep            | 100.486 ms                | 1.589 s                   |
| BlockToStepN              | 1.463 ms                  | 85.891 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:26.038830 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=397, pq.top=397
W20240205 04:41:26.260613 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
[proc 0] 400 steps, total: 23.735, sample: 1.236, forward: 0.547, backward: 0.481, update: 0.267
[proc 3] 400 steps, total: 23.736, sample: 1.497, forward: 0.527, backward: 0.725, update: 0.223
[proc 6] 400 steps, total: 23.736, sample: 1.103, forward: 0.547, backward: 0.843, update: 0.231
[proc 1] 400 steps, total: 23.736, sample: 1.393, forward: 0.513, backward: 0.598, update: 0.234
[proc 4] 400 steps, total: 23.736, sample: 1.330, forward: 0.593, backward: 0.811, update: 0.278
[proc 7] 400 steps, total: 23.736, sample: 1.681, forward: 0.551, backward: 0.739, update: 0.246
[proc 5] 400 steps, total: 23.736, sample: 0.972, forward: 0.555, backward: 0.433, update: 0.224
[proc 2] 400 steps, total: 23.735, sample: 1.237, forward: 0.536, backward: 0.466, update: 0.234
E20240205 04:41:26.614038 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.682 ms                  | 91.828 ms                 |
| Forward                   | 5.524 ms                  | 10.315 ms                 |
| Backward                  | 5.511 ms                  | 10.830 ms                 |
| Optimize                  | 2.600 ms                  | 9.896 ms                  |
| BarrierTimeBeforeRank0    | 3.426 ms                  | 131.829 ms                |
| AfterBackward             | 100.668 ms                | 1.589 s                   |
| BlockToStepN              | 1.596 ms                  | 86.027 ms                 |
| OneStep                   | 141.552 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:27.421113 31545 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240205 04:41:27.614012 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1794
W20240205 04:41:28.030810 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=404, pq.top=404
W20240205 04:41:28.434778 31545 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240205 04:41:28.614012 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=2213
W20240205 04:41:29.130200 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240205 04:41:29.546049 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240205 04:41:29.614012 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=934
E20240205 04:41:29.953713 30967 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=417, sample_step_cpp_seen_[rank]=416
W20240205 04:41:30.596971 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
E20240205 04:41:30.614007 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1006
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 448.226 us                | 17.924 ms                 |
| ProcessBack:Shuffle       | 9.127 ms                  | 38.975 ms                 |
| ProcessBack:UpdateCache   | 10.989 ms                 | 17.844 ms                 |
| ProcessBack:UpsertPq      | 32.055 ms                 | 138.998 ms                |
| ProcessOneStep            | 100.622 ms                | 1.589 s                   |
| BlockToStepN              | 1.524 ms                  | 92.088 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:31.497870 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=420, pq.top=420
E20240205 04:41:31.614012 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=198
W20240205 04:41:31.625399 31545 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.682 ms                  | 91.828 ms                 |
| Forward                   | 5.530 ms                  | 10.315 ms                 |
| Backward                  | 5.542 ms                  | 10.830 ms                 |
| Optimize                  | 2.600 ms                  | 9.896 ms                  |
| BarrierTimeBeforeRank0    | 3.350 ms                  | 131.829 ms                |
| AfterBackward             | 102.092 ms                | 1.589 s                   |
| BlockToStepN              | 1.642 ms                  | 92.213 ms                 |
| OneStep                   | 141.999 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:32.509197 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=427, pq.top=427
E20240205 04:41:32.614106 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=138744
W20240205 04:41:32.676276 31545 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240205 04:41:33.614012 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=61
W20240205 04:41:33.786545 31545 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
W20240205 04:41:34.198494 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=432, pq.top=432
E20240205 04:41:34.614010 31165 parallel_pq_v2.h:79] insert failed, size(hashtable)=1798
W20240205 04:41:34.809351 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
W20240205 04:41:35.333549 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=438, pq.top=437
E20240205 04:41:35.614010 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=2664
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 469.093 us                | 5.979 ms                  |
| ProcessBack:Shuffle       | 9.092 ms                  | 36.833 ms                 |
| ProcessBack:UpdateCache   | 10.951 ms                 | 16.883 ms                 |
| ProcessBack:UpsertPq      | 31.896 ms                 | 143.413 ms                |
| ProcessOneStep            | 102.047 ms                | 1.589 s                   |
| BlockToStepN              | 1.598 ms                  | 94.292 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:35.929114 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
W20240205 04:41:36.471732 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=445, pq.top=445
E20240205 04:41:36.614009 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=6364
E20240205 04:41:36.859735 31165 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=448, sample_step_cpp_seen_[rank]=447
W20240205 04:41:37.021584 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.566 ms                  | 91.828 ms                 |
| Forward                   | 5.528 ms                  | 10.315 ms                 |
| Backward                  | 5.613 ms                  | 10.830 ms                 |
| Optimize                  | 2.609 ms                  | 9.896 ms                  |
| BarrierTimeBeforeRank0    | 3.272 ms                  | 131.829 ms                |
| AfterBackward             | 100.668 ms                | 1.589 s                   |
| BlockToStepN              | 1.741 ms                  | 94.435 ms                 |
| OneStep                   | 142.032 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 04:41:37.614013 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
W20240205 04:41:38.032277 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240205 04:41:38.165743 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=451, pq.top=451
E20240205 04:41:38.616663 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 04:41:39.118312 31545 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
W20240205 04:41:39.492484 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=461, pq.top=461
E20240205 04:41:39.616019 31576 parallel_pq_v2.h:79] insert failed, size(hashtable)=73195
W20240205 04:41:40.278411 31545 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240205 04:41:40.616010 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=6656
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 510.752 us                | 10.953 ms                 |
| ProcessBack:Shuffle       | 9.092 ms                  | 36.833 ms                 |
| ProcessBack:UpdateCache   | 10.942 ms                 | 16.883 ms                 |
| ProcessBack:UpsertPq      | 31.896 ms                 | 144.650 ms                |
| ProcessOneStep            | 103.017 ms                | 1.566 s                   |
| BlockToStepN              | 1.659 ms                  | 92.088 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:41.244374 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240205 04:41:41.281770 31545 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240205 04:41:41.616014 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=60207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.493 ms                  | 90.624 ms                 |
| Forward                   | 5.535 ms                  | 10.022 ms                 |
| Backward                  | 5.613 ms                  | 9.312 ms                  |
| Optimize                  | 2.610 ms                  | 7.881 ms                  |
| BarrierTimeBeforeRank0    | 3.285 ms                  | 130.773 ms                |
| AfterBackward             | 103.064 ms                | 1.566 s                   |
| BlockToStepN              | 1.780 ms                  | 92.213 ms                 |
| OneStep                   | 141.999 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:42.332791 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
W20240205 04:41:42.386704 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=475, pq.top=474
E20240205 04:41:42.616014 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=25307
E20240205 04:41:43.164769 30967 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=481, sample_step_cpp_seen_[rank]=480
W20240205 04:41:43.473407 31545 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 04:41:43.616012 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=2965
W20240205 04:41:44.536770 31545 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 04:41:44.616010 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=17124
W20240205 04:41:44.718169 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=483, pq.top=483
E20240205 04:41:45.616008 30967 parallel_pq_v2.h:79] insert failed, size(hashtable)=46813
W20240205 04:41:45.640578 31545 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 432.468 us                | 15.834 ms                 |
| ProcessBack:Shuffle       | 9.124 ms                  | 33.935 ms                 |
| ProcessBack:UpdateCache   | 10.943 ms                 | 16.835 ms                 |
| ProcessBack:UpsertPq      | 31.704 ms                 | 143.413 ms                |
| ProcessOneStep            | 102.047 ms                | 1.566 s                   |
| BlockToStepN              | 1.685 ms                  | 92.088 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 04:41:45.825649 30967 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=491, pq.top=491
E20240205 04:41:46.616010 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=14839
W20240205 04:41:46.979269 31545 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.453 ms                  | 90.624 ms                 |
| Forward                   | 5.541 ms                  | 10.157 ms                 |
| Backward                  | 5.610 ms                  | 9.312 ms                  |
| Optimize                  | 2.655 ms                  | 9.896 ms                  |
| BarrierTimeBeforeRank0    | 3.350 ms                  | 130.773 ms                |
| AfterBackward             | 102.092 ms                | 1.566 s                   |
| BlockToStepN              | 1.780 ms                  | 92.213 ms                 |
| OneStep                   | 141.552 ms                | 1.617 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 04:41:47.616022 31545 parallel_pq_v2.h:79] insert failed, size(hashtable)=2779
[proc 0] 500 steps, total: 21.704, sample: 0.886, forward: 0.563, backward: 0.642, update: 0.308
[proc 2] 500 steps, total: 21.704, sample: 1.100, forward: 0.521, backward: 0.497, update: 0.229
[proc 5] 500 steps, total: 21.704, sample: 0.984, forward: 0.582, backward: 0.526, update: 0.261
[proc 7] 500 steps, total: 21.704, sample: 1.461, forward: 0.541, backward: 0.703, update: 0.241
Successfully xmh. training takes 113.20451354980469 seconds
[proc 3] 500 steps, total: 21.704, sample: 1.331, forward: 0.548, backward: 0.688, update: 0.238
before call kg_cache_controller.StopThreads()
W20240205 04:41:48.030119 30967 grad_async_v2.h:84] call StopThreads. PID = 29415
W20240205 04:41:48.030164 30967 grad_base.h:212] before processOneStepNegThread_.join();
[proc 4] 500 steps, total: 21.704, sample: 1.001, forward: 0.544, backward: 0.612, update: 0.224
W20240205 04:41:48.030612 30967 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 04:41:48.030623 30967 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
[proc 6] 500 steps, total: 21.704, sample: 1.080, forward: 0.549, backward: 0.813, update: 0.230
[proc 1] 500 steps, total: 21.704, sample: 1.173, forward: 0.513, backward: 0.530, update: 0.226
W20240205 04:41:48.044693 31545 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
W20240205 04:41:48.263177 30967 grad_async_v2.h:105] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 391.648 us                | 16.642 ms                 |
| ProcessBack:Shuffle       | 9.100 ms                  | 33.935 ms                 |
| ProcessBack:UpdateCache   | 10.880 ms                 | 16.835 ms                 |
| ProcessBack:UpsertPq      | 31.704 ms                 | 143.413 ms                |
| ProcessOneStep            | 100.622 ms                | 1.566 s                   |
| BlockToStepN              | 1.675 ms                  | 92.088 ms                 |
+---------------------------+---------------------------+---------------------------+
