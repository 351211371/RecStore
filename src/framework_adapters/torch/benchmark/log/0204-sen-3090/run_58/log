WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 15:53:30.165535 50224 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_118', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=16, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [50224 sampler.py:454] Start PreSampling
WARNING [50224 sampler.py:532] Before construct renumbering_dict
WARNING [50224 sampler.py:555] PreSampling done
W20240205 16:13:53.342063 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 16:13:53.342248 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 16:13:53.342293 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 16:13:53.342325 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 16:13:53.342367 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 16:13:53.342397 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 16:13:53.342433 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 16:13:53.342475 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 16:13:53.342504 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 16:13:53.342535 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 16:13:53.342568 50224 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 16:13:53.342595 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 16:13:53.342626 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 16:13:53.342782 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 16:13:53.342816 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 16:13:53.342849 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 16:13:53.342887 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 16:13:53.342918 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 16:13:53.342947 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 16:13:53.342985 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 16:13:53.343019 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 16:13:53.343050 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 16:13:53.343086 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 16:13:53.343112 50224 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 16:13:53.343134 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 16:13:53.343156 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 16:13:53.343214 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 16:13:53.343254 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 16:13:53.343283 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 16:13:53.343314 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 16:13:53.343340 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 16:13:53.343370 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 16:13:53.343403 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 16:13:53.343434 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 16:13:53.343472 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 16:13:53.343499 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 16:13:53.343525 50224 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 16:13:53.343547 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 16:13:53.343570 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 16:13:53.343628 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 16:13:53.343660 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 16:13:53.343690 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 16:13:53.343726 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 16:13:53.343760 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 16:13:53.343797 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 16:13:53.343825 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 16:13:53.343858 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 16:13:53.343894 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 16:13:53.343919 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 16:13:53.343945 50224 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 16:13:53.343967 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 16:13:53.343988 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 16:13:53.344046 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 16:13:53.344089 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 16:13:53.344121 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 16:13:53.344147 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 16:13:53.344177 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 16:13:53.344218 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 16:13:53.344244 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 16:13:53.344276 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 16:13:53.344309 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 16:13:53.344341 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 16:13:53.344368 50224 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 16:13:53.344391 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 16:13:53.344413 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 16:13:53.344470 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 16:13:53.344506 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 16:13:53.344537 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 16:13:53.344568 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 16:13:53.344594 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 16:13:53.344627 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 16:13:53.344661 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 16:13:53.344692 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 16:13:53.344727 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 16:13:53.344760 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 16:13:53.344787 50224 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 16:13:53.344810 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 16:13:53.344844 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 16:13:53.344899 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 16:13:53.344929 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 16:13:53.344959 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 16:13:53.344987 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 16:13:53.345016 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 16:13:53.345048 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 16:13:53.345080 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 16:13:53.345111 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 16:13:53.345141 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 16:13:53.345175 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 16:13:53.345204 50224 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 16:13:53.345227 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 16:13:53.345253 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 16:13:53.345304 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 16:13:53.345340 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 16:13:53.345371 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 16:13:53.345400 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 16:13:53.345430 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 16:13:53.345463 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 16:13:53.345495 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 16:13:53.345525 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 16:13:53.345552 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 16:13:53.345582 50224 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 16:13:53.345608 50224 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 16:13:53.345631 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 16:13:53.345654 50224 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 16:13:53.803117 50224 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 16:22:30.786765 50224 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302710,  4302728,    91270,  ..., 54739086, 62986613,  4914841]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2246.246 seconds
[Rank1] pid = 51640
[Rank2] pid = 51738
[Rank3] pid = 51806
[Rank4] pid = 51874
[Rank5] pid = 51943
[Rank6] pid = 52011
INFO [50224 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [51640 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [51738 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [51806 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [51874 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [51943 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [52011 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [52078 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [51943 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51806 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52011 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52078 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51874 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51738 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [50224 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51640 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 16:31:08.593957 52079 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 16:31:08.594269 51944 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 16:31:08.595091 52142 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 16:31:08.595090 52012 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 16:31:08.595101 51807 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 16:31:08.595284 51875 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 16:31:08.595558 51641 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 16:31:08.595738 51739 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 16:31:08.689083 51875 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1020497b1000 7.629 MB
W20240205 16:31:08.689296 52142 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x102049f54000 7.629 MB
W20240205 16:31:08.689327 52012 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204a6f7000 7.629 MB
W20240205 16:31:08.689399 51875 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204ae9a000 7.629 MB
W20240205 16:31:08.689404 52079 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204b63d000 7.629 MB
W20240205 16:31:08.689425 51641 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204bde0000 7.629 MB
W20240205 16:31:08.689436 51807 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204c583000 7.629 MB
W20240205 16:31:08.689450 51944 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204cd26000 7.629 MB
W20240205 16:31:08.689463 51739 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204d4c9000 7.629 MB
W20240205 16:31:08.689587 51875 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10204dc6c000 1.49 GB
W20240205 16:31:08.689607 52079 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020ad24f000 7.629 MB
W20240205 16:31:08.689652 51875 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1020ad9f2000 1.49 GB
W20240205 16:31:08.689695 52079 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210cfd5000 1.49 GB
W20240205 16:31:08.689716 51944 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10216c5b8000 7.629 MB
W20240205 16:31:08.689724 51739 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10216cd5b000 7.629 MB
W20240205 16:31:08.689731 51641 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10216d4fe000 7.629 MB
W20240205 16:31:08.689738 52012 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10216dca1000 7.629 MB
W20240205 16:31:08.689739 52079 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10216e444000 1.49 GB
W20240205 16:31:08.689759 51875 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 16:31:08.689814 51807 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1021cda27000 7.629 MB
W20240205 16:31:08.689838 51641 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021ce1ca000 1.49 GB
W20240205 16:31:08.689851 52079 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 16:31:08.689849 52142 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10222d7ad000 7.629 MB
W20240205 16:31:08.689872 52012 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10222df50000 1.49 GB
W20240205 16:31:08.689905 51807 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10228d533000 1.49 GB
W20240205 16:31:08.689918 51641 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1022ecb16000 1.49 GB
W20240205 16:31:08.689925 52012 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10234c0f9000 1.49 GB
W20240205 16:31:08.689955 52142 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1023ab6dc000 1.49 GB
W20240205 16:31:08.689975 51807 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10240acbf000 1.49 GB
W20240205 16:31:08.690006 51641 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 16:31:08.690016 52142 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10246a2a2000 1.49 GB
W20240205 16:31:08.691457 52142 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 16:31:08.693092 51944 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1024c9885000 1.49 GB
W20240205 16:31:08.693123 51739 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102528e68000 1.49 GB
W20240205 16:31:08.693167 51944 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10258844b000 1.49 GB
W20240205 16:31:08.693173 51739 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240205 16:31:08.693230 51944 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 16:31:08.693236 51739 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 16:31:08.694582 51807 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 16:31:08.694592 52012 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 16:31:08.702911 51875 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 16:31:08.702981 52079 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 16:31:08.704679 51641 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 16:31:08.706293 52142 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 16:31:08.706357 51944 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 16:31:08.706398 51807 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 16:31:08.706405 52012 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 16:31:08.714994 51739 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
[Rank7] pid = 52078
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [50224 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [51806 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [52078 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [51640 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [51738 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [51943 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [52011 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [51874 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 16:31:58.059823 51875 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 16:31:58.059943 52012 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 16:31:58.060325 51641 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 16:31:58.060439 52142 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 16:31:58.060564 52079 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 16:31:58.060688 51944 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 16:31:58.060760 51739 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 16:31:58.060966 51807 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 16:31:58.064400 52079 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 16,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 16:31:58.064711 52079 grad_base.h:184] Init GradProcessingBase done
I20240205 16:32:10.944945 52079 grad_async_v1.h:203] Use main thread to update emb.
W20240205 16:32:10.945081 52079 kg_controller.h:75] after init GradAsyncProcessing
I20240205 16:32:10.945092 52079 kg_controller.h:84] Construct KGCacheController done
E20240205 16:32:12.716796 52079 recstore.cc:66] init folly done
E20240205 16:32:12.716814 51807 recstore.cc:66] init folly done
E20240205 16:32:12.716820 51944 recstore.cc:66] init folly done
E20240205 16:32:12.716831 51641 recstore.cc:66] init folly done
E20240205 16:32:12.716843 52142 recstore.cc:66] init folly done
E20240205 16:32:12.716872 51739 recstore.cc:66] init folly done
E20240205 16:32:12.716981 52012 recstore.cc:66] init folly done
E20240205 16:32:12.716981 51875 recstore.cc:66] init folly done
I20240205 16:32:12.718180 52079 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 16:32:34.348340 51944 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 16:32:34.431046 52142 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 16:32:34.603351 51875 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 16:32:35.522477 51739 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 16:32:36.527426 51807 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 16:32:36.862989 51641 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 16:32:37.163880 52079 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 16:32:38.219632 52012 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240205 16:32:40.418399 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240205 16:32:41.475770 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240205 16:32:42.539498 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.355 ms                  | 277.120 ms                |
| ProcessBack:UpdateCache   | 10.438 ms                 | 624.769 ms                |
| ProcessBack:UpsertPq      | 35.624 ms                 | 46.092 ms                 |
| ProcessOneStep            | 65.507 ms                 | 1.177 s                   |
| BlockToStepN              | 9.103 ms                  | 845.867 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.960 ms                  | 7.187 ms                  |
| Forward                   | 5.860 ms                  | 773.890 ms                |
| Backward                  | 10.549 ms                 | 215.663 ms                |
| Optimize                  | 4.732 ms                  | 26.434 ms                 |
| BarrierTimeBeforeRank0    | 17.963 ms                 | 20.746 ms                 |
| AfterBackward             | 65.553 ms                 | 1.178 s                   |
| BlockToStepN              | 9.143 ms                  | 845.979 ms                |
| OneStep                   | 123.768 ms                | 3.035 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:32:43.963656 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240205 16:32:45.042529 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240205 16:32:46.042009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240205 16:32:47.060843 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.985 ms                  | 277.120 ms                |
| ProcessBack:UpdateCache   | 10.044 ms                 | 624.769 ms                |
| ProcessBack:UpsertPq      | 42.243 ms                 | 54.247 ms                 |
| ProcessOneStep            | 65.507 ms                 | 1.177 s                   |
| BlockToStepN              | 9.103 ms                  | 845.867 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.993 ms                  | 108.865 ms                |
| Forward                   | 5.070 ms                  | 773.890 ms                |
| Backward                  | 10.601 ms                 | 215.663 ms                |
| Optimize                  | 2.454 ms                  | 26.434 ms                 |
| BarrierTimeBeforeRank0    | 1.784 ms                  | 273.491 ms                |
| AfterBackward             | 65.553 ms                 | 1.178 s                   |
| BlockToStepN              | 9.143 ms                  | 845.979 ms                |
| OneStep                   | 172.139 ms                | 3.035 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:32:48.202159 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240205 16:32:49.245712 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240205 16:32:50.315272 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240205 16:32:51.388813 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.042 ms                  | 277.120 ms                |
| ProcessBack:UpdateCache   | 10.473 ms                 | 624.769 ms                |
| ProcessBack:UpsertPq      | 44.303 ms                 | 114.756 ms                |
| ProcessOneStep            | 71.676 ms                 | 1.177 s                   |
| BlockToStepN              | 9.103 ms                  | 845.867 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:32:52.815254 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.936 ms                  | 298.034 ms                |
| Forward                   | 5.176 ms                  | 773.890 ms                |
| Backward                  | 10.925 ms                 | 215.663 ms                |
| Optimize                  | 2.454 ms                  | 26.434 ms                 |
| BarrierTimeBeforeRank0    | 1.395 ms                  | 273.491 ms                |
| AfterBackward             | 73.529 ms                 | 1.178 s                   |
| BlockToStepN              | 9.143 ms                  | 845.979 ms                |
| OneStep                   | 172.139 ms                | 3.035 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:32:53.815009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=24, pq.top=24
W20240205 16:32:54.900619 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240205 16:32:55.900008 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240205 16:32:56.900007 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.757 ms                  | 247.320 ms                |
| ProcessBack:UpdateCache   | 10.844 ms                 | 623.404 ms                |
| ProcessBack:UpsertPq      | 42.243 ms                 | 81.262 ms                 |
| ProcessOneStep            | 65.507 ms                 | 1.177 s                   |
| BlockToStepN              | 9.103 ms                  | 845.867 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:32:57.900007 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.428 ms                  | 298.034 ms                |
| Forward                   | 5.480 ms                  | 773.890 ms                |
| Backward                  | 10.605 ms                 | 215.663 ms                |
| Optimize                  | 2.643 ms                  | 26.434 ms                 |
| BarrierTimeBeforeRank0    | 2.235 ms                  | 273.491 ms                |
| AfterBackward             | 65.553 ms                 | 1.178 s                   |
| BlockToStepN              | 9.143 ms                  | 845.979 ms                |
| OneStep                   | 211.960 ms                | 3.035 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:32:58.900012 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240205 16:32:59.900009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240205 16:33:00.915634 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240205 16:33:01.915009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.674 ms                  | 247.320 ms                |
| ProcessBack:UpdateCache   | 10.844 ms                 | 623.404 ms                |
| ProcessBack:UpsertPq      | 37.878 ms                 | 81.262 ms                 |
| ProcessOneStep            | 63.070 ms                 | 1.177 s                   |
| BlockToStepN              | 709.116 ms                | 845.867 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:02.915009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.428 ms                  | 298.034 ms                |
| Forward                   | 5.534 ms                  | 773.890 ms                |
| Backward                  | 10.344 ms                 | 215.663 ms                |
| Optimize                  | 2.703 ms                  | 26.434 ms                 |
| BarrierTimeBeforeRank0    | 1.522 ms                  | 273.491 ms                |
| AfterBackward             | 62.366 ms                 | 1.178 s                   |
| BlockToStepN              | 9.611 ms                  | 845.979 ms                |
| OneStep                   | 211.960 ms                | 3.035 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:03.915009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240205 16:33:04.915011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240205 16:33:05.915009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240205 16:33:06.915011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.614 ms                  | 247.320 ms                |
| ProcessBack:UpdateCache   | 10.944 ms                 | 623.404 ms                |
| ProcessBack:UpsertPq      | 36.136 ms                 | 81.262 ms                 |
| ProcessOneStep            | 59.504 ms                 | 137.392 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:07.915009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.944 ms                  | 181.337 ms                |
| Forward                   | 5.478 ms                  | 31.129 ms                 |
| Backward                  | 6.647 ms                  | 13.028 ms                 |
| Optimize                  | 2.793 ms                  | 5.706 ms                  |
| BarrierTimeBeforeRank0    | 2.664 ms                  | 86.285 ms                 |
| AfterBackward             | 59.705 ms                 | 137.424 ms                |
| BlockToStepN              | 13.800 ms                 | 841.663 ms                |
| OneStep                   | 211.960 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:09.115036 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240205 16:33:10.219977 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240205 16:33:11.219007 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240205 16:33:12.219044 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.578 ms                  | 247.320 ms                |
| ProcessBack:UpdateCache   | 10.945 ms                 | 623.404 ms                |
| ProcessBack:UpsertPq      | 37.065 ms                 | 81.262 ms                 |
| ProcessOneStep            | 61.624 ms                 | 137.392 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.300 ms                  | 198.112 ms                |
| Forward                   | 5.478 ms                  | 31.129 ms                 |
| Backward                  | 6.035 ms                  | 13.218 ms                 |
| Optimize                  | 2.723 ms                  | 5.706 ms                  |
| BarrierTimeBeforeRank0    | 2.505 ms                  | 91.033 ms                 |
| AfterBackward             | 61.660 ms                 | 137.424 ms                |
| BlockToStepN              | 13.800 ms                 | 841.663 ms                |
| OneStep                   | 211.960 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:13.219009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240205 16:33:14.219008 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240205 16:33:15.219012 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240205 16:33:16.219009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240205 16:33:17.240955 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.578 ms                  | 247.320 ms                |
| ProcessBack:UpdateCache   | 10.793 ms                 | 623.404 ms                |
| ProcessBack:UpsertPq      | 36.697 ms                 | 81.262 ms                 |
| ProcessOneStep            | 60.124 ms                 | 137.392 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.813 ms                  | 198.112 ms                |
| Forward                   | 5.380 ms                  | 31.129 ms                 |
| Backward                  | 10.211 ms                 | 13.218 ms                 |
| Optimize                  | 2.869 ms                  | 5.736 ms                  |
| BarrierTimeBeforeRank0    | 2.235 ms                  | 91.033 ms                 |
| AfterBackward             | 60.165 ms                 | 137.424 ms                |
| BlockToStepN              | 709.210 ms                | 841.663 ms                |
| OneStep                   | 791.472 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:18.244370 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240205 16:33:19.244009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240205 16:33:20.244009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240205 16:33:21.244009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240205 16:33:22.244012 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.578 ms                  | 38.774 ms                 |
| ProcessBack:UpdateCache   | 10.438 ms                 | 34.704 ms                 |
| ProcessBack:UpsertPq      | 35.528 ms                 | 78.787 ms                 |
| ProcessOneStep            | 58.155 ms                 | 137.392 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.195 ms                  | 198.112 ms                |
| Forward                   | 5.361 ms                  | 31.129 ms                 |
| Backward                  | 10.476 ms                 | 13.218 ms                 |
| Optimize                  | 2.841 ms                  | 5.736 ms                  |
| BarrierTimeBeforeRank0    | 1.352 ms                  | 91.033 ms                 |
| AfterBackward             | 58.106 ms                 | 137.424 ms                |
| BlockToStepN              | 13.800 ms                 | 841.663 ms                |
| OneStep                   | 211.960 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:23.244011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240205 16:33:24.244011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240205 16:33:25.244009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240205 16:33:26.244009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240205 16:33:27.244009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.565 ms                  | 38.774 ms                 |
| ProcessBack:UpdateCache   | 10.301 ms                 | 34.704 ms                 |
| ProcessBack:UpsertPq      | 34.348 ms                 | 78.787 ms                 |
| ProcessOneStep            | 56.845 ms                 | 137.392 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.813 ms                  | 198.112 ms                |
| Forward                   | 5.331 ms                  | 31.129 ms                 |
| Backward                  | 10.503 ms                 | 13.218 ms                 |
| Optimize                  | 2.723 ms                  | 5.809 ms                  |
| BarrierTimeBeforeRank0    | 1.200 ms                  | 91.033 ms                 |
| AfterBackward             | 56.593 ms                 | 137.424 ms                |
| BlockToStepN              | 13.800 ms                 | 841.663 ms                |
| OneStep                   | 211.960 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:28.244010 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240205 16:33:29.244011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240205 16:33:30.244012 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240205 16:33:31.244033 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 57.579, sample: 2.221, forward: 1.345, backward: 1.257, update: 0.254
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 57.497, sample: 2.476, forward: 1.294, backward: 1.076, update: 0.253
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 53.708, sample: 2.577, forward: 1.308, backward: 0.828, update: 0.262
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 55.400, sample: 1.657, forward: 1.211, backward: 1.176, update: 0.271
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 56.405, sample: 2.631, forward: 1.269, backward: 0.780, update: 0.248
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 57.324, sample: 2.595, forward: 1.306, backward: 0.977, update: 0.234
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 55.064, sample: 1.547, forward: 1.237, backward: 1.297, update: 0.279
train_sampler.Prefill()
-------Step 0-------
tensor([   60612,    60645,    60677,    60729,  6057913,   140729, 56548604,
        15369191, 18395537,    60771]) tensor([ 5312834, 17171689, 62403286, 73125709, 22925713, 30753033, 34343975,
        74241888, 74704254, 28298217])
-------Step 1-------
tensor([   60612,    60645,    60677,    60729,  6057913,   140729, 56548604,
        15369191, 18395537,    60771]) tensor([61527276, 27387301, 12008278, 83119721, 75140960, 47647190, 79850183,
        44740582, 32888975, 11578238])
-------Step 2-------
tensor([  158426,   158469,   158508,    31625,   158554,   158596,   158638,
        28549694,   158674,   158690]) tensor([63643209, 27191382, 76025962, 50175607, 46443168, 24583717, 61831874,
        38948736, 12691080, 46708342])
-------Step 3-------
tensor([  158426,   158469,   158508,    31625,   158554,   158596,   158638,
        28549694,   158674,   158690]) tensor([43387992, 83813577, 34219626, 38087243, 60243831, 71160161, 41216397,
        14231478, 25562292,   696636])
-------Step 4-------
tensor([  250801, 50263849,   250858,   177311,   250889,   177359,   250920,
        39912657,   250957,   251022]) tensor([82386132,  8931772, 81946846, 20371975, 63326860, 47795057, 70976289,
        37287427, 78150515, 54442323])
-------Step 5-------
tensor([  250801, 50263849,   250858,   177311,   250889,   177359,   250920,
        39912657,   250957,   251022]) tensor([33434748, 83386605,   216463, 84077730, 63359626, 48393212, 13222048,
         8934383, 74534777, 35424493])
-------Step 6-------
tensor([  345671,    65358,   345723,   345761,    65392, 80048888,   345796,
          345822,   195518, 36093407]) tensor([14788175, 37863673, 34026209, 83153375, 31814876, 34389151, 27644354,
         6963728, 60188115, 76465200])
-------Step 7-------
tensor([  345671,    65358,   345723,   345761,    65392, 80048888,   345796,
          345822,   195518, 36093407]) tensor([28113260, 58037843, 78610235, 64964082, 85060829, 47532542, 59802239,
        49926250, 35089637, 30381236])
-------Step 8-------
tensor([  438111, 23927027,   438150,   212729,   438207,    81618,   438237,
          438280,   438321,   438357]) tensor([38473008, 28338739, 29948812,  1895231, 55066504, 73575346, 14337833,
        64214697,  1588405, 58121292])
-------Step 9-------
tensor([  438111, 23927027,   438150,   212729,   438207,    81618,   438237,
          438280,   438321,   438357]) tensor([57088595, 40426313, 15467169, 51498955,  8272737, 38960112, 26988550,
        38921197, 85861867, 58862835])
before start barrier
start train
[proc 0] 100 steps, total: 54.763, sample: 2.446, forward: 1.317, backward: 1.108, update: 0.351
W20240205 16:33:32.244010 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.565 ms                  | 38.774 ms                 |
| ProcessBack:UpdateCache   | 10.121 ms                 | 34.704 ms                 |
| ProcessBack:UpsertPq      | 34.123 ms                 | 78.787 ms                 |
| ProcessOneStep            | 56.297 ms                 | 137.392 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.528 ms                  | 198.112 ms                |
| Forward                   | 5.317 ms                  | 31.129 ms                 |
| Backward                  | 10.523 ms                 | 13.218 ms                 |
| Optimize                  | 2.728 ms                  | 5.809 ms                  |
| BarrierTimeBeforeRank0    | 1.064 ms                  | 91.033 ms                 |
| AfterBackward             | 56.330 ms                 | 137.424 ms                |
| BlockToStepN              | 13.800 ms                 | 841.663 ms                |
| OneStep                   | 211.960 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:33.244007 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240205 16:33:34.415884 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240205 16:33:35.415009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240205 16:33:36.415006 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240205 16:33:37.415007 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.527 ms                  | 38.774 ms                 |
| ProcessBack:UpdateCache   | 10.262 ms                 | 34.704 ms                 |
| ProcessBack:UpsertPq      | 34.639 ms                 | 81.262 ms                 |
| ProcessOneStep            | 57.361 ms                 | 137.392 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.428 ms                  | 198.112 ms                |
| Forward                   | 5.331 ms                  | 31.129 ms                 |
| Backward                  | 10.543 ms                 | 16.949 ms                 |
| Optimize                  | 2.807 ms                  | 9.454 ms                  |
| BarrierTimeBeforeRank0    | 1.395 ms                  | 127.576 ms                |
| AfterBackward             | 57.395 ms                 | 137.424 ms                |
| BlockToStepN              | 13.800 ms                 | 841.663 ms                |
| OneStep                   | 263.461 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:38.415009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240205 16:33:39.415009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240205 16:33:40.415045 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240205 16:33:41.423832 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240205 16:33:42.458148 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.542 ms                  | 38.774 ms                 |
| ProcessBack:UpdateCache   | 10.121 ms                 | 34.704 ms                 |
| ProcessBack:UpsertPq      | 34.639 ms                 | 81.262 ms                 |
| ProcessOneStep            | 57.668 ms                 | 137.392 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.834 ms                  | 198.112 ms                |
| Forward                   | 5.361 ms                  | 31.129 ms                 |
| Backward                  | 10.565 ms                 | 16.949 ms                 |
| Optimize                  | 2.723 ms                  | 9.454 ms                  |
| BarrierTimeBeforeRank0    | 1.200 ms                  | 127.576 ms                |
| AfterBackward             | 57.703 ms                 | 137.424 ms                |
| BlockToStepN              | 13.800 ms                 | 841.663 ms                |
| OneStep                   | 263.461 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:43.458006 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240205 16:33:44.458006 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240205 16:33:45.458009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240205 16:33:46.458009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240205 16:33:47.458009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.497 ms                  | 28.555 ms                 |
| ProcessBack:UpdateCache   | 10.167 ms                 | 33.927 ms                 |
| ProcessBack:UpsertPq      | 34.606 ms                 | 78.787 ms                 |
| ProcessOneStep            | 57.138 ms                 | 137.392 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.869 ms                  | 198.112 ms                |
| Forward                   | 5.331 ms                  | 31.129 ms                 |
| Backward                  | 10.605 ms                 | 16.949 ms                 |
| Optimize                  | 2.723 ms                  | 9.454 ms                  |
| BarrierTimeBeforeRank0    | 1.395 ms                  | 127.576 ms                |
| AfterBackward             | 57.172 ms                 | 137.424 ms                |
| BlockToStepN              | 13.800 ms                 | 841.663 ms                |
| OneStep                   | 263.461 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:48.458009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240205 16:33:49.458007 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240205 16:33:50.503125 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240205 16:33:51.503010 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240205 16:33:52.503010 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.483 ms                  | 28.555 ms                 |
| ProcessBack:UpdateCache   | 10.113 ms                 | 33.927 ms                 |
| ProcessBack:UpsertPq      | 34.123 ms                 | 78.787 ms                 |
| ProcessOneStep            | 56.549 ms                 | 137.392 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.875 ms                  | 198.112 ms                |
| Forward                   | 5.339 ms                  | 31.129 ms                 |
| Backward                  | 10.580 ms                 | 16.949 ms                 |
| Optimize                  | 2.703 ms                  | 9.454 ms                  |
| BarrierTimeBeforeRank0    | 1.522 ms                  | 127.576 ms                |
| AfterBackward             | 56.593 ms                 | 137.424 ms                |
| BlockToStepN              | 13.800 ms                 | 841.663 ms                |
| OneStep                   | 263.461 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:53.503010 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240205 16:33:54.503010 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240205 16:33:55.503010 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240205 16:33:56.503010 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240205 16:33:57.548235 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.456 ms                  | 28.555 ms                 |
| ProcessBack:UpdateCache   | 10.267 ms                 | 33.927 ms                 |
| ProcessBack:UpsertPq      | 33.896 ms                 | 78.787 ms                 |
| ProcessOneStep            | 56.474 ms                 | 118.157 ms                |
| BlockToStepN              | 13.751 ms                 | 841.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.813 ms                  | 181.337 ms                |
| Forward                   | 5.357 ms                  | 25.851 ms                 |
| Backward                  | 10.580 ms                 | 15.935 ms                 |
| Optimize                  | 2.720 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 2.505 ms                  | 97.416 ms                 |
| AfterBackward             | 56.510 ms                 | 118.199 ms                |
| BlockToStepN              | 13.800 ms                 | 841.663 ms                |
| OneStep                   | 263.461 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:33:58.553738 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240205 16:33:59.553009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240205 16:34:00.553009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240205 16:34:01.553009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240205 16:34:02.553009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.444 ms                  | 28.555 ms                 |
| ProcessBack:UpdateCache   | 10.167 ms                 | 33.927 ms                 |
| ProcessBack:UpsertPq      | 33.772 ms                 | 78.787 ms                 |
| ProcessOneStep            | 56.297 ms                 | 118.157 ms                |
| BlockToStepN              | 101.314 ms                | 837.563 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.541 ms                  | 181.337 ms                |
| Forward                   | 5.357 ms                  | 25.851 ms                 |
| Backward                  | 10.598 ms                 | 15.935 ms                 |
| Optimize                  | 2.708 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 2.505 ms                  | 97.416 ms                 |
| AfterBackward             | 56.330 ms                 | 118.199 ms                |
| BlockToStepN              | 101.366 ms                | 837.663 ms                |
| OneStep                   | 263.461 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:03.553009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240205 16:34:04.553009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240205 16:34:05.740149 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240205 16:34:06.740010 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.444 ms                  | 28.555 ms                 |
| ProcessBack:UpdateCache   | 10.044 ms                 | 33.927 ms                 |
| ProcessBack:UpsertPq      | 33.743 ms                 | 78.787 ms                 |
| ProcessOneStep            | 56.104 ms                 | 118.157 ms                |
| BlockToStepN              | 112.272 ms                | 837.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:07.747604 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.511 ms                  | 181.337 ms                |
| Forward                   | 5.339 ms                  | 25.851 ms                 |
| Backward                  | 10.580 ms                 | 15.935 ms                 |
| Optimize                  | 2.699 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 2.505 ms                  | 97.416 ms                 |
| AfterBackward             | 56.300 ms                 | 118.199 ms                |
| BlockToStepN              | 112.331 ms                | 837.663 ms                |
| OneStep                   | 263.461 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:08.771046 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240205 16:34:09.832815 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240205 16:34:10.882985 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240205 16:34:11.948750 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.460 ms                  | 27.431 ms                 |
| ProcessBack:UpdateCache   | 10.013 ms                 | 13.510 ms                 |
| ProcessBack:UpsertPq      | 33.896 ms                 | 74.511 ms                 |
| ProcessOneStep            | 56.474 ms                 | 118.157 ms                |
| BlockToStepN              | 709.116 ms                | 837.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:13.039742 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.396 ms                  | 181.337 ms                |
| Forward                   | 5.339 ms                  | 25.851 ms                 |
| Backward                  | 10.549 ms                 | 15.935 ms                 |
| Optimize                  | 2.703 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 2.235 ms                  | 97.416 ms                 |
| AfterBackward             | 56.510 ms                 | 118.199 ms                |
| BlockToStepN              | 120.603 ms                | 837.663 ms                |
| OneStep                   | 263.461 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:14.254595 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240205 16:34:15.280911 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240205 16:34:16.280014 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240205 16:34:17.280012 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.460 ms                  | 27.431 ms                 |
| ProcessBack:UpdateCache   | 9.879 ms                  | 13.510 ms                 |
| ProcessBack:UpsertPq      | 33.854 ms                 | 74.511 ms                 |
| ProcessOneStep            | 56.474 ms                 | 118.157 ms                |
| BlockToStepN              | 120.553 ms                | 837.563 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.461 ms                  | 181.337 ms                |
| Forward                   | 5.357 ms                  | 25.851 ms                 |
| Backward                  | 10.549 ms                 | 15.935 ms                 |
| Optimize                  | 2.699 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 2.235 ms                  | 98.348 ms                 |
| AfterBackward             | 56.510 ms                 | 118.199 ms                |
| BlockToStepN              | 709.210 ms                | 837.663 ms                |
| OneStep                   | 791.472 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:18.350647 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240205 16:34:19.427397 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240205 16:34:20.490334 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240205 16:34:21.558512 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.466 ms                  | 27.431 ms                 |
| ProcessBack:UpdateCache   | 9.793 ms                  | 13.510 ms                 |
| ProcessBack:UpsertPq      | 33.863 ms                 | 74.511 ms                 |
| ProcessOneStep            | 56.474 ms                 | 118.157 ms                |
| BlockToStepN              | 138.224 ms                | 837.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:22.771540 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.511 ms                  | 181.337 ms                |
| Forward                   | 5.329 ms                  | 25.851 ms                 |
| Backward                  | 10.549 ms                 | 15.935 ms                 |
| Optimize                  | 2.708 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 1.629 ms                  | 98.348 ms                 |
| AfterBackward             | 56.531 ms                 | 118.199 ms                |
| BlockToStepN              | 138.300 ms                | 837.663 ms                |
| OneStep                   | 263.461 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 6] 200 steps, total: 51.740, sample: 2.301, forward: 0.597, backward: 1.019, update: 0.262
[proc 0] 200 steps, total: 51.740, sample: 2.064, forward: 0.585, backward: 1.078, update: 0.328
[proc 4] 200 steps, total: 51.740, sample: 1.992, forward: 0.530, backward: 0.978, update: 0.245
[proc 7] 200 steps, total: 51.740, sample: 1.969, forward: 0.543, backward: 0.538, update: 0.236
[proc 2] 200 steps, total: 51.740, sample: 2.236, forward: 0.543, backward: 0.969, update: 0.260
[proc 5] 200 steps, total: 51.740, sample: 1.791, forward: 0.554, backward: 1.105, update: 0.265
[proc 3] 200 steps, total: 51.740, sample: 2.488, forward: 0.561, backward: 1.003, update: 0.271
[proc 1] 200 steps, total: 51.740, sample: 2.235, forward: 0.517, backward: 1.073, update: 0.279
W20240205 16:34:23.771008 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240205 16:34:24.818202 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240205 16:34:25.869076 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240205 16:34:26.922785 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 27.431 ms                 |
| ProcessBack:UpdateCache   | 9.748 ms                  | 13.510 ms                 |
| ProcessBack:UpsertPq      | 33.916 ms                 | 74.511 ms                 |
| ProcessOneStep            | 56.495 ms                 | 118.157 ms                |
| BlockToStepN              | 709.116 ms                | 837.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:27.999366 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.497 ms                  | 181.337 ms                |
| Forward                   | 5.325 ms                  | 25.851 ms                 |
| Backward                  | 10.543 ms                 | 15.935 ms                 |
| Optimize                  | 2.720 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 1.529 ms                  | 98.348 ms                 |
| AfterBackward             | 56.510 ms                 | 118.199 ms                |
| BlockToStepN              | 139.495 ms                | 837.663 ms                |
| OneStep                   | 263.461 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:29.080361 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240205 16:34:30.154762 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240205 16:34:31.385186 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240205 16:34:32.386071 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 27.431 ms                 |
| ProcessBack:UpdateCache   | 9.706 ms                  | 13.510 ms                 |
| ProcessBack:UpsertPq      | 33.863 ms                 | 74.511 ms                 |
| ProcessOneStep            | 56.463 ms                 | 118.157 ms                |
| BlockToStepN              | 140.120 ms                | 837.563 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.497 ms                  | 181.337 ms                |
| Forward                   | 5.317 ms                  | 25.851 ms                 |
| Backward                  | 10.543 ms                 | 15.935 ms                 |
| Optimize                  | 2.722 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 1.395 ms                  | 98.348 ms                 |
| AfterBackward             | 56.498 ms                 | 118.199 ms                |
| BlockToStepN              | 140.182 ms                | 837.663 ms                |
| OneStep                   | 263.461 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:33.392871 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240205 16:34:34.472848 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240205 16:34:35.552423 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240205 16:34:36.552011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=224, pq.top=224
W20240205 16:34:37.552008 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=226, pq.top=226
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 21.386 ms                 |
| ProcessBack:UpdateCache   | 9.669 ms                  | 13.413 ms                 |
| ProcessBack:UpsertPq      | 33.854 ms                 | 73.744 ms                 |
| ProcessOneStep            | 56.463 ms                 | 118.157 ms                |
| BlockToStepN              | 148.292 ms                | 837.563 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.400 ms                  | 181.337 ms                |
| Forward                   | 5.275 ms                  | 25.851 ms                 |
| Backward                  | 10.532 ms                 | 15.935 ms                 |
| Optimize                  | 2.728 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 1.395 ms                  | 98.348 ms                 |
| AfterBackward             | 56.510 ms                 | 118.199 ms                |
| BlockToStepN              | 148.366 ms                | 837.663 ms                |
| OneStep                   | 263.461 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:38.624042 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240205 16:34:39.624011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240205 16:34:40.624009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240205 16:34:41.624009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240205 16:34:42.624011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 21.386 ms                 |
| ProcessBack:UpdateCache   | 9.625 ms                  | 13.413 ms                 |
| ProcessBack:UpsertPq      | 33.854 ms                 | 73.744 ms                 |
| ProcessOneStep            | 56.463 ms                 | 118.157 ms                |
| BlockToStepN              | 150.204 ms                | 837.563 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.367 ms                  | 181.337 ms                |
| Forward                   | 5.261 ms                  | 25.851 ms                 |
| Backward                  | 10.520 ms                 | 15.935 ms                 |
| Optimize                  | 2.739 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 1.392 ms                  | 98.348 ms                 |
| AfterBackward             | 56.430 ms                 | 118.199 ms                |
| BlockToStepN              | 709.210 ms                | 837.663 ms                |
| OneStep                   | 791.472 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:43.624011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240205 16:34:44.624011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240205 16:34:45.624009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240205 16:34:46.624009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240205 16:34:47.624009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.460 ms                  | 21.386 ms                 |
| ProcessBack:UpdateCache   | 9.563 ms                  | 13.413 ms                 |
| ProcessBack:UpsertPq      | 33.854 ms                 | 73.744 ms                 |
| ProcessOneStep            | 56.474 ms                 | 118.157 ms                |
| BlockToStepN              | 161.013 ms                | 837.563 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.353 ms                  | 181.337 ms                |
| Forward                   | 5.261 ms                  | 25.851 ms                 |
| Backward                  | 10.509 ms                 | 15.935 ms                 |
| Optimize                  | 2.793 ms                  | 9.097 ms                  |
| BarrierTimeBeforeRank0    | 1.352 ms                  | 98.348 ms                 |
| AfterBackward             | 56.510 ms                 | 118.199 ms                |
| BlockToStepN              | 161.097 ms                | 837.663 ms                |
| OneStep                   | 263.461 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:48.624011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=246, pq.top=246
W20240205 16:34:49.624014 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240205 16:34:50.624011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240205 16:34:51.624011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240205 16:34:52.624011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.456 ms                  | 21.386 ms                 |
| ProcessBack:UpdateCache   | 9.590 ms                  | 13.413 ms                 |
| ProcessBack:UpsertPq      | 33.863 ms                 | 73.744 ms                 |
| ProcessOneStep            | 56.549 ms                 | 109.173 ms                |
| BlockToStepN              | 169.396 ms                | 834.037 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.304 ms                  | 163.121 ms                |
| Forward                   | 5.233 ms                  | 11.984 ms                 |
| Backward                  | 10.476 ms                 | 15.623 ms                 |
| Optimize                  | 2.790 ms                  | 8.866 ms                  |
| BarrierTimeBeforeRank0    | 1.352 ms                  | 97.416 ms                 |
| AfterBackward             | 56.593 ms                 | 109.216 ms                |
| BlockToStepN              | 709.210 ms                | 836.149 ms                |
| OneStep                   | 791.472 ms                | 1.165 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:53.624009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240205 16:34:54.624011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240205 16:34:55.624008 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240205 16:34:56.624011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.460 ms                  | 21.386 ms                 |
| ProcessBack:UpdateCache   | 9.587 ms                  | 13.510 ms                 |
| ProcessBack:UpsertPq      | 34.002 ms                 | 73.744 ms                 |
| ProcessOneStep            | 56.823 ms                 | 109.173 ms                |
| BlockToStepN              | 173.922 ms                | 834.037 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:57.876355 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.304 ms                  | 163.121 ms                |
| Forward                   | 5.232 ms                  | 11.984 ms                 |
| Backward                  | 10.476 ms                 | 15.623 ms                 |
| Optimize                  | 2.797 ms                  | 8.866 ms                  |
| BarrierTimeBeforeRank0    | 1.395 ms                  | 97.416 ms                 |
| AfterBackward             | 56.890 ms                 | 109.216 ms                |
| BlockToStepN              | 174.008 ms                | 836.149 ms                |
| OneStep                   | 292.255 ms                | 1.165 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:34:58.876006 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240205 16:34:59.943078 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240205 16:35:00.943008 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=268, pq.top=268
W20240205 16:35:01.943008 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 21.386 ms                 |
| ProcessBack:UpdateCache   | 9.538 ms                  | 13.510 ms                 |
| ProcessBack:UpsertPq      | 34.089 ms                 | 73.744 ms                 |
| ProcessOneStep            | 56.946 ms                 | 109.173 ms                |
| BlockToStepN              | 201.054 ms                | 834.037 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:35:02.943015 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.304 ms                  | 163.121 ms                |
| Forward                   | 5.228 ms                  | 12.174 ms                 |
| Backward                  | 10.475 ms                 | 15.623 ms                 |
| Optimize                  | 2.790 ms                  | 8.866 ms                  |
| BarrierTimeBeforeRank0    | 1.200 ms                  | 97.416 ms                 |
| AfterBackward             | 56.980 ms                 | 109.216 ms                |
| BlockToStepN              | 709.210 ms                | 836.149 ms                |
| OneStep                   | 791.472 ms                | 1.165 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:35:03.943011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240205 16:35:04.943011 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240205 16:35:05.943010 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240205 16:35:06.943008 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 18.837 ms                 |
| ProcessBack:UpdateCache   | 9.495 ms                  | 13.413 ms                 |
| ProcessBack:UpsertPq      | 34.109 ms                 | 73.158 ms                 |
| ProcessOneStep            | 57.227 ms                 | 109.173 ms                |
| BlockToStepN              | 709.116 ms                | 834.037 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:35:07.943007 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.396 ms                  | 163.121 ms                |
| Forward                   | 5.233 ms                  | 12.174 ms                 |
| Backward                  | 10.475 ms                 | 15.623 ms                 |
| Optimize                  | 2.769 ms                  | 8.866 ms                  |
| BarrierTimeBeforeRank0    | 1.066 ms                  | 97.416 ms                 |
| AfterBackward             | 57.284 ms                 | 109.216 ms                |
| BlockToStepN              | 201.168 ms                | 836.149 ms                |
| OneStep                   | 292.255 ms                | 1.165 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 16:35:09.022650 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240205 16:35:10.022008 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240205 16:35:11.022008 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240205 16:35:12.022009 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.466 ms                  | 18.837 ms                 |
| ProcessBack:UpdateCache   | 9.425 ms                  | 13.413 ms                 |
| ProcessBack:UpsertPq      | 34.138 ms                 | 73.158 ms                 |
| ProcessOneStep            | 57.612 ms                 | 109.173 ms                |
| BlockToStepN              | 201.054 ms                | 834.037 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 16:35:13.022006 52079 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.428 ms                  | 163.121 ms                |
| Forward                   | 5.226 ms                  | 12.174 ms                 |
| Backward                  | 10.451 ms                 | 15.623 ms                 |
| Optimize                  | 2.769 ms                  | 8.866 ms                  |
| BarrierTimeBeforeRank0    | 987.953 us                | 97.416 ms                 |
| AfterBackward             | 57.646 ms                 | 109.216 ms                |
| BlockToStepN              | 201.168 ms                | 836.149 ms                |
| OneStep                   | 292.255 ms                | 1.165 s                   |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 156.2887864112854 seconds
before call kg_cache_controller.StopThreads()
W20240205 16:35:13.452798 52079 grad_async_v1.h:243] call StopThreads. PID = 50224
W20240205 16:35:13.452829 52079 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 16:35:13.456792 52079 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 16:35:13.456802 52079 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240205 16:35:13.468268 52079 grad_async_v1.h:264] StopThreads done.
