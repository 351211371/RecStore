WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 10:44:34.892489 52031 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_127', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=2, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [52031 sampler.py:454] Start PreSampling
WARNING [52031 sampler.py:532] Before construct renumbering_dict
WARNING [52031 sampler.py:555] PreSampling done
W20240204 10:44:40.490669 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 10:44:40.490954 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 10:44:40.490998 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 10:44:40.491034 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 10:44:40.491081 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 10:44:40.491118 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 10:44:40.491153 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 10:44:40.491222 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 10:44:40.491266 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 10:44:40.491295 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 10:44:40.491334 52031 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 10:44:40.491364 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 10:44:40.491397 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 10:44:40.491617 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 10:44:40.491653 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 10:44:40.491683 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 10:44:40.491744 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 10:44:40.491775 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 10:44:40.491822 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 10:44:40.491863 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 10:44:40.491906 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 10:44:40.491943 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 10:44:40.491981 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 10:44:40.492017 52031 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 10:44:40.492043 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 10:44:40.492076 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 10:44:40.492134 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 10:44:40.492167 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 10:44:40.492213 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 10:44:40.492259 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 10:44:40.492296 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 10:44:40.492326 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 10:44:40.492368 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 10:44:40.492405 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 10:44:40.492441 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 10:44:40.492473 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 10:44:40.492502 52031 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 10:44:40.492527 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 10:44:40.492560 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 10:44:40.492614 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 10:44:40.492655 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 10:44:40.492684 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 10:44:40.492723 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 10:44:40.492754 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 10:44:40.492794 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 10:44:40.492828 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 10:44:40.492872 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 10:44:40.492913 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 10:44:40.492956 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 10:44:40.492985 52031 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 10:44:40.493010 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 10:44:40.493043 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 10:44:40.493113 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 10:44:40.493185 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 10:44:40.493225 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 10:44:40.493263 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 10:44:40.493304 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 10:44:40.493333 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 10:44:40.493374 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 10:44:40.493422 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 10:44:40.493451 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 10:44:40.493501 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 10:44:40.493539 52031 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 10:44:40.493566 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 10:44:40.493589 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 10:44:40.493643 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 10:44:40.493687 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 10:44:40.493732 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 10:44:40.493772 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 10:44:40.493808 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 10:44:40.493846 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 10:44:40.493876 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 10:44:40.493919 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 10:44:40.493948 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 10:44:40.493985 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 10:44:40.494022 52031 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 10:44:40.494048 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 10:44:40.494078 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 10:44:40.494133 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 10:44:40.494166 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 10:44:40.494199 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 10:44:40.494248 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 10:44:40.494284 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 10:44:40.494340 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 10:44:40.494371 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 10:44:40.494403 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 10:44:40.494432 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 10:44:40.494462 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 10:44:40.494504 52031 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 10:44:40.494531 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 10:44:40.494556 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 10:44:40.494612 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 10:44:40.494645 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 10:44:40.494678 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 10:44:40.494707 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 10:44:40.494736 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 10:44:40.494766 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 10:44:40.494798 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 10:44:40.494827 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 10:44:40.494863 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 10:44:40.494911 52031 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 10:44:40.494948 52031 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 10:44:40.494974 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 10:44:40.494999 52031 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 10:44:40.734416 52031 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240204 10:44:40.824621 52031 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 745, 1063, 1493,  ..., 9123, 9196, 4737]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 6.030 seconds
[Rank1] pid = 52458
[Rank2] pid = 52522
[Rank3] pid = 52586
[Rank4] pid = 52650
[Rank5] pid = 52665
[Rank6] pid = 52784
INFO [52031 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [52458 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [52522 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [52586 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [52650 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [52784 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [52665 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [52786 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [52650 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52784 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52786 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52665 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52586 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52031 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52458 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52522 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:44:42.500279 52787 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 10:44:42.500728 52716 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240204 10:44:42.500808 52913 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240204 10:44:42.501567 52587 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 10:44:42.501678 52523 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240204 10:44:42.501675 52459 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 10:44:42.501665 52785 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 10:44:42.501660 52651 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240204 10:44:42.530129 52716 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1000281ab000 7.629 MB
W20240204 10:44:42.530125 52913 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100027a08000 7.629 MB
W20240204 10:44:42.530342 52716 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10002894e000 7.629 MB
W20240204 10:44:42.530372 52913 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000290f1000 7.629 MB
W20240204 10:44:42.530431 52716 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x100029894000 1.49 GB
W20240204 10:44:42.530470 52913 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x100088e77000 1.49 GB
W20240204 10:44:42.530493 52716 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1000e845a000 1.49 GB
W20240204 10:44:42.530542 52913 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x100147a3d000 1.49 GB
W20240204 10:44:42.530560 52716 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:44:42.530604 52913 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:44:42.535766 52787 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1001a7022000 7.629 MB
W20240204 10:44:42.535904 52787 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1001a77c5000 7.629 MB
W20240204 10:44:42.535972 52787 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1001a7f68000 1.49 GB
W20240204 10:44:42.536015 52787 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10020754b000 1.49 GB
W20240204 10:44:42.536084 52787 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:44:42.538168 52716 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:44:42.538221 52913 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:44:42.538233 52523 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100266b3a000 7.629 MB
W20240204 10:44:42.538265 52587 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1002672dd000 7.629 MB
W20240204 10:44:42.538307 52459 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100267a80000 7.629 MB
W20240204 10:44:42.538376 52523 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100268223000 7.629 MB
W20240204 10:44:42.538431 52587 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1002689c6000 7.629 MB
W20240204 10:44:42.538450 52523 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x100269169000 1.49 GB
W20240204 10:44:42.538480 52459 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1002c8eef000 7.629 MB
W20240204 10:44:42.538470 52651 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1002c874c000 7.629 MB
W20240204 10:44:42.538503 52523 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1002c9692000 1.49 GB
W20240204 10:44:42.538525 52587 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x100328c75000 1.49 GB
W20240204 10:44:42.538556 52523 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:44:42.538558 52459 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x100388258000 1.49 GB
W20240204 10:44:42.538578 52587 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1003e783b000 1.49 GB
W20240204 10:44:42.538619 52459 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100446e1e000 1.49 GB
W20240204 10:44:42.538656 52587 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:44:42.538671 52459 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:44:42.538683 52651 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1004a6403000 7.629 MB
W20240204 10:44:42.538774 52651 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1004a6ba6000 1.49 GB
W20240204 10:44:42.538847 52651 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x100506189000 1.49 GB
W20240204 10:44:42.538914 52651 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:44:42.538966 52785 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10056576c000 7.629 MB
W20240204 10:44:42.539106 52785 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x100565f0f000 7.629 MB
W20240204 10:44:42.539175 52785 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1005666b2000 1.49 GB
W20240204 10:44:42.539225 52785 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1005c5c95000 1.49 GB
W20240204 10:44:42.539273 52785 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:44:42.545161 52787 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:44:42.553412 52587 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:44:42.553453 52459 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:44:42.553453 52523 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:44:42.553473 52785 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:44:42.553494 52651 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [52786 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [52522 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [52784 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 52786
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [52031 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [52665 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [52586 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [52458 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [52650 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 10:44:45.256323 52651 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 10:44:45.256597 52523 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:44:45.256692 52785 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:44:45.256938 52716 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:44:45.257143 52913 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:44:45.257396 52787 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:44:45.257484 52587 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:44:45.257606 52459 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 10:44:45.261842 52787 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 2,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 10:44:45.262156 52787 grad_base.h:184] Init GradProcessingBase done
I20240204 10:44:45.268976 52787 grad_async_v1.h:203] Use main thread to update emb.
W20240204 10:44:45.269110 52787 kg_controller.h:75] after init GradAsyncProcessing
I20240204 10:44:45.269137 52787 kg_controller.h:84] Construct KGCacheController done
E20240204 10:44:47.034034 52716 recstore.cc:66] init folly done
E20240204 10:44:47.034066 52459 recstore.cc:66] init folly done
E20240204 10:44:47.034184 52651 recstore.cc:66] init folly done
E20240204 10:44:47.034371 52913 recstore.cc:66] init folly done
E20240204 10:44:47.034385 52785 recstore.cc:66] init folly done
E20240204 10:44:47.034441 52587 recstore.cc:66] init folly done
E20240204 10:44:47.034519 52787 recstore.cc:66] init folly done
E20240204 10:44:47.034541 52523 recstore.cc:66] init folly done
I20240204 10:44:47.035607 52787 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 10:44:47.820861 52587 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 10:44:47.820950 52913 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:44:47.831844 52785 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:44:47.832293 52459 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:44:47.834932 52523 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:44:47.839545 52716 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:44:47.845352 52787 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:44:47.856880 52651 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 10:44:50.104097 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240204 10:44:50.191296 52787 grad_async_v1.h:533] Stalled in ProcessBackward: rank=3, step_no=1, sample_step_cpp_seen_[rank]=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.134 ms                  | 5.562 ms                  |
| Forward                   | 9.553 ms                  | 647.707 ms                |
| Backward                  | 9.301 ms                  | 222.532 ms                |
| Optimize                  | 3.110 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 2.399 ms                  | 15.105 ms                 |
| AfterBackward             | 75.158 ms                 | 1.354 s                   |
| BlockToStepN              | 6.571 ms                  | 36.240 ms                 |
| OneStep                   | 112.056 ms                | 2.284 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:44:51.460131 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.131 ms                  | 305.149 ms                |
| ProcessBack:UpdateCache   | 9.086 ms                  | 795.035 ms                |
| ProcessBack:UpsertPq      | 7.408 ms                  | 21.473 ms                 |
| ProcessOneStep            | 25.912 ms                 | 1.354 s                   |
| BlockToStepN              | 348.870 us                | 208.547 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:44:52.470232 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240204 10:44:53.470011 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=28, pq.top=28
W20240204 10:44:54.470022 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.376 ms                  | 17.662 ms                 |
| Forward                   | 4.701 ms                  | 647.707 ms                |
| Backward                  | 8.597 ms                  | 222.532 ms                |
| Optimize                  | 1.843 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 2.418 ms                  | 15.105 ms                 |
| AfterBackward             | 27.755 ms                 | 1.354 s                   |
| BlockToStepN              | 85.818 ms                 | 208.717 ms                |
| OneStep                   | 134.739 ms                | 2.284 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:44:55.470006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=42, pq.top=42
W20240204 10:44:56.470018 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=48, pq.top=48
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.850 ms                  | 271.554 ms                |
| ProcessBack:UpdateCache   | 9.949 ms                  | 793.227 ms                |
| ProcessBack:UpsertPq      | 9.242 ms                  | 20.389 ms                 |
| ProcessOneStep            | 27.996 ms                 | 609.387 ms                |
| BlockToStepN              | 91.614 ms                 | 208.547 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:44:57.470006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=54, pq.top=54
W20240204 10:44:58.470007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240204 10:44:59.471097 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.403 ms                  | 17.662 ms                 |
| Forward                   | 4.774 ms                  | 9.553 ms                  |
| Backward                  | 5.638 ms                  | 10.476 ms                 |
| Optimize                  | 1.840 ms                  | 3.586 ms                  |
| BarrierTimeBeforeRank0    | 3.446 ms                  | 13.191 ms                 |
| AfterBackward             | 28.314 ms                 | 609.502 ms                |
| BlockToStepN              | 102.435 ms                | 169.690 ms                |
| OneStep                   | 152.067 ms                | 632.868 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:00.471019 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=70, pq.top=70
W20240204 10:45:01.471007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.802 ms                  | 12.056 ms                 |
| ProcessBack:UpdateCache   | 9.865 ms                  | 11.374 ms                 |
| ProcessBack:UpsertPq      | 9.670 ms                  | 19.369 ms                 |
| ProcessOneStep            | 28.270 ms                 | 609.387 ms                |
| BlockToStepN              | 109.392 ms                | 170.540 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:02.471007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=80, pq.top=80
W20240204 10:45:03.471009 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240204 10:45:04.471015 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=90, pq.top=90
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.405 ms                  | 18.427 ms                 |
| Forward                   | 4.695 ms                  | 9.553 ms                  |
| Backward                  | 8.544 ms                  | 10.476 ms                 |
| Optimize                  | 1.788 ms                  | 3.586 ms                  |
| BarrierTimeBeforeRank0    | 2.725 ms                  | 13.191 ms                 |
| AfterBackward             | 28.270 ms                 | 609.502 ms                |
| BlockToStepN              | 118.067 ms                | 186.023 ms                |
| OneStep                   | 171.171 ms                | 632.868 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:05.471006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240204 10:45:06.486843 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=100, pq.top=100
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 18.857, sample: 0.318, forward: 1.054, backward: 1.053, update: 0.178
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 18.865, sample: 0.319, forward: 1.063, backward: 1.043, update: 0.182
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 18.876, sample: 0.316, forward: 1.068, backward: 1.020, update: 0.188
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 18.862, sample: 0.316, forward: 1.074, backward: 1.099, update: 0.191
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 18.840, sample: 0.315, forward: 1.025, backward: 0.873, update: 0.174
train_sampler.Prefill()
-------Step 0-------
tensor([ 2002,    86,  3321,  3303, 11898,  8619,  1103,   437, 12843, 11680]) tensor([ 1493,  9570,  5819, 11385, 11600,  1056,   571,  4908,   503, 12631])
-------Step 1-------
tensor([ 2002,    86,  3321,  3303, 11898,  8619,  1103,   437, 12843, 11680]) tensor([ 3913, 10224, 14584,  1581,   909,  7639, 14311,  9938,  5375, 13228])
-------Step 2-------
tensor([ 7581, 11001,  5278,  3875, 10263,  8533, 10477,    73,  7155,   915]) tensor([ 2940,  5068,  3878,  9013,  5739,  8559, 13487,  9638, 13451,  9965])
-------Step 3-------
tensor([ 7581, 11001,  5278,  3875, 10263,  8533, 10477,    73,  7155,   915]) tensor([ 8584,  6587,  4941,  7323,  7042,   711,  5367,  2111, 12712,  2154])
-------Step 4-------
tensor([   86,  9245, 10655,  5535,  4595,  3289,    80,  7109,  7292,  1017]) tensor([ 620, 1162, 4115, 3186, 3264, 2614,  437, 6637, 5554, 1860])
-------Step 5-------
tensor([   86,  9245, 10655,  5535,  4595,  3289,    80,  7109,  7292,  1017]) tensor([11282,  4825,  6011,  1712,  3168,   836,   829,  1082,  6122,  6653])
-------Step 6-------
tensor([ 1688,  8397,    20,    23,  6346,  2961,  8289, 11629, 13987, 13403]) tensor([11001,  3009,  7515,  4283,  6067,  9378,  4076,  8800, 10338, 11948])
-------Step 7-------
tensor([ 1688,  8397,    20,    23,  6346,  2961,  8289, 11629, 13987, 13403]) tensor([13085, 13127,  4675,  6487,  1299,  5763,  7225,  2960,   127, 12652])
-------Step 8-------
tensor([ 3576,  7290,  4989, 12767,    27,    92,  9894, 12451,    18,  2081]) tensor([ 6012,  5628,  4608,  7582,  2737, 14019,  9581,  1435,  7355,  3380])
-------Step 9-------
tensor([ 3576,  7290,  4989, 12767,    27,    92,  9894, 12451,    18,  2081]) tensor([12033,  3971, 12811,  8025, 14926, 13888, 13941,  9938,   666, 12832])
before start barrier
start train
[proc 0] 100 steps, total: 18.851, sample: 0.355, forward: 1.117, backward: 0.913, update: 0.193
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 18.864, sample: 0.301, forward: 1.015, backward: 1.073, update: 0.176
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 18.876, sample: 0.312, forward: 1.075, backward: 0.953, update: 0.181
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.871 ms                  | 12.056 ms                 |
| ProcessBack:UpdateCache   | 9.546 ms                  | 11.374 ms                 |
| ProcessBack:UpsertPq      | 9.670 ms                  | 19.369 ms                 |
| ProcessOneStep            | 28.242 ms                 | 609.387 ms                |
| BlockToStepN              | 124.544 ms                | 208.547 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:07.494032 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240204 10:45:08.494024 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=108, pq.top=108
W20240204 10:45:09.494007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.427 ms                  | 18.527 ms                 |
| Forward                   | 4.800 ms                  | 9.553 ms                  |
| Backward                  | 8.585 ms                  | 22.681 ms                 |
| Optimize                  | 1.811 ms                  | 3.586 ms                  |
| BarrierTimeBeforeRank0    | 1.468 ms                  | 13.191 ms                 |
| AfterBackward             | 28.283 ms                 | 609.502 ms                |
| BlockToStepN              | 131.408 ms                | 208.717 ms                |
| OneStep                   | 181.252 ms                | 632.868 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:10.494007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240204 10:45:11.494006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=122, pq.top=122
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.927 ms                  | 15.099 ms                 |
| ProcessBack:UpdateCache   | 9.419 ms                  | 11.382 ms                 |
| ProcessBack:UpsertPq      | 9.642 ms                  | 19.369 ms                 |
| ProcessOneStep            | 28.250 ms                 | 609.387 ms                |
| BlockToStepN              | 134.168 ms                | 208.547 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:12.494020 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=126, pq.top=126
W20240204 10:45:13.494006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240204 10:45:14.494006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=134, pq.top=134
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.427 ms                  | 21.743 ms                 |
| Forward                   | 4.802 ms                  | 9.553 ms                  |
| Backward                  | 8.597 ms                  | 22.681 ms                 |
| Optimize                  | 1.822 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 1.180 ms                  | 13.191 ms                 |
| AfterBackward             | 28.277 ms                 | 609.502 ms                |
| BlockToStepN              | 138.307 ms                | 224.539 ms                |
| OneStep                   | 190.722 ms                | 632.868 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:15.494006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=138, pq.top=138
W20240204 10:45:16.494016 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=142, pq.top=142
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.927 ms                  | 12.056 ms                 |
| ProcessBack:UpdateCache   | 9.355 ms                  | 11.374 ms                 |
| ProcessBack:UpsertPq      | 9.657 ms                  | 19.203 ms                 |
| ProcessOneStep            | 28.242 ms                 | 609.387 ms                |
| BlockToStepN              | 139.259 ms                | 238.811 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:17.533766 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=146, pq.top=146
W20240204 10:45:18.533007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=150, pq.top=150
W20240204 10:45:19.533007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=154, pq.top=154
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.427 ms                  | 18.878 ms                 |
| Forward                   | 4.774 ms                  | 8.244 ms                  |
| Backward                  | 8.618 ms                  | 10.476 ms                 |
| Optimize                  | 1.840 ms                  | 3.586 ms                  |
| BarrierTimeBeforeRank0    | 1.070 ms                  | 14.958 ms                 |
| AfterBackward             | 28.277 ms                 | 75.158 ms                 |
| BlockToStepN              | 146.804 ms                | 234.720 ms                |
| OneStep                   | 200.480 ms                | 285.990 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:20.533021 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=158, pq.top=158
W20240204 10:45:21.533007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.918 ms                  | 12.056 ms                 |
| ProcessBack:UpdateCache   | 9.348 ms                  | 11.374 ms                 |
| ProcessBack:UpsertPq      | 9.645 ms                  | 19.369 ms                 |
| ProcessOneStep            | 28.256 ms                 | 75.120 ms                 |
| BlockToStepN              | 148.274 ms                | 238.213 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:22.533006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240204 10:45:23.533007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240204 10:45:24.545042 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.405 ms                  | 18.878 ms                 |
| Forward                   | 4.774 ms                  | 8.244 ms                  |
| Backward                  | 8.628 ms                  | 10.476 ms                 |
| Optimize                  | 1.822 ms                  | 3.586 ms                  |
| BarrierTimeBeforeRank0    | 1.070 ms                  | 18.044 ms                 |
| AfterBackward             | 28.288 ms                 | 75.158 ms                 |
| BlockToStepN              | 155.752 ms                | 240.537 ms                |
| OneStep                   | 207.584 ms                | 309.799 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:25.545008 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=176
W20240204 10:45:26.545006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.895 ms                  | 11.511 ms                 |
| ProcessBack:UpdateCache   | 9.400 ms                  | 11.382 ms                 |
| ProcessBack:UpsertPq      | 9.670 ms                  | 19.369 ms                 |
| ProcessOneStep            | 28.270 ms                 | 75.120 ms                 |
| BlockToStepN              | 159.102 ms                | 240.442 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:27.563642 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240204 10:45:28.563007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240204 10:45:29.563017 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.403 ms                  | 19.274 ms                 |
| Forward                   | 4.802 ms                  | 8.244 ms                  |
| Backward                  | 8.607 ms                  | 10.476 ms                 |
| Optimize                  | 1.805 ms                  | 3.586 ms                  |
| BarrierTimeBeforeRank0    | 1.186 ms                  | 20.102 ms                 |
| AfterBackward             | 28.288 ms                 | 75.158 ms                 |
| BlockToStepN              | 165.076 ms                | 264.335 ms                |
| OneStep                   | 215.669 ms                | 343.661 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:30.563006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240204 10:45:31.563006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=198
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.850 ms                  | 11.511 ms                 |
| ProcessBack:UpdateCache   | 9.534 ms                  | 11.382 ms                 |
| ProcessBack:UpsertPq      | 9.704 ms                  | 19.369 ms                 |
| ProcessOneStep            | 28.262 ms                 | 75.120 ms                 |
| BlockToStepN              | 166.376 ms                | 266.780 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 25.501, sample: 0.343, forward: 0.435, backward: 0.899, update: 0.179
[proc 2] 200 steps, total: 25.500, sample: 0.326, forward: 0.427, backward: 0.876, update: 0.192
[proc 7] 200 steps, total: 25.500, sample: 0.344, forward: 0.427, backward: 0.701, update: 0.182
[proc 0] 200 steps, total: 25.500, sample: 0.396, forward: 0.469, backward: 0.802, update: 0.187
[proc 1] 200 steps, total: 25.500, sample: 0.307, forward: 0.384, backward: 0.868, update: 0.184
[proc 6] 200 steps, total: 25.501, sample: 0.346, forward: 0.440, backward: 0.867, update: 0.180
[proc 4] 200 steps, total: 25.500, sample: 0.334, forward: 0.392, backward: 0.778, update: 0.175
[proc 3] 200 steps, total: 25.501, sample: 0.356, forward: 0.425, backward: 0.873, update: 0.187
W20240204 10:45:32.563006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=202, pq.top=202
W20240204 10:45:33.588513 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240204 10:45:34.588019 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.397 ms                  | 19.998 ms                 |
| Forward                   | 4.805 ms                  | 8.244 ms                  |
| Backward                  | 8.585 ms                  | 10.476 ms                 |
| Optimize                  | 1.782 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 1.664 ms                  | 20.761 ms                 |
| AfterBackward             | 28.288 ms                 | 75.158 ms                 |
| BlockToStepN              | 170.468 ms                | 266.824 ms                |
| OneStep                   | 220.291 ms                | 343.661 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:35.588007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240204 10:45:36.588006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=216, pq.top=216
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.806 ms                  | 11.511 ms                 |
| ProcessBack:UpdateCache   | 9.583 ms                  | 11.382 ms                 |
| ProcessBack:UpsertPq      | 9.721 ms                  | 19.369 ms                 |
| ProcessOneStep            | 28.250 ms                 | 75.120 ms                 |
| BlockToStepN              | 171.159 ms                | 266.780 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:37.638000 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
W20240204 10:45:38.637015 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240204 10:45:39.637010 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.395 ms                  | 19.998 ms                 |
| Forward                   | 4.812 ms                  | 8.244 ms                  |
| Backward                  | 8.593 ms                  | 12.020 ms                 |
| Optimize                  | 1.782 ms                  | 5.168 ms                  |
| BarrierTimeBeforeRank0    | 1.896 ms                  | 20.761 ms                 |
| AfterBackward             | 28.314 ms                 | 75.158 ms                 |
| BlockToStepN              | 173.941 ms                | 268.089 ms                |
| OneStep                   | 228.346 ms                | 361.754 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:40.637005 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240204 10:45:41.637007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=234, pq.top=234
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.802 ms                  | 10.766 ms                 |
| ProcessBack:UpdateCache   | 9.656 ms                  | 11.374 ms                 |
| ProcessBack:UpsertPq      | 9.748 ms                  | 19.203 ms                 |
| ProcessOneStep            | 28.286 ms                 | 75.120 ms                 |
| BlockToStepN              | 175.670 ms                | 268.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:42.637006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240204 10:45:43.637015 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240204 10:45:44.637012 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.398 ms                  | 19.998 ms                 |
| Forward                   | 4.812 ms                  | 8.244 ms                  |
| Backward                  | 8.562 ms                  | 12.020 ms                 |
| Optimize                  | 1.780 ms                  | 5.168 ms                  |
| BarrierTimeBeforeRank0    | 2.399 ms                  | 23.374 ms                 |
| AfterBackward             | 28.333 ms                 | 75.158 ms                 |
| BlockToStepN              | 177.371 ms                | 283.550 ms                |
| OneStep                   | 233.462 ms                | 361.754 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:45.637014 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=248, pq.top=248
W20240204 10:45:46.637008 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.762 ms                  | 10.766 ms                 |
| ProcessBack:UpdateCache   | 9.798 ms                  | 11.374 ms                 |
| ProcessBack:UpsertPq      | 9.792 ms                  | 19.203 ms                 |
| ProcessOneStep            | 28.328 ms                 | 38.921 ms                 |
| BlockToStepN              | 181.841 ms                | 283.451 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:47.637007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240204 10:45:48.637019 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240204 10:45:49.687796 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=262, pq.top=262
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.396 ms                  | 21.155 ms                 |
| Forward                   | 4.812 ms                  | 6.941 ms                  |
| Backward                  | 8.559 ms                  | 12.020 ms                 |
| Optimize                  | 1.780 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 2.467 ms                  | 23.374 ms                 |
| AfterBackward             | 28.424 ms                 | 43.229 ms                 |
| BlockToStepN              | 186.023 ms                | 284.674 ms                |
| OneStep                   | 240.258 ms                | 356.557 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:50.687007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240204 10:45:51.724237 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.762 ms                  | 10.766 ms                 |
| ProcessBack:UpdateCache   | 9.798 ms                  | 11.382 ms                 |
| ProcessBack:UpsertPq      | 9.831 ms                  | 19.203 ms                 |
| ProcessOneStep            | 28.395 ms                 | 43.187 ms                 |
| BlockToStepN              | 187.545 ms                | 284.570 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:52.724016 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240204 10:45:53.724011 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=276, pq.top=276
W20240204 10:45:54.724007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.397 ms                  | 21.743 ms                 |
| Forward                   | 4.818 ms                  | 8.244 ms                  |
| Backward                  | 8.559 ms                  | 12.406 ms                 |
| Optimize                  | 1.782 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 2.725 ms                  | 23.374 ms                 |
| AfterBackward             | 28.420 ms                 | 43.229 ms                 |
| BlockToStepN              | 189.031 ms                | 291.448 ms                |
| OneStep                   | 244.358 ms                | 356.557 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:55.724009 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=282, pq.top=282
W20240204 10:45:56.724006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.737 ms                  | 10.651 ms                 |
| ProcessBack:UpdateCache   | 9.843 ms                  | 11.382 ms                 |
| ProcessBack:UpsertPq      | 9.847 ms                  | 19.203 ms                 |
| ProcessOneStep            | 28.381 ms                 | 43.187 ms                 |
| BlockToStepN              | 190.783 ms                | 291.397 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:45:57.724006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240204 10:45:58.725859 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240204 10:45:59.725011 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=296, pq.top=296
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.410 ms                  | 21.743 ms                 |
| Forward                   | 4.818 ms                  | 9.553 ms                  |
| Backward                  | 8.544 ms                  | 15.183 ms                 |
| Optimize                  | 1.772 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 3.224 ms                  | 23.374 ms                 |
| AfterBackward             | 28.424 ms                 | 43.229 ms                 |
| BlockToStepN              | 193.410 ms                | 291.448 ms                |
| OneStep                   | 248.622 ms                | 356.557 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:00.725006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 7] 300 steps, total: 28.980, sample: 0.354, forward: 0.437, backward: 0.745, update: 0.183
[proc 1] 300 steps, total: 28.980, sample: 0.344, forward: 0.418, backward: 0.885, update: 0.180
[proc 5] 300 steps, total: 28.980, sample: 0.318, forward: 0.448, backward: 0.769, update: 0.180
[proc 6] 300 steps, total: 28.980, sample: 0.309, forward: 0.433, backward: 0.869, update: 0.181
[proc 0] 300 steps, total: 28.980, sample: 0.389, forward: 0.485, backward: 0.615, update: 0.189
[proc 3] 300 steps, total: 28.980, sample: 0.320, forward: 0.422, backward: 0.836, update: 0.184
[proc 4] 300 steps, total: 28.980, sample: 0.335, forward: 0.418, backward: 0.911, update: 0.179
[proc 2] 300 steps, total: 28.980, sample: 0.326, forward: 0.429, backward: 0.916, update: 0.193
W20240204 10:46:01.725006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.712 ms                  | 10.651 ms                 |
| ProcessBack:UpdateCache   | 9.885 ms                  | 11.569 ms                 |
| ProcessBack:UpsertPq      | 9.858 ms                  | 19.369 ms                 |
| ProcessOneStep            | 28.397 ms                 | 43.187 ms                 |
| BlockToStepN              | 193.784 ms                | 304.594 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:02.725008 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240204 10:46:03.725016 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240204 10:46:04.725011 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=312, pq.top=312
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.420 ms                  | 22.291 ms                 |
| Forward                   | 4.812 ms                  | 9.553 ms                  |
| Backward                  | 8.544 ms                  | 15.183 ms                 |
| Optimize                  | 1.767 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 3.395 ms                  | 23.504 ms                 |
| AfterBackward             | 28.457 ms                 | 43.229 ms                 |
| BlockToStepN              | 196.368 ms                | 311.427 ms                |
| OneStep                   | 252.959 ms                | 381.128 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:05.725006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240204 10:46:06.725006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=318, pq.top=318
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.680 ms                  | 10.766 ms                 |
| ProcessBack:UpdateCache   | 9.909 ms                  | 11.569 ms                 |
| ProcessBack:UpsertPq      | 9.866 ms                  | 19.369 ms                 |
| ProcessOneStep            | 28.459 ms                 | 43.187 ms                 |
| BlockToStepN              | 197.867 ms                | 311.329 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:07.725008 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240204 10:46:08.725013 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=324, pq.top=324
W20240204 10:46:09.725013 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.427 ms                  | 22.291 ms                 |
| Forward                   | 4.805 ms                  | 9.559 ms                  |
| Backward                  | 8.526 ms                  | 15.183 ms                 |
| Optimize                  | 1.761 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 3.724 ms                  | 23.504 ms                 |
| AfterBackward             | 28.490 ms                 | 43.229 ms                 |
| BlockToStepN              | 199.142 ms                | 311.427 ms                |
| OneStep                   | 255.934 ms                | 381.128 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:10.725008 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240204 10:46:11.725006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=334, pq.top=334
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.660 ms                  | 10.651 ms                 |
| ProcessBack:UpdateCache   | 9.922 ms                  | 11.382 ms                 |
| ProcessBack:UpsertPq      | 9.880 ms                  | 19.829 ms                 |
| ProcessOneStep            | 28.463 ms                 | 43.187 ms                 |
| BlockToStepN              | 201.558 ms                | 312.473 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:12.730226 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240204 10:46:13.730008 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=340, pq.top=340
W20240204 10:46:14.730020 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=343, pq.top=343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.431 ms                  | 22.291 ms                 |
| Forward                   | 4.812 ms                  | 9.559 ms                  |
| Backward                  | 8.508 ms                  | 15.183 ms                 |
| Optimize                  | 1.760 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 3.960 ms                  | 23.778 ms                 |
| AfterBackward             | 28.513 ms                 | 43.229 ms                 |
| BlockToStepN              | 203.059 ms                | 312.944 ms                |
| OneStep                   | 258.710 ms                | 381.128 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:15.752306 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240204 10:46:16.803619 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=350, pq.top=350
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.661 ms                  | 10.651 ms                 |
| ProcessBack:UpdateCache   | 9.927 ms                  | 11.382 ms                 |
| ProcessBack:UpsertPq      | 9.903 ms                  | 19.829 ms                 |
| ProcessOneStep            | 28.488 ms                 | 43.187 ms                 |
| BlockToStepN              | 204.294 ms                | 321.198 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:17.803007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240204 10:46:18.803005 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=356, pq.top=356
W20240204 10:46:19.803018 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.438 ms                  | 21.743 ms                 |
| Forward                   | 4.812 ms                  | 9.553 ms                  |
| Backward                  | 8.525 ms                  | 12.406 ms                 |
| Optimize                  | 1.757 ms                  | 4.636 ms                  |
| BarrierTimeBeforeRank0    | 4.047 ms                  | 23.504 ms                 |
| AfterBackward             | 28.517 ms                 | 41.565 ms                 |
| BlockToStepN              | 207.682 ms                | 315.297 ms                |
| OneStep                   | 261.680 ms                | 381.128 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:20.803006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=363, pq.top=363
W20240204 10:46:21.822850 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=366, pq.top=366
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.669 ms                  | 11.179 ms                 |
| ProcessBack:UpdateCache   | 9.924 ms                  | 11.569 ms                 |
| ProcessBack:UpsertPq      | 9.903 ms                  | 19.950 ms                 |
| ProcessOneStep            | 28.501 ms                 | 41.524 ms                 |
| BlockToStepN              | 208.547 ms                | 315.206 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:22.832777 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240204 10:46:23.832008 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240204 10:46:24.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=374, pq.top=374
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.444 ms                  | 21.743 ms                 |
| Forward                   | 4.805 ms                  | 9.559 ms                  |
| Backward                  | 8.533 ms                  | 15.183 ms                 |
| Optimize                  | 1.757 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 3.971 ms                  | 23.504 ms                 |
| AfterBackward             | 28.550 ms                 | 41.565 ms                 |
| BlockToStepN              | 209.432 ms                | 327.262 ms                |
| OneStep                   | 265.065 ms                | 390.080 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:25.832016 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=378, pq.top=378
W20240204 10:46:26.832012 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=381, pq.top=381
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.667 ms                  | 10.766 ms                 |
| ProcessBack:UpdateCache   | 9.922 ms                  | 11.382 ms                 |
| ProcessBack:UpsertPq      | 9.903 ms                  | 19.829 ms                 |
| ProcessOneStep            | 28.520 ms                 | 41.524 ms                 |
| BlockToStepN              | 209.973 ms                | 327.187 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:27.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=384, pq.top=384
W20240204 10:46:28.832006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=387, pq.top=387
W20240204 10:46:29.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=390, pq.top=390
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.454 ms                  | 21.743 ms                 |
| Forward                   | 4.805 ms                  | 9.559 ms                  |
| Backward                  | 8.533 ms                  | 15.183 ms                 |
| Optimize                  | 1.753 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 4.157 ms                  | 23.504 ms                 |
| AfterBackward             | 28.589 ms                 | 41.565 ms                 |
| BlockToStepN              | 212.352 ms                | 327.262 ms                |
| OneStep                   | 269.057 ms                | 392.342 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:30.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240204 10:46:31.832019 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=396, pq.top=396
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.660 ms                  | 10.766 ms                 |
| ProcessBack:UpdateCache   | 9.933 ms                  | 11.429 ms                 |
| ProcessBack:UpsertPq      | 9.942 ms                  | 19.829 ms                 |
| ProcessOneStep            | 28.573 ms                 | 41.524 ms                 |
| BlockToStepN              | 213.756 ms                | 327.187 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:32.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 6] 400 steps, total: 32.120, sample: 0.364, forward: 0.453, backward: 0.825, update: 0.179
[proc 0] 400 steps, total: 32.120, sample: 0.416, forward: 0.487, backward: 0.611, update: 0.171
[proc 5] 400 steps, total: 32.120, sample: 0.358, forward: 0.444, backward: 0.488, update: 0.165
[proc 7] 400 steps, total: 32.120, sample: 0.321, forward: 0.436, backward: 0.586, update: 0.174
[proc 2] 400 steps, total: 32.120, sample: 0.353, forward: 0.428, backward: 0.897, update: 0.189
[proc 1] 400 steps, total: 32.120, sample: 0.353, forward: 0.398, backward: 0.889, update: 0.170
[proc 3] 400 steps, total: 32.120, sample: 0.323, forward: 0.433, backward: 0.859, update: 0.173
[proc 4] 400 steps, total: 32.120, sample: 0.366, forward: 0.403, backward: 0.889, update: 0.171
W20240204 10:46:33.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=402, pq.top=402
W20240204 10:46:34.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=405, pq.top=405
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.462 ms                  | 21.743 ms                 |
| Forward                   | 4.800 ms                  | 9.559 ms                  |
| Backward                  | 8.516 ms                  | 15.183 ms                 |
| Optimize                  | 1.743 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 4.349 ms                  | 23.778 ms                 |
| AfterBackward             | 28.617 ms                 | 42.268 ms                 |
| BlockToStepN              | 215.319 ms                | 327.715 ms                |
| OneStep                   | 270.794 ms                | 393.808 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:35.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=408, pq.top=408
W20240204 10:46:36.832021 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=411, pq.top=411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.657 ms                  | 10.766 ms                 |
| ProcessBack:UpdateCache   | 9.954 ms                  | 11.429 ms                 |
| ProcessBack:UpsertPq      | 9.944 ms                  | 20.389 ms                 |
| ProcessOneStep            | 28.589 ms                 | 42.240 ms                 |
| BlockToStepN              | 215.421 ms                | 327.649 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:37.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240204 10:46:38.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240204 10:46:39.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.475 ms                  | 21.743 ms                 |
| Forward                   | 4.805 ms                  | 9.559 ms                  |
| Backward                  | 8.525 ms                  | 15.183 ms                 |
| Optimize                  | 1.753 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 4.349 ms                  | 24.723 ms                 |
| AfterBackward             | 28.625 ms                 | 42.268 ms                 |
| BlockToStepN              | 216.511 ms                | 333.146 ms                |
| OneStep                   | 272.958 ms                | 394.053 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:40.832008 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=422, pq.top=422
W20240204 10:46:41.832018 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=425, pq.top=425
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.660 ms                  | 10.766 ms                 |
| ProcessBack:UpdateCache   | 9.942 ms                  | 11.429 ms                 |
| ProcessBack:UpsertPq      | 9.948 ms                  | 20.389 ms                 |
| ProcessOneStep            | 28.594 ms                 | 42.240 ms                 |
| BlockToStepN              | 217.389 ms                | 333.032 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:42.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240204 10:46:43.832006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=431, pq.top=431
W20240204 10:46:44.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=434, pq.top=434
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.490 ms                  | 22.379 ms                 |
| Forward                   | 4.799 ms                  | 9.559 ms                  |
| Backward                  | 8.533 ms                  | 15.183 ms                 |
| Optimize                  | 1.756 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 4.311 ms                  | 24.723 ms                 |
| AfterBackward             | 28.637 ms                 | 42.583 ms                 |
| BlockToStepN              | 218.928 ms                | 333.146 ms                |
| OneStep                   | 275.620 ms                | 394.053 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:45.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240204 10:46:46.832010 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=440, pq.top=440
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.664 ms                  | 11.179 ms                 |
| ProcessBack:UpdateCache   | 9.934 ms                  | 11.569 ms                 |
| ProcessBack:UpsertPq      | 9.957 ms                  | 20.389 ms                 |
| ProcessOneStep            | 28.608 ms                 | 42.540 ms                 |
| BlockToStepN              | 219.964 ms                | 333.676 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:47.832017 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=443, pq.top=443
W20240204 10:46:48.832006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=446, pq.top=446
W20240204 10:46:49.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=449, pq.top=449
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.490 ms                  | 22.379 ms                 |
| Forward                   | 4.779 ms                  | 9.559 ms                  |
| Backward                  | 8.535 ms                  | 15.183 ms                 |
| Optimize                  | 1.756 ms                  | 4.780 ms                  |
| BarrierTimeBeforeRank0    | 4.228 ms                  | 24.723 ms                 |
| AfterBackward             | 28.651 ms                 | 42.583 ms                 |
| BlockToStepN              | 221.173 ms                | 333.746 ms                |
| OneStep                   | 276.298 ms                | 399.386 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:50.832006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=452, pq.top=452
W20240204 10:46:51.832006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=455, pq.top=455
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.664 ms                  | 11.179 ms                 |
| ProcessBack:UpdateCache   | 9.930 ms                  | 11.569 ms                 |
| ProcessBack:UpsertPq      | 9.971 ms                  | 20.389 ms                 |
| ProcessOneStep            | 28.622 ms                 | 42.240 ms                 |
| BlockToStepN              | 221.436 ms                | 333.676 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:52.832019 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240204 10:46:53.832006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=460, pq.top=460
W20240204 10:46:54.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=463, pq.top=463
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.497 ms                  | 22.291 ms                 |
| Forward                   | 4.779 ms                  | 9.553 ms                  |
| Backward                  | 8.544 ms                  | 12.406 ms                 |
| Optimize                  | 1.757 ms                  | 4.636 ms                  |
| BarrierTimeBeforeRank0    | 4.157 ms                  | 23.778 ms                 |
| AfterBackward             | 28.665 ms                 | 42.268 ms                 |
| BlockToStepN              | 222.018 ms                | 341.481 ms                |
| OneStep                   | 277.284 ms                | 404.611 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:55.832006 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=466, pq.top=466
W20240204 10:46:56.832007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=469, pq.top=469
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.674 ms                  | 11.179 ms                 |
| ProcessBack:UpdateCache   | 9.930 ms                  | 11.569 ms                 |
| ProcessBack:UpsertPq      | 9.972 ms                  | 20.389 ms                 |
| ProcessOneStep            | 28.639 ms                 | 42.240 ms                 |
| BlockToStepN              | 222.167 ms                | 341.409 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:46:57.861465 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=472, pq.top=472
W20240204 10:46:58.861007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=475, pq.top=475
W20240204 10:46:59.861023 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=478, pq.top=478
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.511 ms                  | 22.291 ms                 |
| Forward                   | 4.774 ms                  | 9.553 ms                  |
| Backward                  | 8.548 ms                  | 12.406 ms                 |
| Optimize                  | 1.756 ms                  | 4.636 ms                  |
| BarrierTimeBeforeRank0    | 4.058 ms                  | 23.778 ms                 |
| AfterBackward             | 28.677 ms                 | 43.229 ms                 |
| BlockToStepN              | 224.539 ms                | 341.481 ms                |
| OneStep                   | 280.316 ms                | 404.611 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:47:00.861007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240204 10:47:01.861007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=483, pq.top=483
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.675 ms                  | 10.766 ms                 |
| ProcessBack:UpdateCache   | 9.926 ms                  | 11.429 ms                 |
| ProcessBack:UpsertPq      | 9.982 ms                  | 20.700 ms                 |
| ProcessOneStep            | 28.647 ms                 | 43.187 ms                 |
| BlockToStepN              | 225.097 ms                | 350.313 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:47:02.861021 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=486, pq.top=486
W20240204 10:47:03.861007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=488, pq.top=488
W20240204 10:47:04.861007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=491, pq.top=491
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.512 ms                  | 22.291 ms                 |
| Forward                   | 4.779 ms                  | 9.553 ms                  |
| Backward                  | 8.543 ms                  | 12.406 ms                 |
| Optimize                  | 1.756 ms                  | 4.636 ms                  |
| BarrierTimeBeforeRank0    | 4.228 ms                  | 23.778 ms                 |
| AfterBackward             | 28.707 ms                 | 43.229 ms                 |
| BlockToStepN              | 225.206 ms                | 357.478 ms                |
| OneStep                   | 282.341 ms                | 410.127 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:47:05.861007 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240204 10:47:06.889226 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=498, pq.top=498
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.671 ms                  | 10.766 ms                 |
| ProcessBack:UpdateCache   | 9.931 ms                  | 11.429 ms                 |
| ProcessBack:UpsertPq      | 9.992 ms                  | 20.923 ms                 |
| ProcessOneStep            | 28.671 ms                 | 43.187 ms                 |
| BlockToStepN              | 226.683 ms                | 357.411 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:47:07.889008 52787 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=500, pq.top=500
[proc 2] 500 steps, total: 34.702, sample: 0.357, forward: 0.423, backward: 0.723, update: 0.180
[proc 1] 500 steps, total: 34.702, sample: 0.311, forward: 0.386, backward: 0.887, update: 0.173
[proc 3] 500 steps, total: 34.702, sample: 0.313, forward: 0.416, backward: 0.859, update: 0.179
[proc 7] 500 steps, total: 34.702, sample: 0.329, forward: 0.420, backward: 0.413, update: 0.161
[proc 4] 500 steps, total: 34.702, sample: 0.309, forward: 0.402, backward: 0.897, update: 0.173
[proc 6] 500 steps, total: 34.702, sample: 0.308, forward: 0.438, backward: 0.834, update: 0.179
[proc 0] 500 steps, total: 34.702, sample: 0.407, forward: 0.455, backward: 0.725, update: 0.184
[proc 5] 500 steps, total: 34.702, sample: 0.304, forward: 0.440, backward: 0.878, update: 0.179
Successfully xmh. training takes 140.15515422821045 seconds
before call kg_cache_controller.StopThreads()
W20240204 10:47:08.000509 52787 grad_async_v1.h:243] call StopThreads. PID = 52031
W20240204 10:47:08.000523 52787 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 10:47:08.006570 52787 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 10:47:08.006595 52787 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 10:47:08.036134 52787 grad_async_v1.h:264] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f211dac26d0>
