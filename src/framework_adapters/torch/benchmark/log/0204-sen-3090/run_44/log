WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 00:36:04.138049 42835 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_102', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=14, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [42835 sampler.py:454] Start PreSampling
WARNING [42835 sampler.py:532] Before construct renumbering_dict
WARNING [42835 sampler.py:555] PreSampling done
W20240205 00:56:04.327221 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 00:56:04.327412 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 00:56:04.327461 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 00:56:04.327497 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 00:56:04.327530 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 00:56:04.327570 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 00:56:04.327605 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 00:56:04.327661 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 00:56:04.327697 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 00:56:04.327733 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 00:56:04.327775 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_10 [1000000]0x100004c60000 7.629 MB
W20240205 00:56:04.327804 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_11 [1000000]0x100005403000 7.629 MB
W20240205 00:56:04.327842 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_12 [1000000]0x100005ba6000 7.629 MB
W20240205 00:56:04.327872 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_13 [1000000]0x100006349000 7.629 MB
W20240205 00:56:04.327917 42835 IPCTensor.h:369] NewIPCTensor: step_r0 [14]0x100006aec000 112 B 
W20240205 00:56:04.327960 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100006aee000 8 B 
W20240205 00:56:04.327986 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100006af0000 8 B 
W20240205 00:56:04.328137 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100006af2000 7.629 MB
W20240205 00:56:04.328179 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100007295000 7.629 MB
W20240205 00:56:04.328215 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100007a38000 7.629 MB
W20240205 00:56:04.328248 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000081db000 7.629 MB
W20240205 00:56:04.328284 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10000897e000 7.629 MB
W20240205 00:56:04.328312 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100009121000 7.629 MB
W20240205 00:56:04.328346 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000098c4000 7.629 MB
W20240205 00:56:04.328377 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x10000a067000 7.629 MB
W20240205 00:56:04.328423 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000a80a000 7.629 MB
W20240205 00:56:04.328452 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10000afad000 7.629 MB
W20240205 00:56:04.328487 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_10 [1000000]0x10000b750000 7.629 MB
W20240205 00:56:04.328529 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_11 [1000000]0x10000bef3000 7.629 MB
W20240205 00:56:04.328590 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_12 [1000000]0x10000c696000 7.629 MB
W20240205 00:56:04.328639 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_13 [1000000]0x10000ce39000 7.629 MB
W20240205 00:56:04.328670 42835 IPCTensor.h:369] NewIPCTensor: step_r1 [14]0x10000d5dc000 112 B 
W20240205 00:56:04.328696 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10000d5de000 8 B 
W20240205 00:56:04.328727 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10000d5e0000 8 B 
W20240205 00:56:04.328790 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10000d5e2000 7.629 MB
W20240205 00:56:04.328823 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000dd85000 7.629 MB
W20240205 00:56:04.328855 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000e528000 7.629 MB
W20240205 00:56:04.328886 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000eccb000 7.629 MB
W20240205 00:56:04.328917 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000f46e000 7.629 MB
W20240205 00:56:04.328960 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000fc11000 7.629 MB
W20240205 00:56:04.328999 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000103b4000 7.629 MB
W20240205 00:56:04.329039 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100010b57000 7.629 MB
W20240205 00:56:04.329070 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000112fa000 7.629 MB
W20240205 00:56:04.329108 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x100011a9d000 7.629 MB
W20240205 00:56:04.329145 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_10 [1000000]0x100012240000 7.629 MB
W20240205 00:56:04.329187 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_11 [1000000]0x1000129e3000 7.629 MB
W20240205 00:56:04.329222 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_12 [1000000]0x100013186000 7.629 MB
W20240205 00:56:04.329252 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_13 [1000000]0x100013929000 7.629 MB
W20240205 00:56:04.329282 42835 IPCTensor.h:369] NewIPCTensor: step_r2 [14]0x1000140cc000 112 B 
W20240205 00:56:04.329308 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000140ce000 8 B 
W20240205 00:56:04.329334 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000140d0000 8 B 
W20240205 00:56:04.329401 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000140d2000 7.629 MB
W20240205 00:56:04.329434 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x100014875000 7.629 MB
W20240205 00:56:04.329464 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100015018000 7.629 MB
W20240205 00:56:04.329494 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000157bb000 7.629 MB
W20240205 00:56:04.329526 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x100015f5e000 7.629 MB
W20240205 00:56:04.329569 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100016701000 7.629 MB
W20240205 00:56:04.329602 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100016ea4000 7.629 MB
W20240205 00:56:04.329633 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100017647000 7.629 MB
W20240205 00:56:04.329674 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100017dea000 7.629 MB
W20240205 00:56:04.329710 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10001858d000 7.629 MB
W20240205 00:56:04.329754 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_10 [1000000]0x100018d30000 7.629 MB
W20240205 00:56:04.329795 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_11 [1000000]0x1000194d3000 7.629 MB
W20240205 00:56:04.329833 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_12 [1000000]0x100019c76000 7.629 MB
W20240205 00:56:04.329874 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_13 [1000000]0x10001a419000 7.629 MB
W20240205 00:56:04.329903 42835 IPCTensor.h:369] NewIPCTensor: step_r3 [14]0x10001abbc000 112 B 
W20240205 00:56:04.329928 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001abbe000 8 B 
W20240205 00:56:04.329953 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10001abc0000 8 B 
W20240205 00:56:04.330015 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10001abc2000 7.629 MB
W20240205 00:56:04.330054 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x10001b365000 7.629 MB
W20240205 00:56:04.330085 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x10001bb08000 7.629 MB
W20240205 00:56:04.330121 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001c2ab000 7.629 MB
W20240205 00:56:04.330154 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001ca4e000 7.629 MB
W20240205 00:56:04.330191 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x10001d1f1000 7.629 MB
W20240205 00:56:04.330226 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x10001d994000 7.629 MB
W20240205 00:56:04.330262 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x10001e137000 7.629 MB
W20240205 00:56:04.330296 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x10001e8da000 7.629 MB
W20240205 00:56:04.330332 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001f07d000 7.629 MB
W20240205 00:56:04.330372 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_10 [1000000]0x10001f820000 7.629 MB
W20240205 00:56:04.330404 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_11 [1000000]0x10001ffc3000 7.629 MB
W20240205 00:56:04.330437 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_12 [1000000]0x100020766000 7.629 MB
W20240205 00:56:04.330468 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_13 [1000000]0x100020f09000 7.629 MB
W20240205 00:56:04.330498 42835 IPCTensor.h:369] NewIPCTensor: step_r4 [14]0x1000216ac000 112 B 
W20240205 00:56:04.330524 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000216ae000 8 B 
W20240205 00:56:04.330549 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000216b0000 8 B 
W20240205 00:56:04.330608 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000216b2000 7.629 MB
W20240205 00:56:04.330646 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100021e55000 7.629 MB
W20240205 00:56:04.330680 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000225f8000 7.629 MB
W20240205 00:56:04.330721 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x100022d9b000 7.629 MB
W20240205 00:56:04.330752 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x10002353e000 7.629 MB
W20240205 00:56:04.330783 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x100023ce1000 7.629 MB
W20240205 00:56:04.330814 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x100024484000 7.629 MB
W20240205 00:56:04.330850 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x100024c27000 7.629 MB
W20240205 00:56:04.330881 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000253ca000 7.629 MB
W20240205 00:56:04.330914 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x100025b6d000 7.629 MB
W20240205 00:56:04.330950 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_10 [1000000]0x100026310000 7.629 MB
W20240205 00:56:04.330987 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_11 [1000000]0x100026ab3000 7.629 MB
W20240205 00:56:04.331023 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_12 [1000000]0x100027256000 7.629 MB
W20240205 00:56:04.331056 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_13 [1000000]0x1000279f9000 7.629 MB
W20240205 00:56:04.331092 42835 IPCTensor.h:369] NewIPCTensor: step_r5 [14]0x10002819c000 112 B 
W20240205 00:56:04.331118 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10002819e000 8 B 
W20240205 00:56:04.331147 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000281a0000 8 B 
W20240205 00:56:04.331211 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000281a2000 7.629 MB
W20240205 00:56:04.331245 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x100028945000 7.629 MB
W20240205 00:56:04.331280 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000290e8000 7.629 MB
W20240205 00:56:04.331312 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10002988b000 7.629 MB
W20240205 00:56:04.331343 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10002a02e000 7.629 MB
W20240205 00:56:04.331379 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10002a7d1000 7.629 MB
W20240205 00:56:04.331411 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10002af74000 7.629 MB
W20240205 00:56:04.331451 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10002b717000 7.629 MB
W20240205 00:56:04.331485 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x10002beba000 7.629 MB
W20240205 00:56:04.331521 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x10002c65d000 7.629 MB
W20240205 00:56:04.331560 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_10 [1000000]0x10002ce00000 7.629 MB
W20240205 00:56:04.331598 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_11 [1000000]0x10002d5a3000 7.629 MB
W20240205 00:56:04.331636 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_12 [1000000]0x10002dd46000 7.629 MB
W20240205 00:56:04.331668 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_13 [1000000]0x10002e4e9000 7.629 MB
W20240205 00:56:04.331699 42835 IPCTensor.h:369] NewIPCTensor: step_r6 [14]0x10002ec8c000 112 B 
W20240205 00:56:04.331725 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x10002ec8e000 8 B 
W20240205 00:56:04.331751 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10002ec90000 8 B 
W20240205 00:56:04.331808 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10002ec92000 7.629 MB
W20240205 00:56:04.331852 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10002f435000 7.629 MB
W20240205 00:56:04.331889 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10002fbd8000 7.629 MB
W20240205 00:56:04.331923 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x10003037b000 7.629 MB
W20240205 00:56:04.331964 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x100030b1e000 7.629 MB
W20240205 00:56:04.332000 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000312c1000 7.629 MB
W20240205 00:56:04.332036 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100031a64000 7.629 MB
W20240205 00:56:04.332080 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100032207000 7.629 MB
W20240205 00:56:04.332120 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000329aa000 7.629 MB
W20240205 00:56:04.332155 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x10003314d000 7.629 MB
W20240205 00:56:04.332188 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_10 [1000000]0x1000338f0000 7.629 MB
W20240205 00:56:04.332230 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_11 [1000000]0x100034093000 7.629 MB
W20240205 00:56:04.332275 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_12 [1000000]0x100034836000 7.629 MB
W20240205 00:56:04.332309 42835 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_13 [1000000]0x100034fd9000 7.629 MB
W20240205 00:56:04.332343 42835 IPCTensor.h:369] NewIPCTensor: step_r7 [14]0x10003577c000 112 B 
W20240205 00:56:04.332370 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10003577e000 8 B 
W20240205 00:56:04.332396 42835 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100035780000 8 B 
W20240205 00:56:04.860311 42835 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100035782000 128.2 GB
W20240205 01:04:48.290933 42835 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020443ba000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302711,  4302741,    86772,  ..., 69822201, 64380423,  5180142]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2232.082 seconds
[Rank1] pid = 3921
[Rank2] pid = 4113
[Rank3] pid = 4274
[Rank4] pid = 4483
[Rank5] pid = 4661
[Rank6] pid = 4864
INFO [42835 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3921 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [4113 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [4274 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [4483 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [4661 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [4864 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [5068 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [4864 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [4113 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [5068 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [4483 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [4274 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [4661 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [3921 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42835 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 01:13:29.231977  4865 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 01:13:29.235433  5070 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 01:13:29.235697  4662 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 01:13:29.235930  5133 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 01:13:29.236073  4484 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 01:13:29.235925  4114 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 01:13:29.235941  4278 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 01:13:29.236403  3922 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 01:13:29.309957  4865 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x102058c03000 7.629 MB
W20240205 01:13:29.310156  4865 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1020593a6000 7.629 MB
W20240205 01:13:29.310220  4865 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x102059b49000 1.49 GB
W20240205 01:13:29.310264  4865 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1020b912c000 1.49 GB
W20240205 01:13:29.310326  4865 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 01:13:29.311681  4662 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x102118715000 7.629 MB
W20240205 01:13:29.311827  4662 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102118eb8000 7.629 MB
W20240205 01:13:29.311879  4662 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10211965b000 1.49 GB
W20240205 01:13:29.311926  4662 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x102178c3e000 1.49 GB
W20240205 01:13:29.311980  4662 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 01:13:29.313149  5133 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1021d8221000 7.629 MB
W20240205 01:13:29.313164  5070 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1021d89c4000 7.629 MB
W20240205 01:13:29.313300  5133 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1021d9167000 7.629 MB
W20240205 01:13:29.313369  5133 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1021d990a000 1.49 GB
W20240205 01:13:29.313387  5070 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102238eed000 7.629 MB
W20240205 01:13:29.313416  5133 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x102239690000 1.49 GB
W20240205 01:13:29.313452  5070 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102298c73000 1.49 GB
W20240205 01:13:29.313477  5133 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 01:13:29.313544  5070 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1022f8256000 1.49 GB
W20240205 01:13:29.313622  5070 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 01:13:29.313899  4114 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102357841000 7.629 MB
W20240205 01:13:29.313933  4278 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102357fe4000 7.629 MB
W20240205 01:13:29.313937  4484 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102358787000 7.629 MB
W20240205 01:13:29.314016  3922 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102358f2a000 7.629 MB
W20240205 01:13:29.314064  4114 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1023596cd000 7.629 MB
W20240205 01:13:29.314090  4278 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x102359e70000 7.629 MB
W20240205 01:13:29.314111  4484 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10235a613000 7.629 MB
W20240205 01:13:29.314136  4114 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10235adb6000 1.49 GB
W20240205 01:13:29.314157  4278 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1023ba399000 1.49 GB
W20240205 01:13:29.314179  4484 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10241997c000 1.49 GB
W20240205 01:13:29.314186  4114 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102478f5f000 1.49 GB
W20240205 01:13:29.314217  3922 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1024d8542000 7.629 MB
W20240205 01:13:29.314226  4278 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1024d8ce5000 1.49 GB
W20240205 01:13:29.314249  4484 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1025382c8000 1.49 GB
W20240205 01:13:29.314273  4114 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 01:13:29.314294  4278 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 01:13:29.314304  4484 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 01:13:29.314352  3922 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1025978ab000 1.49 GB
W20240205 01:13:29.314404  3922 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1025f6e8e000 1.49 GB
W20240205 01:13:29.314499  3922 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 01:13:29.319924  4662 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 01:13:29.323338  4278 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 01:13:29.325745  5070 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 01:13:29.327622  5133 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 01:13:29.333880  4114 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 01:13:29.338443  4484 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 01:13:29.344404  3922 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 01:13:29.346871  4865 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
cudaHostRegister 0x100035782000
4: KnownLocalCachedEmbedding init done
WARNING [4483 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
1: KnownLocalCachedEmbedding init done
WARNING [3921 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
5: KnownLocalCachedEmbedding init done
WARNING [4661 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
2: KnownLocalCachedEmbedding init done
WARNING [4113 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
6: KnownLocalCachedEmbedding init done
WARNING [4864 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
7: KnownLocalCachedEmbedding init done
WARNING [5068 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
3: KnownLocalCachedEmbedding init done
WARNING [4274 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 5068
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100035782000
0: KnownLocalCachedEmbedding init done
WARNING [42835 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 01:14:18.782297  5070 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 01:14:18.782419  5133 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 01:14:18.782498  4865 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 01:14:18.782580  4114 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 01:14:18.782632  4278 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 01:14:18.782666  4662 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 01:14:18.782881  4484 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 01:14:18.783106  3922 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 01:14:18.786363  5070 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 14,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 01:14:18.786650  5070 grad_base.h:184] Init GradProcessingBase done
I20240205 01:14:31.875903  5070 grad_async_v1.h:203] Use main thread to update emb.
W20240205 01:14:31.876263  5070 kg_controller.h:75] after init GradAsyncProcessing
I20240205 01:14:31.876273  5070 kg_controller.h:84] Construct KGCacheController done
E20240205 01:14:33.669011  4484 recstore.cc:66] init folly done
E20240205 01:14:33.669049  4865 recstore.cc:66] init folly done
E20240205 01:14:33.670853  5133 recstore.cc:66] init folly done
E20240205 01:14:33.670897  4278 recstore.cc:66] init folly done
E20240205 01:14:33.671166  4114 recstore.cc:66] init folly done
E20240205 01:14:33.671216  4662 recstore.cc:66] init folly done
E20240205 01:14:33.671217  3922 recstore.cc:66] init folly done
E20240205 01:14:33.671346  5070 recstore.cc:66] init folly done
I20240205 01:14:33.672456  5070 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 01:14:55.667796  4662 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 01:14:56.015332  4484 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 01:14:56.019387  5133 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 01:14:57.065174  4114 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 01:14:57.559890  4278 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 01:14:58.172103  5070 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 01:14:58.199285  3922 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 01:14:59.332360  4865 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240205 01:15:01.724021  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240205 01:15:02.518272  8219 grad_async_v1.h:533] Stalled in ProcessBackward: rank=6, step_no=1, sample_step_cpp_seen_[rank]=0
W20240205 01:15:02.996757  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.580 ms                 | 342.065 ms                |
| ProcessBack:UpdateCache   | 9.530 ms                  | 697.875 ms                |
| ProcessBack:UpsertPq      | 31.429 ms                 | 36.652 ms                 |
| ProcessOneStep            | 88.198 ms                 | 1.328 s                   |
| BlockToStepN              | 667.116 ms                | 747.622 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 18.997 ms                 | 98.695 ms                 |
| Forward                   | 7.707 ms                  | 758.056 ms                |
| Backward                  | 10.467 ms                 | 280.580 ms                |
| Optimize                  | 2.295 ms                  | 4.690 ms                  |
| BarrierTimeBeforeRank0    | 1.258 ms                  | 215.944 ms                |
| AfterBackward             | 88.235 ms                 | 1.328 s                   |
| BlockToStepN              | 667.257 ms                | 749.323 ms                |
| OneStep                   | 1.073 s                   | 3.142 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:03.996006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240205 01:15:04.996008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240205 01:15:05.996011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240205 01:15:06.996009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240205 01:15:07.996011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.915 ms                  | 342.065 ms                |
| ProcessBack:UpdateCache   | 9.243 ms                  | 697.875 ms                |
| ProcessBack:UpsertPq      | 38.600 ms                 | 71.986 ms                 |
| ProcessOneStep            | 71.242 ms                 | 1.328 s                   |
| BlockToStepN              | 3.739 ms                  | 747.622 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.110 ms                  | 98.695 ms                 |
| Forward                   | 6.661 ms                  | 758.056 ms                |
| Backward                  | 10.467 ms                 | 280.580 ms                |
| Optimize                  | 2.473 ms                  | 4.827 ms                  |
| BarrierTimeBeforeRank0    | 171.757 us                | 215.944 ms                |
| AfterBackward             | 71.301 ms                 | 1.328 s                   |
| BlockToStepN              | 3.788 ms                  | 749.323 ms                |
| OneStep                   | 188.464 ms                | 3.142 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:08.996034  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240205 01:15:09.996011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240205 01:15:10.996009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240205 01:15:11.996012  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240205 01:15:12.996009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.695 ms                  | 342.065 ms                |
| ProcessBack:UpdateCache   | 9.771 ms                  | 697.875 ms                |
| ProcessBack:UpsertPq      | 42.527 ms                 | 71.986 ms                 |
| ProcessOneStep            | 68.007 ms                 | 1.328 s                   |
| BlockToStepN              | 3.739 ms                  | 767.663 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.227 ms                 | 190.908 ms                |
| Forward                   | 5.999 ms                  | 758.056 ms                |
| Backward                  | 10.327 ms                 | 280.580 ms                |
| Optimize                  | 2.587 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 1.258 ms                  | 215.944 ms                |
| AfterBackward             | 68.045 ms                 | 1.328 s                   |
| BlockToStepN              | 3.788 ms                  | 767.782 ms                |
| OneStep                   | 188.464 ms                | 3.142 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:13.996004  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240205 01:15:14.996011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240205 01:15:15.996011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240205 01:15:16.996011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240205 01:15:18.015527  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=34, pq.top=34
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.374 ms                  | 320.227 ms                |
| ProcessBack:UpdateCache   | 10.026 ms                 | 681.746 ms                |
| ProcessBack:UpsertPq      | 36.375 ms                 | 66.303 ms                 |
| ProcessOneStep            | 64.415 ms                 | 1.328 s                   |
| BlockToStepN              | 3.739 ms                  | 776.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.717 ms                  | 190.908 ms                |
| Forward                   | 5.701 ms                  | 758.056 ms                |
| Backward                  | 8.814 ms                  | 280.580 ms                |
| Optimize                  | 2.473 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 3.595 ms                  | 215.944 ms                |
| AfterBackward             | 64.448 ms                 | 1.328 s                   |
| BlockToStepN              | 3.788 ms                  | 776.144 ms                |
| OneStep                   | 188.464 ms                | 3.142 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:19.015005  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240205 01:15:20.015009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240205 01:15:21.032145  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240205 01:15:22.032009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240205 01:15:23.032008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.515 ms                  | 320.227 ms                |
| ProcessBack:UpdateCache   | 10.464 ms                 | 681.746 ms                |
| ProcessBack:UpsertPq      | 35.807 ms                 | 66.303 ms                 |
| ProcessOneStep            | 64.415 ms                 | 1.328 s                   |
| BlockToStepN              | 3.739 ms                  | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.471 ms                  | 190.908 ms                |
| Forward                   | 5.531 ms                  | 758.056 ms                |
| Backward                  | 6.129 ms                  | 280.580 ms                |
| Optimize                  | 2.648 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.417 ms                  | 215.944 ms                |
| AfterBackward             | 64.448 ms                 | 1.328 s                   |
| BlockToStepN              | 3.788 ms                  | 799.117 ms                |
| OneStep                   | 188.464 ms                | 3.142 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:24.032009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240205 01:15:25.032009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240205 01:15:26.032016  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240205 01:15:27.032009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240205 01:15:28.032011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.584 ms                  | 320.227 ms                |
| ProcessBack:UpdateCache   | 10.584 ms                 | 681.746 ms                |
| ProcessBack:UpsertPq      | 37.077 ms                 | 75.122 ms                 |
| ProcessOneStep            | 65.652 ms                 | 99.515 ms                 |
| BlockToStepN              | 3.739 ms                  | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.110 ms                  | 142.177 ms                |
| Forward                   | 5.588 ms                  | 10.208 ms                 |
| Backward                  | 5.938 ms                  | 12.263 ms                 |
| Optimize                  | 2.602 ms                  | 5.097 ms                  |
| BarrierTimeBeforeRank0    | 4.555 ms                  | 207.763 ms                |
| AfterBackward             | 66.315 ms                 | 99.549 ms                 |
| BlockToStepN              | 3.788 ms                  | 799.117 ms                |
| OneStep                   | 189.775 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:29.032009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240205 01:15:30.032008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240205 01:15:31.032011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240205 01:15:32.032011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240205 01:15:33.032044  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.553 ms                  | 320.227 ms                |
| ProcessBack:UpdateCache   | 10.713 ms                 | 681.746 ms                |
| ProcessBack:UpsertPq      | 41.069 ms                 | 76.633 ms                 |
| ProcessOneStep            | 67.207 ms                 | 99.515 ms                 |
| BlockToStepN              | 3.739 ms                  | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.267 ms                  | 142.177 ms                |
| Forward                   | 5.588 ms                  | 11.263 ms                 |
| Backward                  | 5.929 ms                  | 12.263 ms                 |
| Optimize                  | 2.614 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.555 ms                  | 207.763 ms                |
| AfterBackward             | 67.243 ms                 | 99.549 ms                 |
| BlockToStepN              | 3.788 ms                  | 799.117 ms                |
| OneStep                   | 189.775 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:34.032006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240205 01:15:35.032006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240205 01:15:36.032009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240205 01:15:37.032009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240205 01:15:38.032008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.558 ms                  | 320.227 ms                |
| ProcessBack:UpdateCache   | 10.541 ms                 | 681.746 ms                |
| ProcessBack:UpsertPq      | 37.077 ms                 | 76.633 ms                 |
| ProcessOneStep            | 64.788 ms                 | 99.515 ms                 |
| BlockToStepN              | 3.739 ms                  | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.110 ms                  | 143.103 ms                |
| Forward                   | 5.569 ms                  | 11.263 ms                 |
| Backward                  | 6.129 ms                  | 12.263 ms                 |
| Optimize                  | 2.647 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.417 ms                  | 207.763 ms                |
| AfterBackward             | 64.834 ms                 | 99.549 ms                 |
| BlockToStepN              | 3.788 ms                  | 799.117 ms                |
| OneStep                   | 189.775 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:39.032006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240205 01:15:40.032011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240205 01:15:41.032011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240205 01:15:42.032009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240205 01:15:43.032011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.528 ms                  | 30.036 ms                 |
| ProcessBack:UpdateCache   | 10.047 ms                 | 27.751 ms                 |
| ProcessBack:UpsertPq      | 35.460 ms                 | 75.122 ms                 |
| ProcessOneStep            | 63.539 ms                 | 99.515 ms                 |
| BlockToStepN              | 3.739 ms                  | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.801 ms                  | 143.103 ms                |
| Forward                   | 5.531 ms                  | 11.263 ms                 |
| Backward                  | 7.420 ms                  | 12.263 ms                 |
| Optimize                  | 2.647 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.327 ms                  | 207.763 ms                |
| AfterBackward             | 63.575 ms                 | 99.549 ms                 |
| BlockToStepN              | 3.788 ms                  | 799.117 ms                |
| OneStep                   | 189.775 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:44.032006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240205 01:15:45.032011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240205 01:15:46.032011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240205 01:15:47.060273  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=92, pq.top=92
W20240205 01:15:48.074419  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.489 ms                  | 30.036 ms                 |
| ProcessBack:UpdateCache   | 10.014 ms                 | 27.751 ms                 |
| ProcessBack:UpsertPq      | 34.281 ms                 | 75.122 ms                 |
| ProcessOneStep            | 61.788 ms                 | 99.515 ms                 |
| BlockToStepN              | 3.739 ms                  | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.253 ms                  | 143.103 ms                |
| Forward                   | 5.378 ms                  | 11.263 ms                 |
| Backward                  | 8.814 ms                  | 12.263 ms                 |
| Optimize                  | 2.684 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.327 ms                  | 207.763 ms                |
| AfterBackward             | 61.864 ms                 | 99.549 ms                 |
| BlockToStepN              | 3.788 ms                  | 799.117 ms                |
| OneStep                   | 189.775 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:49.074007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240205 01:15:50.188963  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 53.517, sample: 1.572, forward: 1.202, backward: 1.340, update: 0.264
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 51.745, sample: 1.617, forward: 1.188, backward: 1.246, update: 0.271
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 55.410, sample: 2.135, forward: 1.233, backward: 1.203, update: 0.253
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 54.012, sample: 2.065, forward: 1.205, backward: 1.352, update: 0.273
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 55.062, sample: 2.249, forward: 1.230, backward: 1.255, update: 0.242
train_sampler.Prefill()
-------Step 0-------
tensor([   60461,    60495,    60541,    60570,  6011106,    97214, 62134737,
        15612349, 24327683,    60618]) tensor([ 5294349, 13549833, 52409392, 65892560, 18993507, 35773242, 31521127,
        68957103, 61155752, 25518675])
-------Step 1-------
tensor([   60461,    60495,    60541,    60570,  6011106,    97214, 62134737,
        15612349, 24327683,    60618]) tensor([60287371, 28359228, 10160327, 70744202, 82873184, 49037124, 80159548,
        55756863, 42752540, 11655465])
-------Step 2-------
tensor([  156935,   156998,   157037,    30380,   157083,   157138,   157178,
        28990860,   157208,   157241]) tensor([62343773, 20742529, 82799220, 42581712, 35555906, 32471888, 60549505,
        40753198, 12438788, 48073950])
-------Step 3-------
tensor([  156935,   156998,   157037,    30380,   157083,   157138,   157178,
        28990860,   157208,   157241]) tensor([56015467, 84891906, 30203162, 43268556, 55796630, 72683278, 42292086,
        14493710, 23206410,   762594])
-------Step 4-------
tensor([  253997, 38190166,   254045,   121766,   254086,   121806,   254122,
        45058782,   254166,   254197]) tensor([83364681,  8886297, 74139178, 16902864, 78231701, 49535357, 56284955,
        42452560, 78083895, 59819367])
-------Step 5-------
tensor([  253997, 38190166,   254045,   121766,   254086,   121806,   254122,
        45058782,   254166,   254197]) tensor([40200802, 70819349,   215221, 85117651, 66385552, 46151322, 12972775,
        10806979, 62427472, 33937349])
-------Step 6-------
tensor([  347624,    63792,   347656,   347700,    63824, 64295945,   347734,
          347755,   134037, 41216842]) tensor([12471069, 33024251, 41821445, 82786569, 38498910, 31559486, 28033265,
         7024330, 58788801, 77103350])
-------Step 7-------
tensor([  347624,    63792,   347656,   347700,    63824, 64295945,   347734,
          347755,   134037, 41216842]) tensor([21488187, 59746138, 61929041, 50649454, 82823915, 56817645, 48479553,
        63932545, 30918774, 37803157])
-------Step 8-------
tensor([  444630, 28122388,   444657,   145745,   444695,    80202,   444753,
          444795,   444839,   444883]) tensor([38397461, 28946962, 39030480,  2010978, 56634271, 75757758, 13261298,
        78828551,  1586521, 70996421])
-------Step 9-------
tensor([  444630, 28122388,   444657,   145745,   444695,    80202,   444753,
          444795,   444839,   444883]) tensor([44981259, 42533481, 15619866, 62686274,  9898457, 47157971, 23042394,
        32039035, 76075332, 75961909])
-------Step 10-------
tensor([   69153,   494512,   494527,   157195,   494549,   494564,   494581,
        10339483,   494600,   494618]) tensor([20837010, 45750674, 38524222, 73920842, 29770756, 79810633, 39889382,
        56814730, 46778250,  7986658])
-------Step 11-------
tensor([   69153,   494512,   494527,   157195,   494549,   494564,   494581,
        10339483,   494600,   494618]) tensor([ 1688503,  9517394, 26858723, 16296243, 35686607,  9724333, 78205760,
        72043348,    79214, 38305087])
-------Step 12-------
tensor([  531728,   531738,   531751,   531765,   169676,   109922, 83704077,
          109963,   531779, 80827665]) tensor([16709667, 45239672, 71444591, 61721862,   333155, 33694235, 39536747,
         6978116, 82270549, 67564750])
-------Step 13-------
tensor([  531728,   531738,   531751,   531765,   169676,   109922, 83704077,
          109963,   531779, 80827665]) tensor([66228383, 11406280,  5861103, 24336369, 84073315,   569769, 82500110,
        74016980, 16433879, 68470728])
before start barrier
start train
[proc 0] 100 steps, total: 52.906, sample: 1.941, forward: 1.317, backward: 1.093, update: 0.322
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 55.058, sample: 2.637, forward: 1.265, backward: 0.752, update: 0.242
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 52.878, sample: 2.151, forward: 1.192, backward: 0.786, update: 0.250
W20240205 01:15:51.188006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240205 01:15:52.188006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240205 01:15:53.188005  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.496 ms                  | 34.983 ms                 |
| ProcessBack:UpdateCache   | 9.927 ms                  | 27.751 ms                 |
| ProcessBack:UpsertPq      | 33.785 ms                 | 75.122 ms                 |
| ProcessOneStep            | 59.396 ms                 | 99.515 ms                 |
| BlockToStepN              | 3.739 ms                  | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.962 ms                  | 143.103 ms                |
| Forward                   | 5.344 ms                  | 11.263 ms                 |
| Backward                  | 10.060 ms                 | 16.813 ms                 |
| Optimize                  | 2.686 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.417 ms                  | 207.763 ms                |
| AfterBackward             | 59.431 ms                 | 99.549 ms                 |
| BlockToStepN              | 3.788 ms                  | 799.117 ms                |
| OneStep                   | 189.775 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:54.188007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240205 01:15:55.188007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240205 01:15:56.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240205 01:15:57.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240205 01:15:58.188005  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.489 ms                  | 34.983 ms                 |
| ProcessBack:UpdateCache   | 9.927 ms                  | 27.751 ms                 |
| ProcessBack:UpsertPq      | 33.760 ms                 | 75.122 ms                 |
| ProcessOneStep            | 57.531 ms                 | 99.515 ms                 |
| BlockToStepN              | 12.390 ms                 | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.646 ms                  | 143.103 ms                |
| Forward                   | 5.390 ms                  | 11.263 ms                 |
| Backward                  | 9.260 ms                  | 16.813 ms                 |
| Optimize                  | 2.686 ms                  | 9.678 ms                  |
| BarrierTimeBeforeRank0    | 4.555 ms                  | 207.763 ms                |
| AfterBackward             | 57.570 ms                 | 99.549 ms                 |
| BlockToStepN              | 667.257 ms                | 799.117 ms                |
| OneStep                   | 756.248 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:15:59.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240205 01:16:00.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240205 01:16:01.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240205 01:16:02.188007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240205 01:16:03.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.466 ms                  | 30.036 ms                 |
| ProcessBack:UpdateCache   | 9.927 ms                  | 16.634 ms                 |
| ProcessBack:UpsertPq      | 34.084 ms                 | 75.122 ms                 |
| ProcessOneStep            | 60.752 ms                 | 99.515 ms                 |
| BlockToStepN              | 667.116 ms                | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.275 ms                  | 143.103 ms                |
| Forward                   | 5.399 ms                  | 11.263 ms                 |
| Backward                  | 8.342 ms                  | 16.813 ms                 |
| Optimize                  | 2.699 ms                  | 9.678 ms                  |
| BarrierTimeBeforeRank0    | 4.555 ms                  | 207.763 ms                |
| AfterBackward             | 59.670 ms                 | 99.549 ms                 |
| BlockToStepN              | 72.516 ms                 | 799.117 ms                |
| OneStep                   | 189.775 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:04.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240205 01:16:05.188010  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240205 01:16:06.188051  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240205 01:16:07.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240205 01:16:08.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.489 ms                  | 30.036 ms                 |
| ProcessBack:UpdateCache   | 9.927 ms                  | 16.634 ms                 |
| ProcessBack:UpsertPq      | 33.985 ms                 | 73.957 ms                 |
| ProcessOneStep            | 59.451 ms                 | 99.515 ms                 |
| BlockToStepN              | 109.060 ms                | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.592 ms                  | 143.103 ms                |
| Forward                   | 5.390 ms                  | 16.463 ms                 |
| Backward                  | 8.071 ms                  | 16.813 ms                 |
| Optimize                  | 2.699 ms                  | 9.678 ms                  |
| BarrierTimeBeforeRank0    | 4.418 ms                  | 207.763 ms                |
| AfterBackward             | 59.488 ms                 | 99.549 ms                 |
| BlockToStepN              | 109.176 ms                | 799.117 ms                |
| OneStep                   | 192.250 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:09.188007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240205 01:16:10.188007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240205 01:16:11.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240205 01:16:12.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240205 01:16:13.188009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 30.036 ms                 |
| ProcessBack:UpdateCache   | 9.927 ms                  | 16.634 ms                 |
| ProcessBack:UpsertPq      | 34.208 ms                 | 73.957 ms                 |
| ProcessOneStep            | 58.462 ms                 | 99.515 ms                 |
| BlockToStepN              | 109.060 ms                | 798.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.745 ms                  | 143.103 ms                |
| Forward                   | 5.344 ms                  | 16.463 ms                 |
| Backward                  | 8.003 ms                  | 16.813 ms                 |
| Optimize                  | 2.707 ms                  | 9.678 ms                  |
| BarrierTimeBeforeRank0    | 4.581 ms                  | 207.763 ms                |
| AfterBackward             | 58.493 ms                 | 99.549 ms                 |
| BlockToStepN              | 109.176 ms                | 799.117 ms                |
| OneStep                   | 192.250 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:14.278138  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240205 01:16:15.278007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240205 01:16:16.278007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240205 01:16:17.278007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240205 01:16:18.278007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.428 ms                  | 30.036 ms                 |
| ProcessBack:UpdateCache   | 9.866 ms                  | 16.634 ms                 |
| ProcessBack:UpsertPq      | 33.973 ms                 | 73.957 ms                 |
| ProcessOneStep            | 56.939 ms                 | 98.667 ms                 |
| BlockToStepN              | 109.060 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.740 ms                  | 142.177 ms                |
| Forward                   | 5.334 ms                  | 11.403 ms                 |
| Backward                  | 7.888 ms                  | 14.110 ms                 |
| Optimize                  | 2.741 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.555 ms                  | 156.927 ms                |
| AfterBackward             | 56.990 ms                 | 98.718 ms                 |
| BlockToStepN              | 109.176 ms                | 796.829 ms                |
| OneStep                   | 192.250 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:19.278007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240205 01:16:20.278007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240205 01:16:21.278007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240205 01:16:22.465092  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240205 01:16:23.465008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.428 ms                  | 30.036 ms                 |
| ProcessBack:UpdateCache   | 9.798 ms                  | 16.634 ms                 |
| ProcessBack:UpsertPq      | 33.760 ms                 | 73.957 ms                 |
| ProcessOneStep            | 56.606 ms                 | 98.667 ms                 |
| BlockToStepN              | 111.448 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.745 ms                  | 142.177 ms                |
| Forward                   | 5.322 ms                  | 11.403 ms                 |
| Backward                  | 8.072 ms                  | 14.110 ms                 |
| Optimize                  | 2.721 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.418 ms                  | 156.927 ms                |
| AfterBackward             | 56.659 ms                 | 98.718 ms                 |
| BlockToStepN              | 111.501 ms                | 796.829 ms                |
| OneStep                   | 192.250 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:24.465008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240205 01:16:25.465006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240205 01:16:26.502776  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240205 01:16:27.528523  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240205 01:16:28.575817  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.428 ms                  | 30.036 ms                 |
| ProcessBack:UpdateCache   | 9.771 ms                  | 16.634 ms                 |
| ProcessBack:UpsertPq      | 33.458 ms                 | 73.957 ms                 |
| ProcessOneStep            | 56.075 ms                 | 98.667 ms                 |
| BlockToStepN              | 123.850 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.744 ms                  | 142.177 ms                |
| Forward                   | 5.288 ms                  | 11.403 ms                 |
| Backward                  | 8.500 ms                  | 14.110 ms                 |
| Optimize                  | 2.721 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.327 ms                  | 156.927 ms                |
| AfterBackward             | 56.130 ms                 | 98.718 ms                 |
| BlockToStepN              | 123.900 ms                | 796.829 ms                |
| OneStep                   | 214.765 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:29.631115  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240205 01:16:30.870775  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240205 01:16:31.870007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240205 01:16:32.870007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.428 ms                  | 26.521 ms                 |
| ProcessBack:UpdateCache   | 9.774 ms                  | 16.438 ms                 |
| ProcessBack:UpsertPq      | 33.280 ms                 | 73.373 ms                 |
| ProcessOneStep            | 55.978 ms                 | 98.667 ms                 |
| BlockToStepN              | 667.116 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.745 ms                  | 142.177 ms                |
| Forward                   | 5.295 ms                  | 11.403 ms                 |
| Backward                  | 8.975 ms                  | 14.110 ms                 |
| Optimize                  | 2.716 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.555 ms                  | 156.927 ms                |
| AfterBackward             | 56.011 ms                 | 98.718 ms                 |
| BlockToStepN              | 667.257 ms                | 796.829 ms                |
| OneStep                   | 756.248 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:33.895715  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240205 01:16:34.955803  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240205 01:16:36.028788  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240205 01:16:37.028007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240205 01:16:38.028007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=192, pq.top=192
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.428 ms                  | 26.521 ms                 |
| ProcessBack:UpdateCache   | 9.762 ms                  | 16.438 ms                 |
| ProcessBack:UpsertPq      | 33.577 ms                 | 73.373 ms                 |
| ProcessOneStep            | 56.563 ms                 | 98.667 ms                 |
| BlockToStepN              | 129.637 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.745 ms                  | 142.177 ms                |
| Forward                   | 5.312 ms                  | 16.463 ms                 |
| Backward                  | 10.021 ms                 | 15.088 ms                 |
| Optimize                  | 2.722 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.418 ms                  | 156.927 ms                |
| AfterBackward             | 56.621 ms                 | 98.718 ms                 |
| BlockToStepN              | 129.716 ms                | 796.829 ms                |
| OneStep                   | 226.751 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:39.067734  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240205 01:16:40.067010  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240205 01:16:41.067010  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240205 01:16:42.067011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 1] 200 steps, total: 51.330, sample: 2.301, forward: 0.512, backward: 0.857, update: 0.252
[proc 2] 200 steps, total: 51.330, sample: 2.141, forward: 0.544, backward: 0.974, update: 0.256
[proc 6] 200 steps, total: 51.330, sample: 1.355, forward: 0.521, backward: 1.069, update: 0.284
[proc 7] 200 steps, total: 51.330, sample: 1.769, forward: 0.534, backward: 0.584, update: 0.246
[proc 3] 200 steps, total: 51.330, sample: 1.296, forward: 0.521, backward: 1.083, update: 0.289
[proc 4] 200 steps, total: 51.330, sample: 2.137, forward: 0.603, backward: 0.951, update: 0.253
[proc 0] 200 steps, total: 51.330, sample: 1.491, forward: 0.567, backward: 0.919, update: 0.349
[proc 5] 200 steps, total: 51.330, sample: 1.934, forward: 0.561, backward: 0.771, update: 0.251
W20240205 01:16:43.067014  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.428 ms                  | 26.521 ms                 |
| ProcessBack:UpdateCache   | 9.613 ms                  | 16.438 ms                 |
| ProcessBack:UpsertPq      | 33.607 ms                 | 73.373 ms                 |
| ProcessOneStep            | 56.606 ms                 | 98.667 ms                 |
| BlockToStepN              | 129.637 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.963 ms                  | 142.177 ms                |
| Forward                   | 5.296 ms                  | 17.553 ms                 |
| Backward                  | 10.129 ms                 | 15.088 ms                 |
| Optimize                  | 2.721 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.327 ms                  | 156.927 ms                |
| AfterBackward             | 56.659 ms                 | 98.718 ms                 |
| BlockToStepN              | 129.716 ms                | 796.829 ms                |
| OneStep                   | 226.751 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:44.067013  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240205 01:16:45.067010  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240205 01:16:46.067009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240205 01:16:47.067009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240205 01:16:48.085497  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.466 ms                  | 26.521 ms                 |
| ProcessBack:UpdateCache   | 9.573 ms                  | 16.438 ms                 |
| ProcessBack:UpsertPq      | 33.760 ms                 | 73.373 ms                 |
| ProcessOneStep            | 56.808 ms                 | 98.667 ms                 |
| BlockToStepN              | 153.066 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.141 ms                  | 142.177 ms                |
| Forward                   | 5.296 ms                  | 17.553 ms                 |
| Backward                  | 10.155 ms                 | 15.088 ms                 |
| Optimize                  | 2.716 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.129 ms                  | 156.927 ms                |
| AfterBackward             | 56.845 ms                 | 98.718 ms                 |
| BlockToStepN              | 153.160 ms                | 796.829 ms                |
| OneStep                   | 233.990 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:49.108464  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240205 01:16:50.142175  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240205 01:16:51.142007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=216, pq.top=216
W20240205 01:16:52.142006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
W20240205 01:16:53.203073  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.489 ms                  | 26.521 ms                 |
| ProcessBack:UpdateCache   | 9.573 ms                  | 16.438 ms                 |
| ProcessBack:UpsertPq      | 33.952 ms                 | 73.373 ms                 |
| ProcessOneStep            | 56.843 ms                 | 98.667 ms                 |
| BlockToStepN              | 158.492 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.313 ms                  | 142.177 ms                |
| Forward                   | 5.295 ms                  | 17.553 ms                 |
| Backward                  | 10.215 ms                 | 15.088 ms                 |
| Optimize                  | 2.707 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.129 ms                  | 156.927 ms                |
| AfterBackward             | 56.887 ms                 | 98.718 ms                 |
| BlockToStepN              | 158.545 ms                | 796.829 ms                |
| OneStep                   | 252.817 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:54.203006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240205 01:16:55.203009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240205 01:16:56.203011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240205 01:16:57.203008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240205 01:16:58.203008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.466 ms                  | 24.569 ms                 |
| ProcessBack:UpdateCache   | 9.572 ms                  | 14.871 ms                 |
| ProcessBack:UpsertPq      | 33.879 ms                 | 71.986 ms                 |
| ProcessOneStep            | 56.618 ms                 | 98.667 ms                 |
| BlockToStepN              | 667.116 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.388 ms                  | 142.177 ms                |
| Forward                   | 5.296 ms                  | 17.553 ms                 |
| Backward                  | 10.226 ms                 | 15.088 ms                 |
| Optimize                  | 2.704 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 3.847 ms                  | 156.927 ms                |
| AfterBackward             | 56.659 ms                 | 98.718 ms                 |
| BlockToStepN              | 158.545 ms                | 796.829 ms                |
| OneStep                   | 252.817 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:16:59.203008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240205 01:17:00.203009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240205 01:17:01.203008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240205 01:17:02.203008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240205 01:17:03.203007  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.489 ms                  | 24.569 ms                 |
| ProcessBack:UpdateCache   | 9.515 ms                  | 14.871 ms                 |
| ProcessBack:UpsertPq      | 33.879 ms                 | 71.986 ms                 |
| ProcessOneStep            | 56.606 ms                 | 98.667 ms                 |
| BlockToStepN              | 158.492 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.472 ms                  | 142.177 ms                |
| Forward                   | 5.312 ms                  | 17.553 ms                 |
| Backward                  | 10.238 ms                 | 15.088 ms                 |
| Optimize                  | 2.707 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 3.521 ms                  | 156.927 ms                |
| AfterBackward             | 56.647 ms                 | 98.718 ms                 |
| BlockToStepN              | 158.545 ms                | 796.829 ms                |
| OneStep                   | 257.832 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:17:04.258455  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240205 01:17:05.258008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240205 01:17:06.258011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240205 01:17:07.258011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240205 01:17:08.258009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.489 ms                  | 24.569 ms                 |
| ProcessBack:UpdateCache   | 9.505 ms                  | 14.871 ms                 |
| ProcessBack:UpsertPq      | 33.876 ms                 | 71.986 ms                 |
| ProcessOneStep            | 56.563 ms                 | 98.667 ms                 |
| BlockToStepN              | 163.174 ms                | 796.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.475 ms                  | 142.177 ms                |
| Forward                   | 5.326 ms                  | 17.553 ms                 |
| Backward                  | 10.227 ms                 | 15.088 ms                 |
| Optimize                  | 2.707 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 3.595 ms                  | 156.927 ms                |
| AfterBackward             | 56.647 ms                 | 98.718 ms                 |
| BlockToStepN              | 163.265 ms                | 796.829 ms                |
| OneStep                   | 257.832 ms                | 1.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:17:09.258009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240205 01:17:10.258009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240205 01:17:11.258008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240205 01:17:12.258008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240205 01:17:13.258008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.515 ms                  | 24.569 ms                 |
| ProcessBack:UpdateCache   | 9.530 ms                  | 14.871 ms                 |
| ProcessBack:UpsertPq      | 33.879 ms                 | 71.986 ms                 |
| ProcessOneStep            | 56.805 ms                 | 98.528 ms                 |
| BlockToStepN              | 167.209 ms                | 792.240 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.475 ms                  | 140.048 ms                |
| Forward                   | 5.326 ms                  | 16.463 ms                 |
| Backward                  | 10.215 ms                 | 14.190 ms                 |
| Optimize                  | 2.699 ms                  | 8.353 ms                  |
| BarrierTimeBeforeRank0    | 3.847 ms                  | 133.942 ms                |
| AfterBackward             | 56.838 ms                 | 98.578 ms                 |
| BlockToStepN              | 167.289 ms                | 792.356 ms                |
| OneStep                   | 260.094 ms                | 1.092 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:17:14.258008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240205 01:17:15.258009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240205 01:17:16.258011  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240205 01:17:17.258010  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240205 01:17:18.258010  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.506 ms                  | 24.569 ms                 |
| ProcessBack:UpdateCache   | 9.597 ms                  | 14.871 ms                 |
| ProcessBack:UpsertPq      | 33.973 ms                 | 73.373 ms                 |
| ProcessOneStep            | 56.939 ms                 | 98.528 ms                 |
| BlockToStepN              | 667.116 ms                | 792.240 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.476 ms                  | 140.048 ms                |
| Forward                   | 5.322 ms                  | 16.463 ms                 |
| Backward                  | 10.189 ms                 | 14.190 ms                 |
| Optimize                  | 2.701 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.003 ms                  | 133.942 ms                |
| AfterBackward             | 56.990 ms                 | 98.578 ms                 |
| BlockToStepN              | 667.257 ms                | 792.356 ms                |
| OneStep                   | 756.248 ms                | 1.092 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:17:19.258008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240205 01:17:20.258008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240205 01:17:21.330119  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240205 01:17:22.330008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240205 01:17:23.330006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.515 ms                  | 24.569 ms                 |
| ProcessBack:UpdateCache   | 9.645 ms                  | 14.871 ms                 |
| ProcessBack:UpsertPq      | 34.084 ms                 | 73.373 ms                 |
| ProcessOneStep            | 57.336 ms                 | 98.528 ms                 |
| BlockToStepN              | 192.237 ms                | 792.240 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.552 ms                  | 140.048 ms                |
| Forward                   | 5.326 ms                  | 16.463 ms                 |
| Backward                  | 10.155 ms                 | 14.190 ms                 |
| Optimize                  | 2.701 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 4.023 ms                  | 133.942 ms                |
| AfterBackward             | 57.383 ms                 | 98.578 ms                 |
| BlockToStepN              | 192.301 ms                | 792.356 ms                |
| OneStep                   | 281.146 ms                | 1.092 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:17:24.330024  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240205 01:17:25.330010  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240205 01:17:26.330009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240205 01:17:27.330009  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240205 01:17:28.330008  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.527 ms                  | 18.314 ms                 |
| ProcessBack:UpdateCache   | 9.613 ms                  | 14.266 ms                 |
| ProcessBack:UpsertPq      | 34.145 ms                 | 71.986 ms                 |
| ProcessOneStep            | 57.531 ms                 | 98.528 ms                 |
| BlockToStepN              | 200.268 ms                | 792.240 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.607 ms                  | 140.048 ms                |
| Forward                   | 5.326 ms                  | 16.463 ms                 |
| Backward                  | 10.123 ms                 | 14.190 ms                 |
| Optimize                  | 2.704 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 3.663 ms                  | 133.942 ms                |
| AfterBackward             | 57.570 ms                 | 98.578 ms                 |
| BlockToStepN              | 200.388 ms                | 792.356 ms                |
| OneStep                   | 320.306 ms                | 1.092 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 01:17:29.445622  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240205 01:17:30.445006  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240205 01:17:31.454934  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=288, pq.top=288
W20240205 01:17:32.454010  5070 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
Successfully xmh. training takes 154.62892246246338 seconds
before call kg_cache_controller.StopThreads()
W20240205 01:17:32.800938  5070 grad_async_v1.h:243] call StopThreads. PID = 42835
W20240205 01:17:32.800971  5070 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 01:17:32.805546  5070 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 01:17:32.805557  5070 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240205 01:17:32.816859  5070 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.527 ms                  | 18.314 ms                 |
| ProcessBack:UpdateCache   | 9.656 ms                  | 14.266 ms                 |
| ProcessBack:UpsertPq      | 34.224 ms                 | 71.986 ms                 |
| ProcessOneStep            | 57.809 ms                 | 98.528 ms                 |
| BlockToStepN              | 200.268 ms                | 792.240 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.731 ms                  | 140.048 ms                |
| Forward                   | 5.322 ms                  | 16.463 ms                 |
| Backward                  | 10.081 ms                 | 14.190 ms                 |
| Optimize                  | 2.689 ms                  | 9.549 ms                  |
| BarrierTimeBeforeRank0    | 3.847 ms                  | 133.942 ms                |
| AfterBackward             | 57.852 ms                 | 98.578 ms                 |
| BlockToStepN              | 200.388 ms                | 792.356 ms                |
| OneStep                   | 320.306 ms                | 1.092 s                   |
+---------------------------+---------------------------+---------------------------+
