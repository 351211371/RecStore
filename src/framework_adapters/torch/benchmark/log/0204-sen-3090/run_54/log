WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 13:21:38.914332 29021 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_114', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=4, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [29021 sampler.py:454] Start PreSampling
WARNING [29021 sampler.py:532] Before construct renumbering_dict
WARNING [29021 sampler.py:555] PreSampling done
W20240205 13:42:05.461495 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 13:42:05.461684 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 13:42:05.461724 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 13:42:05.461759 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 13:42:05.461797 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 13:42:05.461836 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 13:42:05.461875 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 13:42:05.461920 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 13:42:05.461957 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 13:42:05.461987 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 13:42:05.462021 29021 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 13:42:05.462054 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 13:42:05.462085 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 13:42:05.462242 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 13:42:05.462278 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 13:42:05.462311 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 13:42:05.462356 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 13:42:05.462389 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 13:42:05.462415 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 13:42:05.462440 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 13:42:05.462468 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 13:42:05.462495 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 13:42:05.462530 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 13:42:05.462563 29021 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 13:42:05.462585 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 13:42:05.462607 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 13:42:05.462666 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 13:42:05.462694 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 13:42:05.462720 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 13:42:05.462745 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 13:42:05.462772 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 13:42:05.462805 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 13:42:05.462834 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 13:42:05.462860 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 13:42:05.462889 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 13:42:05.462920 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 13:42:05.462947 29021 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 13:42:05.462970 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 13:42:05.462991 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 13:42:05.463052 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 13:42:05.463083 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 13:42:05.463110 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 13:42:05.463135 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 13:42:05.463163 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 13:42:05.463196 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 13:42:05.463225 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 13:42:05.463256 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 13:42:05.463285 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 13:42:05.463311 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 13:42:05.463339 29021 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 13:42:05.463361 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 13:42:05.463383 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 13:42:05.463436 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 13:42:05.463470 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 13:42:05.463498 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 13:42:05.463524 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 13:42:05.463552 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 13:42:05.463578 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 13:42:05.463606 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 13:42:05.463634 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 13:42:05.463660 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 13:42:05.463699 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 13:42:05.463732 29021 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 13:42:05.463753 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 13:42:05.463775 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 13:42:05.463824 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 13:42:05.463860 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 13:42:05.463891 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 13:42:05.463922 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 13:42:05.463953 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 13:42:05.463986 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 13:42:05.464013 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 13:42:05.464042 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 13:42:05.464108 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 13:42:05.464145 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 13:42:05.464174 29021 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 13:42:05.464198 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 13:42:05.464222 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 13:42:05.464274 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 13:42:05.464306 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 13:42:05.464336 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 13:42:05.464371 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 13:42:05.464401 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 13:42:05.464437 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 13:42:05.464468 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 13:42:05.464509 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 13:42:05.464545 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 13:42:05.464586 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 13:42:05.464620 29021 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 13:42:05.464644 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 13:42:05.464672 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 13:42:05.464725 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 13:42:05.464758 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 13:42:05.464787 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 13:42:05.464815 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 13:42:05.464850 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 13:42:05.464883 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 13:42:05.464919 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 13:42:05.464955 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 13:42:05.464995 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 13:42:05.465029 29021 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 13:42:05.465057 29021 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 13:42:05.465081 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 13:42:05.465106 29021 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 13:42:05.903079 29021 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 13:50:40.015813 29021 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302704,  4302745,   109713,  ..., 51164565, 65294571,  4890732]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2247.242 seconds
[Rank1] pid = 55960
[Rank2] pid = 56151
[Rank3] pid = 56315
[Rank4] pid = 56519
[Rank5] pid = 56658
[Rank6] pid = 56820
INFO [29021 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [55960 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [56151 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [56820 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [56315 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [56658 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [56519 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [56658 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56519 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57025 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [56820 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56315 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56151 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57025 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29021 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55960 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 13:59:18.806259 56659 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 13:59:18.809962 57026 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 13:59:18.810779 56821 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 13:59:18.810928 56152 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 13:59:18.810931 56316 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 13:59:18.810926 57089 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 13:59:18.810935 56520 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 13:59:18.810964 55961 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 13:59:18.902698 56316 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1020497b1000 7.629 MB
W20240205 13:59:18.902745 57089 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x102049f54000 7.629 MB
W20240205 13:59:18.902781 56520 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204a6f7000 7.629 MB
W20240205 13:59:18.902784 56659 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204ae9a000 7.629 MB
W20240205 13:59:18.902791 56152 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204b63d000 7.629 MB
W20240205 13:59:18.902882 57026 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204bde0000 7.629 MB
W20240205 13:59:18.902918 56821 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204cd26000 7.629 MB
W20240205 13:59:18.902916 55961 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204c583000 7.629 MB
W20240205 13:59:18.902971 56316 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10204d4c9000 7.629 MB
W20240205 13:59:18.903043 56316 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10204dc6c000 1.49 GB
W20240205 13:59:18.903110 56316 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1020ad24f000 1.49 GB
W20240205 13:59:18.903163 56316 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 13:59:18.903210 57026 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10210c832000 7.629 MB
W20240205 13:59:18.903227 56821 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10210cfd5000 7.629 MB
W20240205 13:59:18.903234 55961 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210d778000 7.629 MB
W20240205 13:59:18.903290 57026 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210df1b000 1.49 GB
W20240205 13:59:18.903329 56152 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10216d4fe000 7.629 MB
W20240205 13:59:18.903335 56659 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10216dca1000 7.629 MB
W20240205 13:59:18.903350 56520 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10216e444000 7.629 MB
W20240205 13:59:18.903354 57089 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10216ebe7000 7.629 MB
W20240205 13:59:18.903421 56520 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10216f38a000 1.49 GB
W20240205 13:59:18.903429 57089 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1021ce96d000 1.49 GB
W20240205 13:59:18.903435 56659 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10222df50000 1.49 GB
W20240205 13:59:18.903501 56659 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10228d533000 1.49 GB
W20240205 13:59:18.904800 56659 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 13:59:18.904808 57089 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1022ecb16000 1.49 GB
W20240205 13:59:18.904816 56520 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10234c0f9000 1.49 GB
W20240205 13:59:18.904844 55961 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1023ab6dc000 1.49 GB
W20240205 13:59:18.904875 57089 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 13:59:18.904948 56152 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10240acbf000 1.49 GB
W20240205 13:59:18.906388 57026 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10246a2a2000 1.49 GB
W20240205 13:59:18.906407 56520 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 13:59:18.906414 56152 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1024c9885000 1.49 GB
W20240205 13:59:18.906420 55961 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x102528e68000 1.49 GB
W20240205 13:59:18.906438 57026 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 13:59:18.906463 56152 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 13:59:18.906476 55961 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 13:59:18.906489 56821 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10258844b000 1.49 GB
W20240205 13:59:18.906553 56821 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240205 13:59:18.906589 56821 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 13:59:18.910180 56316 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 13:59:18.916779 56659 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 13:59:18.916961 55961 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 13:59:18.916987 57089 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 13:59:18.916996 57026 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 13:59:18.917006 56520 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 13:59:18.917021 56152 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 13:59:18.930508 56821 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [56315 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [55960 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [56519 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [56820 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [56151 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 57025
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [29021 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [57025 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [56658 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 14:00:08.835148 56659 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 14:00:08.835367 57089 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 14:00:08.835599 56520 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 14:00:08.835675 57026 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 14:00:08.835721 55961 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 14:00:08.835798 56152 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 14:00:08.835865 56821 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 14:00:08.835928 56316 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 14:00:08.838860 57026 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 4,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 14:00:08.839080 57026 grad_base.h:184] Init GradProcessingBase done
I20240205 14:00:21.413375 57026 grad_async_v1.h:203] Use main thread to update emb.
W20240205 14:00:21.413630 57026 kg_controller.h:75] after init GradAsyncProcessing
I20240205 14:00:21.413640 57026 kg_controller.h:84] Construct KGCacheController done
E20240205 14:00:23.128708 56316 recstore.cc:66] init folly done
E20240205 14:00:23.128741 56520 recstore.cc:66] init folly done
E20240205 14:00:23.128743 56821 recstore.cc:66] init folly done
E20240205 14:00:23.128743 56659 recstore.cc:66] init folly done
E20240205 14:00:23.128907 57026 recstore.cc:66] init folly done
E20240205 14:00:23.129215 55961 recstore.cc:66] init folly done
E20240205 14:00:23.129225 57089 recstore.cc:66] init folly done
E20240205 14:00:23.129226 56152 recstore.cc:66] init folly done
I20240205 14:00:23.130143 57026 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 14:00:44.304155 56659 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 14:00:44.448911 57089 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 14:00:44.711814 56520 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 14:00:45.792910 56152 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 14:00:46.787511 55961 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 14:00:46.853587 56316 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 14:00:47.019321 57026 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 14:00:47.970361 56821 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.591 ms                 | 15.591 ms                 |
| Forward                   | 725.614 ms                | 725.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:00:50.246071 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240205 14:00:51.246006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240205 14:00:52.264232 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.313 ms                  | 270.630 ms                |
| ProcessBack:UpdateCache   | 11.014 ms                 | 756.736 ms                |
| ProcessBack:UpsertPq      | 36.708 ms                 | 67.552 ms                 |
| ProcessOneStep            | 69.135 ms                 | 1.329 s                   |
| BlockToStepN              | 5.422 ms                  | 806.755 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:00:53.587630 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.539 ms                  | 107.631 ms                |
| Forward                   | 5.379 ms                  | 725.614 ms                |
| Backward                  | 10.656 ms                 | 191.881 ms                |
| Optimize                  | 4.802 ms                  | 5.376 ms                  |
| BarrierTimeBeforeRank0    | 10.601 ms                 | 268.998 ms                |
| AfterBackward             | 69.192 ms                 | 1.329 s                   |
| BlockToStepN              | 5.471 ms                  | 808.759 ms                |
| OneStep                   | 120.775 ms                | 3.085 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:00:54.669747 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240205 14:00:55.669015 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240205 14:00:56.683297 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240205 14:00:57.683007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.373 ms                  | 270.630 ms                |
| ProcessBack:UpdateCache   | 10.885 ms                 | 756.736 ms                |
| ProcessBack:UpsertPq      | 36.708 ms                 | 67.552 ms                 |
| ProcessOneStep            | 62.200 ms                 | 1.329 s                   |
| BlockToStepN              | 8.211 ms                  | 806.755 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:00:58.683008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.542 ms                 | 107.631 ms                |
| Forward                   | 5.084 ms                  | 725.614 ms                |
| Backward                  | 10.622 ms                 | 191.881 ms                |
| Optimize                  | 2.739 ms                  | 5.610 ms                  |
| BarrierTimeBeforeRank0    | 3.889 ms                  | 268.998 ms                |
| AfterBackward             | 62.187 ms                 | 1.329 s                   |
| BlockToStepN              | 8.266 ms                  | 808.759 ms                |
| OneStep                   | 205.887 ms                | 3.085 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:00:59.683008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240205 14:01:00.683010 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240205 14:01:01.785669 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240205 14:01:02.802233 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.313 ms                  | 270.630 ms                |
| ProcessBack:UpdateCache   | 10.021 ms                 | 756.736 ms                |
| ProcessBack:UpsertPq      | 34.211 ms                 | 67.552 ms                 |
| ProcessOneStep            | 56.010 ms                 | 1.329 s                   |
| BlockToStepN              | 10.805 ms                 | 806.755 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:03.802008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.143 ms                 | 351.146 ms                |
| Forward                   | 5.084 ms                  | 725.614 ms                |
| Backward                  | 9.938 ms                  | 191.881 ms                |
| Optimize                  | 3.350 ms                  | 5.610 ms                  |
| BarrierTimeBeforeRank0    | 2.673 ms                  | 268.998 ms                |
| AfterBackward             | 54.295 ms                 | 1.329 s                   |
| BlockToStepN              | 10.859 ms                 | 808.759 ms                |
| OneStep                   | 205.887 ms                | 3.085 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:04.802008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240205 14:01:05.802009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240205 14:01:06.802009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240205 14:01:07.802008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.313 ms                  | 238.556 ms                |
| ProcessBack:UpdateCache   | 10.021 ms                 | 755.933 ms                |
| ProcessBack:UpsertPq      | 32.077 ms                 | 55.756 ms                 |
| ProcessOneStep            | 53.920 ms                 | 1.329 s                   |
| BlockToStepN              | 11.409 ms                 | 806.755 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:08.802009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.846 ms                 | 351.146 ms                |
| Forward                   | 5.229 ms                  | 725.614 ms                |
| Backward                  | 9.831 ms                  | 191.881 ms                |
| Optimize                  | 3.315 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 1.539 ms                  | 268.998 ms                |
| AfterBackward             | 53.900 ms                 | 1.329 s                   |
| BlockToStepN              | 11.480 ms                 | 808.759 ms                |
| OneStep                   | 205.887 ms                | 3.085 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:09.950922 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240205 14:01:10.977813 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240205 14:01:11.977008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240205 14:01:12.977010 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.319 ms                  | 238.556 ms                |
| ProcessBack:UpdateCache   | 9.982 ms                  | 755.933 ms                |
| ProcessBack:UpsertPq      | 31.389 ms                 | 67.552 ms                 |
| ProcessOneStep            | 53.858 ms                 | 1.329 s                   |
| BlockToStepN              | 11.409 ms                 | 806.755 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.229 ms                 | 351.146 ms                |
| Forward                   | 5.197 ms                  | 725.614 ms                |
| Backward                  | 9.822 ms                  | 191.881 ms                |
| Optimize                  | 2.908 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 1.676 ms                  | 268.998 ms                |
| AfterBackward             | 53.830 ms                 | 1.329 s                   |
| BlockToStepN              | 11.480 ms                 | 808.759 ms                |
| OneStep                   | 205.887 ms                | 3.085 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:13.977007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240205 14:01:14.977007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240205 14:01:16.001766 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240205 14:01:17.001008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.319 ms                  | 238.556 ms                |
| ProcessBack:UpdateCache   | 10.021 ms                 | 755.933 ms                |
| ProcessBack:UpsertPq      | 31.804 ms                 | 70.066 ms                 |
| ProcessOneStep            | 53.991 ms                 | 90.507 ms                 |
| BlockToStepN              | 11.409 ms                 | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:18.216382 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.970 ms                  | 339.575 ms                |
| Forward                   | 5.182 ms                  | 8.730 ms                  |
| Backward                  | 9.902 ms                  | 30.739 ms                 |
| Optimize                  | 3.036 ms                  | 5.745 ms                  |
| BarrierTimeBeforeRank0    | 2.703 ms                  | 61.438 ms                 |
| AfterBackward             | 54.295 ms                 | 90.540 ms                 |
| BlockToStepN              | 11.480 ms                 | 797.795 ms                |
| OneStep                   | 205.887 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:19.216006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240205 14:01:20.216006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240205 14:01:21.217939 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240205 14:01:22.217007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.373 ms                  | 238.556 ms                |
| ProcessBack:UpdateCache   | 9.829 ms                  | 755.933 ms                |
| ProcessBack:UpsertPq      | 32.077 ms                 | 70.066 ms                 |
| ProcessOneStep            | 54.281 ms                 | 90.507 ms                 |
| BlockToStepN              | 11.409 ms                 | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:23.217005 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.229 ms                 | 339.575 ms                |
| Forward                   | 5.227 ms                  | 21.341 ms                 |
| Backward                  | 9.977 ms                  | 30.739 ms                 |
| Optimize                  | 2.910 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 996.750 us                | 61.438 ms                 |
| AfterBackward             | 54.323 ms                 | 90.540 ms                 |
| BlockToStepN              | 11.480 ms                 | 797.795 ms                |
| OneStep                   | 205.887 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:24.217007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240205 14:01:25.217007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240205 14:01:26.259752 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240205 14:01:27.315860 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.319 ms                  | 238.556 ms                |
| ProcessBack:UpdateCache   | 9.901 ms                  | 755.933 ms                |
| ProcessBack:UpsertPq      | 32.347 ms                 | 70.066 ms                 |
| ProcessOneStep            | 54.281 ms                 | 90.507 ms                 |
| BlockToStepN              | 749.048 ms                | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:28.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.327 ms                 | 339.575 ms                |
| Forward                   | 5.197 ms                  | 21.341 ms                 |
| Backward                  | 10.475 ms                 | 30.739 ms                 |
| Optimize                  | 2.817 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 849.111 us                | 70.504 ms                 |
| AfterBackward             | 54.295 ms                 | 90.540 ms                 |
| BlockToStepN              | 11.480 ms                 | 797.795 ms                |
| OneStep                   | 205.887 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:29.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240205 14:01:30.315008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240205 14:01:31.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240205 14:01:32.315008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.319 ms                  | 16.219 ms                 |
| ProcessBack:UpdateCache   | 9.683 ms                  | 12.487 ms                 |
| ProcessBack:UpsertPq      | 31.621 ms                 | 67.552 ms                 |
| ProcessOneStep            | 53.858 ms                 | 90.507 ms                 |
| BlockToStepN              | 11.409 ms                 | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:33.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.041 ms                 | 339.575 ms                |
| Forward                   | 5.182 ms                  | 21.341 ms                 |
| Backward                  | 10.513 ms                 | 30.739 ms                 |
| Optimize                  | 2.739 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 607.469 us                | 70.504 ms                 |
| AfterBackward             | 53.897 ms                 | 90.540 ms                 |
| BlockToStepN              | 749.170 ms                | 797.795 ms                |
| OneStep                   | 845.798 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:34.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240205 14:01:35.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240205 14:01:36.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240205 14:01:37.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.296 ms                  | 16.219 ms                 |
| ProcessBack:UpdateCache   | 9.747 ms                  | 12.487 ms                 |
| ProcessBack:UpsertPq      | 31.498 ms                 | 67.552 ms                 |
| ProcessOneStep            | 53.609 ms                 | 90.507 ms                 |
| BlockToStepN              | 11.409 ms                 | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:38.315009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.229 ms                 | 339.575 ms                |
| Forward                   | 5.154 ms                  | 21.341 ms                 |
| Backward                  | 10.475 ms                 | 30.739 ms                 |
| Optimize                  | 2.773 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 1.539 ms                  | 70.504 ms                 |
| AfterBackward             | 53.641 ms                 | 90.540 ms                 |
| BlockToStepN              | 11.480 ms                 | 797.795 ms                |
| OneStep                   | 205.887 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:39.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240205 14:01:40.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 52.911, sample: 1.610, forward: 1.203, backward: 1.210, update: 0.307
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 56.170, sample: 2.679, forward: 1.243, backward: 1.138, update: 0.261
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 56.433, sample: 1.672, forward: 1.182, backward: 1.293, update: 0.279
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 55.089, sample: 1.772, forward: 1.207, backward: 1.135, update: 0.257
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 54.095, sample: 1.588, forward: 1.194, backward: 1.137, update: 0.264
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 54.028, sample: 1.670, forward: 1.250, backward: 1.288, update: 0.275
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 56.578, sample: 1.972, forward: 1.262, backward: 1.159, update: 0.264
train_sampler.Prefill()
-------Step 0-------
tensor([   36328,    36353,    36375,    36395,  6133055,   154279, 66495303,
        21435646, 24931565,    36421]) tensor([ 5366564, 17960952, 52028190, 64340746, 16945001, 38320066, 30853016,
        80866036, 78277836, 34469478])
-------Step 1-------
tensor([   36328,    36353,    36375,    36395,  6133055,   154279, 66495303,
        21435646, 24931565,    36421]) tensor([68599143, 33500998,  9472524, 82816176, 84970780, 50789159, 81254413,
        57344986, 30647560, 15684743])
-------Step 2-------
tensor([   90442,    90463,    90486,    36739,    90506,    90527,    90542,
        28955766,    90564,    90587]) tensor([60682370, 20085916, 71052268, 42412829, 34440442, 33423668, 68886499,
        48493648, 17048228, 49763498])
-------Step 3-------
tensor([   90442,    90463,    90486,    36739,    90506,    90527,    90542,
        28955766,    90564,    90587]) tensor([40607377, 84507288, 29440573, 46288775, 74782959, 53442480, 42172772,
        19741185, 31135330,   801346])
-------Step 4-------
tensor([  145879, 38260928,   145901,   194573,   145919,   194617,   145953,
        48276063,   145972,   145992]) tensor([82881907, 11440609, 71836811, 15135182, 59183031, 51433554, 71717268,
        45430477, 85527621, 62270161])
-------Step 5-------
tensor([  145879, 38260928,   145901,   194573,   145919,   194617,   145953,
        48276063,   145972,   145992]) tensor([29043324, 66429310,   175663, 85639981, 47834322, 65538985, 17869131,
        10771714, 61152024, 48460386])
-------Step 6-------
tensor([  200712,    76472,   200729,   200755,    76513, 77434501,   200778,
          200802,   214764, 44173940]) tensor([11348174, 32219680, 29540794, 67788867, 27672440, 30889499, 28336222,
         6864982, 57392071, 85131930])
-------Step 7-------
tensor([  200712,    76472,   200729,   200755,    76513, 77434501,   200778,
          200802,   214764, 44173940]) tensor([20865666, 43132412, 58963552, 48533108, 83242991, 42287738, 45094108,
        46726270, 30067358, 38635692])
-------Step 8-------
tensor([  254721, 30272541,   254745,   232062,   254766,    95693,   254786,
          254818,   254835,   254860]) tensor([47163822, 20415490, 28083785,  1918709, 40732800, 76824341, 13323274,
        60030246,  1586452, 52572021])
-------Step 9-------
tensor([  254721, 30272541,   254745,   232062,   254766,    95693,   254786,
          254818,   254835,   254860]) tensor([56501283, 29969032, 15662846, 48180991,  8087271, 33923397, 32030612,
        44811989, 71624040, 76929494])
before start barrier
start train
[proc 0] 100 steps, total: 53.862, sample: 2.706, forward: 1.260, backward: 1.166, update: 0.362
W20240205 14:01:41.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240205 14:01:42.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.296 ms                  | 16.219 ms                 |
| ProcessBack:UpdateCache   | 9.829 ms                  | 13.098 ms                 |
| ProcessBack:UpsertPq      | 31.777 ms                 | 67.552 ms                 |
| ProcessOneStep            | 53.920 ms                 | 90.507 ms                 |
| BlockToStepN              | 13.123 ms                 | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:43.315004 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.027 ms                 | 339.575 ms                |
| Forward                   | 5.154 ms                  | 21.341 ms                 |
| Backward                  | 10.467 ms                 | 30.739 ms                 |
| Optimize                  | 2.733 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 1.539 ms                  | 70.504 ms                 |
| AfterBackward             | 54.025 ms                 | 90.540 ms                 |
| BlockToStepN              | 13.169 ms                 | 797.795 ms                |
| OneStep                   | 205.887 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:44.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240205 14:01:45.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240205 14:01:46.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240205 14:01:47.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.313 ms                  | 16.219 ms                 |
| ProcessBack:UpdateCache   | 9.670 ms                  | 13.098 ms                 |
| ProcessBack:UpsertPq      | 31.985 ms                 | 67.552 ms                 |
| ProcessOneStep            | 54.260 ms                 | 90.507 ms                 |
| BlockToStepN              | 13.123 ms                 | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:48.315012 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.027 ms                 | 339.575 ms                |
| Forward                   | 5.135 ms                  | 21.341 ms                 |
| Backward                  | 10.458 ms                 | 30.739 ms                 |
| Optimize                  | 2.732 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 885.413 us                | 70.504 ms                 |
| AfterBackward             | 54.295 ms                 | 90.540 ms                 |
| BlockToStepN              | 745.489 ms                | 797.795 ms                |
| OneStep                   | 845.798 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:49.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240205 14:01:50.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240205 14:01:51.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240205 14:01:52.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.300 ms                  | 16.219 ms                 |
| ProcessBack:UpdateCache   | 9.594 ms                  | 13.098 ms                 |
| ProcessBack:UpsertPq      | 32.126 ms                 | 67.552 ms                 |
| ProcessOneStep            | 54.393 ms                 | 90.507 ms                 |
| BlockToStepN              | 13.123 ms                 | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:53.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.041 ms                 | 339.575 ms                |
| Forward                   | 5.072 ms                  | 21.341 ms                 |
| Backward                  | 10.440 ms                 | 30.739 ms                 |
| Optimize                  | 2.739 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 885.413 us                | 70.504 ms                 |
| AfterBackward             | 54.427 ms                 | 90.540 ms                 |
| BlockToStepN              | 745.489 ms                | 797.795 ms                |
| OneStep                   | 845.798 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:54.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240205 14:01:55.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240205 14:01:56.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240205 14:01:57.315008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.300 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.460 ms                  | 12.487 ms                 |
| ProcessBack:UpsertPq      | 32.093 ms                 | 65.787 ms                 |
| ProcessOneStep            | 54.260 ms                 | 90.507 ms                 |
| BlockToStepN              | 13.123 ms                 | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:58.315004 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.175 ms                 | 339.575 ms                |
| Forward                   | 5.069 ms                  | 21.341 ms                 |
| Backward                  | 10.340 ms                 | 30.739 ms                 |
| Optimize                  | 2.773 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 1.191 ms                  | 70.504 ms                 |
| AfterBackward             | 54.295 ms                 | 90.540 ms                 |
| BlockToStepN              | 745.489 ms                | 797.795 ms                |
| OneStep                   | 845.798 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:01:59.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240205 14:02:00.315008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240205 14:02:01.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240205 14:02:02.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.313 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.458 ms                  | 12.487 ms                 |
| ProcessBack:UpsertPq      | 31.985 ms                 | 65.787 ms                 |
| ProcessOneStep            | 53.996 ms                 | 90.507 ms                 |
| BlockToStepN              | 88.674 ms                 | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:03.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.229 ms                 | 339.575 ms                |
| Forward                   | 5.038 ms                  | 21.341 ms                 |
| Backward                  | 10.166 ms                 | 30.739 ms                 |
| Optimize                  | 2.739 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 885.413 us                | 70.504 ms                 |
| AfterBackward             | 54.028 ms                 | 90.540 ms                 |
| BlockToStepN              | 105.850 ms                | 797.795 ms                |
| OneStep                   | 205.887 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:04.315009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240205 14:02:05.315008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240205 14:02:06.315008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240205 14:02:07.315007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.296 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.452 ms                  | 12.487 ms                 |
| ProcessBack:UpsertPq      | 31.829 ms                 | 65.787 ms                 |
| ProcessOneStep            | 53.858 ms                 | 89.921 ms                 |
| BlockToStepN              | 108.521 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:08.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.175 ms                 | 273.449 ms                |
| Forward                   | 5.028 ms                  | 12.375 ms                 |
| Backward                  | 9.977 ms                  | 16.044 ms                 |
| Optimize                  | 2.733 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 885.413 us                | 64.133 ms                 |
| AfterBackward             | 53.897 ms                 | 89.967 ms                 |
| BlockToStepN              | 108.571 ms                | 796.415 ms                |
| OneStep                   | 205.887 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:09.315008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240205 14:02:10.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240205 14:02:11.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240205 14:02:12.315006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.286 ms                  | 16.219 ms                 |
| ProcessBack:UpdateCache   | 9.458 ms                  | 12.487 ms                 |
| ProcessBack:UpsertPq      | 31.871 ms                 | 65.787 ms                 |
| ProcessOneStep            | 53.866 ms                 | 89.921 ms                 |
| BlockToStepN              | 745.392 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:13.315042 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.004 ms                 | 273.449 ms                |
| Forward                   | 5.010 ms                  | 12.375 ms                 |
| Backward                  | 9.938 ms                  | 30.739 ms                 |
| Optimize                  | 2.733 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 996.750 us                | 64.133 ms                 |
| AfterBackward             | 53.960 ms                 | 89.967 ms                 |
| BlockToStepN              | 109.054 ms                | 796.415 ms                |
| OneStep                   | 205.887 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:14.564205 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240205 14:02:15.564006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240205 14:02:16.564007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240205 14:02:17.661271 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.291 ms                  | 16.219 ms                 |
| ProcessBack:UpdateCache   | 9.481 ms                  | 12.487 ms                 |
| ProcessBack:UpsertPq      | 32.077 ms                 | 70.770 ms                 |
| ProcessOneStep            | 53.996 ms                 | 96.219 ms                 |
| BlockToStepN              | 114.130 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:18.697091 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.004 ms                 | 273.449 ms                |
| Forward                   | 4.975 ms                  | 12.375 ms                 |
| Backward                  | 9.902 ms                  | 30.739 ms                 |
| Optimize                  | 2.733 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 1.263 ms                  | 64.133 ms                 |
| AfterBackward             | 54.226 ms                 | 96.258 ms                 |
| BlockToStepN              | 114.188 ms                | 796.415 ms                |
| OneStep                   | 211.526 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:19.751629 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240205 14:02:20.834448 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240205 14:02:21.901119 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240205 14:02:23.119204 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.296 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.448 ms                  | 12.423 ms                 |
| ProcessBack:UpsertPq      | 32.313 ms                 | 70.066 ms                 |
| ProcessOneStep            | 54.393 ms                 | 96.219 ms                 |
| BlockToStepN              | 124.392 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.027 ms                 | 273.449 ms                |
| Forward                   | 4.975 ms                  | 12.375 ms                 |
| Backward                  | 9.862 ms                  | 30.739 ms                 |
| Optimize                  | 2.708 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 885.413 us                | 64.133 ms                 |
| AfterBackward             | 54.427 ms                 | 96.258 ms                 |
| BlockToStepN              | 124.442 ms                | 796.415 ms                |
| OneStep                   | 216.830 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:24.119006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240205 14:02:25.119006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240205 14:02:26.140159 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240205 14:02:27.215323 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.296 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.430 ms                  | 12.423 ms                 |
| ProcessBack:UpsertPq      | 32.419 ms                 | 70.066 ms                 |
| ProcessOneStep            | 54.396 ms                 | 96.219 ms                 |
| BlockToStepN              | 734.853 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:28.256867 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.041 ms                 | 273.449 ms                |
| Forward                   | 4.939 ms                  | 12.375 ms                 |
| Backward                  | 9.843 ms                  | 30.739 ms                 |
| Optimize                  | 2.703 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 765.874 us                | 64.133 ms                 |
| AfterBackward             | 54.427 ms                 | 96.258 ms                 |
| BlockToStepN              | 127.652 ms                | 796.415 ms                |
| OneStep                   | 216.830 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:29.328742 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240205 14:02:30.382279 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240205 14:02:31.590895 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 6] 200 steps, total: 51.604, sample: 1.345, forward: 0.517, backward: 0.913, update: 0.266
[proc 7] 200 steps, total: 51.604, sample: 1.576, forward: 0.514, backward: 1.042, update: 0.264
[proc 1] 200 steps, total: 51.604, sample: 1.514, forward: 0.505, backward: 1.095, update: 0.262
[proc 3] 200 steps, total: 51.604, sample: 1.522, forward: 0.519, backward: 0.560, update: 0.238
[proc 5] 200 steps, total: 51.603, sample: 1.739, forward: 0.563, backward: 0.980, update: 0.253
[proc 4] 200 steps, total: 51.604, sample: 2.022, forward: 0.524, backward: 0.707, update: 0.239
[proc 2] 200 steps, total: 51.604, sample: 1.532, forward: 0.508, backward: 1.000, update: 0.259
[proc 0] 200 steps, total: 51.603, sample: 2.456, forward: 0.502, backward: 0.986, update: 0.309
W20240205 14:02:32.590006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.296 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.422 ms                  | 12.423 ms                 |
| ProcessBack:UpsertPq      | 32.410 ms                 | 70.066 ms                 |
| ProcessOneStep            | 54.260 ms                 | 96.219 ms                 |
| BlockToStepN              | 128.527 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:33.606298 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.085 ms                 | 273.449 ms                |
| Forward                   | 4.937 ms                  | 12.375 ms                 |
| Backward                  | 9.843 ms                  | 30.739 ms                 |
| Optimize                  | 2.703 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 765.874 us                | 64.133 ms                 |
| AfterBackward             | 54.295 ms                 | 96.258 ms                 |
| BlockToStepN              | 128.598 ms                | 796.415 ms                |
| OneStep                   | 216.830 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:34.666357 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240205 14:02:35.666009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240205 14:02:36.666008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=208, pq.top=208
W20240205 14:02:37.715916 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=210, pq.top=210
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.300 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.409 ms                  | 12.423 ms                 |
| ProcessBack:UpsertPq      | 32.347 ms                 | 70.066 ms                 |
| ProcessOneStep            | 54.281 ms                 | 96.219 ms                 |
| BlockToStepN              | 143.042 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:38.715009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.041 ms                 | 273.449 ms                |
| Forward                   | 4.939 ms                  | 12.375 ms                 |
| Backward                  | 9.846 ms                  | 30.739 ms                 |
| Optimize                  | 2.703 ms                  | 8.761 ms                  |
| BarrierTimeBeforeRank0    | 765.874 us                | 64.133 ms                 |
| AfterBackward             | 54.295 ms                 | 96.258 ms                 |
| BlockToStepN              | 734.983 ms                | 796.415 ms                |
| OneStep                   | 844.999 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:39.715008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240205 14:02:40.715008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240205 14:02:41.715009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240205 14:02:42.715009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.334 ms                  | 16.219 ms                 |
| ProcessBack:UpdateCache   | 9.422 ms                  | 12.423 ms                 |
| ProcessBack:UpsertPq      | 32.347 ms                 | 70.066 ms                 |
| ProcessOneStep            | 54.396 ms                 | 96.219 ms                 |
| BlockToStepN              | 155.978 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:43.715008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.004 ms                 | 273.449 ms                |
| Forward                   | 4.939 ms                  | 12.375 ms                 |
| Backward                  | 9.846 ms                  | 30.739 ms                 |
| Optimize                  | 2.691 ms                  | 8.761 ms                  |
| BarrierTimeBeforeRank0    | 731.351 us                | 64.133 ms                 |
| AfterBackward             | 54.427 ms                 | 96.258 ms                 |
| BlockToStepN              | 156.618 ms                | 797.795 ms                |
| OneStep                   | 238.074 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:44.715008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240205 14:02:45.715008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240205 14:02:46.785187 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240205 14:02:47.888931 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.357 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.430 ms                  | 12.037 ms                 |
| ProcessBack:UpsertPq      | 32.415 ms                 | 67.552 ms                 |
| ProcessOneStep            | 54.494 ms                 | 96.219 ms                 |
| BlockToStepN              | 164.809 ms                | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.708 ms                  | 273.449 ms                |
| Forward                   | 4.933 ms                  | 12.375 ms                 |
| Backward                  | 9.843 ms                  | 30.739 ms                 |
| Optimize                  | 2.680 ms                  | 8.761 ms                  |
| BarrierTimeBeforeRank0    | 702.747 us                | 64.133 ms                 |
| AfterBackward             | 54.531 ms                 | 96.258 ms                 |
| BlockToStepN              | 734.983 ms                | 797.795 ms                |
| OneStep                   | 844.999 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:48.888005 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=230, pq.top=230
W20240205 14:02:49.998860 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240205 14:02:50.998006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=234, pq.top=234
W20240205 14:02:52.063710 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240205 14:02:53.063009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.370 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.422 ms                  | 12.037 ms                 |
| ProcessBack:UpsertPq      | 32.555 ms                 | 67.552 ms                 |
| ProcessOneStep            | 54.851 ms                 | 96.219 ms                 |
| BlockToStepN              | 734.853 ms                | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.708 ms                  | 273.449 ms                |
| Forward                   | 4.933 ms                  | 12.375 ms                 |
| Backward                  | 9.841 ms                  | 30.739 ms                 |
| Optimize                  | 2.680 ms                  | 8.761 ms                  |
| BarrierTimeBeforeRank0    | 690.548 us                | 64.133 ms                 |
| AfterBackward             | 54.920 ms                 | 96.258 ms                 |
| BlockToStepN              | 167.516 ms                | 797.795 ms                |
| OneStep                   | 263.350 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:54.063005 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240205 14:02:55.063009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240205 14:02:56.063021 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240205 14:02:57.063006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.386 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.419 ms                  | 12.037 ms                 |
| ProcessBack:UpsertPq      | 32.657 ms                 | 67.552 ms                 |
| ProcessOneStep            | 54.979 ms                 | 96.219 ms                 |
| BlockToStepN              | 170.072 ms                | 797.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:58.165395 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.988 ms                  | 273.449 ms                |
| Forward                   | 4.937 ms                  | 12.375 ms                 |
| Backward                  | 9.832 ms                  | 30.739 ms                 |
| Optimize                  | 2.673 ms                  | 8.761 ms                  |
| BarrierTimeBeforeRank0    | 607.469 us                | 64.133 ms                 |
| AfterBackward             | 55.039 ms                 | 96.258 ms                 |
| BlockToStepN              | 170.158 ms                | 797.795 ms                |
| OneStep                   | 285.271 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:02:59.182267 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240205 14:03:00.182006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
W20240205 14:03:01.182006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=252, pq.top=252
W20240205 14:03:02.263041 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=254, pq.top=254
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.390 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.395 ms                  | 12.037 ms                 |
| ProcessBack:UpsertPq      | 32.703 ms                 | 67.552 ms                 |
| ProcessOneStep            | 55.123 ms                 | 90.507 ms                 |
| BlockToStepN              | 178.211 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:03:03.263003 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.004 ms                 | 255.438 ms                |
| Forward                   | 4.933 ms                  | 9.980 ms                  |
| Backward                  | 9.822 ms                  | 16.044 ms                 |
| Optimize                  | 2.671 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 436.960 us                | 61.438 ms                 |
| AfterBackward             | 55.208 ms                 | 90.540 ms                 |
| BlockToStepN              | 178.278 ms                | 796.415 ms                |
| OneStep                   | 285.271 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:03:04.263007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240205 14:03:05.263008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240205 14:03:06.263006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240205 14:03:07.263007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.391 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.353 ms                  | 12.037 ms                 |
| ProcessBack:UpsertPq      | 32.796 ms                 | 67.552 ms                 |
| ProcessOneStep            | 55.229 ms                 | 90.507 ms                 |
| BlockToStepN              | 183.550 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:03:08.263005 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.004 ms                 | 255.438 ms                |
| Forward                   | 4.933 ms                  | 9.980 ms                  |
| Backward                  | 9.811 ms                  | 16.044 ms                 |
| Optimize                  | 2.666 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 301.676 us                | 61.438 ms                 |
| AfterBackward             | 55.288 ms                 | 90.540 ms                 |
| BlockToStepN              | 183.646 ms                | 796.415 ms                |
| OneStep                   | 285.271 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:03:09.263007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240205 14:03:10.263006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=268, pq.top=268
W20240205 14:03:11.263006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
W20240205 14:03:12.337953 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.403 ms                  | 16.061 ms                 |
| ProcessBack:UpdateCache   | 9.323 ms                  | 12.037 ms                 |
| ProcessBack:UpsertPq      | 32.710 ms                 | 67.552 ms                 |
| ProcessOneStep            | 55.321 ms                 | 90.507 ms                 |
| BlockToStepN              | 183.550 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:03:13.337004 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.004 ms                 | 255.438 ms                |
| Forward                   | 4.937 ms                  | 9.980 ms                  |
| Backward                  | 9.811 ms                  | 16.044 ms                 |
| Optimize                  | 2.680 ms                  | 8.354 ms                  |
| BarrierTimeBeforeRank0    | 230.999 us                | 61.438 ms                 |
| AfterBackward             | 55.427 ms                 | 90.540 ms                 |
| BlockToStepN              | 192.791 ms                | 796.415 ms                |
| OneStep                   | 286.975 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:03:14.337006 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240205 14:03:15.337009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240205 14:03:16.337008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240205 14:03:17.337007 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.417 ms                  | 15.984 ms                 |
| ProcessBack:UpdateCache   | 9.315 ms                  | 12.023 ms                 |
| ProcessBack:UpsertPq      | 32.796 ms                 | 65.787 ms                 |
| ProcessOneStep            | 55.505 ms                 | 90.507 ms                 |
| BlockToStepN              | 734.853 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:03:18.409231 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.988 ms                  | 255.438 ms                |
| Forward                   | 4.937 ms                  | 9.980 ms                  |
| Backward                  | 9.813 ms                  | 17.876 ms                 |
| Optimize                  | 2.683 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 394.067 us                | 61.438 ms                 |
| AfterBackward             | 55.709 ms                 | 90.540 ms                 |
| BlockToStepN              | 195.173 ms                | 796.415 ms                |
| OneStep                   | 286.975 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 14:03:19.409009 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240205 14:03:20.422775 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240205 14:03:21.422019 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240205 14:03:22.422008 57026 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
Successfully xmh. training takes 155.9456512928009 seconds
before call kg_cache_controller.StopThreads()
W20240205 14:03:22.965108 57026 grad_async_v1.h:243] call StopThreads. PID = 29021
W20240205 14:03:22.965135 57026 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 14:03:22.969480 57026 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 14:03:22.969491 57026 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.441 ms                  | 15.984 ms                 |
| ProcessBack:UpdateCache   | 9.315 ms                  | 12.023 ms                 |
| ProcessBack:UpsertPq      | 32.796 ms                 | 65.787 ms                 |
| ProcessOneStep            | 55.696 ms                 | 90.507 ms                 |
| BlockToStepN              | 209.073 ms                | 796.277 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 14:03:23.178597 57026 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.957 ms                  | 255.438 ms                |
| Forward                   | 4.933 ms                  | 9.980 ms                  |
| Backward                  | 9.831 ms                  | 17.876 ms                 |
| Optimize                  | 2.680 ms                  | 9.612 ms                  |
| BarrierTimeBeforeRank0    | 230.999 us                | 61.438 ms                 |
| AfterBackward             | 55.735 ms                 | 90.540 ms                 |
| BlockToStepN              | 209.214 ms                | 796.415 ms                |
| OneStep                   | 311.319 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
