WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 23:30:15.094923 41816 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_101', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [41816 sampler.py:454] Start PreSampling
WARNING [41816 sampler.py:532] Before construct renumbering_dict
WARNING [41816 sampler.py:555] PreSampling done
W20240204 23:49:37.490020 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 23:49:37.490224 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 23:49:37.490258 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 23:49:37.490298 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 23:49:37.490325 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 23:49:37.490358 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 23:49:37.490393 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 23:49:37.490434 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 23:49:37.490468 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 23:49:37.490509 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 23:49:37.490547 41816 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 23:49:37.490577 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 23:49:37.490613 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 23:49:37.490772 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 23:49:37.490815 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 23:49:37.490845 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 23:49:37.490888 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 23:49:37.490916 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 23:49:37.490948 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 23:49:37.490978 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 23:49:37.491007 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 23:49:37.491046 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 23:49:37.491089 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 23:49:37.491119 41816 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 23:49:37.491143 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 23:49:37.491176 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 23:49:37.491232 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 23:49:37.491271 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 23:49:37.491299 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 23:49:37.491335 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 23:49:37.491372 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 23:49:37.491405 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 23:49:37.491438 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 23:49:37.491480 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 23:49:37.491515 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 23:49:37.491551 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 23:49:37.491580 41816 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 23:49:37.491604 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 23:49:37.491634 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 23:49:37.491695 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 23:49:37.491734 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 23:49:37.491763 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 23:49:37.491791 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 23:49:37.491824 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 23:49:37.491853 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 23:49:37.491886 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 23:49:37.491917 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 23:49:37.491948 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 23:49:37.491976 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 23:49:37.492005 41816 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 23:49:37.492028 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 23:49:37.511130 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 23:49:37.511261 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 23:49:37.511308 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 23:49:37.511340 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 23:49:37.511374 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 23:49:37.511402 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 23:49:37.511435 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 23:49:37.511473 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 23:49:37.511503 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 23:49:37.511536 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 23:49:37.511569 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 23:49:37.511597 41816 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 23:49:37.511622 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 23:49:37.511651 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 23:49:37.511714 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 23:49:37.511746 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 23:49:37.511778 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 23:49:37.511816 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 23:49:37.511849 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 23:49:37.511884 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 23:49:37.511921 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 23:49:37.511956 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 23:49:37.511989 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 23:49:37.512025 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 23:49:37.512068 41816 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 23:49:37.512092 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 23:49:37.512116 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 23:49:37.512172 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 23:49:37.512210 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 23:49:37.512239 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 23:49:37.512280 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 23:49:37.512311 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 23:49:37.512341 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 23:49:37.512369 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 23:49:37.512403 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 23:49:37.512439 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 23:49:37.512476 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 23:49:37.512507 41816 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 23:49:37.512530 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 23:49:37.512558 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 23:49:37.512617 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 23:49:37.512653 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 23:49:37.512692 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 23:49:37.512720 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 23:49:37.512750 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 23:49:37.512779 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 23:49:37.512817 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 23:49:37.512853 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 23:49:37.512887 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 23:49:37.512923 41816 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 23:49:37.512954 41816 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 23:49:37.512979 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 23:49:37.513005 41816 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 23:49:37.933054 41816 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240204 23:58:14.512748 41816 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302714,  4302732,    87566,  ..., 74196621, 68934484,  5212572]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2301.438 seconds
[Rank1] pid = 10059
[Rank2] pid = 10226
[Rank3] pid = 10389
[Rank4] pid = 10591
[Rank5] pid = 10767
[Rank6] pid = 10957
INFO [41816 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [10059 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [10226 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [10389 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [10591 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [10767 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [11147 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [10957 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [11147 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [10767 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [10957 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [10389 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [10226 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [10591 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41816 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [10059 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 00:08:46.757849 11211 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 00:08:46.762960 11148 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 00:08:46.763659 10768 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 00:08:46.763782 10965 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 00:08:46.763804 10593 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 00:08:46.763850 10060 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 00:08:46.764212 10234 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 00:08:46.764211 10390 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 00:08:46.860620 10965 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1020497af000 7.629 MB
W20240205 00:08:46.860685 11211 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x102049f52000 7.629 MB
W20240205 00:08:46.860776 10234 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204a6f5000 7.629 MB
W20240205 00:08:46.860792 11148 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204ae98000 7.629 MB
W20240205 00:08:46.860813 10768 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204b63b000 7.629 MB
W20240205 00:08:46.860817 10593 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204bdde000 7.629 MB
W20240205 00:08:46.860832 10390 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204c581000 7.629 MB
W20240205 00:08:46.860865 10965 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204cd24000 7.629 MB
W20240205 00:08:46.860920 10965 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10204d4c7000 1.49 GB
W20240205 00:08:46.860962 10965 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1020acaaa000 1.49 GB
W20240205 00:08:46.861021 10965 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 00:08:46.861310 10060 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10210c08f000 7.629 MB
W20240205 00:08:46.862800 10768 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10210c832000 7.629 MB
W20240205 00:08:46.862859 10234 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10210cfd5000 7.629 MB
W20240205 00:08:46.862879 11211 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10210d778000 7.629 MB
W20240205 00:08:46.862901 10768 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10210e6be000 1.49 GB
W20240205 00:08:46.862897 10060 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210df1b000 7.629 MB
W20240205 00:08:46.862921 11148 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10216dca1000 7.629 MB
W20240205 00:08:46.862957 10234 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10216e444000 1.49 GB
W20240205 00:08:46.862963 10768 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1021cda27000 1.49 GB
W20240205 00:08:46.862972 11211 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10222d00a000 1.49 GB
W20240205 00:08:46.862977 11148 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10228c5ed000 1.49 GB
W20240205 00:08:46.862998 10593 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1022ebbd0000 7.629 MB
W20240205 00:08:46.863020 11148 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1022ec373000 1.49 GB
W20240205 00:08:46.863031 10390 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10234b956000 7.629 MB
W20240205 00:08:46.863050 11211 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10234c0f9000 1.49 GB
W20240205 00:08:46.863068 10234 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1023ab6dc000 1.49 GB
W20240205 00:08:46.863081 11148 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 00:08:46.863077 10060 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10240acbf000 1.49 GB
W20240205 00:08:46.863096 10593 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10246a2a2000 1.49 GB
W20240205 00:08:46.863119 10768 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 00:08:46.863121 11211 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 00:08:46.863137 10390 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1024c9885000 1.49 GB
W20240205 00:08:46.863143 10593 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x102528e68000 1.49 GB
W20240205 00:08:46.863166 10234 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 00:08:46.863193 10060 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10258844b000 1.49 GB
W20240205 00:08:46.863204 10593 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 00:08:46.863215 10390 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240205 00:08:46.863274 10390 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 00:08:46.863303 10060 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 00:08:46.872489 10965 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 00:08:46.879019 11148 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 00:08:46.879056 10390 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 00:08:46.879076 11211 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 00:08:46.879081 10768 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 00:08:46.879102 10593 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 00:08:46.879132 10234 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 00:08:46.879182 10060 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [10767 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [10226 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [10059 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [10591 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 11147
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [41816 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [10389 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [10957 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [11147 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 00:09:38.675683 11211 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 00:09:38.676237 10965 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 00:09:38.676270 10390 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 00:09:38.676313 10768 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 00:09:38.676410 10060 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 00:09:38.676476 11148 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 00:09:38.676513 10593 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 00:09:38.676578 10234 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 00:09:38.678436 11148 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 00:09:38.678602 11148 grad_base.h:184] Init GradProcessingBase done
I20240205 00:09:51.964871 11148 grad_async_v1.h:203] Use main thread to update emb.
W20240205 00:09:51.965185 11148 kg_controller.h:75] after init GradAsyncProcessing
I20240205 00:09:51.965196 11148 kg_controller.h:84] Construct KGCacheController done
E20240205 00:09:52.777277 10965 recstore.cc:66] init folly done
E20240205 00:09:52.777300 10234 recstore.cc:66] init folly done
E20240205 00:09:52.777355 10593 recstore.cc:66] init folly done
E20240205 00:09:52.777369 11148 recstore.cc:66] init folly done
E20240205 00:09:52.777453 10390 recstore.cc:66] init folly done
E20240205 00:09:52.777465 11211 recstore.cc:66] init folly done
E20240205 00:09:52.777550 10768 recstore.cc:66] init folly done
E20240205 00:09:52.777550 10060 recstore.cc:66] init folly done
I20240205 00:09:52.778529 11148 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 00:10:14.277245 10768 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 00:10:14.402199 11211 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 00:10:14.638885 10593 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 00:10:15.537324 10234 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 00:10:16.479948 10390 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 00:10:16.593760 10060 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 00:10:17.070459 11148 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 00:10:17.898514 10965 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.678 ms                 | 25.678 ms                 |
| Forward                   | 668.303 ms                | 668.303 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:20.182250 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240205 00:10:21.255205 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240205 00:10:22.300189 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.331 ms                  | 338.148 ms                |
| ProcessBack:UpdateCache   | 9.165 ms                  | 661.931 ms                |
| ProcessBack:UpsertPq      | 40.083 ms                 | 53.513 ms                 |
| ProcessOneStep            | 69.501 ms                 | 1.344 s                   |
| BlockToStepN              | 8.701 ms                  | 835.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:23.473088 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.927 ms                 | 155.741 ms                |
| Forward                   | 5.744 ms                  | 668.303 ms                |
| Backward                  | 10.413 ms                 | 201.394 ms                |
| Optimize                  | 2.983 ms                  | 25.859 ms                 |
| BarrierTimeBeforeRank0    | 33.548 us                 | 38.595 ms                 |
| AfterBackward             | 69.540 ms                 | 1.344 s                   |
| BlockToStepN              | 8.768 ms                  | 837.120 ms                |
| OneStep                   | 120.816 ms                | 3.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:24.618320 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240205 00:10:25.759485 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240205 00:10:26.830091 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.455 ms                  | 338.148 ms                |
| ProcessBack:UpdateCache   | 9.452 ms                  | 661.931 ms                |
| ProcessBack:UpsertPq      | 46.413 ms                 | 100.687 ms                |
| ProcessOneStep            | 70.425 ms                 | 1.344 s                   |
| BlockToStepN              | 8.701 ms                  | 841.472 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:27.888871 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.046 ms                 | 155.741 ms                |
| Forward                   | 5.944 ms                  | 668.303 ms                |
| Backward                  | 10.562 ms                 | 201.394 ms                |
| Optimize                  | 2.586 ms                  | 25.859 ms                 |
| BarrierTimeBeforeRank0    | 51.499 us                 | 93.684 ms                 |
| AfterBackward             | 73.336 ms                 | 1.344 s                   |
| BlockToStepN              | 8.768 ms                  | 841.619 ms                |
| OneStep                   | 245.398 ms                | 3.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:28.973273 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240205 00:10:29.973008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240205 00:10:30.973008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240205 00:10:31.973006 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.331 ms                  | 338.148 ms                |
| ProcessBack:UpdateCache   | 9.787 ms                  | 661.931 ms                |
| ProcessBack:UpsertPq      | 46.984 ms                 | 108.522 ms                |
| ProcessOneStep            | 73.299 ms                 | 1.344 s                   |
| BlockToStepN              | 731.898 ms                | 841.472 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:33.015466 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.338 ms                 | 155.741 ms                |
| Forward                   | 5.744 ms                  | 668.303 ms                |
| Backward                  | 10.413 ms                 | 201.394 ms                |
| Optimize                  | 2.983 ms                  | 25.859 ms                 |
| BarrierTimeBeforeRank0    | 51.499 us                 | 93.684 ms                 |
| AfterBackward             | 71.479 ms                 | 1.344 s                   |
| BlockToStepN              | 8.768 ms                  | 841.619 ms                |
| OneStep                   | 245.398 ms                | 3.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:34.015007 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240205 00:10:35.015007 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240205 00:10:36.015007 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240205 00:10:37.015007 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.320 ms                  | 304.457 ms                |
| ProcessBack:UpdateCache   | 9.854 ms                  | 660.912 ms                |
| ProcessBack:UpsertPq      | 43.175 ms                 | 100.687 ms                |
| ProcessOneStep            | 69.501 ms                 | 1.344 s                   |
| BlockToStepN              | 8.701 ms                  | 841.472 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:38.015003 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.060 ms                 | 155.741 ms                |
| Forward                   | 5.348 ms                  | 668.303 ms                |
| Backward                  | 10.509 ms                 | 201.394 ms                |
| Optimize                  | 3.200 ms                  | 25.859 ms                 |
| BarrierTimeBeforeRank0    | 48.996 us                 | 93.684 ms                 |
| AfterBackward             | 68.201 ms                 | 1.344 s                   |
| BlockToStepN              | 8.768 ms                  | 841.619 ms                |
| OneStep                   | 245.398 ms                | 3.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:39.015010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240205 00:10:40.015009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240205 00:10:41.015007 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240205 00:10:42.015008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.300 ms                  | 304.457 ms                |
| ProcessBack:UpdateCache   | 9.985 ms                  | 660.912 ms                |
| ProcessBack:UpsertPq      | 42.528 ms                 | 100.687 ms                |
| ProcessOneStep            | 68.172 ms                 | 1.344 s                   |
| BlockToStepN              | 731.898 ms                | 841.472 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:43.015008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.614 ms                  | 155.741 ms                |
| Forward                   | 5.187 ms                  | 668.303 ms                |
| Backward                  | 10.509 ms                 | 201.394 ms                |
| Optimize                  | 2.598 ms                  | 25.859 ms                 |
| BarrierTimeBeforeRank0    | 46.112 us                 | 93.684 ms                 |
| AfterBackward             | 69.540 ms                 | 1.344 s                   |
| BlockToStepN              | 732.007 ms                | 841.619 ms                |
| OneStep                   | 837.098 ms                | 3.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:44.015009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240205 00:10:45.015009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240205 00:10:46.015008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240205 00:10:47.049160 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.300 ms                  | 304.457 ms                |
| ProcessBack:UpdateCache   | 10.091 ms                 | 660.912 ms                |
| ProcessBack:UpsertPq      | 45.583 ms                 | 108.522 ms                |
| ProcessOneStep            | 71.445 ms                 | 150.576 ms                |
| BlockToStepN              | 711.143 ms                | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:48.141081 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.587 ms                  | 118.523 ms                |
| Forward                   | 5.216 ms                  | 19.543 ms                 |
| Backward                  | 10.590 ms                 | 13.791 ms                 |
| Optimize                  | 2.704 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 46.112 us                 | 38.595 ms                 |
| AfterBackward             | 73.336 ms                 | 150.634 ms                |
| BlockToStepN              | 8.768 ms                  | 840.931 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:49.203210 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240205 00:10:50.251628 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240205 00:10:51.251008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240205 00:10:52.251011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.331 ms                  | 304.457 ms                |
| ProcessBack:UpdateCache   | 10.048 ms                 | 660.912 ms                |
| ProcessBack:UpsertPq      | 46.220 ms                 | 115.101 ms                |
| ProcessOneStep            | 73.497 ms                 | 150.576 ms                |
| BlockToStepN              | 8.701 ms                  | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:53.251008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.587 ms                  | 118.523 ms                |
| Forward                   | 5.199 ms                  | 19.543 ms                 |
| Backward                  | 10.573 ms                 | 13.791 ms                 |
| Optimize                  | 2.704 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 46.112 us                 | 38.595 ms                 |
| AfterBackward             | 73.336 ms                 | 150.634 ms                |
| BlockToStepN              | 8.768 ms                  | 840.931 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:54.251008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240205 00:10:55.251008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240205 00:10:56.251005 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240205 00:10:57.251008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.237 ms                  | 304.457 ms                |
| ProcessBack:UpdateCache   | 10.124 ms                 | 660.912 ms                |
| ProcessBack:UpsertPq      | 45.714 ms                 | 115.101 ms                |
| ProcessOneStep            | 70.425 ms                 | 150.576 ms                |
| BlockToStepN              | 8.701 ms                  | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:58.251010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.100 ms                  | 118.523 ms                |
| Forward                   | 5.185 ms                  | 19.543 ms                 |
| Backward                  | 10.478 ms                 | 13.791 ms                 |
| Optimize                  | 2.704 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 50.913 us                 | 38.595 ms                 |
| AfterBackward             | 70.393 ms                 | 150.634 ms                |
| BlockToStepN              | 8.768 ms                  | 840.931 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:10:59.251009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240205 00:11:00.251010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240205 00:11:01.251008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240205 00:11:02.251010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.182 ms                  | 16.636 ms                 |
| ProcessBack:UpdateCache   | 10.197 ms                 | 38.398 ms                 |
| ProcessBack:UpsertPq      | 45.059 ms                 | 113.534 ms                |
| ProcessOneStep            | 70.195 ms                 | 150.576 ms                |
| BlockToStepN              | 13.146 ms                 | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:03.251008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.502 ms                  | 118.523 ms                |
| Forward                   | 5.167 ms                  | 19.543 ms                 |
| Backward                  | 10.417 ms                 | 13.791 ms                 |
| Optimize                  | 2.626 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 72.833 us                 | 38.595 ms                 |
| AfterBackward             | 70.018 ms                 | 150.634 ms                |
| BlockToStepN              | 13.195 ms                 | 840.931 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:04.257712 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240205 00:11:05.312364 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240205 00:11:06.357002 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240205 00:11:07.431885 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.129 ms                  | 16.636 ms                 |
| ProcessBack:UpdateCache   | 10.443 ms                 | 38.398 ms                 |
| ProcessBack:UpsertPq      | 45.577 ms                 | 113.534 ms                |
| ProcessOneStep            | 70.414 ms                 | 150.576 ms                |
| BlockToStepN              | 13.146 ms                 | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:08.462919 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.271 ms                  | 118.523 ms                |
| Forward                   | 5.181 ms                  | 19.543 ms                 |
| Backward                  | 10.354 ms                 | 13.791 ms                 |
| Optimize                  | 2.654 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 430.784 us                | 38.595 ms                 |
| AfterBackward             | 70.480 ms                 | 150.634 ms                |
| BlockToStepN              | 13.195 ms                 | 840.931 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:09.467401 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240205 00:11:10.467020 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 56.723, sample: 1.256, forward: 1.220, backward: 0.776, update: 0.251
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 55.825, sample: 1.178, forward: 1.210, backward: 1.247, update: 0.270
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 53.463, sample: 1.461, forward: 1.193, backward: 1.170, update: 0.263
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 54.882, sample: 1.260, forward: 1.210, backward: 1.109, update: 0.265
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 56.960, sample: 1.430, forward: 1.208, backward: 1.219, update: 0.268
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 54.768, sample: 1.294, forward: 1.228, backward: 1.275, update: 0.271
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 57.085, sample: 1.315, forward: 1.226, backward: 1.257, update: 0.268
train_sampler.Prefill()
-------Step 0-------
tensor([   40872,    40904,    40932,    40960,  5968695,   155048, 67623715,
        14836037, 17715699,    40982]) tensor([ 5407543, 18639439, 49158881, 81307001, 24414550, 38407425, 29941769,
        83757163, 78091681, 23439175])
-------Step 1-------
tensor([   40872,    40904,    40932,    40960,  5968695,   155048, 67623715,
        14836037, 17715699,    40982]) tensor([56169380, 33724561, 12586584, 84166448, 69029931, 53083254, 79045530,
        39885053, 46368441, 11136628])
-------Step 2-------
tensor([  102893,   102927,   102948,    34231,   102973,   102995,   103018,
        30881207,   103047,   103068]) tensor([60555961, 20218132, 80623760, 40573815, 33752945, 24091303, 56452400,
        49347485, 17004918, 52055330])
-------Step 3-------
tensor([  102893,   102927,   102948,    34231,   102973,   102995,   103018,
        30881207,   103047,   103068]) tensor([60535309, 77930986, 28893158, 46802538, 51836554, 56502951, 45244405,
        13757895, 21329287,   745145])
-------Step 4-------
tensor([  165132, 37083659,   165160,   196323,   165188,   196367,   165208,
        48836075,   165234,   165261]) tensor([76066200,  8669338, 71357476, 21895080, 79052218, 52686835, 74374484,
        45883126, 83435827, 42111288])
-------Step 5-------
tensor([  165132, 37083659,   165160,   196323,   165188,   196367,   165208,
        48836075,   165234,   165261]) tensor([43396785, 84253133,   326280, 85842297, 46822913, 65692003, 17830126,
         8421590, 58704788, 49270579])
-------Step 6-------
tensor([  227267,    71390,   227295,   227322,    71433, 78586190,   227344,
          227368,   215998, 44505657]) tensor([15755757, 31661624, 44285978, 72035973, 41260500, 29980270, 29831981,
         7157140, 57300552, 82536803])
-------Step 7-------
tensor([  227267,    71390,   227295,   227322,    71433, 78586190,   227344,
          227368,   215998, 44505657]) tensor([20913144, 45394606, 59500654, 47680495, 85095473, 60821284, 66055942,
        69195029, 29541514, 26734232])
-------Step 8-------
tensor([  288249, 29487653,   288276,   234872,   288306,    89379,   288334,
          288359,   288386,   288406]) tensor([36295966, 23061117, 42356398,  1877775, 42945755, 75902389, 12951374,
        79465555,  1589860, 74294529])
-------Step 9-------
tensor([  288249, 29487653,   288276,   234872,   288306,    89379,   288334,
          288359,   288386,   288406]) tensor([62110687, 29982335, 16452849, 63071607, 10110347, 50358093, 30841710,
        43380905, 85903336, 56916559])
before start barrier
start train
[proc 0] 100 steps, total: 54.291, sample: 1.932, forward: 1.212, backward: 1.034, update: 0.350
W20240205 00:11:11.493081 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240205 00:11:12.575407 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.129 ms                  | 16.636 ms                 |
| ProcessBack:UpdateCache   | 10.550 ms                 | 38.398 ms                 |
| ProcessBack:UpsertPq      | 45.883 ms                 | 113.534 ms                |
| ProcessOneStep            | 71.445 ms                 | 150.576 ms                |
| BlockToStepN              | 13.146 ms                 | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:13.624094 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.502 ms                  | 118.523 ms                |
| Forward                   | 5.181 ms                  | 19.543 ms                 |
| Backward                  | 10.250 ms                 | 13.791 ms                 |
| Optimize                  | 2.626 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 470.889 us                | 38.595 ms                 |
| AfterBackward             | 71.983 ms                 | 150.634 ms                |
| BlockToStepN              | 13.195 ms                 | 840.931 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:14.624008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240205 00:11:15.624008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240205 00:11:16.624011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240205 00:11:17.624008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.100 ms                  | 16.636 ms                 |
| ProcessBack:UpdateCache   | 10.486 ms                 | 38.398 ms                 |
| ProcessBack:UpsertPq      | 45.568 ms                 | 113.534 ms                |
| ProcessOneStep            | 70.804 ms                 | 150.576 ms                |
| BlockToStepN              | 13.146 ms                 | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:18.624009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.416 ms                  | 118.523 ms                |
| Forward                   | 5.187 ms                  | 19.543 ms                 |
| Backward                  | 10.301 ms                 | 13.791 ms                 |
| Optimize                  | 2.651 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 84.535 us                 | 38.595 ms                 |
| AfterBackward             | 70.480 ms                 | 150.634 ms                |
| BlockToStepN              | 13.195 ms                 | 840.931 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:19.624011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240205 00:11:20.624008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240205 00:11:21.624009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240205 00:11:22.624009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.087 ms                  | 16.636 ms                 |
| ProcessBack:UpdateCache   | 10.443 ms                 | 38.398 ms                 |
| ProcessBack:UpsertPq      | 43.734 ms                 | 113.534 ms                |
| ProcessOneStep            | 70.195 ms                 | 150.576 ms                |
| BlockToStepN              | 13.146 ms                 | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:23.624009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.183 ms                  | 118.523 ms                |
| Forward                   | 5.199 ms                  | 19.543 ms                 |
| Backward                  | 10.375 ms                 | 13.791 ms                 |
| Optimize                  | 2.704 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 72.833 us                 | 38.595 ms                 |
| AfterBackward             | 70.018 ms                 | 150.634 ms                |
| BlockToStepN              | 13.261 ms                 | 840.931 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:24.624008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240205 00:11:25.624011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240205 00:11:26.624009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240205 00:11:27.624011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.082 ms                  | 16.636 ms                 |
| ProcessBack:UpdateCache   | 10.259 ms                 | 22.448 ms                 |
| ProcessBack:UpsertPq      | 42.474 ms                 | 108.522 ms                |
| ProcessOneStep            | 68.731 ms                 | 150.576 ms                |
| BlockToStepN              | 50.917 ms                 | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:28.624008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.021 ms                  | 118.523 ms                |
| Forward                   | 5.216 ms                  | 19.543 ms                 |
| Backward                  | 10.420 ms                 | 13.791 ms                 |
| Optimize                  | 2.709 ms                  | 10.423 ms                 |
| BarrierTimeBeforeRank0    | 72.833 us                 | 38.595 ms                 |
| AfterBackward             | 68.201 ms                 | 150.634 ms                |
| BlockToStepN              | 103.258 ms                | 840.931 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:29.624008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240205 00:11:30.624009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240205 00:11:31.624012 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240205 00:11:32.624011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.082 ms                  | 38.162 ms                 |
| ProcessBack:UpdateCache   | 10.223 ms                 | 22.448 ms                 |
| ProcessBack:UpsertPq      | 42.474 ms                 | 108.522 ms                |
| ProcessOneStep            | 69.269 ms                 | 150.576 ms                |
| BlockToStepN              | 103.156 ms                | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:33.624011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.842 ms                  | 118.523 ms                |
| Forward                   | 5.266 ms                  | 19.543 ms                 |
| Backward                  | 10.466 ms                 | 13.791 ms                 |
| Optimize                  | 2.735 ms                  | 10.423 ms                 |
| BarrierTimeBeforeRank0    | 60.800 us                 | 38.595 ms                 |
| AfterBackward             | 69.470 ms                 | 150.634 ms                |
| BlockToStepN              | 103.258 ms                | 840.931 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:34.689764 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240205 00:11:35.770105 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240205 00:11:37.144486 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.082 ms                  | 38.162 ms                 |
| ProcessBack:UpdateCache   | 10.223 ms                 | 22.448 ms                 |
| ProcessBack:UpsertPq      | 42.474 ms                 | 108.522 ms                |
| ProcessOneStep            | 69.501 ms                 | 137.985 ms                |
| BlockToStepN              | 103.156 ms                | 840.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:38.155978 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=152, pq.top=152
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.021 ms                  | 127.805 ms                |
| Forward                   | 5.281 ms                  | 11.701 ms                 |
| Backward                  | 10.440 ms                 | 13.063 ms                 |
| Optimize                  | 2.767 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 50.913 us                 | 31.435 ms                 |
| AfterBackward             | 70.018 ms                 | 138.029 ms                |
| BlockToStepN              | 103.258 ms                | 837.120 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:39.174232 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=154, pq.top=154
W20240205 00:11:40.200630 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
W20240205 00:11:41.218439 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=158, pq.top=158
W20240205 00:11:42.316030 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.087 ms                  | 38.162 ms                 |
| ProcessBack:UpdateCache   | 10.226 ms                 | 22.448 ms                 |
| ProcessBack:UpsertPq      | 42.604 ms                 | 108.522 ms                |
| ProcessOneStep            | 70.272 ms                 | 137.985 ms                |
| BlockToStepN              | 103.156 ms                | 835.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:43.397408 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.271 ms                  | 127.805 ms                |
| Forward                   | 5.311 ms                  | 11.701 ms                 |
| Backward                  | 10.466 ms                 | 13.791 ms                 |
| Optimize                  | 2.774 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 48.996 us                 | 31.435 ms                 |
| AfterBackward             | 70.228 ms                 | 138.029 ms                |
| BlockToStepN              | 103.258 ms                | 837.120 ms                |
| OneStep                   | 245.398 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:44.455833 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240205 00:11:45.814172 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240205 00:11:46.840265 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.087 ms                  | 38.162 ms                 |
| ProcessBack:UpdateCache   | 10.210 ms                 | 22.448 ms                 |
| ProcessBack:UpsertPq      | 42.474 ms                 | 108.522 ms                |
| ProcessOneStep            | 69.422 ms                 | 137.985 ms                |
| BlockToStepN              | 103.156 ms                | 835.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:47.840006 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.482 ms                  | 155.741 ms                |
| Forward                   | 5.340 ms                  | 11.701 ms                 |
| Backward                  | 10.478 ms                 | 13.791 ms                 |
| Optimize                  | 2.796 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 48.996 us                 | 31.435 ms                 |
| AfterBackward             | 69.470 ms                 | 138.029 ms                |
| BlockToStepN              | 707.323 ms                | 837.120 ms                |
| OneStep                   | 837.098 ms                | 1.170 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:48.840008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240205 00:11:49.870400 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240205 00:11:50.950176 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240205 00:11:51.989810 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.087 ms                  | 21.799 ms                 |
| ProcessBack:UpdateCache   | 10.193 ms                 | 20.822 ms                 |
| ProcessBack:UpsertPq      | 42.092 ms                 | 104.129 ms                |
| ProcessOneStep            | 68.855 ms                 | 137.985 ms                |
| BlockToStepN              | 707.068 ms                | 835.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:53.054762 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.670 ms                  | 155.741 ms                |
| Forward                   | 5.384 ms                  | 11.701 ms                 |
| Backward                  | 10.465 ms                 | 13.791 ms                 |
| Optimize                  | 2.796 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 46.112 us                 | 31.435 ms                 |
| AfterBackward             | 68.764 ms                 | 138.029 ms                |
| BlockToStepN              | 103.258 ms                | 837.120 ms                |
| OneStep                   | 245.398 ms                | 1.170 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:54.353068 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240205 00:11:55.383522 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240205 00:11:56.388118 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240205 00:11:57.388010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.087 ms                  | 21.799 ms                 |
| ProcessBack:UpdateCache   | 10.176 ms                 | 20.822 ms                 |
| ProcessBack:UpsertPq      | 41.521 ms                 | 104.129 ms                |
| ProcessOneStep            | 68.145 ms                 | 137.985 ms                |
| BlockToStepN              | 103.156 ms                | 835.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:58.455346 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.890 ms                  | 245.795 ms                |
| Forward                   | 5.497 ms                  | 13.900 ms                 |
| Backward                  | 10.449 ms                 | 13.791 ms                 |
| Optimize                  | 2.767 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 46.962 us                 | 31.435 ms                 |
| AfterBackward             | 68.178 ms                 | 138.029 ms                |
| BlockToStepN              | 109.708 ms                | 837.120 ms                |
| OneStep                   | 245.398 ms                | 1.170 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:11:59.542481 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240205 00:12:00.542013 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240205 00:12:01.542009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240205 00:12:02.583662 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=198
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.087 ms                  | 21.799 ms                 |
| ProcessBack:UpdateCache   | 10.172 ms                 | 20.822 ms                 |
| ProcessBack:UpsertPq      | 41.023 ms                 | 104.129 ms                |
| ProcessOneStep            | 67.709 ms                 | 137.985 ms                |
| BlockToStepN              | 148.099 ms                | 835.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:03.583012 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.890 ms                  | 245.795 ms                |
| Forward                   | 5.534 ms                  | 13.900 ms                 |
| Backward                  | 10.413 ms                 | 13.791 ms                 |
| Optimize                  | 2.735 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 43.619 us                 | 31.435 ms                 |
| AfterBackward             | 67.742 ms                 | 138.029 ms                |
| BlockToStepN              | 148.244 ms                | 837.120 ms                |
| OneStep                   | 245.398 ms                | 1.170 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 52.556, sample: 1.255, forward: 0.598, backward: 0.966, update: 0.260
[proc 7] 200 steps, total: 52.556, sample: 1.262, forward: 0.599, backward: 0.938, update: 0.255
[proc 1] 200 steps, total: 52.556, sample: 1.275, forward: 0.534, backward: 0.914, update: 0.252
[proc 3] 200 steps, total: 52.557, sample: 1.243, forward: 0.578, backward: 0.650, update: 0.236
[proc 0] 200 steps, total: 52.556, sample: 2.785, forward: 0.600, backward: 0.968, update: 0.332
[proc 6] 200 steps, total: 52.557, sample: 1.449, forward: 0.539, backward: 0.977, update: 0.249
[proc 4] 200 steps, total: 52.557, sample: 1.256, forward: 0.558, backward: 0.722, update: 0.250
[proc 2] 200 steps, total: 52.557, sample: 1.241, forward: 0.535, backward: 0.555, update: 0.259
W20240205 00:12:04.583011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240205 00:12:05.583037 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240205 00:12:06.583010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240205 00:12:07.583011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.088 ms                  | 22.297 ms                 |
| ProcessBack:UpdateCache   | 10.176 ms                 | 22.448 ms                 |
| ProcessBack:UpsertPq      | 40.807 ms                 | 104.129 ms                |
| ProcessOneStep            | 67.702 ms                 | 137.985 ms                |
| BlockToStepN              | 148.099 ms                | 835.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:08.583011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.995 ms                  | 245.795 ms                |
| Forward                   | 5.668 ms                  | 13.900 ms                 |
| Backward                  | 10.354 ms                 | 13.791 ms                 |
| Optimize                  | 2.735 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 46.962 us                 | 31.435 ms                 |
| AfterBackward             | 67.742 ms                 | 138.029 ms                |
| BlockToStepN              | 148.244 ms                | 837.120 ms                |
| OneStep                   | 245.398 ms                | 1.170 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:09.583010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240205 00:12:10.583014 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240205 00:12:12.002518 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.092 ms                  | 22.297 ms                 |
| ProcessBack:UpdateCache   | 10.193 ms                 | 22.448 ms                 |
| ProcessBack:UpsertPq      | 41.047 ms                 | 104.129 ms                |
| ProcessOneStep            | 68.070 ms                 | 137.985 ms                |
| BlockToStepN              | 707.068 ms                | 835.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:13.002012 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.024 ms                  | 303.059 ms                |
| Forward                   | 5.676 ms                  | 13.900 ms                 |
| Backward                  | 10.312 ms                 | 13.791 ms                 |
| Optimize                  | 2.735 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 43.619 us                 | 31.435 ms                 |
| AfterBackward             | 68.128 ms                 | 138.029 ms                |
| BlockToStepN              | 148.326 ms                | 837.120 ms                |
| OneStep                   | 258.892 ms                | 1.191 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:14.004722 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240205 00:12:15.004009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
W20240205 00:12:16.103951 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240205 00:12:17.103011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.092 ms                  | 22.297 ms                 |
| ProcessBack:UpdateCache   | 10.197 ms                 | 22.448 ms                 |
| ProcessBack:UpsertPq      | 41.100 ms                 | 104.129 ms                |
| ProcessOneStep            | 68.145 ms                 | 137.985 ms                |
| BlockToStepN              | 157.909 ms                | 835.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:18.103011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.311 ms                  | 303.059 ms                |
| Forward                   | 5.683 ms                  | 13.900 ms                 |
| Backward                  | 10.320 ms                 | 13.791 ms                 |
| Optimize                  | 2.734 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 43.512 us                 | 31.435 ms                 |
| AfterBackward             | 68.186 ms                 | 138.029 ms                |
| BlockToStepN              | 158.049 ms                | 840.931 ms                |
| OneStep                   | 272.179 ms                | 1.191 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:19.103039 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240205 00:12:20.129144 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240205 00:12:21.153429 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=230, pq.top=230
W20240205 00:12:22.153009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.093 ms                  | 21.799 ms                 |
| ProcessBack:UpdateCache   | 10.197 ms                 | 20.822 ms                 |
| ProcessBack:UpsertPq      | 41.256 ms                 | 100.687 ms                |
| ProcessOneStep            | 68.172 ms                 | 137.985 ms                |
| BlockToStepN              | 707.068 ms                | 893.186 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:23.153009 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.504 ms                  | 317.296 ms                |
| Forward                   | 5.688 ms                  | 13.900 ms                 |
| Backward                  | 10.320 ms                 | 13.791 ms                 |
| Optimize                  | 2.734 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 42.669 us                 | 31.435 ms                 |
| AfterBackward             | 68.200 ms                 | 138.029 ms                |
| BlockToStepN              | 171.518 ms                | 893.407 ms                |
| OneStep                   | 294.045 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:24.153005 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240205 00:12:25.171736 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240205 00:12:26.171011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240205 00:12:27.171010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.093 ms                  | 21.799 ms                 |
| ProcessBack:UpdateCache   | 10.124 ms                 | 20.822 ms                 |
| ProcessBack:UpsertPq      | 41.345 ms                 | 100.687 ms                |
| ProcessOneStep            | 68.354 ms                 | 137.985 ms                |
| BlockToStepN              | 707.068 ms                | 919.123 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:28.171007 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.808 ms                  | 317.296 ms                |
| Forward                   | 5.689 ms                  | 13.900 ms                 |
| Backward                  | 10.320 ms                 | 13.791 ms                 |
| Optimize                  | 2.734 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 42.240 us                 | 31.435 ms                 |
| AfterBackward             | 68.459 ms                 | 138.029 ms                |
| BlockToStepN              | 205.419 ms                | 919.225 ms                |
| OneStep                   | 321.307 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:29.171007 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240205 00:12:30.171012 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240205 00:12:31.171012 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240205 00:12:32.252629 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.093 ms                  | 21.799 ms                 |
| ProcessBack:UpdateCache   | 10.124 ms                 | 20.822 ms                 |
| ProcessBack:UpsertPq      | 41.390 ms                 | 100.687 ms                |
| ProcessOneStep            | 68.842 ms                 | 137.985 ms                |
| BlockToStepN              | 205.347 ms                | 922.221 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:33.342157 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=248, pq.top=248
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.837 ms                  | 317.296 ms                |
| Forward                   | 5.688 ms                  | 13.900 ms                 |
| Backward                  | 10.331 ms                 | 13.791 ms                 |
| Optimize                  | 2.734 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 41.796 us                 | 31.435 ms                 |
| AfterBackward             | 68.889 ms                 | 138.029 ms                |
| BlockToStepN              | 205.419 ms                | 924.190 ms                |
| OneStep                   | 321.307 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:34.342011 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240205 00:12:35.342013 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240205 00:12:36.342010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240205 00:12:37.342008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=254, pq.top=254
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.093 ms                  | 21.799 ms                 |
| ProcessBack:UpdateCache   | 10.102 ms                 | 20.822 ms                 |
| ProcessBack:UpsertPq      | 41.345 ms                 | 100.687 ms                |
| ProcessOneStep            | 69.269 ms                 | 136.804 ms                |
| BlockToStepN              | 205.347 ms                | 924.099 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:38.342008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.919 ms                  | 303.059 ms                |
| Forward                   | 5.683 ms                  | 13.900 ms                 |
| Backward                  | 10.338 ms                 | 13.791 ms                 |
| Optimize                  | 2.735 ms                  | 6.917 ms                  |
| BarrierTimeBeforeRank0    | 41.796 us                 | 23.004 ms                 |
| AfterBackward             | 69.300 ms                 | 136.861 ms                |
| BlockToStepN              | 707.323 ms                | 924.190 ms                |
| OneStep                   | 837.098 ms                | 1.191 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:39.342007 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240205 00:12:40.342008 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240205 00:12:41.342007 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240205 00:12:42.342010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.093 ms                  | 22.297 ms                 |
| ProcessBack:UpdateCache   | 10.060 ms                 | 20.822 ms                 |
| ProcessBack:UpsertPq      | 41.100 ms                 | 100.687 ms                |
| ProcessOneStep            | 68.842 ms                 | 136.804 ms                |
| BlockToStepN              | 707.068 ms                | 927.668 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:43.342007 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.062 ms                  | 303.059 ms                |
| Forward                   | 5.674 ms                  | 13.900 ms                 |
| Backward                  | 10.312 ms                 | 13.791 ms                 |
| Optimize                  | 2.734 ms                  | 6.917 ms                  |
| BarrierTimeBeforeRank0    | 42.240 us                 | 23.004 ms                 |
| AfterBackward             | 68.904 ms                 | 136.861 ms                |
| BlockToStepN              | 222.888 ms                | 927.784 ms                |
| OneStep                   | 330.811 ms                | 1.191 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 00:12:44.342006 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240205 00:12:45.342006 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240205 00:12:46.342010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240205 00:12:47.342010 11148 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.093 ms                  | 22.297 ms                 |
| ProcessBack:UpdateCache   | 10.018 ms                 | 20.822 ms                 |
| ProcessBack:UpsertPq      | 41.145 ms                 | 100.687 ms                |
| ProcessOneStep            | 68.855 ms                 | 136.804 ms                |
| BlockToStepN              | 222.816 ms                | 927.668 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 151.12421298027039 seconds
before call kg_cache_controller.StopThreads()
W20240205 00:12:48.194847 11148 grad_async_v1.h:243] call StopThreads. PID = 41816
W20240205 00:12:48.194875 11148 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 00:12:48.197657 11148 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 00:12:48.197667 11148 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240205 00:12:48.205603 11148 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.090 ms                  | 303.059 ms                |
| Forward                   | 5.672 ms                  | 13.900 ms                 |
| Backward                  | 10.297 ms                 | 13.791 ms                 |
| Optimize                  | 2.734 ms                  | 6.917 ms                  |
| BarrierTimeBeforeRank0    | 40.610 us                 | 23.004 ms                 |
| AfterBackward             | 68.889 ms                 | 136.861 ms                |
| BlockToStepN              | 246.589 ms                | 927.784 ms                |
| OneStep                   | 339.117 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.093 ms                  | 22.297 ms                 |
| ProcessBack:UpdateCache   | 10.012 ms                 | 20.822 ms                 |
| ProcessBack:UpsertPq      | 41.189 ms                 | 100.687 ms                |
| ProcessOneStep            | 68.842 ms                 | 136.804 ms                |
| BlockToStepN              | 246.498 ms                | 927.668 ms                |
+---------------------------+---------------------------+---------------------------+
