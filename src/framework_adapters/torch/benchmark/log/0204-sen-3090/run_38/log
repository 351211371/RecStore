WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 15:26:59.248924 60904 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_96', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=14, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [60904 sampler.py:454] Start PreSampling
WARNING [60904 sampler.py:532] Before construct renumbering_dict
WARNING [60904 sampler.py:555] PreSampling done
W20240204 15:47:10.645079 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 15:47:10.645267 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 15:47:10.645311 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 15:47:10.645339 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 15:47:10.645375 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 15:47:10.645406 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 15:47:10.645444 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 15:47:10.645485 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 15:47:10.645525 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 15:47:10.645565 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 15:47:10.645601 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_10 [1000000]0x100004c60000 7.629 MB
W20240204 15:47:10.645643 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_11 [1000000]0x100005403000 7.629 MB
W20240204 15:47:10.645675 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_12 [1000000]0x100005ba6000 7.629 MB
W20240204 15:47:10.645710 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_13 [1000000]0x100006349000 7.629 MB
W20240204 15:47:10.645748 60904 IPCTensor.h:369] NewIPCTensor: step_r0 [14]0x100006aec000 112 B 
W20240204 15:47:10.645789 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100006aee000 8 B 
W20240204 15:47:10.645814 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100006af0000 8 B 
W20240204 15:47:10.645969 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100006af2000 7.629 MB
W20240204 15:47:10.646006 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100007295000 7.629 MB
W20240204 15:47:10.646032 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100007a38000 7.629 MB
W20240204 15:47:10.646060 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000081db000 7.629 MB
W20240204 15:47:10.646087 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10000897e000 7.629 MB
W20240204 15:47:10.646114 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100009121000 7.629 MB
W20240204 15:47:10.646147 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000098c4000 7.629 MB
W20240204 15:47:10.646173 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x10000a067000 7.629 MB
W20240204 15:47:10.646199 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000a80a000 7.629 MB
W20240204 15:47:10.646226 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10000afad000 7.629 MB
W20240204 15:47:10.646251 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_10 [1000000]0x10000b750000 7.629 MB
W20240204 15:47:10.646277 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_11 [1000000]0x10000bef3000 7.629 MB
W20240204 15:47:10.646308 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_12 [1000000]0x10000c696000 7.629 MB
W20240204 15:47:10.646343 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_13 [1000000]0x10000ce39000 7.629 MB
W20240204 15:47:10.646371 60904 IPCTensor.h:369] NewIPCTensor: step_r1 [14]0x10000d5dc000 112 B 
W20240204 15:47:10.646394 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10000d5de000 8 B 
W20240204 15:47:10.646420 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10000d5e0000 8 B 
W20240204 15:47:10.646471 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10000d5e2000 7.629 MB
W20240204 15:47:10.646507 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000dd85000 7.629 MB
W20240204 15:47:10.646540 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000e528000 7.629 MB
W20240204 15:47:10.646574 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000eccb000 7.629 MB
W20240204 15:47:10.646605 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000f46e000 7.629 MB
W20240204 15:47:10.646636 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000fc11000 7.629 MB
W20240204 15:47:10.646665 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000103b4000 7.629 MB
W20240204 15:47:10.646695 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100010b57000 7.629 MB
W20240204 15:47:10.646733 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000112fa000 7.629 MB
W20240204 15:47:10.646765 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x100011a9d000 7.629 MB
W20240204 15:47:10.646796 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_10 [1000000]0x100012240000 7.629 MB
W20240204 15:47:10.646827 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_11 [1000000]0x1000129e3000 7.629 MB
W20240204 15:47:10.646865 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_12 [1000000]0x100013186000 7.629 MB
W20240204 15:47:10.646893 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_13 [1000000]0x100013929000 7.629 MB
W20240204 15:47:10.646922 60904 IPCTensor.h:369] NewIPCTensor: step_r2 [14]0x1000140cc000 112 B 
W20240204 15:47:10.646944 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000140ce000 8 B 
W20240204 15:47:10.646971 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000140d0000 8 B 
W20240204 15:47:10.647033 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000140d2000 7.629 MB
W20240204 15:47:10.647066 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x100014875000 7.629 MB
W20240204 15:47:10.647099 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100015018000 7.629 MB
W20240204 15:47:10.647125 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000157bb000 7.629 MB
W20240204 15:47:10.647152 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x100015f5e000 7.629 MB
W20240204 15:47:10.647179 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100016701000 7.629 MB
W20240204 15:47:10.647209 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100016ea4000 7.629 MB
W20240204 15:47:10.647238 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100017647000 7.629 MB
W20240204 15:47:10.647267 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100017dea000 7.629 MB
W20240204 15:47:10.647301 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10001858d000 7.629 MB
W20240204 15:47:10.647336 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_10 [1000000]0x100018d30000 7.629 MB
W20240204 15:47:10.647363 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_11 [1000000]0x1000194d3000 7.629 MB
W20240204 15:47:10.647398 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_12 [1000000]0x100019c76000 7.629 MB
W20240204 15:47:10.647428 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_13 [1000000]0x10001a419000 7.629 MB
W20240204 15:47:10.647459 60904 IPCTensor.h:369] NewIPCTensor: step_r3 [14]0x10001abbc000 112 B 
W20240204 15:47:10.647481 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001abbe000 8 B 
W20240204 15:47:10.647503 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10001abc0000 8 B 
W20240204 15:47:10.647552 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10001abc2000 7.629 MB
W20240204 15:47:10.647583 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x10001b365000 7.629 MB
W20240204 15:47:10.647610 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x10001bb08000 7.629 MB
W20240204 15:47:10.647637 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001c2ab000 7.629 MB
W20240204 15:47:10.647672 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001ca4e000 7.629 MB
W20240204 15:47:10.647703 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x10001d1f1000 7.629 MB
W20240204 15:47:10.647732 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x10001d994000 7.629 MB
W20240204 15:47:10.647759 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x10001e137000 7.629 MB
W20240204 15:47:10.647791 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x10001e8da000 7.629 MB
W20240204 15:47:10.647822 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001f07d000 7.629 MB
W20240204 15:47:10.647858 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_10 [1000000]0x10001f820000 7.629 MB
W20240204 15:47:10.647886 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_11 [1000000]0x10001ffc3000 7.629 MB
W20240204 15:47:10.647915 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_12 [1000000]0x100020766000 7.629 MB
W20240204 15:47:10.647948 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_13 [1000000]0x100020f09000 7.629 MB
W20240204 15:47:10.647981 60904 IPCTensor.h:369] NewIPCTensor: step_r4 [14]0x1000216ac000 112 B 
W20240204 15:47:10.648003 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000216ae000 8 B 
W20240204 15:47:10.648029 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000216b0000 8 B 
W20240204 15:47:10.648095 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000216b2000 7.629 MB
W20240204 15:47:10.648138 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100021e55000 7.629 MB
W20240204 15:47:10.648175 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000225f8000 7.629 MB
W20240204 15:47:10.648203 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x100022d9b000 7.629 MB
W20240204 15:47:10.648233 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x10002353e000 7.629 MB
W20240204 15:47:10.648269 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x100023ce1000 7.629 MB
W20240204 15:47:10.648303 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x100024484000 7.629 MB
W20240204 15:47:10.648334 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x100024c27000 7.629 MB
W20240204 15:47:10.648373 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000253ca000 7.629 MB
W20240204 15:47:10.648411 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x100025b6d000 7.629 MB
W20240204 15:47:10.648439 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_10 [1000000]0x100026310000 7.629 MB
W20240204 15:47:10.648471 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_11 [1000000]0x100026ab3000 7.629 MB
W20240204 15:47:10.648504 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_12 [1000000]0x100027256000 7.629 MB
W20240204 15:47:10.648536 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_13 [1000000]0x1000279f9000 7.629 MB
W20240204 15:47:10.648563 60904 IPCTensor.h:369] NewIPCTensor: step_r5 [14]0x10002819c000 112 B 
W20240204 15:47:10.648586 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10002819e000 8 B 
W20240204 15:47:10.648608 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000281a0000 8 B 
W20240204 15:47:10.648660 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000281a2000 7.629 MB
W20240204 15:47:10.648700 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x100028945000 7.629 MB
W20240204 15:47:10.648732 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000290e8000 7.629 MB
W20240204 15:47:10.648761 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10002988b000 7.629 MB
W20240204 15:47:10.648789 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10002a02e000 7.629 MB
W20240204 15:47:10.648818 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10002a7d1000 7.629 MB
W20240204 15:47:10.648847 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10002af74000 7.629 MB
W20240204 15:47:10.648878 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10002b717000 7.629 MB
W20240204 15:47:10.648907 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x10002beba000 7.629 MB
W20240204 15:47:10.648941 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x10002c65d000 7.629 MB
W20240204 15:47:10.648973 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_10 [1000000]0x10002ce00000 7.629 MB
W20240204 15:47:10.649006 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_11 [1000000]0x10002d5a3000 7.629 MB
W20240204 15:47:10.649039 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_12 [1000000]0x10002dd46000 7.629 MB
W20240204 15:47:10.649071 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_13 [1000000]0x10002e4e9000 7.629 MB
W20240204 15:47:10.649098 60904 IPCTensor.h:369] NewIPCTensor: step_r6 [14]0x10002ec8c000 112 B 
W20240204 15:47:10.649121 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x10002ec8e000 8 B 
W20240204 15:47:10.649147 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10002ec90000 8 B 
W20240204 15:47:10.649199 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10002ec92000 7.629 MB
W20240204 15:47:10.649231 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10002f435000 7.629 MB
W20240204 15:47:10.649266 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10002fbd8000 7.629 MB
W20240204 15:47:10.649297 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x10003037b000 7.629 MB
W20240204 15:47:10.649333 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x100030b1e000 7.629 MB
W20240204 15:47:10.649376 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000312c1000 7.629 MB
W20240204 15:47:10.649413 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100031a64000 7.629 MB
W20240204 15:47:10.649448 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100032207000 7.629 MB
W20240204 15:47:10.649478 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000329aa000 7.629 MB
W20240204 15:47:10.649516 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x10003314d000 7.629 MB
W20240204 15:47:10.649557 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_10 [1000000]0x1000338f0000 7.629 MB
W20240204 15:47:10.649588 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_11 [1000000]0x100034093000 7.629 MB
W20240204 15:47:10.649624 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_12 [1000000]0x100034836000 7.629 MB
W20240204 15:47:10.649654 60904 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_13 [1000000]0x100034fd9000 7.629 MB
W20240204 15:47:10.649686 60904 IPCTensor.h:369] NewIPCTensor: step_r7 [14]0x10003577c000 112 B 
W20240204 15:47:10.649710 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10003577e000 8 B 
W20240204 15:47:10.649734 60904 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100035780000 8 B 
W20240204 15:47:11.057322 60904 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100035782000 128.2 GB
W20240204 15:55:48.427512 60904 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020443ba000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302706,  4302747,    96098,  ..., 73443960, 53572170,  5218217]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2231.953 seconds
[Rank1] pid = 26667
[Rank2] pid = 26827
[Rank3] pid = 27035
[Rank4] pid = 27206
[Rank5] pid = 27395
[Rank6] pid = 27560
INFO [60904 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [26667 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [26827 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [27035 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [27206 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [27560 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [27395 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [27748 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [27560 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27395 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27748 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [60904 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27035 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26827 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26667 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 16:04:23.504690 27576 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240204 16:04:23.504832 27417 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240204 16:04:23.504832 27833 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240204 16:04:23.505280 27749 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240204 16:04:23.507030 27057 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240204 16:04:23.507119 26668 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240204 16:04:23.507529 26837 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
INFO [27206 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 16:04:23.512797 27221 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240204 16:04:23.587548 26668 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102058c11000 7.629 MB
W20240204 16:04:23.587567 27749 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1020593b4000 7.629 MB
W20240204 16:04:23.587591 27576 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x102059b57000 7.629 MB
W20240204 16:04:23.587606 27417 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10205a2fa000 7.629 MB
W20240204 16:04:23.587627 27833 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10205aa9d000 7.629 MB
W20240204 16:04:23.587648 27057 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10205b240000 7.629 MB
W20240204 16:04:23.587672 26837 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10205b9e3000 7.629 MB
W20240204 16:04:23.587697 27221 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10205c186000 7.629 MB
W20240204 16:04:23.587724 27749 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10205c929000 7.629 MB
W20240204 16:04:23.587767 26668 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10205d0cc000 7.629 MB
W20240204 16:04:23.587771 27576 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10205d86f000 7.629 MB
W20240204 16:04:23.587775 27749 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10205e012000 1.49 GB
W20240204 16:04:23.587785 27417 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1020bd5f5000 7.629 MB
W20240204 16:04:23.587805 27833 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1020bdd98000 7.629 MB
W20240204 16:04:23.587822 27749 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1020be53b000 1.49 GB
W20240204 16:04:23.587834 27057 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10211db1e000 7.629 MB
W20240204 16:04:23.587867 26668 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10211e2c1000 1.49 GB
W20240204 16:04:23.587873 27221 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10217d8a4000 7.629 MB
W20240204 16:04:23.587879 26837 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10217e047000 7.629 MB
W20240204 16:04:23.587885 27749 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 16:04:23.587889 27417 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10217e7ea000 1.49 GB
W20240204 16:04:23.587896 27576 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1021dddcd000 1.49 GB
W20240204 16:04:23.587903 27833 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10223d3b0000 1.49 GB
W20240204 16:04:23.587930 27057 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10229c993000 1.49 GB
W20240204 16:04:23.587957 26668 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1022fbf76000 1.49 GB
W20240204 16:04:23.587971 27833 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10235b559000 1.49 GB
W20240204 16:04:23.587978 27576 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1023bab3c000 1.49 GB
W20240204 16:04:23.587985 27417 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10241a11f000 1.49 GB
W20240204 16:04:23.587990 27221 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x102479702000 1.49 GB
W20240204 16:04:23.588006 27057 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1024d8ce5000 1.49 GB
W20240204 16:04:23.588013 26837 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1025382c8000 1.49 GB
W20240204 16:04:23.588043 26668 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 16:04:23.588047 27833 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 16:04:23.588066 27576 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 16:04:23.588068 27057 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 16:04:23.588069 27221 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1025978ab000 1.49 GB
W20240204 16:04:23.588111 27417 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 16:04:23.588132 26837 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1025f6e8e000 1.49 GB
W20240204 16:04:23.588160 27221 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 16:04:23.588200 26837 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 16:04:23.591550 27749 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 16:04:23.594848 26668 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 16:04:23.597525 27833 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 16:04:23.603835 27576 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 16:04:23.608844 27057 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 16:04:23.609095 27417 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 16:04:23.619609 27221 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 16:04:23.619660 26837 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100035782000
5: KnownLocalCachedEmbedding init done
WARNING [27395 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 27748
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100035782000
0: KnownLocalCachedEmbedding init done
WARNING [60904 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
3: KnownLocalCachedEmbedding init done
WARNING [27035 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
6: KnownLocalCachedEmbedding init done
WARNING [27560 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
7: KnownLocalCachedEmbedding init done
WARNING [27748 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
4: KnownLocalCachedEmbedding init done
WARNING [27206 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
1: KnownLocalCachedEmbedding init done
WARNING [26667 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100035782000
2: KnownLocalCachedEmbedding init done
WARNING [26827 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 16:05:15.307552 26837 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 16:05:15.307963 27833 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 16:05:15.308015 27417 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 16:05:15.308130 26668 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 16:05:15.308178 27057 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 16:05:15.308248 27576 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 16:05:15.308313 27749 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 16:05:15.308374 27221 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 16:05:15.310820 27749 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 14,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 16:05:15.311117 27749 grad_base.h:184] Init GradProcessingBase done
I20240204 16:05:28.611145 27749 grad_async_v2.h:42] Use main thread to update emb.
W20240204 16:05:28.611627 27749 kg_controller.h:78] after init GradAsyncProcessingV2
I20240204 16:05:28.611639 27749 kg_controller.h:84] Construct KGCacheController done
E20240204 16:05:30.396562 27833 recstore.cc:66] init folly done
E20240204 16:05:30.396615 26837 recstore.cc:66] init folly done
E20240204 16:05:30.396611 27221 recstore.cc:66] init folly done
E20240204 16:05:30.396617 27057 recstore.cc:66] init folly done
E20240204 16:05:30.396647 27417 recstore.cc:66] init folly done
E20240204 16:05:30.396660 26668 recstore.cc:66] init folly done
E20240204 16:05:30.396668 27749 recstore.cc:66] init folly done
E20240204 16:05:30.396669 27576 recstore.cc:66] init folly done
I20240204 16:05:30.397630 27749 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240204 16:05:49.125972 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 16:05:49.126597 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:05:50.204286 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 16:05:50.204456 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 165.224 us                | 413.113 us                |
+---------------------------+---------------------------+---------------------------+
W20240204 16:05:51.920867 33780 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 16:05:51.937336 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 16:05:52.131803 27417 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 16:05:52.409828 27221 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240204 16:05:52.937027 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
I20240204 16:05:53.393479 27833 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 16:05:53.399008 33780 grad_async_v2.h:137] Detect new sample comes, old_end12, new_end0
E20240204 16:05:53.937016 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 16:05:54.371459 27057 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 16:05:54.430301 33780 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
E20240204 16:05:54.937036 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
I20240204 16:05:55.320470 26837 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 156.007 us                | 281.299 us                |
+---------------------------+---------------------------+---------------------------+
W20240204 16:05:55.748533 33780 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end11
I20240204 16:05:55.772863 27576 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 16:05:55.839814 26668 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240204 16:05:55.937775 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 16:05:56.624722 27749 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240204 16:05:56.937027 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 16:05:57.440003 33780 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240204 16:05:57.937012 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=30
W20240204 16:05:58.516901 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 16:05:58.937038 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:05:59.924839 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 16:05:59.937007 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 16:06:00.143235 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.568 ms                  | 10.378 ms                 |
| Forward                   | 6.985 ms                  | 937.599 ms                |
| Backward                  | 5.368 ms                  | 418.611 ms                |
| Optimize                  | 2.815 ms                  | 4.845 ms                  |
| BarrierTimeBeforeRank0    | 50.620 ms                 | 253.534 ms                |
| AfterBackward             | 76.990 ms                 | 1.894 s                   |
| BlockToStepN              | 176.967 us                | 1.359 ms                  |
| OneStep                   | 148.977 ms                | 3.520 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 189.349 us                | 2.944 ms                  |
| ProcessBack:Shuffle       | 20.449 ms                 | 437.893 ms                |
| ProcessBack:UpdateCache   | 10.033 ms                 | 1.001 s                   |
| ProcessBack:UpsertPq      | 36.151 ms                 | 118.138 ms                |
| ProcessOneStep            | 76.942 ms                 | 1.893 s                   |
| BlockToStepN              | 125.262 us                | 804.709 us                |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:00.933318 33780 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240204 16:06:00.953672 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 16:06:01.544472 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=5, pq.top=5
E20240204 16:06:01.953035 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=257
W20240204 16:06:01.989637 33780 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
W20240204 16:06:02.677721 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=11, pq.top=11
E20240204 16:06:02.953009 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=1031
W20240204 16:06:03.253620 33780 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
W20240204 16:06:03.677032 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=17, pq.top=17
E20240204 16:06:03.953045 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=28
E20240204 16:06:04.208678 27749 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=18, sample_step_cpp_seen_[rank]=17
W20240204 16:06:04.510089 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240204 16:06:04.957386 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.140 ms                  | 369.844 ms                |
| Forward                   | 5.715 ms                  | 937.599 ms                |
| Backward                  | 5.077 ms                  | 418.611 ms                |
| Optimize                  | 3.572 ms                  | 8.011 ms                  |
| BarrierTimeBeforeRank0    | 4.890 ms                  | 253.534 ms                |
| AfterBackward             | 152.870 ms                | 1.894 s                   |
| BlockToStepN              | 454.521 us                | 4.847 ms                  |
| OneStep                   | 202.703 ms                | 3.520 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 225.587 us                | 719.330 us                |
| ProcessBack:Shuffle       | 9.226 ms                  | 437.893 ms                |
| ProcessBack:UpdateCache   | 13.889 ms                 | 1.001 s                   |
| ProcessBack:UpsertPq      | 72.401 ms                 | 188.883 ms                |
| ProcessOneStep            | 152.798 ms                | 1.893 s                   |
| BlockToStepN              | 360.754 us                | 4.735 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:05.594485 33780 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240204 16:06:05.957015 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=694
W20240204 16:06:06.229952 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240204 16:06:06.731280 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end11
E20240204 16:06:06.957007 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=22709
W20240204 16:06:07.450873 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240204 16:06:07.931818 33780 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240204 16:06:07.957010 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=28
W20240204 16:06:08.553746 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240204 16:06:08.933881 33780 grad_async_v2.h:137] Detect new sample comes, old_end11, new_end10
E20240204 16:06:08.957002 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=162
E20240204 16:06:09.208441 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=37, sample_step_cpp_seen_[rank]=36
E20240204 16:06:09.957011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=258
W20240204 16:06:10.011541 33780 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end10
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.655 ms                  | 369.844 ms                |
| Forward                   | 5.678 ms                  | 937.599 ms                |
| Backward                  | 5.077 ms                  | 418.611 ms                |
| Optimize                  | 2.780 ms                  | 8.011 ms                  |
| BarrierTimeBeforeRank0    | 2.080 ms                  | 253.534 ms                |
| AfterBackward             | 118.056 ms                | 1.894 s                   |
| BlockToStepN              | 700.933 us                | 4.847 ms                  |
| OneStep                   | 152.900 ms                | 3.520 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:10.383670 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=39, pq.top=39
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 376.326 us                | 2.193 ms                  |
| ProcessBack:Shuffle       | 9.163 ms                  | 422.030 ms                |
| ProcessBack:UpdateCache   | 11.128 ms                 | 1.001 s                   |
| ProcessBack:UpsertPq      | 42.068 ms                 | 183.628 ms                |
| ProcessOneStep            | 122.344 ms                | 1.893 s                   |
| BlockToStepN              | 648.521 us                | 4.735 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 16:06:10.957007 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=14703
W20240204 16:06:11.238549 33780 grad_async_v2.h:137] Detect new sample comes, old_end10, new_end5
E20240204 16:06:11.957016 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=790
W20240204 16:06:12.229475 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240204 16:06:12.394172 33780 grad_async_v2.h:137] Detect new sample comes, old_end11, new_end10
E20240204 16:06:12.957034 34022 parallel_pq_v2.h:79] insert failed, size(hashtable)=31537
W20240204 16:06:13.475123 33780 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240204 16:06:13.957027 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=61
W20240204 16:06:14.206329 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240204 16:06:14.494493 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240204 16:06:14.957012 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.184 ms                  | 369.844 ms                |
| Forward                   | 5.715 ms                  | 50.388 ms                 |
| Backward                  | 5.128 ms                  | 11.523 ms                 |
| Optimize                  | 3.412 ms                  | 9.356 ms                  |
| BarrierTimeBeforeRank0    | 1.658 ms                  | 244.541 ms                |
| AfterBackward             | 116.411 ms                | 1.730 s                   |
| BlockToStepN              | 581.494 us                | 2.619 ms                  |
| OneStep                   | 148.977 ms                | 2.120 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:15.380550 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 522.757 us                | 1.997 ms                  |
| ProcessBack:Shuffle       | 9.095 ms                  | 422.030 ms                |
| ProcessBack:UpdateCache   | 11.019 ms                 | 1.001 s                   |
| ProcessBack:UpsertPq      | 39.667 ms                 | 183.628 ms                |
| ProcessOneStep            | 117.068 ms                | 1.729 s                   |
| BlockToStepN              | 498.575 us                | 2.526 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:15.495728 33780 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
E20240204 16:06:15.957012 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=2257
W20240204 16:06:16.434651 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=72, pq.top=72
W20240204 16:06:16.744630 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240204 16:06:16.957018 34030 parallel_pq_v2.h:79] insert failed, size(hashtable)=74674
E20240204 16:06:17.014623 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=77, sample_step_cpp_seen_[rank]=76
W20240204 16:06:17.710323 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=81, pq.top=81
E20240204 16:06:17.957012 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=3319
W20240204 16:06:17.973160 33780 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end12
E20240204 16:06:18.957011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=136
W20240204 16:06:18.996891 33780 grad_async_v2.h:137] Detect new sample comes, old_end12, new_end13
W20240204 16:06:19.114181 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=83, pq.top=83
E20240204 16:06:19.957019 34037 parallel_pq_v2.h:79] insert failed, size(hashtable)=14022
W20240204 16:06:20.052701 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.431 ms                  | 369.844 ms                |
| Forward                   | 5.681 ms                  | 50.388 ms                 |
| Backward                  | 5.226 ms                  | 11.523 ms                 |
| Optimize                  | 2.989 ms                  | 9.560 ms                  |
| BarrierTimeBeforeRank0    | 2.779 ms                  | 244.541 ms                |
| AfterBackward             | 108.339 ms                | 1.730 s                   |
| BlockToStepN              | 812.245 us                | 4.847 ms                  |
| OneStep                   | 144.062 ms                | 2.120 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:20.350294 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 434.689 us                | 13.288 ms                 |
| ProcessBack:Shuffle       | 8.744 ms                  | 33.870 ms                 |
| ProcessBack:UpdateCache   | 10.793 ms                 | 27.058 ms                 |
| ProcessBack:UpsertPq      | 37.738 ms                 | 182.407 ms                |
| ProcessOneStep            | 108.540 ms                | 1.729 s                   |
| BlockToStepN              | 689.101 us                | 4.735 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 16:06:20.957016 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=5372
W20240204 16:06:21.199627 33780 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
W20240204 16:06:21.440335 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 29.192, sample: 1.566, forward: 1.255, backward: 0.934, update: 0.250
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 25.762, sample: 1.674, forward: 1.342, backward: 0.970, update: 0.257
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 29.470, sample: 1.958, forward: 1.317, backward: 0.907, update: 0.275
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.230, sample: 1.503, forward: 1.633, backward: 1.066, update: 0.234
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 25.829, sample: 1.425, forward: 1.324, backward: 1.040, update: 0.240
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 26.281, sample: 2.562, forward: 1.342, backward: 1.150, update: 0.283
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 28.208, sample: 1.589, forward: 1.276, backward: 1.087, update: 0.250
train_sampler.Prefill()
-------Step 0-------
tensor([   42945,    42964,    42994,    43019,  6224007,   142547, 61754489,
        20954299, 17764006,    43048]) tensor([ 5390282, 13529780, 56648215, 78914940, 18753717, 36014852, 38104187,
        80530929, 66609030, 24715820])
-------Step 1-------
tensor([   42945,    42964,    42994,    43019,  6224007,   142547, 61754489,
        20954299, 17764006,    43048]) tensor([79993546, 34085860,  9866539, 75490468, 81923511, 51313122, 66728868,
        46129868, 45299976, 15186533])
-------Step 2-------
tensor([  117430,   117467,   117518,    21960,   117539,   117571,   117608,
        21057140,   117655,   117679]) tensor([68401763, 27290751, 84805809, 47230203, 41193071, 23555070, 80190398,
        49458369, 12180243, 50290629])
-------Step 3-------
tensor([  117430,   117467,   117518,    21960,   117539,   117571,   117608,
        21057140,   117655,   117679]) tensor([59012864, 77628509, 30942513, 41666515, 60369921, 52767421, 33451516,
        19235508, 22256704,   708398])
-------Step 4-------
tensor([  187101, 45333579,   187129,   180561,   187147,   180595,   187180,
        43078246,   187207,   187233]) tensor([74562261, 11044675, 83264529, 16775447, 81168383, 38579184, 60997482,
        41056629, 85257556, 49050458])
-------Step 5-------
tensor([  187101, 45333579,   187129,   180561,   187147,   180595,   187180,
        43078246,   187207,   187233]) tensor([37067242, 68603137,   332558, 85211296, 48136902, 45882002, 12710056,
         8437622, 66252930, 33752090])
-------Step 6-------
tensor([  249313,    46254,   249333,   249361,    46273, 68725369,   249387,
          249409,   199440, 40122766]) tensor([11904176, 34966725, 36482842, 67222955, 35608414, 38142524, 20406650,
         6116496, 65167370, 84849837])
-------Step 7-------
tensor([  249313,    46254,   249333,   249361,    46273, 68725369,   249387,
          249409,   199440, 40122766]) tensor([28065815, 42955825, 76202838, 59651630, 74713499, 52294787, 47177961,
        67623148, 31915261, 27144074])
-------Step 8-------
tensor([  310519, 29782237,   310549,   217402,   310568,    57633,   310592,
          310609,   310634,   310658]) tensor([52920070, 20265334, 41548498,  1915602, 40683533, 60655866, 18288671,
        81706689,  1480738, 64325634])
-------Step 9-------
tensor([  310519, 29782237,   310549,   217402,   310568,    57633,   310592,
          310609,   310634,   310658]) tensor([50075978, 30234915, 11856408, 66297393, 10262057, 40821223, 23295815,
        36019286, 73647643, 56546567])
-------Step 10-------
tensor([   74279,   374622,   374651,   236041,   374678,   374704,   374738,
        11495323,   374762,   374788]) tensor([20693511, 39816231, 27896236, 83882607, 21583037, 69009884, 29375666,
        77125798, 45489212, 10051201])
-------Step 11-------
tensor([   74279,   374622,   374651,   236041,   374678,   374704,   374738,
        11495323,   374762,   374788]) tensor([ 1682743,  9142586, 32280069, 15553824, 35951917, 10083131, 79429128,
        75259126,    54021, 40761698])
-------Step 12-------
tensor([  432766,   432778,   432792,   432803,   255188,    78248, 76370635,
           78271,   432818, 82057427]) tensor([16574278, 52710582, 81683328, 75606709,   354526, 30767661, 46220599,
         6197483, 69922032, 80157839])
-------Step 13-------
tensor([  432766,   432778,   432792,   432803,   255188,    78248, 76370635,
           78271,   432818, 82057427]) tensor([69907765,  8857921,  5791060, 33040508, 81016590,   568252, 83551771,
        82874997, 18676632, 55712072])
before start barrier
start train
[proc 0] 100 steps, total: 24.977, sample: 2.594, forward: 1.560, backward: 0.974, update: 0.362
E20240204 16:06:21.957296 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240204 16:06:22.170642 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=103, sample_step_cpp_seen_[rank]=102
W20240204 16:06:22.343290 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240204 16:06:22.957013 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=3691
W20240204 16:06:23.380918 33780 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
W20240204 16:06:23.646414 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=104, pq.top=104
E20240204 16:06:23.957013 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240204 16:06:24.434039 33780 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end11
W20240204 16:06:24.737905 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=111, pq.top=111
E20240204 16:06:24.957013 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=56149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.431 ms                  | 369.844 ms                |
| Forward                   | 5.681 ms                  | 50.388 ms                 |
| Backward                  | 5.240 ms                  | 11.523 ms                 |
| Optimize                  | 3.101 ms                  | 9.560 ms                  |
| BarrierTimeBeforeRank0    | 2.731 ms                  | 244.541 ms                |
| AfterBackward             | 108.583 ms                | 1.730 s                   |
| BlockToStepN              | 867.510 us                | 18.043 ms                 |
| OneStep                   | 145.602 ms                | 2.120 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 465.963 us                | 11.482 ms                 |
| ProcessBack:Shuffle       | 8.763 ms                  | 33.870 ms                 |
| ProcessBack:UpdateCache   | 10.853 ms                 | 27.058 ms                 |
| ProcessBack:UpsertPq      | 35.097 ms                 | 182.407 ms                |
| ProcessOneStep            | 108.540 ms                | 1.729 s                   |
| BlockToStepN              | 760.730 us                | 17.974 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:25.551841 33780 grad_async_v2.h:137] Detect new sample comes, old_end10, new_end3
W20240204 16:06:25.864078 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=117, pq.top=117
E20240204 16:06:25.957007 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=478
W20240204 16:06:26.570969 33780 grad_async_v2.h:137] Detect new sample comes, old_end12, new_end11
W20240204 16:06:26.886354 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=125, pq.top=125
E20240204 16:06:26.967536 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240204 16:06:27.315856 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=128, sample_step_cpp_seen_[rank]=127
W20240204 16:06:27.777927 33780 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
E20240204 16:06:27.976220 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:06:28.800120 33780 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 16:06:28.976011 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=276
W20240204 16:06:29.479887 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240204 16:06:29.819968 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end13
E20240204 16:06:29.976014 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=42257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.797 ms                  | 369.844 ms                |
| Forward                   | 5.681 ms                  | 50.388 ms                 |
| Backward                  | 5.201 ms                  | 11.523 ms                 |
| Optimize                  | 2.884 ms                  | 9.560 ms                  |
| BarrierTimeBeforeRank0    | 2.094 ms                  | 244.541 ms                |
| AfterBackward             | 105.584 ms                | 1.730 s                   |
| BlockToStepN              | 879.969 us                | 32.159 ms                 |
| OneStep                   | 145.407 ms                | 2.120 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 416.203 us                | 13.664 ms                 |
| ProcessBack:Shuffle       | 8.692 ms                  | 33.870 ms                 |
| ProcessBack:UpdateCache   | 11.037 ms                 | 27.058 ms                 |
| ProcessBack:UpsertPq      | 35.034 ms                 | 176.239 ms                |
| ProcessOneStep            | 105.528 ms                | 1.729 s                   |
| BlockToStepN              | 786.103 us                | 32.032 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:30.503608 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=144, pq.top=144
W20240204 16:06:30.953859 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240204 16:06:30.976009 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=125
E20240204 16:06:31.976013 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=6021
W20240204 16:06:31.976677 33780 grad_async_v2.h:137] Detect new sample comes, old_end11, new_end10
E20240204 16:06:32.315011 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=149, sample_step_cpp_seen_[rank]=148
E20240204 16:06:32.977684 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:06:33.038434 33780 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end10
W20240204 16:06:33.298964 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=150, pq.top=150
E20240204 16:06:33.977011 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=628
W20240204 16:06:34.157207 33780 grad_async_v2.h:137] Detect new sample comes, old_end11, new_end3
W20240204 16:06:34.398458 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=159, pq.top=159
E20240204 16:06:34.977015 33779 parallel_pq_v2.h:79] insert failed, size(hashtable)=8010
W20240204 16:06:35.166899 33780 grad_async_v2.h:137] Detect new sample comes, old_end13, new_end10
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.773 ms                  | 340.674 ms                |
| Forward                   | 5.648 ms                  | 34.715 ms                 |
| Backward                  | 5.250 ms                  | 9.773 ms                  |
| Optimize                  | 2.787 ms                  | 9.560 ms                  |
| BarrierTimeBeforeRank0    | 2.094 ms                  | 167.974 ms                |
| AfterBackward             | 104.441 ms                | 1.730 s                   |
| BlockToStepN              | 929.154 us                | 40.374 ms                 |
| OneStep                   | 144.268 ms                | 1.840 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 467.754 us                | 16.661 ms                 |
| ProcessBack:Shuffle       | 8.628 ms                  | 33.870 ms                 |
| ProcessBack:UpdateCache   | 11.112 ms                 | 27.058 ms                 |
| ProcessBack:UpsertPq      | 34.189 ms                 | 176.239 ms                |
| ProcessOneStep            | 104.859 ms                | 1.729 s                   |
| BlockToStepN              | 848.114 us                | 40.250 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:35.453624 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=166, pq.top=166
E20240204 16:06:35.988080 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:06:36.570899 33780 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240204 16:06:36.988013 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=5445
E20240204 16:06:37.315011 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=170, sample_step_cpp_seen_[rank]=169
W20240204 16:06:37.634483 33780 grad_async_v2.h:137] Detect new sample comes, old_end10, new_end3
E20240204 16:06:37.988014 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=6042
W20240204 16:06:38.323915 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=172, pq.top=172
W20240204 16:06:38.695310 33780 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
E20240204 16:06:38.988018 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=10188
W20240204 16:06:39.537822 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240204 16:06:39.863780 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
E20240204 16:06:39.988013 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=416
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.077 ms                  | 340.674 ms                |
| Forward                   | 5.681 ms                  | 34.715 ms                 |
| Backward                  | 5.301 ms                  | 10.089 ms                 |
| Optimize                  | 2.787 ms                  | 9.560 ms                  |
| BarrierTimeBeforeRank0    | 2.770 ms                  | 167.974 ms                |
| AfterBackward             | 103.160 ms                | 1.792 s                   |
| BlockToStepN              | 1.083 ms                  | 40.374 ms                 |
| OneStep                   | 141.645 ms                | 2.075 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 513.990 us                | 15.141 ms                 |
| ProcessBack:Shuffle       | 8.596 ms                  | 25.524 ms                 |
| ProcessBack:UpdateCache   | 11.037 ms                 | 18.013 ms                 |
| ProcessBack:UpsertPq      | 33.649 ms                 | 170.820 ms                |
| ProcessOneStep            | 103.090 ms                | 1.792 s                   |
| BlockToStepN              | 995.563 us                | 40.250 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 16:06:40.988014 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=6525
W20240204 16:06:41.019616 33780 grad_async_v2.h:137] Detect new sample comes, old_end10, new_end8
E20240204 16:06:41.988024 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=191
W20240204 16:06:42.163872 33780 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
E20240204 16:06:42.315009 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=189, sample_step_cpp_seen_[rank]=188
E20240204 16:06:42.988010 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=67
W20240204 16:06:43.193184 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=192, pq.top=192
W20240204 16:06:43.222601 33780 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end11
E20240204 16:06:43.988016 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
W20240204 16:06:44.408198 33780 grad_async_v2.h:137] Detect new sample comes, old_end11, new_end3
[proc 0] 200 steps, total: 23.082, sample: 1.981, forward: 0.589, backward: 0.593, update: 0.291
[proc 4] 200 steps, total: 23.083, sample: 1.096, forward: 0.562, backward: 0.625, update: 0.246
[proc 3] 200 steps, total: 23.083, sample: 1.060, forward: 0.547, backward: 0.574, update: 0.236
[proc 1] 200 steps, total: 23.083, sample: 1.351, forward: 0.619, backward: 0.542, update: 0.248
[proc 2] 200 steps, total: 23.083, sample: 1.630, forward: 0.539, backward: 0.659, update: 0.239
[proc 6] 200 steps, total: 23.083, sample: 1.206, forward: 0.581, backward: 0.619, update: 0.243
[proc 7] 200 steps, total: 23.083, sample: 1.113, forward: 0.538, backward: 0.586, update: 0.262
[proc 5] 200 steps, total: 23.083, sample: 1.296, forward: 0.551, backward: 0.555, update: 0.237
E20240204 16:06:44.988013 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=61023
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.017 ms                  | 340.674 ms                |
| Forward                   | 5.692 ms                  | 34.715 ms                 |
| Backward                  | 5.322 ms                  | 10.089 ms                 |
| Optimize                  | 2.780 ms                  | 9.560 ms                  |
| BarrierTimeBeforeRank0    | 2.968 ms                  | 167.974 ms                |
| AfterBackward             | 103.160 ms                | 1.894 s                   |
| BlockToStepN              | 990.743 us                | 40.374 ms                 |
| OneStep                   | 141.645 ms                | 2.120 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 583.860 us                | 11.468 ms                 |
| ProcessBack:Shuffle       | 8.628 ms                  | 25.524 ms                 |
| ProcessBack:UpdateCache   | 11.037 ms                 | 18.013 ms                 |
| ProcessBack:UpsertPq      | 33.863 ms                 | 177.818 ms                |
| ProcessOneStep            | 103.090 ms                | 1.893 s                   |
| BlockToStepN              | 858.076 us                | 40.250 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:45.417433 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240204 16:06:45.475389 33780 grad_async_v2.h:137] Detect new sample comes, old_end13, new_end10
E20240204 16:06:45.993178 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:06:46.580322 33780 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240204 16:06:46.993016 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=323
E20240204 16:06:47.315008 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=209, sample_step_cpp_seen_[rank]=208
W20240204 16:06:47.637164 33780 grad_async_v2.h:137] Detect new sample comes, old_end13, new_end0
E20240204 16:06:47.993016 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=24144
W20240204 16:06:48.641844 33780 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240204 16:06:48.999982 30756 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:06:49.873447 33780 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end13
E20240204 16:06:49.999037 34039 parallel_pq_v2.h:79] insert failed, size(hashtable)=62804
W20240204 16:06:50.147974 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=225, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.816 ms                  | 340.674 ms                |
| Forward                   | 5.681 ms                  | 34.715 ms                 |
| Backward                  | 5.376 ms                  | 10.089 ms                 |
| Optimize                  | 2.764 ms                  | 9.560 ms                  |
| BarrierTimeBeforeRank0    | 2.731 ms                  | 167.974 ms                |
| AfterBackward             | 103.160 ms                | 1.894 s                   |
| BlockToStepN              | 1.162 ms                  | 40.374 ms                 |
| OneStep                   | 141.382 ms                | 2.120 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 456.825 us                | 13.025 ms                 |
| ProcessBack:Shuffle       | 8.612 ms                  | 20.449 ms                 |
| ProcessBack:UpdateCache   | 10.979 ms                 | 16.889 ms                 |
| ProcessBack:UpsertPq      | 32.522 ms                 | 177.818 ms                |
| ProcessOneStep            | 103.090 ms                | 1.893 s                   |
| BlockToStepN              | 1.059 ms                  | 40.250 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:06:50.875285 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240204 16:06:50.999020 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1297
E20240204 16:06:52.007481 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:06:52.079768 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240204 16:06:52.315011 27749 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=229, sample_step_cpp_seen_[rank]=228
W20240204 16:06:52.928236 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=230, pq.top=230
E20240204 16:06:53.007009 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=883
W20240204 16:06:53.108355 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
W20240204 16:06:53.958446 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=238, pq.top=238
E20240204 16:06:54.007009 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240204 16:06:54.245543 33780 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
W20240204 16:06:55.003412 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=245, pq.top=245
E20240204 16:06:55.007026 34029 parallel_pq_v2.h:79] insert failed, size(hashtable)=45156
W20240204 16:06:55.258492 33780 grad_async_v2.h:137] Detect new sample comes, old_end10, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.077 ms                  | 340.674 ms                |
| Forward                   | 5.668 ms                  | 34.715 ms                 |
| Backward                  | 5.433 ms                  | 10.089 ms                 |
| Optimize                  | 2.732 ms                  | 9.560 ms                  |
| BarrierTimeBeforeRank0    | 2.526 ms                  | 167.974 ms                |
| AfterBackward             | 103.570 ms                | 1.982 s                   |
| BlockToStepN              | 1.263 ms                  | 53.094 ms                 |
| OneStep                   | 142.128 ms                | 2.120 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 616.139 us                | 22.089 ms                 |
| ProcessBack:Shuffle       | 8.609 ms                  | 20.449 ms                 |
| ProcessBack:UpdateCache   | 10.857 ms                 | 16.889 ms                 |
| ProcessBack:UpsertPq      | 31.886 ms                 | 177.818 ms                |
| ProcessOneStep            | 103.090 ms                | 1.982 s                   |
| BlockToStepN              | 1.160 ms                  | 52.932 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 16:06:56.017659 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:06:56.416759 33780 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end13
E20240204 16:06:57.019694 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:06:57.429073 33780 grad_async_v2.h:137] Detect new sample comes, old_end13, new_end0
E20240204 16:06:58.019021 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=129543
W20240204 16:06:58.181094 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240204 16:06:58.469987 33780 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240204 16:06:59.022547 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:06:59.358016 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240204 16:06:59.665270 33780 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240204 16:07:00.022012 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=69490
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.431 ms                  | 326.252 ms                |
| Forward                   | 5.668 ms                  | 13.952 ms                 |
| Backward                  | 5.401 ms                  | 10.065 ms                 |
| Optimize                  | 2.709 ms                  | 9.356 ms                  |
| BarrierTimeBeforeRank0    | 2.383 ms                  | 135.547 ms                |
| AfterBackward             | 103.160 ms                | 1.894 s                   |
| BlockToStepN              | 1.299 ms                  | 57.053 ms                 |
| OneStep                   | 144.268 ms                | 2.075 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 16:07:00.359822 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=270, pq.top=270
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 630.552 us                | 23.605 ms                 |
| ProcessBack:Shuffle       | 8.638 ms                  | 25.524 ms                 |
| ProcessBack:UpdateCache   | 10.843 ms                 | 16.889 ms                 |
| ProcessBack:UpsertPq      | 31.778 ms                 | 177.818 ms                |
| ProcessOneStep            | 102.899 ms                | 1.893 s                   |
| BlockToStepN              | 1.216 ms                  | 56.932 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:07:00.935788 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240204 16:07:01.022011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=118455
E20240204 16:07:01.213814 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=274, sample_step_cpp_seen_[rank]=273
W20240204 16:07:01.942276 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240204 16:07:02.022012 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=6661
W20240204 16:07:02.818434 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240204 16:07:02.952816 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end10
E20240204 16:07:03.022011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=8094
W20240204 16:07:03.944967 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=283, pq.top=283
E20240204 16:07:04.022035 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=6199
W20240204 16:07:04.034524 33780 grad_async_v2.h:137] Detect new sample comes, old_end12, new_end5
E20240204 16:07:05.022011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=804
W20240204 16:07:05.265062 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end11
W20240204 16:07:05.307483 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.648 ms                  | 326.252 ms                |
| Forward                   | 5.712 ms                  | 13.952 ms                 |
| Backward                  | 5.408 ms                  | 10.089 ms                 |
| Optimize                  | 2.709 ms                  | 9.356 ms                  |
| BarrierTimeBeforeRank0    | 2.013 ms                  | 135.547 ms                |
| AfterBackward             | 103.160 ms                | 1.894 s                   |
| BlockToStepN              | 1.368 ms                  | 57.053 ms                 |
| OneStep                   | 144.268 ms                | 2.075 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 583.948 us                | 11.970 ms                 |
| ProcessBack:Shuffle       | 8.679 ms                  | 25.524 ms                 |
| ProcessBack:UpdateCache   | 10.767 ms                 | 16.873 ms                 |
| ProcessBack:UpsertPq      | 31.602 ms                 | 182.407 ms                |
| ProcessOneStep            | 103.090 ms                | 1.893 s                   |
| BlockToStepN              | 1.253 ms                  | 56.932 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 16:07:06.022032 34040 parallel_pq_v2.h:79] insert failed, size(hashtable)=197971
E20240204 16:07:06.213012 27749 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=297, sample_step_cpp_seen_[rank]=296
W20240204 16:07:06.365339 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240204 16:07:07.022014 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=4834
W20240204 16:07:07.455648 33780 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
[proc 4] 300 steps, total: 23.193, sample: 0.957, forward: 0.568, backward: 0.599, update: 0.236
[proc 6] 300 steps, total: 23.193, sample: 1.207, forward: 0.557, backward: 0.708, update: 0.234
[proc 3] 300 steps, total: 23.193, sample: 1.055, forward: 0.525, backward: 0.548, update: 0.222
[proc 5] 300 steps, total: 23.193, sample: 1.199, forward: 0.523, backward: 0.572, update: 0.249
[proc 7] 300 steps, total: 23.193, sample: 1.051, forward: 0.542, backward: 0.659, update: 0.235
[proc 0] 300 steps, total: 23.193, sample: 2.162, forward: 0.577, backward: 0.639, update: 0.280
[proc 1] 300 steps, total: 23.193, sample: 1.345, forward: 0.512, backward: 0.569, update: 0.236
[proc 2] 300 steps, total: 23.193, sample: 1.677, forward: 0.535, backward: 0.685, update: 0.229
E20240204 16:07:08.022011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=28452
W20240204 16:07:08.076206 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=301, pq.top=300
W20240204 16:07:08.566752 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end11
E20240204 16:07:09.022007 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=40
W20240204 16:07:09.189445 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240204 16:07:09.750560 33780 grad_async_v2.h:137] Detect new sample comes, old_end10, new_end3
E20240204 16:07:10.022009 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=544
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.773 ms                  | 326.252 ms                |
| Forward                   | 5.706 ms                  | 13.952 ms                 |
| Backward                  | 5.446 ms                  | 10.089 ms                 |
| Optimize                  | 2.728 ms                  | 9.356 ms                  |
| BarrierTimeBeforeRank0    | 1.711 ms                  | 135.547 ms                |
| AfterBackward             | 103.160 ms                | 1.894 s                   |
| BlockToStepN              | 1.432 ms                  | 68.161 ms                 |
| OneStep                   | 144.398 ms                | 2.075 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 647.509 us                | 20.998 ms                 |
| ProcessBack:Shuffle       | 8.744 ms                  | 25.524 ms                 |
| ProcessBack:UpdateCache   | 10.756 ms                 | 16.873 ms                 |
| ProcessBack:UpsertPq      | 31.913 ms                 | 183.628 ms                |
| ProcessOneStep            | 103.090 ms                | 1.893 s                   |
| BlockToStepN              | 1.336 ms                  | 68.061 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:07:10.406368 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240204 16:07:10.819183 33780 grad_async_v2.h:137] Detect new sample comes, old_end13, new_end10
E20240204 16:07:11.022012 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=115
E20240204 16:07:11.337867 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=321, sample_step_cpp_seen_[rank]=320
W20240204 16:07:11.870092 33780 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240204 16:07:12.030109 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 16:07:12.890969 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=322, pq.top=322
W20240204 16:07:12.945907 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 16:07:13.030011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=13109
W20240204 16:07:13.947438 33780 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240204 16:07:14.030015 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=13119
W20240204 16:07:14.078322 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=329, pq.top=329
E20240204 16:07:15.030010 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=33247
W20240204 16:07:15.103080 33780 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240204 16:07:15.133090 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=336, pq.top=336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.773 ms                  | 326.252 ms                |
| Forward                   | 5.713 ms                  | 13.952 ms                 |
| Backward                  | 5.504 ms                  | 10.525 ms                 |
| Optimize                  | 2.734 ms                  | 9.356 ms                  |
| BarrierTimeBeforeRank0    | 1.815 ms                  | 135.547 ms                |
| AfterBackward             | 103.570 ms                | 1.894 s                   |
| BlockToStepN              | 1.502 ms                  | 86.181 ms                 |
| OneStep                   | 145.407 ms                | 2.075 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 733.793 us                | 16.475 ms                 |
| ProcessBack:Shuffle       | 8.789 ms                  | 22.777 ms                 |
| ProcessBack:UpdateCache   | 10.610 ms                 | 16.873 ms                 |
| ProcessBack:UpsertPq      | 31.568 ms                 | 183.628 ms                |
| ProcessOneStep            | 104.135 ms                | 1.893 s                   |
| BlockToStepN              | 1.408 ms                  | 86.043 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 16:07:16.030010 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=73312
W20240204 16:07:16.165380 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=340, pq.top=340
W20240204 16:07:16.191154 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
E20240204 16:07:17.030010 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1633
W20240204 16:07:17.513656 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end11
W20240204 16:07:17.608568 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=347, pq.top=347
E20240204 16:07:18.030009 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=16862
W20240204 16:07:18.596320 33780 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
W20240204 16:07:18.634493 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=353, pq.top=353
E20240204 16:07:18.721932 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=353, sample_step_cpp_seen_[rank]=352
E20240204 16:07:19.030020 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=7004
W20240204 16:07:19.800676 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
E20240204 16:07:20.032727 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.773 ms                  | 273.568 ms                |
| Forward                   | 5.735 ms                  | 12.490 ms                 |
| Backward                  | 5.537 ms                  | 10.089 ms                 |
| Optimize                  | 2.764 ms                  | 8.452 ms                  |
| BarrierTimeBeforeRank0    | 1.608 ms                  | 119.094 ms                |
| AfterBackward             | 104.199 ms                | 1.870 s                   |
| BlockToStepN              | 1.554 ms                  | 86.181 ms                 |
| OneStep                   | 146.730 ms                | 2.004 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 308.762 us                | 3.090 ms                  |
| ProcessBack:Shuffle       | 8.794 ms                  | 25.524 ms                 |
| ProcessBack:UpdateCache   | 10.568 ms                 | 16.873 ms                 |
| ProcessBack:UpsertPq      | 31.568 ms                 | 193.877 ms                |
| ProcessOneStep            | 104.135 ms                | 1.870 s                   |
| BlockToStepN              | 1.432 ms                  | 86.043 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:07:20.849299 33780 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 16:07:21.032011 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=1217
W20240204 16:07:21.232672 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=356, pq.top=356
W20240204 16:07:21.873603 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end11
E20240204 16:07:22.032008 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=50608
W20240204 16:07:22.789091 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240204 16:07:22.958045 33780 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240204 16:07:23.032008 34040 parallel_pq_v2.h:79] insert failed, size(hashtable)=33521
E20240204 16:07:23.787950 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=373, sample_step_cpp_seen_[rank]=372
E20240204 16:07:24.032027 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=3919
W20240204 16:07:24.057184 33780 grad_async_v2.h:137] Detect new sample comes, old_end12, new_end10
E20240204 16:07:25.032013 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=215
W20240204 16:07:25.097743 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end10
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.648 ms                  | 273.568 ms                |
| Forward                   | 5.729 ms                  | 12.490 ms                 |
| Backward                  | 5.539 ms                  | 10.089 ms                 |
| Optimize                  | 2.755 ms                  | 8.452 ms                  |
| BarrierTimeBeforeRank0    | 2.057 ms                  | 119.094 ms                |
| AfterBackward             | 104.284 ms                | 1.894 s                   |
| BlockToStepN              | 1.554 ms                  | 86.181 ms                 |
| OneStep                   | 147.341 ms                | 2.075 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 16:07:25.386729 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 368.085 us                | 3.665 ms                  |
| ProcessBack:Shuffle       | 8.795 ms                  | 25.524 ms                 |
| ProcessBack:UpdateCache   | 10.501 ms                 | 16.873 ms                 |
| ProcessBack:UpsertPq      | 31.555 ms                 | 193.877 ms                |
| ProcessOneStep            | 104.396 ms                | 1.893 s                   |
| BlockToStepN              | 1.443 ms                  | 86.043 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 16:07:26.032011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=10228
W20240204 16:07:26.134613 33780 grad_async_v2.h:137] Detect new sample comes, old_end12, new_end3
W20240204 16:07:26.896770 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=385, pq.top=385
E20240204 16:07:27.032011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=65245
W20240204 16:07:27.236568 33780 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240204 16:07:28.032014 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=207
W20240204 16:07:28.238080 33780 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
W20240204 16:07:28.481307 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=395, pq.top=395
E20240204 16:07:29.032513 34027 parallel_pq_v2.h:79] insert failed, size(hashtable)=103696
E20240204 16:07:29.076453 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=399, sample_step_cpp_seen_[rank]=398
W20240204 16:07:29.318343 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240204 16:07:30.032016 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=2084
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.524 ms                  | 273.568 ms                |
| Forward                   | 5.729 ms                  | 12.490 ms                 |
| Backward                  | 5.574 ms                  | 10.525 ms                 |
| Optimize                  | 2.774 ms                  | 8.452 ms                  |
| BarrierTimeBeforeRank0    | 2.058 ms                  | 119.094 ms                |
| AfterBackward             | 104.441 ms                | 1.894 s                   |
| BlockToStepN              | 1.605 ms                  | 86.181 ms                 |
| OneStep                   | 147.499 ms                | 2.075 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 16:07:30.365727 33780 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 496.420 us                | 7.478 ms                  |
| ProcessBack:Shuffle       | 8.830 ms                  | 22.777 ms                 |
| ProcessBack:UpdateCache   | 10.498 ms                 | 16.486 ms                 |
| ProcessBack:UpsertPq      | 31.537 ms                 | 193.877 ms                |
| ProcessOneStep            | 104.396 ms                | 1.893 s                   |
| BlockToStepN              | 1.515 ms                  | 86.043 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 22.811, sample: 1.493, forward: 0.614, backward: 0.620, update: 0.304
[proc 7] 400 steps, total: 22.811, sample: 1.024, forward: 0.586, backward: 0.668, update: 0.275
[proc 1] 400 steps, total: 22.811, sample: 1.400, forward: 0.543, backward: 0.658, update: 0.242
[proc 4] 400 steps, total: 22.811, sample: 1.047, forward: 0.616, backward: 0.663, update: 0.255
[proc 3] 400 steps, total: 22.811, sample: 1.189, forward: 0.593, backward: 0.671, update: 0.259
[proc 2] 400 steps, total: 22.811, sample: 1.212, forward: 0.523, backward: 0.457, update: 0.227
[proc 6] 400 steps, total: 22.812, sample: 1.153, forward: 0.600, backward: 0.608, update: 0.290
[proc 5] 400 steps, total: 22.812, sample: 1.257, forward: 0.575, backward: 0.632, update: 0.261
W20240204 16:07:30.864850 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=401, pq.top=401
E20240204 16:07:31.032011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=2290
W20240204 16:07:31.452526 33780 grad_async_v2.h:137] Detect new sample comes, old_end10, new_end13
W20240204 16:07:31.920775 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=408, pq.top=408
E20240204 16:07:32.032009 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=2389
W20240204 16:07:32.545313 33780 grad_async_v2.h:137] Detect new sample comes, old_end13, new_end7
E20240204 16:07:33.032258 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=128264
W20240204 16:07:33.198570 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240204 16:07:33.650434 33780 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end13
E20240204 16:07:34.032016 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=123533
W20240204 16:07:34.245726 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=423, pq.top=423
E20240204 16:07:34.377501 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=424, sample_step_cpp_seen_[rank]=423
W20240204 16:07:34.660733 33780 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240204 16:07:35.041234 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.480 ms                  | 273.568 ms                |
| Forward                   | 5.729 ms                  | 12.490 ms                 |
| Backward                  | 5.577 ms                  | 10.525 ms                 |
| Optimize                  | 2.764 ms                  | 8.452 ms                  |
| BarrierTimeBeforeRank0    | 2.246 ms                  | 119.094 ms                |
| AfterBackward             | 104.284 ms                | 1.894 s                   |
| BlockToStepN              | 1.655 ms                  | 86.181 ms                 |
| OneStep                   | 147.499 ms                | 2.075 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 483.412 us                | 8.390 ms                  |
| ProcessBack:Shuffle       | 8.842 ms                  | 22.777 ms                 |
| ProcessBack:UpdateCache   | 10.426 ms                 | 16.486 ms                 |
| ProcessBack:UpsertPq      | 31.402 ms                 | 193.877 ms                |
| ProcessOneStep            | 104.248 ms                | 1.893 s                   |
| BlockToStepN              | 1.579 ms                  | 86.043 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:07:35.721014 33780 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240204 16:07:36.041173 34026 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240204 16:07:36.514598 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240204 16:07:36.724234 33780 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end11
E20240204 16:07:37.041015 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=4834
W20240204 16:07:37.757329 33780 grad_async_v2.h:137] Detect new sample comes, old_end10, new_end2
E20240204 16:07:38.041009 34022 parallel_pq_v2.h:79] insert failed, size(hashtable)=63880
W20240204 16:07:38.087715 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240204 16:07:38.796945 33780 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240204 16:07:39.041010 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=174
W20240204 16:07:39.206660 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=445, pq.top=445
E20240204 16:07:39.903987 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=450, sample_step_cpp_seen_[rank]=449
E20240204 16:07:40.041010 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=811
W20240204 16:07:40.048075 33780 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.318 ms                  | 224.668 ms                |
| Forward                   | 5.720 ms                  | 11.628 ms                 |
| Backward                  | 5.575 ms                  | 10.089 ms                 |
| Optimize                  | 2.793 ms                  | 8.439 ms                  |
| BarrierTimeBeforeRank0    | 2.383 ms                  | 74.499 ms                 |
| AfterBackward             | 104.284 ms                | 1.894 s                   |
| BlockToStepN              | 1.757 ms                  | 86.181 ms                 |
| OneStep                   | 148.323 ms                | 2.075 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 745.732 us                | 13.613 ms                 |
| ProcessBack:Shuffle       | 8.851 ms                  | 22.777 ms                 |
| ProcessBack:UpdateCache   | 10.348 ms                 | 15.878 ms                 |
| ProcessBack:UpsertPq      | 30.947 ms                 | 192.823 ms                |
| ProcessOneStep            | 104.248 ms                | 1.893 s                   |
| BlockToStepN              | 1.653 ms                  | 86.043 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 16:07:41.041011 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=12
W20240204 16:07:41.056552 33780 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240204 16:07:41.811987 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=454, pq.top=453
E20240204 16:07:42.041013 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=55351
W20240204 16:07:42.082736 33780 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240204 16:07:43.041008 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=135836
W20240204 16:07:43.179100 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
W20240204 16:07:43.207515 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=463, pq.top=463
E20240204 16:07:44.041332 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=29
W20240204 16:07:44.275612 33780 grad_async_v2.h:137] Detect new sample comes, old_end12, new_end7
W20240204 16:07:44.320469 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=469, pq.top=469
E20240204 16:07:45.041013 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=1784
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.214 ms                  | 224.668 ms                |
| Forward                   | 5.729 ms                  | 11.628 ms                 |
| Backward                  | 5.530 ms                  | 10.089 ms                 |
| Optimize                  | 2.798 ms                  | 8.439 ms                  |
| BarrierTimeBeforeRank0    | 2.510 ms                  | 109.133 ms                |
| AfterBackward             | 104.441 ms                | 1.870 s                   |
| BlockToStepN              | 1.814 ms                  | 95.613 ms                 |
| OneStep                   | 148.927 ms                | 2.004 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 802.076 us                | 14.156 ms                 |
| ProcessBack:Shuffle       | 8.875 ms                  | 22.777 ms                 |
| ProcessBack:UpdateCache   | 10.280 ms                 | 15.829 ms                 |
| ProcessBack:UpsertPq      | 30.947 ms                 | 192.823 ms                |
| ProcessOneStep            | 104.859 ms                | 1.870 s                   |
| BlockToStepN              | 1.700 ms                  | 95.483 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:07:45.579530 33780 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
W20240204 16:07:45.671659 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=479, pq.top=479
E20240204 16:07:45.716689 30756 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=479, sample_step_cpp_seen_[rank]=478
E20240204 16:07:46.041014 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=23531
W20240204 16:07:46.688024 33780 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240204 16:07:47.041013 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=3813
W20240204 16:07:47.533407 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240204 16:07:47.691226 33780 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 16:07:48.041013 27749 parallel_pq_v2.h:79] insert failed, size(hashtable)=977
W20240204 16:07:48.655407 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=487, pq.top=486
W20240204 16:07:48.720572 33780 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end12
E20240204 16:07:49.041023 34044 parallel_pq_v2.h:79] insert failed, size(hashtable)=123556
W20240204 16:07:49.910760 33780 grad_async_v2.h:137] Detect new sample comes, old_end11, new_end5
E20240204 16:07:50.041013 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=326338
W20240204 16:07:50.101908 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=496, pq.top=496
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.146 ms                  | 224.668 ms                |
| Forward                   | 5.743 ms                  | 11.628 ms                 |
| Backward                  | 5.539 ms                  | 10.089 ms                 |
| Optimize                  | 2.800 ms                  | 8.439 ms                  |
| BarrierTimeBeforeRank0    | 2.510 ms                  | 109.133 ms                |
| AfterBackward             | 104.441 ms                | 1.870 s                   |
| BlockToStepN              | 1.844 ms                  | 95.613 ms                 |
| OneStep                   | 148.977 ms                | 2.004 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 748.917 us                | 11.584 ms                 |
| ProcessBack:Shuffle       | 8.894 ms                  | 22.777 ms                 |
| ProcessBack:UpdateCache   | 10.205 ms                 | 15.829 ms                 |
| ProcessBack:UpsertPq      | 30.947 ms                 | 193.877 ms                |
| ProcessOneStep            | 104.859 ms                | 1.870 s                   |
| BlockToStepN              | 1.758 ms                  | 95.483 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 16:07:50.993901 33780 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240204 16:07:51.041007 33780 parallel_pq_v2.h:79] insert failed, size(hashtable)=52424
W20240204 16:07:51.101943 27749 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=499, pq.top=498
[proc 0] 500 steps, total: 20.643, sample: 1.390, forward: 0.628, backward: 0.561, update: 0.314
[proc 3] 500 steps, total: 20.643, sample: 1.306, forward: 0.573, backward: 0.780, update: 0.262
[proc 1] 500 steps, total: 20.643, sample: 1.358, forward: 0.562, backward: 0.719, update: 0.298
Successfully xmh. training takes 114.70781707763672 seconds
[proc 7] 500 steps, total: 20.643, sample: 1.162, forward: 0.550, backward: 0.694, update: 0.248
[proc 2] 500 steps, total: 20.643, sample: 1.214, forward: 0.533, backward: 0.464, update: 0.219
[proc 4] 500 steps, total: 20.643, sample: 1.083, forward: 0.555, backward: 0.711, update: 0.244
[proc 6] 500 steps, total: 20.643, sample: 1.193, forward: 0.543, backward: 0.722, update: 0.232
[proc 5] 500 steps, total: 20.643, sample: 1.324, forward: 0.641, backward: 0.786, update: 0.278
before call kg_cache_controller.StopThreads()
W20240204 16:07:51.332849 27749 grad_async_v2.h:84] call StopThreads. PID = 60904
W20240204 16:07:51.332890 27749 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 16:07:51.333336 27749 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 16:07:51.333348 27749 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240204 16:07:52.013372 33780 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end10
W20240204 16:07:52.035543 27749 grad_async_v2.h:105] StopThreads done.
