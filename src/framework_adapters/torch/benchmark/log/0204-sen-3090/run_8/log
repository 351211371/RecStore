WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 10:18:00.269510 13001 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_114', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=4, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [13001 sampler.py:454] Start PreSampling
WARNING [13001 sampler.py:532] Before construct renumbering_dict
WARNING [13001 sampler.py:555] PreSampling done
W20240204 10:18:05.981942 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 10:18:05.982249 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 10:18:05.982313 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 10:18:05.982376 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 10:18:05.982420 13001 IPCTensor.h:369] NewIPCTensor: step_r0 [4]0x100001e8e000 32 B 
W20240204 10:18:05.982461 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100001e90000 8 B 
W20240204 10:18:05.982502 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100001e92000 8 B 
W20240204 10:18:05.982685 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100001e94000 7.629 MB
W20240204 10:18:05.982736 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100002637000 7.629 MB
W20240204 10:18:05.982798 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100002dda000 7.629 MB
W20240204 10:18:05.982860 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000357d000 7.629 MB
W20240204 10:18:05.982908 13001 IPCTensor.h:369] NewIPCTensor: step_r1 [4]0x100003d20000 32 B 
W20240204 10:18:05.982940 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100003d22000 8 B 
W20240204 10:18:05.982977 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100003d24000 8 B 
W20240204 10:18:05.983052 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100003d26000 7.629 MB
W20240204 10:18:05.983096 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000044c9000 7.629 MB
W20240204 10:18:05.983166 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100004c6c000 7.629 MB
W20240204 10:18:05.983208 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000540f000 7.629 MB
W20240204 10:18:05.983253 13001 IPCTensor.h:369] NewIPCTensor: step_r2 [4]0x100005bb2000 32 B 
W20240204 10:18:05.983285 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x100005bb4000 8 B 
W20240204 10:18:05.983318 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100005bb6000 8 B 
W20240204 10:18:05.983390 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100005bb8000 7.629 MB
W20240204 10:18:05.983433 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000635b000 7.629 MB
W20240204 10:18:05.983497 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100006afe000 7.629 MB
W20240204 10:18:05.983567 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000072a1000 7.629 MB
W20240204 10:18:05.983604 13001 IPCTensor.h:369] NewIPCTensor: step_r3 [4]0x100007a44000 32 B 
W20240204 10:18:05.983635 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x100007a46000 8 B 
W20240204 10:18:05.983668 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100007a48000 8 B 
W20240204 10:18:05.983740 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100007a4a000 7.629 MB
W20240204 10:18:05.983781 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000081ed000 7.629 MB
W20240204 10:18:05.983842 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x100008990000 7.629 MB
W20240204 10:18:05.983881 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x100009133000 7.629 MB
W20240204 10:18:05.983919 13001 IPCTensor.h:369] NewIPCTensor: step_r4 [4]0x1000098d6000 32 B 
W20240204 10:18:05.983950 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000098d8000 8 B 
W20240204 10:18:05.983985 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000098da000 8 B 
W20240204 10:18:05.984071 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000098dc000 7.629 MB
W20240204 10:18:05.984119 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x10000a07f000 7.629 MB
W20240204 10:18:05.984155 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x10000a822000 7.629 MB
W20240204 10:18:05.984191 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x10000afc5000 7.629 MB
W20240204 10:18:05.984226 13001 IPCTensor.h:369] NewIPCTensor: step_r5 [4]0x10000b768000 32 B 
W20240204 10:18:05.984257 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10000b76a000 8 B 
W20240204 10:18:05.984292 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10000b76c000 8 B 
W20240204 10:18:05.984359 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10000b76e000 7.629 MB
W20240204 10:18:05.984414 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10000bf11000 7.629 MB
W20240204 10:18:05.984455 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10000c6b4000 7.629 MB
W20240204 10:18:05.984503 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10000ce57000 7.629 MB
W20240204 10:18:05.984539 13001 IPCTensor.h:369] NewIPCTensor: step_r6 [4]0x10000d5fa000 32 B 
W20240204 10:18:05.984568 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x10000d5fc000 8 B 
W20240204 10:18:05.984599 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10000d5fe000 8 B 
W20240204 10:18:05.984666 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10000d600000 7.629 MB
W20240204 10:18:05.984704 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10000dda3000 7.629 MB
W20240204 10:18:05.984740 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10000e546000 7.629 MB
W20240204 10:18:05.984797 13001 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x10000ece9000 7.629 MB
W20240204 10:18:05.984849 13001 IPCTensor.h:369] NewIPCTensor: step_r7 [4]0x10000f48c000 32 B 
W20240204 10:18:05.984880 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10000f48e000 8 B 
W20240204 10:18:05.984920 13001 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10000f490000 8 B 
W20240204 10:18:06.239874 13001 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x10000f492000 22.81 MB
W20240204 10:18:06.331979 13001 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100010b64000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 748, 1147, 1739,  ..., 4911, 8923, 8387]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 6.163 seconds
[Rank1] pid = 13620
[Rank2] pid = 13650
[Rank3] pid = 13749
[Rank4] pid = 13750
[Rank5] pid = 13830
[Rank6] pid = 13880
INFO [13001 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [13620 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [13650 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [13749 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [13750 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [13830 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [13001 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14012 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [13880 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [13750 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [13650 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [13880 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [13830 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14012 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [13620 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [13749 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:18:09.083261 14013 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 10:18:09.087524 13751 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 10:18:09.087514 13881 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240204 10:18:09.087582 13882 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 10:18:09.087525 13621 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 10:18:09.087721 13685 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240204 10:18:09.087721 14082 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240204 10:18:09.087744 13816 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240204 10:18:09.123157 13882 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100010b7a000 7.629 MB
W20240204 10:18:09.123286 13881 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10001131d000 7.629 MB
W20240204 10:18:09.123339 13751 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100011ac0000 7.629 MB
W20240204 10:18:09.123472 13882 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x100012263000 7.629 MB
W20240204 10:18:09.123560 13882 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x100012a06000 1.49 GB
W20240204 10:18:09.123625 13882 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x100071fe9000 1.49 GB
W20240204 10:18:09.123714 13882 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:18:09.125618 14013 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1000d15d4000 7.629 MB
W20240204 10:18:09.125671 13816 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1000d1d77000 7.629 MB
W20240204 10:18:09.125722 14082 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1000d2cbf000 7.629 MB
W20240204 10:18:09.125720 13685 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1000d251c000 7.629 MB
W20240204 10:18:09.125804 14013 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000d3464000 7.629 MB
W20240204 10:18:09.125838 13882 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:18:09.125845 13816 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1000d3c07000 7.629 MB
W20240204 10:18:09.125906 14013 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1000d43aa000 1.49 GB
W20240204 10:18:09.125945 14082 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10013398d000 7.629 MB
W20240204 10:18:09.125952 13685 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100134130000 7.629 MB
W20240204 10:18:09.125969 14013 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1001348d3000 1.49 GB
W20240204 10:18:09.125998 13881 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100193eb6000 7.629 MB
W20240204 10:18:09.126008 13751 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100194659000 7.629 MB
W20240204 10:18:09.127403 14013 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:18:09.127405 13881 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x100194dfc000 1.49 GB
W20240204 10:18:09.127434 14082 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1001f43df000 1.49 GB
W20240204 10:18:09.127446 13685 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1002539c2000 1.49 GB
W20240204 10:18:09.127534 14082 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1002b2fa5000 1.49 GB
W20240204 10:18:09.127542 13685 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x100312588000 1.49 GB
W20240204 10:18:09.127552 13881 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x100371b6b000 1.49 GB
W20240204 10:18:09.127596 13621 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1003d114e000 7.629 MB
W20240204 10:18:09.127638 13751 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1003d18f1000 1.49 GB
W20240204 10:18:09.127655 13685 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:18:09.127703 13751 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100430ed4000 1.49 GB
W20240204 10:18:09.127728 13816 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1004904b7000 1.49 GB
W20240204 10:18:09.127765 13751 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:18:09.127835 13816 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1004efa9a000 1.49 GB
W20240204 10:18:09.127894 13816 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:18:09.129485 13621 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10054f07f000 7.629 MB
W20240204 10:18:09.129601 13621 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10054f822000 1.49 GB
W20240204 10:18:09.129727 13621 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1005aee05000 1.49 GB
W20240204 10:18:09.129786 13621 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:18:09.132921 13881 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:18:09.132956 14082 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:18:09.140918 14013 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:18:09.141050 13751 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:18:09.141053 13685 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:18:09.141104 13816 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:18:09.141104 13621 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:18:09.141258 13881 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:18:09.143047 14082 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
cudaHostRegister 0x10000f492000
3: KnownLocalCachedEmbedding init done
WARNING [13749 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
1: KnownLocalCachedEmbedding init done
WARNING [13620 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
5: KnownLocalCachedEmbedding init done
WARNING [13830 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
6: KnownLocalCachedEmbedding init done
WARNING [13880 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
4: KnownLocalCachedEmbedding init done
WARNING [13750 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 14012
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x10000f492000
0: KnownLocalCachedEmbedding init done
WARNING [13001 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
7: KnownLocalCachedEmbedding init done
WARNING [14012 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
2: KnownLocalCachedEmbedding init done
WARNING [13650 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 10:18:11.779225 13685 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 10:18:11.779615 13881 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:18:11.779793 13751 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:18:11.780009 14013 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:18:11.780294 13621 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:18:11.780390 14082 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:18:11.780474 13882 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:18:11.781031 13816 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 10:18:11.783986 14013 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 4,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 10:18:11.784343 14013 grad_base.h:184] Init GradProcessingBase done
I20240204 10:18:11.790627 14013 grad_async_v1.h:203] Use main thread to update emb.
W20240204 10:18:11.790724 14013 kg_controller.h:75] after init GradAsyncProcessing
I20240204 10:18:11.790745 14013 kg_controller.h:84] Construct KGCacheController done
E20240204 10:18:13.581696 13621 recstore.cc:66] init folly done
E20240204 10:18:13.581881 13816 recstore.cc:66] init folly done
E20240204 10:18:13.581938 14082 recstore.cc:66] init folly done
E20240204 10:18:13.582165 13685 recstore.cc:66] init folly done
E20240204 10:18:13.582165 13882 recstore.cc:66] init folly done
E20240204 10:18:13.582325 13751 recstore.cc:66] init folly done
E20240204 10:18:13.584831 14013 recstore.cc:66] init folly done
E20240204 10:18:13.584703 13881 recstore.cc:66] init folly done
I20240204 10:18:13.586305 14013 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 10:18:14.371042 14013 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 10:18:14.383076 13751 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:18:14.383437 14082 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:18:14.386963 13621 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:18:14.387405 13816 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:18:14.388728 13685 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:18:14.389438 13881 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:18:14.395601 13882 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 828.170 us                | 828.170 us                |
| Forward                   | 660.318 ms                | 660.318 ms                |
| Backward                  | 226.215 ms                | 226.215 ms                |
| Optimize                  | 2.659 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 18.053 ms                 | 18.053 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:17.020565 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240204 10:18:17.111183 14013 grad_async_v1.h:533] Stalled in ProcessBackward: rank=7, step_no=1, sample_step_cpp_seen_[rank]=0
W20240204 10:18:18.020085 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.361 ms                  | 505.575 ms                |
| ProcessBack:UpdateCache   | 10.352 ms                 | 932.654 ms                |
| ProcessBack:UpsertPq      | 13.876 ms                 | 19.143 ms                 |
| ProcessOneStep            | 34.969 ms                 | 1.714 s                   |
| BlockToStepN              | 54.004 ms                 | 297.371 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:19.020025 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=12, pq.top=12
W20240204 10:18:20.020053 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=14, pq.top=14
W20240204 10:18:21.020020 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=16, pq.top=16
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.953 ms                  | 23.603 ms                 |
| Forward                   | 6.718 ms                  | 660.318 ms                |
| Backward                  | 5.179 ms                  | 226.215 ms                |
| Optimize                  | 2.209 ms                  | 4.012 ms                  |
| BarrierTimeBeforeRank0    | 3.625 ms                  | 18.053 ms                 |
| AfterBackward             | 34.739 ms                 | 1.715 s                   |
| BlockToStepN              | 140.838 ms                | 497.941 ms                |
| OneStep                   | 250.436 ms                | 2.650 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:22.020012 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=18, pq.top=18
W20240204 10:18:23.020020 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=20, pq.top=20
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.450 ms                  | 505.575 ms                |
| ProcessBack:UpdateCache   | 10.352 ms                 | 932.654 ms                |
| ProcessBack:UpsertPq      | 11.517 ms                 | 19.143 ms                 |
| ProcessOneStep            | 31.556 ms                 | 1.714 s                   |
| BlockToStepN              | 237.728 ms                | 542.122 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:24.020006 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240204 10:18:25.020013 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240204 10:18:26.020017 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.339 ms                  | 23.603 ms                 |
| Forward                   | 5.957 ms                  | 660.318 ms                |
| Backward                  | 5.179 ms                  | 226.215 ms                |
| Optimize                  | 1.872 ms                  | 4.012 ms                  |
| BarrierTimeBeforeRank0    | 2.393 ms                  | 18.053 ms                 |
| AfterBackward             | 30.810 ms                 | 1.715 s                   |
| BlockToStepN              | 376.489 ms                | 542.251 ms                |
| OneStep                   | 493.895 ms                | 2.650 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:27.020009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240204 10:18:28.070519 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.317 ms                  | 453.645 ms                |
| ProcessBack:UpdateCache   | 10.352 ms                 | 929.407 ms                |
| ProcessBack:UpsertPq      | 10.815 ms                 | 18.517 ms                 |
| ProcessOneStep            | 30.501 ms                 | 1.714 s                   |
| BlockToStepN              | 448.149 ms                | 552.658 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:29.070029 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=30, pq.top=30
W20240204 10:18:30.070008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=32, pq.top=32
W20240204 10:18:31.070011 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=34, pq.top=34
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.339 ms                  | 23.603 ms                 |
| Forward                   | 5.749 ms                  | 660.318 ms                |
| Backward                  | 5.087 ms                  | 226.215 ms                |
| Optimize                  | 1.872 ms                  | 4.012 ms                  |
| BarrierTimeBeforeRank0    | 3.197 ms                  | 18.053 ms                 |
| AfterBackward             | 30.342 ms                 | 1.715 s                   |
| BlockToStepN              | 470.934 ms                | 578.633 ms                |
| OneStep                   | 537.251 ms                | 2.650 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:32.070008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240204 10:18:33.070027 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.258 ms                  | 453.645 ms                |
| ProcessBack:UpdateCache   | 10.348 ms                 | 929.407 ms                |
| ProcessBack:UpsertPq      | 10.548 ms                 | 18.517 ms                 |
| ProcessOneStep            | 29.834 ms                 | 1.714 s                   |
| BlockToStepN              | 486.771 ms                | 585.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:34.070009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240204 10:18:35.070008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=40, pq.top=40
W20240204 10:18:36.070009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=42, pq.top=42
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.978 ms                  | 23.603 ms                 |
| Forward                   | 5.439 ms                  | 660.318 ms                |
| Backward                  | 7.375 ms                  | 226.215 ms                |
| Optimize                  | 1.808 ms                  | 4.012 ms                  |
| BarrierTimeBeforeRank0    | 2.393 ms                  | 18.053 ms                 |
| AfterBackward             | 29.856 ms                 | 1.715 s                   |
| BlockToStepN              | 501.390 ms                | 585.967 ms                |
| OneStep                   | 559.236 ms                | 2.650 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:37.070020 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=44, pq.top=44
W20240204 10:18:38.070008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=46, pq.top=46
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.258 ms                  | 453.645 ms                |
| ProcessBack:UpdateCache   | 10.327 ms                 | 929.407 ms                |
| ProcessBack:UpsertPq      | 10.395 ms                 | 18.517 ms                 |
| ProcessOneStep            | 29.828 ms                 | 1.714 s                   |
| BlockToStepN              | 502.487 ms                | 585.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:39.070008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240204 10:18:40.070009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240204 10:18:41.070021 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.887 ms                  | 23.209 ms                 |
| Forward                   | 5.275 ms                  | 16.130 ms                 |
| Backward                  | 8.491 ms                  | 10.720 ms                 |
| Optimize                  | 1.806 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 1.773 ms                  | 12.237 ms                 |
| AfterBackward             | 29.702 ms                 | 96.686 ms                 |
| BlockToStepN              | 516.765 ms                | 578.633 ms                |
| OneStep                   | 566.104 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:42.070008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=52, pq.top=52
W20240204 10:18:43.070009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=54, pq.top=54
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.220 ms                  | 453.645 ms                |
| ProcessBack:UpdateCache   | 10.266 ms                 | 929.407 ms                |
| ProcessBack:UpsertPq      | 10.268 ms                 | 18.517 ms                 |
| ProcessOneStep            | 29.670 ms                 | 96.628 ms                 |
| BlockToStepN              | 517.501 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:44.070008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240204 10:18:45.070017 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240204 10:18:46.070017 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.850 ms                  | 23.209 ms                 |
| Forward                   | 5.222 ms                  | 16.130 ms                 |
| Backward                  | 8.576 ms                  | 10.720 ms                 |
| Optimize                  | 1.799 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 1.098 ms                  | 12.237 ms                 |
| AfterBackward             | 29.656 ms                 | 96.686 ms                 |
| BlockToStepN              | 519.526 ms                | 578.633 ms                |
| OneStep                   | 570.419 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:47.070010 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240204 10:18:48.091724 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.244 ms                  | 453.645 ms                |
| ProcessBack:UpdateCache   | 10.079 ms                 | 929.407 ms                |
| ProcessBack:UpsertPq      | 10.150 ms                 | 18.517 ms                 |
| ProcessOneStep            | 29.628 ms                 | 96.628 ms                 |
| BlockToStepN              | 519.527 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:49.091010 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=64, pq.top=64
W20240204 10:18:50.091025 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=66, pq.top=66
W20240204 10:18:51.091010 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=68, pq.top=68
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.820 ms                  | 23.209 ms                 |
| Forward                   | 5.147 ms                  | 16.130 ms                 |
| Backward                  | 8.646 ms                  | 10.720 ms                 |
| Optimize                  | 1.799 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 791.172 us                | 12.237 ms                 |
| AfterBackward             | 29.615 ms                 | 96.686 ms                 |
| BlockToStepN              | 520.153 ms                | 578.633 ms                |
| OneStep                   | 570.970 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:52.107141 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=70, pq.top=70
W20240204 10:18:53.107008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.251 ms                  | 453.645 ms                |
| ProcessBack:UpdateCache   | 9.975 ms                  | 929.407 ms                |
| ProcessBack:UpsertPq      | 10.082 ms                 | 18.517 ms                 |
| ProcessOneStep            | 29.553 ms                 | 96.628 ms                 |
| BlockToStepN              | 521.288 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:54.107010 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240204 10:18:55.107021 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240204 10:18:56.107015 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=76, pq.top=76
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.554 ms                  | 23.209 ms                 |
| Forward                   | 5.096 ms                  | 16.130 ms                 |
| Backward                  | 8.646 ms                  | 10.720 ms                 |
| Optimize                  | 1.804 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 379.184 us                | 12.237 ms                 |
| AfterBackward             | 29.338 ms                 | 96.686 ms                 |
| BlockToStepN              | 522.279 ms                | 578.633 ms                |
| OneStep                   | 573.431 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:57.107007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=78, pq.top=78
W20240204 10:18:58.107009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=80, pq.top=80
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.258 ms                  | 11.621 ms                 |
| ProcessBack:UpdateCache   | 9.861 ms                  | 15.565 ms                 |
| ProcessBack:UpsertPq      | 10.032 ms                 | 17.649 ms                 |
| ProcessOneStep            | 29.250 ms                 | 96.628 ms                 |
| BlockToStepN              | 522.711 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:18:59.107018 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=82, pq.top=82
W20240204 10:19:00.107009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240204 10:19:01.107008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.397 ms                  | 23.209 ms                 |
| Forward                   | 5.073 ms                  | 16.130 ms                 |
| Backward                  | 8.656 ms                  | 10.720 ms                 |
| Optimize                  | 1.799 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 73.914 us                 | 12.237 ms                 |
| AfterBackward             | 29.269 ms                 | 96.686 ms                 |
| BlockToStepN              | 524.606 ms                | 578.633 ms                |
| OneStep                   | 573.566 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:02.107009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240204 10:19:03.107013 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=88, pq.top=88
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.258 ms                  | 11.621 ms                 |
| ProcessBack:UpdateCache   | 9.724 ms                  | 15.565 ms                 |
| ProcessBack:UpsertPq      | 9.959 ms                  | 17.649 ms                 |
| ProcessOneStep            | 29.237 ms                 | 96.628 ms                 |
| BlockToStepN              | 524.509 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:04.107014 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=90, pq.top=90
W20240204 10:19:05.107018 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=92, pq.top=92
W20240204 10:19:06.130879 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=94, pq.top=94
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.392 ms                  | 23.209 ms                 |
| Forward                   | 4.996 ms                  | 16.130 ms                 |
| Backward                  | 8.693 ms                  | 10.720 ms                 |
| Optimize                  | 1.799 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 73.914 us                 | 12.237 ms                 |
| AfterBackward             | 29.269 ms                 | 96.686 ms                 |
| BlockToStepN              | 524.831 ms                | 578.633 ms                |
| OneStep                   | 574.078 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:07.130013 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240204 10:19:08.130017 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.271 ms                  | 11.621 ms                 |
| ProcessBack:UpdateCache   | 9.672 ms                  | 15.565 ms                 |
| ProcessBack:UpsertPq      | 9.943 ms                  | 17.649 ms                 |
| ProcessOneStep            | 29.180 ms                 | 96.628 ms                 |
| BlockToStepN              | 524.754 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:09.130009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 55.671, sample: 0.355, forward: 1.102, backward: 1.028, update: 0.183
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 55.669, sample: 0.355, forward: 1.093, backward: 0.707, update: 0.189
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 55.670, sample: 0.335, forward: 1.077, backward: 1.169, update: 0.191
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 55.663, sample: 0.368, forward: 1.093, backward: 0.706, update: 0.185
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 55.675, sample: 0.346, forward: 1.112, backward: 1.161, update: 0.185
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 55.675, sample: 0.322, forward: 1.046, backward: 0.663, update: 0.175
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 55.671, sample: 0.369, forward: 1.102, backward: 1.000, update: 0.187
train_sampler.Prefill()
-------Step 0-------
tensor([ 1392,    91,  3873,  3776, 11326, 13730,  1152,   440, 13763, 10259]) tensor([ 1739,  5198,  3291, 10527, 12460,  1055,   566,  5872,   498,  6841])
-------Step 1-------
tensor([ 1392,    91,  3873,  3776, 11326, 13730,  1152,   440, 13763, 10259]) tensor([ 4474, 11044, 14665,  1534,  1058,  8675, 13969, 10809,  5535,  7046])
-------Step 2-------
tensor([ 4107,  9734,  6346,  4541, 10174,  9612, 11487,    66, 11890,   947]) tensor([ 3893,  5023,  2299,  8701,  6061,  9702, 13101, 10615, 13237,  9322])
-------Step 3-------
tensor([ 4107,  9734,  6346,  4541, 10174,  9612, 11487,    66, 11890,   947]) tensor([ 8723,  6922,  8646, 12101,  8132,   711,  6267,  2383, 11461,  2108])
before start barrier
start train
[proc 0] 100 steps, total: 55.687, sample: 0.473, forward: 1.200, backward: 0.997, update: 0.187
W20240204 10:19:10.130007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240204 10:19:11.130008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=102, pq.top=102
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.269 ms                  | 23.209 ms                 |
| Forward                   | 4.981 ms                  | 16.130 ms                 |
| Backward                  | 8.748 ms                  | 10.720 ms                 |
| Optimize                  | 1.798 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 60.403 us                 | 12.237 ms                 |
| AfterBackward             | 29.191 ms                 | 96.686 ms                 |
| BlockToStepN              | 524.606 ms                | 578.633 ms                |
| OneStep                   | 573.431 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:12.130014 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240204 10:19:13.130017 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=106, pq.top=106
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.271 ms                  | 11.621 ms                 |
| ProcessBack:UpdateCache   | 9.628 ms                  | 15.565 ms                 |
| ProcessBack:UpsertPq      | 9.943 ms                  | 17.649 ms                 |
| ProcessOneStep            | 29.128 ms                 | 96.628 ms                 |
| BlockToStepN              | 524.524 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:14.130009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240204 10:19:15.130008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240204 10:19:16.130013 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.375 ms                  | 23.209 ms                 |
| Forward                   | 4.981 ms                  | 16.130 ms                 |
| Backward                  | 8.748 ms                  | 10.720 ms                 |
| Optimize                  | 1.794 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 50.558 us                 | 12.237 ms                 |
| AfterBackward             | 29.153 ms                 | 96.686 ms                 |
| BlockToStepN              | 524.831 ms                | 578.633 ms                |
| OneStep                   | 573.690 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:17.130012 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240204 10:19:18.130009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=114, pq.top=114
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.258 ms                  | 11.621 ms                 |
| ProcessBack:UpdateCache   | 9.651 ms                  | 15.565 ms                 |
| ProcessBack:UpsertPq      | 9.944 ms                  | 17.649 ms                 |
| ProcessOneStep            | 29.128 ms                 | 96.628 ms                 |
| BlockToStepN              | 524.547 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:19.130007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240204 10:19:20.130015 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=118, pq.top=118
W20240204 10:19:21.130016 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=120, pq.top=120
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.313 ms                  | 23.209 ms                 |
| Forward                   | 4.996 ms                  | 16.130 ms                 |
| Backward                  | 8.748 ms                  | 10.720 ms                 |
| Optimize                  | 1.794 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 50.558 us                 | 12.237 ms                 |
| AfterBackward             | 29.153 ms                 | 96.686 ms                 |
| BlockToStepN              | 525.272 ms                | 584.332 ms                |
| OneStep                   | 574.078 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:22.130012 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240204 10:19:23.130009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.273 ms                  | 11.621 ms                 |
| ProcessBack:UpdateCache   | 9.638 ms                  | 15.565 ms                 |
| ProcessBack:UpsertPq      | 9.943 ms                  | 17.649 ms                 |
| ProcessOneStep            | 29.090 ms                 | 96.628 ms                 |
| BlockToStepN              | 524.754 ms                | 584.229 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:24.130007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240204 10:19:25.170722 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240204 10:19:26.170007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=128, pq.top=128
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.313 ms                  | 23.209 ms                 |
| Forward                   | 4.987 ms                  | 16.130 ms                 |
| Backward                  | 8.759 ms                  | 10.720 ms                 |
| Optimize                  | 1.789 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 46.409 us                 | 12.237 ms                 |
| AfterBackward             | 29.117 ms                 | 96.686 ms                 |
| BlockToStepN              | 524.634 ms                | 584.332 ms                |
| OneStep                   | 573.690 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:27.170010 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240204 10:19:28.170007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=132, pq.top=132
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.284 ms                  | 11.389 ms                 |
| ProcessBack:UpdateCache   | 9.617 ms                  | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.926 ms                  | 17.123 ms                 |
| ProcessOneStep            | 29.090 ms                 | 96.628 ms                 |
| BlockToStepN              | 524.524 ms                | 584.229 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:29.170010 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=134, pq.top=134
W20240204 10:19:30.170019 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240204 10:19:31.170013 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.244 ms                  | 23.209 ms                 |
| Forward                   | 4.979 ms                  | 16.130 ms                 |
| Backward                  | 8.760 ms                  | 10.720 ms                 |
| Optimize                  | 1.786 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 41.441 us                 | 12.237 ms                 |
| AfterBackward             | 29.039 ms                 | 96.686 ms                 |
| BlockToStepN              | 524.634 ms                | 584.332 ms                |
| OneStep                   | 573.690 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:32.170008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240204 10:19:33.213321 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.284 ms                  | 11.389 ms                 |
| ProcessBack:UpdateCache   | 9.596 ms                  | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.926 ms                  | 17.123 ms                 |
| ProcessOneStep            | 29.006 ms                 | 96.628 ms                 |
| BlockToStepN              | 524.547 ms                | 584.229 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:34.213016 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=142, pq.top=142
W20240204 10:19:35.213021 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=144, pq.top=144
W20240204 10:19:36.213008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=146, pq.top=146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.276 ms                  | 23.603 ms                 |
| Forward                   | 4.981 ms                  | 16.130 ms                 |
| Backward                  | 8.772 ms                  | 10.720 ms                 |
| Optimize                  | 1.793 ms                  | 3.714 ms                  |
| BarrierTimeBeforeRank0    | 41.376 us                 | 15.549 ms                 |
| AfterBackward             | 29.073 ms                 | 96.686 ms                 |
| BlockToStepN              | 524.634 ms                | 584.332 ms                |
| OneStep                   | 574.078 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:37.230643 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=148, pq.top=148
W20240204 10:19:38.230022 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.280 ms                  | 11.389 ms                 |
| ProcessBack:UpdateCache   | 9.623 ms                  | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.934 ms                  | 17.123 ms                 |
| ProcessOneStep            | 29.006 ms                 | 96.628 ms                 |
| BlockToStepN              | 524.547 ms                | 584.229 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:39.230010 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240204 10:19:40.230007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240204 10:19:41.257575 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.244 ms                  | 23.209 ms                 |
| Forward                   | 4.979 ms                  | 12.144 ms                 |
| Backward                  | 8.777 ms                  | 10.708 ms                 |
| Optimize                  | 1.789 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 38.680 us                 | 15.179 ms                 |
| AfterBackward             | 29.117 ms                 | 48.378 ms                 |
| BlockToStepN              | 525.175 ms                | 583.261 ms                |
| OneStep                   | 574.078 ms                | 632.872 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:42.257025 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
W20240204 10:19:43.257014 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=158, pq.top=158
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.288 ms                  | 11.389 ms                 |
| ProcessBack:UpdateCache   | 9.617 ms                  | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.934 ms                  | 17.123 ms                 |
| ProcessOneStep            | 29.162 ms                 | 48.298 ms                 |
| BlockToStepN              | 524.547 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:44.257006 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240204 10:19:45.269752 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=162, pq.top=162
W20240204 10:19:46.269023 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.269 ms                  | 23.209 ms                 |
| Forward                   | 4.987 ms                  | 12.144 ms                 |
| Backward                  | 8.792 ms                  | 10.708 ms                 |
| Optimize                  | 1.778 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 37.368 us                 | 15.549 ms                 |
| AfterBackward             | 29.153 ms                 | 48.378 ms                 |
| BlockToStepN              | 524.606 ms                | 583.261 ms                |
| OneStep                   | 573.690 ms                | 632.872 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:47.269007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240204 10:19:48.269011 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.284 ms                  | 11.389 ms                 |
| ProcessBack:UpdateCache   | 9.617 ms                  | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.928 ms                  | 17.123 ms                 |
| ProcessOneStep            | 29.162 ms                 | 48.298 ms                 |
| BlockToStepN              | 524.321 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:49.269011 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240204 10:19:50.269008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=170, pq.top=170
W20240204 10:19:51.269007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=172, pq.top=172
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.276 ms                  | 23.209 ms                 |
| Forward                   | 4.987 ms                  | 12.144 ms                 |
| Backward                  | 8.799 ms                  | 10.720 ms                 |
| Optimize                  | 1.778 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 37.368 us                 | 15.549 ms                 |
| AfterBackward             | 29.207 ms                 | 48.378 ms                 |
| BlockToStepN              | 524.383 ms                | 583.261 ms                |
| OneStep                   | 573.690 ms                | 632.872 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:52.269021 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=174, pq.top=174
W20240204 10:19:53.269006 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=176
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.275 ms                  | 10.862 ms                 |
| ProcessBack:UpdateCache   | 9.639 ms                  | 13.542 ms                 |
| ProcessBack:UpsertPq      | 9.938 ms                  | 16.025 ms                 |
| ProcessOneStep            | 29.180 ms                 | 48.298 ms                 |
| BlockToStepN              | 524.269 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:54.269009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240204 10:19:55.269008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240204 10:19:56.269014 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.290 ms                  | 23.209 ms                 |
| Forward                   | 4.987 ms                  | 12.144 ms                 |
| Backward                  | 8.777 ms                  | 10.720 ms                 |
| Optimize                  | 1.773 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 41.076 us                 | 18.844 ms                 |
| AfterBackward             | 29.157 ms                 | 48.378 ms                 |
| BlockToStepN              | 523.927 ms                | 583.261 ms                |
| OneStep                   | 572.684 ms                | 632.872 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:57.269013 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240204 10:19:58.269014 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.251 ms                  | 10.862 ms                 |
| ProcessBack:UpdateCache   | 9.724 ms                  | 13.542 ms                 |
| ProcessBack:UpsertPq      | 9.940 ms                  | 16.025 ms                 |
| ProcessOneStep            | 29.128 ms                 | 48.298 ms                 |
| BlockToStepN              | 523.577 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:19:59.269007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=186, pq.top=186
W20240204 10:20:00.269008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240204 10:20:01.291584 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=190, pq.top=190
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.313 ms                  | 23.209 ms                 |
| Forward                   | 4.979 ms                  | 12.144 ms                 |
| Backward                  | 8.762 ms                  | 10.720 ms                 |
| Optimize                  | 1.773 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 43.350 us                 | 18.844 ms                 |
| AfterBackward             | 29.157 ms                 | 48.378 ms                 |
| BlockToStepN              | 523.772 ms                | 583.261 ms                |
| OneStep                   | 572.603 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:02.291014 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240204 10:20:03.291007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.251 ms                  | 11.389 ms                 |
| ProcessBack:UpdateCache   | 9.735 ms                  | 13.542 ms                 |
| ProcessBack:UpsertPq      | 9.938 ms                  | 17.123 ms                 |
| ProcessOneStep            | 29.180 ms                 | 48.298 ms                 |
| BlockToStepN              | 524.127 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:04.291007 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240204 10:20:05.291008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240204 10:20:06.291013 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=198
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.304 ms                  | 23.209 ms                 |
| Forward                   | 4.981 ms                  | 12.144 ms                 |
| Backward                  | 8.764 ms                  | 12.447 ms                 |
| Optimize                  | 1.771 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 46.409 us                 | 18.844 ms                 |
| AfterBackward             | 29.240 ms                 | 48.378 ms                 |
| BlockToStepN              | 524.334 ms                | 583.261 ms                |
| OneStep                   | 573.566 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:07.291013 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=200, pq.top=200
[proc 7] 200 steps, total: 57.599, sample: 0.300, forward: 0.415, backward: 0.473, update: 0.177
[proc 3] 200 steps, total: 57.599, sample: 0.332, forward: 0.446, backward: 0.535, update: 0.174
[proc 5] 200 steps, total: 57.599, sample: 0.350, forward: 0.441, backward: 0.419, update: 0.175
[proc 1] 200 steps, total: 57.599, sample: 0.317, forward: 0.429, backward: 0.841, update: 0.174
[proc 6] 200 steps, total: 57.599, sample: 0.318, forward: 0.442, backward: 0.483, update: 0.173
[proc 0] 200 steps, total: 57.599, sample: 0.438, forward: 0.486, backward: 0.792, update: 0.175
[proc 4] 200 steps, total: 57.599, sample: 0.352, forward: 0.447, backward: 0.611, update: 0.178
[proc 2] 200 steps, total: 57.599, sample: 0.320, forward: 0.405, backward: 0.892, update: 0.171
W20240204 10:20:08.297573 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=202, pq.top=202
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.234 ms                  | 11.389 ms                 |
| ProcessBack:UpdateCache   | 9.789 ms                  | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.938 ms                  | 17.123 ms                 |
| ProcessOneStep            | 29.180 ms                 | 48.298 ms                 |
| BlockToStepN              | 524.127 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:09.297008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240204 10:20:10.297008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240204 10:20:11.297020 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.290 ms                  | 23.209 ms                 |
| Forward                   | 4.978 ms                  | 12.144 ms                 |
| Backward                  | 8.764 ms                  | 12.447 ms                 |
| Optimize                  | 1.771 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 46.409 us                 | 18.844 ms                 |
| AfterBackward             | 29.241 ms                 | 48.378 ms                 |
| BlockToStepN              | 524.263 ms                | 583.261 ms                |
| OneStep                   | 573.690 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:12.297019 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=208, pq.top=208
W20240204 10:20:13.297009 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=210, pq.top=210
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.236 ms                  | 11.389 ms                 |
| ProcessBack:UpdateCache   | 9.835 ms                  | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.943 ms                  | 17.123 ms                 |
| ProcessOneStep            | 29.214 ms                 | 48.298 ms                 |
| BlockToStepN              | 523.577 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:14.297008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240204 10:20:15.297012 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240204 10:20:16.297024 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.276 ms                  | 23.209 ms                 |
| Forward                   | 4.978 ms                  | 12.144 ms                 |
| Backward                  | 8.762 ms                  | 12.447 ms                 |
| Optimize                  | 1.768 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 50.085 us                 | 18.844 ms                 |
| AfterBackward             | 29.241 ms                 | 48.378 ms                 |
| BlockToStepN              | 524.263 ms                | 583.261 ms                |
| OneStep                   | 573.947 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:17.297013 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240204 10:20:18.297008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.220 ms                  | 11.389 ms                 |
| ProcessBack:UpdateCache   | 9.861 ms                  | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.944 ms                  | 17.123 ms                 |
| ProcessOneStep            | 29.226 ms                 | 48.298 ms                 |
| BlockToStepN              | 523.699 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:19.297008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
W20240204 10:20:20.297014 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240204 10:20:21.297019 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=224, pq.top=224
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.304 ms                  | 23.209 ms                 |
| Forward                   | 4.978 ms                  | 12.144 ms                 |
| Backward                  | 8.760 ms                  | 12.447 ms                 |
| Optimize                  | 1.766 ms                  | 3.223 ms                  |
| BarrierTimeBeforeRank0    | 50.558 us                 | 18.844 ms                 |
| AfterBackward             | 29.255 ms                 | 48.378 ms                 |
| BlockToStepN              | 523.927 ms                | 583.261 ms                |
| OneStep                   | 573.947 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:22.297006 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=226, pq.top=226
W20240204 10:20:23.343487 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.211 ms                  | 10.862 ms                 |
| ProcessBack:UpdateCache   | 9.869 ms                  | 13.542 ms                 |
| ProcessBack:UpsertPq      | 9.951 ms                  | 16.025 ms                 |
| ProcessOneStep            | 29.226 ms                 | 48.298 ms                 |
| BlockToStepN              | 523.577 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:24.343019 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240204 10:20:25.343008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240204 10:20:26.343008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.276 ms                  | 23.209 ms                 |
| Forward                   | 4.965 ms                  | 12.144 ms                 |
| Backward                  | 8.719 ms                  | 12.447 ms                 |
| Optimize                  | 1.765 ms                  | 3.223 ms                  |
| BarrierTimeBeforeRank0    | 60.403 us                 | 20.338 ms                 |
| AfterBackward             | 29.240 ms                 | 48.378 ms                 |
| BlockToStepN              | 523.681 ms                | 583.261 ms                |
| OneStep                   | 573.922 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:27.343006 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240204 10:20:28.343015 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.193 ms                  | 10.862 ms                 |
| ProcessBack:UpdateCache   | 9.904 ms                  | 13.542 ms                 |
| ProcessBack:UpsertPq      | 9.951 ms                  | 16.025 ms                 |
| ProcessOneStep            | 29.212 ms                 | 48.298 ms                 |
| BlockToStepN              | 523.510 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:29.343011 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240204 10:20:30.343008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
W20240204 10:20:31.343005 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.276 ms                  | 23.209 ms                 |
| Forward                   | 4.956 ms                  | 12.144 ms                 |
| Backward                  | 8.693 ms                  | 12.447 ms                 |
| Optimize                  | 1.762 ms                  | 3.223 ms                  |
| BarrierTimeBeforeRank0    | 72.743 us                 | 20.338 ms                 |
| AfterBackward             | 29.207 ms                 | 48.378 ms                 |
| BlockToStepN              | 523.681 ms                | 583.261 ms                |
| OneStep                   | 573.690 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:32.343014 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240204 10:20:33.343019 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.172 ms                  | 10.862 ms                 |
| ProcessBack:UpdateCache   | 9.904 ms                  | 13.542 ms                 |
| ProcessBack:UpsertPq      | 9.951 ms                  | 16.025 ms                 |
| ProcessOneStep            | 29.162 ms                 | 48.298 ms                 |
| BlockToStepN              | 523.570 ms                | 583.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:34.343014 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240204 10:20:35.343005 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240204 10:20:36.343008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.276 ms                  | 23.152 ms                 |
| Forward                   | 4.950 ms                  | 11.941 ms                 |
| Backward                  | 8.693 ms                  | 10.972 ms                 |
| Optimize                  | 1.765 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 152.784 us                | 18.929 ms                 |
| AfterBackward             | 29.207 ms                 | 40.739 ms                 |
| BlockToStepN              | 523.382 ms                | 583.261 ms                |
| OneStep                   | 573.431 ms                | 633.614 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:37.343012 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=252, pq.top=252
W20240204 10:20:38.343016 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=254, pq.top=254
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.165 ms                  | 10.862 ms                 |
| ProcessBack:UpdateCache   | 9.904 ms                  | 13.542 ms                 |
| ProcessBack:UpsertPq      | 9.949 ms                  | 16.025 ms                 |
| ProcessOneStep            | 29.180 ms                 | 40.711 ms                 |
| BlockToStepN              | 523.313 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:39.343006 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=256, pq.top=256
W20240204 10:20:40.343010 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240204 10:20:41.343006 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.276 ms                  | 23.152 ms                 |
| Forward                   | 4.947 ms                  | 11.941 ms                 |
| Backward                  | 8.694 ms                  | 10.972 ms                 |
| Optimize                  | 1.762 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 73.914 us                 | 18.929 ms                 |
| AfterBackward             | 29.208 ms                 | 40.739 ms                 |
| BlockToStepN              | 523.616 ms                | 578.633 ms                |
| OneStep                   | 573.690 ms                | 632.872 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:42.343017 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240204 10:20:43.384112 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.164 ms                  | 10.862 ms                 |
| ProcessBack:UpdateCache   | 9.923 ms                  | 13.542 ms                 |
| ProcessBack:UpsertPq      | 9.944 ms                  | 16.025 ms                 |
| ProcessOneStep            | 29.180 ms                 | 40.711 ms                 |
| BlockToStepN              | 523.125 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:44.384008 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240204 10:20:45.384006 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240204 10:20:46.384019 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=268, pq.top=268
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.279 ms                  | 23.152 ms                 |
| Forward                   | 4.947 ms                  | 11.941 ms                 |
| Backward                  | 8.694 ms                  | 10.972 ms                 |
| Optimize                  | 1.759 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 152.784 us                | 18.929 ms                 |
| AfterBackward             | 29.216 ms                 | 40.739 ms                 |
| BlockToStepN              | 522.828 ms                | 578.633 ms                |
| OneStep                   | 572.835 ms                | 632.872 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:20:47.434149 14013 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
Successfully xmh. training takes 153.5625286102295 seconds
before call kg_cache_controller.StopThreads()
W20240204 10:20:47.933648 14013 grad_async_v1.h:243] call StopThreads. PID = 13001
W20240204 10:20:47.933666 14013 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 10:20:47.936942 14013 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 10:20:47.936955 14013 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 10:20:48.066771 14013 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.164 ms                  | 10.862 ms                 |
| ProcessBack:UpdateCache   | 9.917 ms                  | 13.542 ms                 |
| ProcessBack:UpsertPq      | 9.944 ms                  | 16.025 ms                 |
| ProcessOneStep            | 29.180 ms                 | 40.711 ms                 |
| BlockToStepN              | 522.484 ms                | 578.508 ms                |
+---------------------------+---------------------------+---------------------------+
