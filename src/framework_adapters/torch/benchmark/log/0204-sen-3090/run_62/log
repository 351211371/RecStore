WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 18:32:13.924541 20549 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_122', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [20549 sampler.py:454] Start PreSampling
WARNING [20549 sampler.py:532] Before construct renumbering_dict
WARNING [20549 sampler.py:555] PreSampling done
W20240205 18:51:44.984078 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 18:51:44.984261 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 18:51:44.984303 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 18:51:44.984333 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 18:51:44.984365 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 18:51:44.984395 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 18:51:44.984426 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 18:51:44.984459 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 18:51:44.984493 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 18:51:44.984532 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 18:51:44.984568 20549 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 18:51:44.984596 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 18:51:44.984625 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 18:51:44.984776 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 18:51:44.984813 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 18:51:44.984841 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 18:51:44.984884 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 18:51:44.984912 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 18:51:44.984946 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 18:51:44.984974 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 18:51:44.985002 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 18:51:44.985030 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 18:51:44.985064 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 18:51:44.985090 20549 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 18:51:44.985116 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 18:51:44.985137 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 18:51:44.985191 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 18:51:44.985221 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 18:51:44.985252 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 18:51:44.985283 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 18:51:44.985313 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 18:51:44.985348 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 18:51:44.985379 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 18:51:44.985410 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 18:51:44.985440 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 18:51:44.985469 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 18:51:44.985495 20549 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 18:51:44.985520 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 18:51:44.985543 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 18:51:44.985602 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 18:51:44.985653 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 18:51:44.985693 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 18:51:44.985729 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 18:51:44.985760 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 18:51:44.985795 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 18:51:44.985831 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 18:51:44.985857 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 18:51:44.985894 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 18:51:44.985927 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 18:51:44.985960 20549 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 18:51:44.985982 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 18:51:44.986011 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 18:51:44.986073 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 18:51:44.986104 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 18:51:44.986133 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 18:51:44.986162 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 18:51:44.986196 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 18:51:44.986225 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 18:51:44.986253 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 18:51:44.986280 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 18:51:44.986316 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 18:51:44.986352 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 18:51:44.986378 20549 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 18:51:44.986403 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 18:51:44.986425 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 18:51:44.986474 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 18:51:44.986510 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 18:51:44.986536 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 18:51:44.986569 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 18:51:44.986598 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 18:51:44.986630 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 18:51:44.986660 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 18:51:44.986696 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 18:51:44.986722 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 18:51:44.986759 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 18:51:44.986785 20549 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 18:51:44.986809 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 18:51:44.986836 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 18:51:44.986899 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 18:51:44.986935 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 18:51:44.986963 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 18:51:44.986995 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 18:51:44.987028 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 18:51:44.987056 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 18:51:44.987084 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 18:51:44.987112 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 18:51:44.987152 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 18:51:44.987180 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 18:51:44.987212 20549 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 18:51:44.987236 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 18:51:44.987258 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 18:51:44.987310 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 18:51:44.987347 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 18:51:44.987375 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 18:51:44.987411 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 18:51:44.987447 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 18:51:44.987481 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 18:51:44.987516 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 18:51:44.987545 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 18:51:44.987573 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 18:51:44.987604 20549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 18:51:44.987636 20549 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 18:51:44.987660 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 18:51:44.987689 20549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 18:51:45.419572 20549 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 19:00:21.658716 20549 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302704,  4302723,   105363,  ..., 72683582, 48299851,  4884416]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2192.556 seconds
[Rank1] pid = 21769
[Rank2] pid = 21864
[Rank3] pid = 21931
[Rank4] pid = 22000
[Rank5] pid = 22068
[Rank6] pid = 22135
INFO [20549 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [21769 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [21864 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [21931 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [22000 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [22068 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [22135 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [22203 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [21931 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21864 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21769 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22135 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22203 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22068 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22000 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [21931 DistTensor.py:59] The tensor name already exists in the kvstore
INFO [20549 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [22000 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [22068 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [22203 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [21864 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [21769 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [22135 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [20549 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 19:08:57.814038 22268 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 19:08:57.814242 22001 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 19:08:57.814435 22069 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 19:08:57.815901 22204 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 19:08:57.816102 21770 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 19:08:57.816228 22136 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 19:08:57.816361 21865 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 19:08:57.816509 21932 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240205 19:08:58.577189 22204 recstore.cc:66] init folly done
E20240205 19:08:58.577248 21932 recstore.cc:66] init folly done
E20240205 19:08:58.577320 22268 recstore.cc:66] init folly done
E20240205 19:08:58.577354 22136 recstore.cc:66] init folly done
E20240205 19:08:58.577361 22001 recstore.cc:66] init folly done
E20240205 19:08:58.577378 22069 recstore.cc:66] init folly done
E20240205 19:08:58.577999 21865 recstore.cc:66] init folly done
E20240205 19:08:58.578277 21770 recstore.cc:66] init folly done
I20240205 19:09:03.945937 22204 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 19:09:04.425117 22069 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 19:09:04.815367 22001 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 19:09:06.098098 21865 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 19:09:06.802162 21770 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 19:09:06.975445 21932 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 19:09:07.911156 22268 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 19:09:08.013095 22136 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.174 ms                  | 88.870 ms                 |
| Forward                   | 11.408 ms                 | 623.039 ms                |
| Backward                  | 213.656 ms                | 445.463 ms                |
| Optimize                  | 4.163 ms                  | 4.820 ms                  |
| BarrierTimeBeforeRank0    | 50.100 ms                 | 94.861 ms                 |
| BlockToStepN              | 33.804 us                 | 55.711 us                 |
| OneStep                   | 288.892 ms                | 1.183 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.844 ms                  | 88.870 ms                 |
| Forward                   | 10.747 ms                 | 623.039 ms                |
| Backward                  | 213.656 ms                | 445.463 ms                |
| Optimize                  | 4.156 ms                  | 4.820 ms                  |
| BarrierTimeBeforeRank0    | 50.100 ms                 | 94.861 ms                 |
| BlockToStepN              | 33.912 us                 | 17.073 ms                 |
| OneStep                   | 288.976 ms                | 1.183 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.381 ms                  | 95.285 ms                 |
| Forward                   | 10.748 ms                 | 623.039 ms                |
| Backward                  | 218.404 ms                | 445.463 ms                |
| Optimize                  | 4.238 ms                  | 7.417 ms                  |
| BarrierTimeBeforeRank0    | 47.066 ms                 | 103.060 ms                |
| BlockToStepN              | 33.804 us                 | 17.073 ms                 |
| OneStep                   | 288.976 ms                | 1.183 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.381 ms                  | 95.285 ms                 |
| Forward                   | 10.724 ms                 | 15.541 ms                 |
| Backward                  | 227.776 ms                | 445.463 ms                |
| Optimize                  | 4.304 ms                  | 5.371 ms                  |
| BarrierTimeBeforeRank0    | 45.625 ms                 | 103.060 ms                |
| BlockToStepN              | 33.804 us                 | 16.488 ms                 |
| OneStep                   | 289.178 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.428 ms                  | 117.539 ms                |
| Forward                   | 10.649 ms                 | 15.546 ms                 |
| Backward                  | 233.222 ms                | 445.463 ms                |
| Optimize                  | 4.257 ms                  | 5.371 ms                  |
| BarrierTimeBeforeRank0    | 42.456 ms                 | 224.038 ms                |
| BlockToStepN              | 33.861 us                 | 16.488 ms                 |
| OneStep                   | 289.178 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.381 ms                  | 117.539 ms                |
| Forward                   | 10.602 ms                 | 28.232 ms                 |
| Backward                  | 233.839 ms                | 445.463 ms                |
| Optimize                  | 4.024 ms                  | 5.371 ms                  |
| BarrierTimeBeforeRank0    | 38.266 ms                 | 224.038 ms                |
| BlockToStepN              | 33.912 us                 | 16.488 ms                 |
| OneStep                   | 286.366 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 31.199, sample: 1.389, forward: 2.619, backward: 24.313, update: 0.367
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 32.410, sample: 1.366, forward: 2.795, backward: 21.943, update: 0.356
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 33.114, sample: 1.237, forward: 2.650, backward: 22.600, update: 0.336
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 34.787, sample: 1.233, forward: 2.531, backward: 22.705, update: 0.331
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 34.397, sample: 1.220, forward: 2.633, backward: 22.366, update: 0.380
[Rank7] pid = 22203
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([   53382,    53407,    53430,   119674,  6242491,   119699, 48474111,
        18973705,    53456,    53477]) tensor([ 5454269, 16216162, 70119258, 81240118, 22281533, 29226729, 32242642,
        61299154, 78391805, 27719300])
-------Step 1-------
tensor([   53382,    53407,    53430,   119674,  6242491,   119699, 48474111,
        18973705,    53456,    53477]) tensor([60997956, 31753530, 10656108, 84307248, 73453117, 37105705, 56482523,
        44777395, 42829243, 13364990])
-------Step 2-------
tensor([  115932,   115955,   136535,    33876,   115986,   116012,   116037,
        23084754,   116061,   116095]) tensor([79829867, 20300595, 72392329, 56134593, 39900496, 32306440, 61223560,
        47614502, 14572115, 36352082])
-------Step 3-------
tensor([  115932,   115955,   136535,    33876,   115986,   116012,   116037,
        23084754,   116061,   116095]) tensor([57650078, 70248339, 38083994, 34519871, 70598694, 74961162, 33388690,
        17321542, 24681164,   817457])
-------Step 4-------
tensor([  177554, 36961833,   177580,   177608,   177641,   177662,   152673,
        35767070,   177682,   152699]) tensor([67593056,  9413492, 69318296, 19560980, 79123668, 34745273, 58587400,
        33981593, 85636789, 61508007])
-------Step 5-------
tensor([  177554, 36961833,   177580,   177608,   177641,   177662,   152673,
        35767070,   177682,   152699]) tensor([40329604, 78591789,   208101, 72333942, 53071654, 65544407, 15391660,
        10209220, 78997973, 47104564])
-------Step 6-------
tensor([  239576,   204036,   239599,   239627,    71478, 66031948,   239652,
          239681,   239703, 33115892]) tensor([13546621, 41780600, 40634036, 85003936, 38211543, 32276460, 22366623,
         7354606, 77362572, 85230364])
-------Step 7-------
tensor([  239576,   204036,   239599,   239627,    71478, 66031948,   239652,
          239681,   239703, 33115892]) tensor([20938765, 61327734, 60060902, 59776658, 67683749, 59808293, 62604658,
        66643609, 38964297, 30512889])
-------Step 8-------
tensor([  300938, 23701353,   300968,   300995,   301019,    89157,   301049,
          301071,   301097,   301122]) tensor([40814797, 26566516, 39048612, 22500992, 57692924, 51751008, 15069508,
        79531988,  1547625, 73961812])
-------Step 9-------
tensor([  300938, 23701353,   300968,   300995,   301019,    89157,   301049,
          301071,   301097,   301122]) tensor([47983394, 33713229, 13588903, 50525471,  8264855, 47270400, 30543275,
        43720537, 80548379, 77776201])
before start barrier
start train
[proc 0] 100 steps, total: 31.301, sample: 1.290, forward: 1.710, backward: 23.440, update: 0.349
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 35.266, sample: 1.664, forward: 2.794, backward: 22.568, update: 0.377
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 32.237, sample: 1.462, forward: 2.795, backward: 24.998, update: 0.390
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.887 ms                  | 117.539 ms                |
| Forward                   | 10.620 ms                 | 28.232 ms                 |
| Backward                  | 232.914 ms                | 445.463 ms                |
| Optimize                  | 3.831 ms                  | 5.371 ms                  |
| BarrierTimeBeforeRank0    | 38.452 ms                 | 224.038 ms                |
| BlockToStepN              | 34.000 us                 | 16.488 ms                 |
| OneStep                   | 283.440 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.350 ms                  | 134.404 ms                |
| Forward                   | 10.724 ms                 | 28.232 ms                 |
| Backward                  | 233.332 ms                | 445.463 ms                |
| Optimize                  | 4.156 ms                  | 7.481 ms                  |
| BarrierTimeBeforeRank0    | 36.056 ms                 | 224.038 ms                |
| BlockToStepN              | 34.419 us                 | 16.488 ms                 |
| OneStep                   | 286.334 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.350 ms                  | 145.770 ms                |
| Forward                   | 10.731 ms                 | 28.232 ms                 |
| Backward                  | 233.839 ms                | 445.463 ms                |
| Optimize                  | 4.156 ms                  | 7.481 ms                  |
| BarrierTimeBeforeRank0    | 36.056 ms                 | 224.038 ms                |
| BlockToStepN              | 34.419 us                 | 17.073 ms                 |
| OneStep                   | 288.892 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.381 ms                  | 134.404 ms                |
| Forward                   | 10.731 ms                 | 15.546 ms                 |
| Backward                  | 233.332 ms                | 398.471 ms                |
| Optimize                  | 4.156 ms                  | 7.481 ms                  |
| BarrierTimeBeforeRank0    | 36.056 ms                 | 219.653 ms                |
| BlockToStepN              | 34.630 us                 | 16.488 ms                 |
| OneStep                   | 286.366 ms                | 488.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.165 ms                  | 134.404 ms                |
| Forward                   | 10.750 ms                 | 18.490 ms                 |
| Backward                  | 233.007 ms                | 398.471 ms                |
| Optimize                  | 4.156 ms                  | 9.973 ms                  |
| BarrierTimeBeforeRank0    | 33.311 ms                 | 219.653 ms                |
| BlockToStepN              | 34.964 us                 | 16.488 ms                 |
| OneStep                   | 286.120 ms                | 488.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.321 ms                  | 134.404 ms                |
| Forward                   | 10.755 ms                 | 18.490 ms                 |
| Backward                  | 232.741 ms                | 398.471 ms                |
| Optimize                  | 3.896 ms                  | 9.973 ms                  |
| BarrierTimeBeforeRank0    | 33.311 ms                 | 219.653 ms                |
| BlockToStepN              | 34.964 us                 | 16.488 ms                 |
| OneStep                   | 285.676 ms                | 488.522 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 30.173, sample: 1.266, forward: 1.995, backward: 24.430, update: 0.330
[proc 0] 200 steps, total: 30.173, sample: 1.577, forward: 1.111, backward: 21.845, update: 0.398
[proc 1] 200 steps, total: 30.173, sample: 1.416, forward: 1.949, backward: 23.382, update: 0.388
[proc 4] 200 steps, total: 30.173, sample: 1.666, forward: 1.755, backward: 22.173, update: 0.294
[proc 2] 200 steps, total: 30.173, sample: 1.558, forward: 1.792, backward: 23.393, update: 0.328
[proc 7] 200 steps, total: 30.173, sample: 1.343, forward: 1.841, backward: 21.679, update: 0.360
[proc 5] 200 steps, total: 30.173, sample: 1.466, forward: 1.837, backward: 23.267, update: 0.388
[proc 6] 200 steps, total: 30.173, sample: 1.161, forward: 1.805, backward: 23.263, update: 0.322
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.428 ms                  | 134.404 ms                |
| Forward                   | 10.755 ms                 | 18.490 ms                 |
| Backward                  | 232.014 ms                | 398.471 ms                |
| Optimize                  | 3.713 ms                  | 9.973 ms                  |
| BarrierTimeBeforeRank0    | 35.794 ms                 | 224.038 ms                |
| BlockToStepN              | 34.714 us                 | 16.488 ms                 |
| OneStep                   | 286.482 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.281 ms                  | 134.404 ms                |
| Forward                   | 10.754 ms                 | 18.490 ms                 |
| Backward                  | 231.574 ms                | 398.471 ms                |
| Optimize                  | 3.412 ms                  | 9.973 ms                  |
| BarrierTimeBeforeRank0    | 37.527 ms                 | 224.038 ms                |
| BlockToStepN              | 34.536 us                 | 16.488 ms                 |
| OneStep                   | 287.547 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.123 ms                  | 134.404 ms                |
| Forward                   | 10.778 ms                 | 18.490 ms                 |
| Backward                  | 232.357 ms                | 398.471 ms                |
| Optimize                  | 3.137 ms                  | 9.973 ms                  |
| BarrierTimeBeforeRank0    | 37.025 ms                 | 224.038 ms                |
| BlockToStepN              | 34.087 us                 | 16.488 ms                 |
| OneStep                   | 287.723 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.154 ms                  | 129.950 ms                |
| Forward                   | 10.810 ms                 | 17.444 ms                 |
| Backward                  | 232.389 ms                | 350.951 ms                |
| Optimize                  | 3.098 ms                  | 7.736 ms                  |
| BarrierTimeBeforeRank0    | 34.211 ms                 | 219.653 ms                |
| BlockToStepN              | 34.023 us                 | 13.248 ms                 |
| OneStep                   | 286.794 ms                | 488.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.154 ms                  | 129.950 ms                |
| Forward                   | 10.843 ms                 | 17.444 ms                 |
| Backward                  | 232.014 ms                | 350.951 ms                |
| Optimize                  | 3.094 ms                  | 7.736 ms                  |
| BarrierTimeBeforeRank0    | 34.775 ms                 | 224.038 ms                |
| BlockToStepN              | 34.087 us                 | 17.073 ms                 |
| OneStep                   | 287.547 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.094 ms                  | 129.950 ms                |
| Forward                   | 10.848 ms                 | 17.444 ms                 |
| Backward                  | 231.574 ms                | 350.951 ms                |
| Optimize                  | 3.036 ms                  | 7.736 ms                  |
| BarrierTimeBeforeRank0    | 35.613 ms                 | 224.038 ms                |
| BlockToStepN              | 34.419 us                 | 17.073 ms                 |
| OneStep                   | 287.531 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 30.444, sample: 1.318, forward: 2.158, backward: 24.439, update: 0.409
[proc 7] 300 steps, total: 30.444, sample: 1.439, forward: 1.881, backward: 24.320, update: 0.317
[proc 2] 300 steps, total: 30.444, sample: 1.113, forward: 1.909, backward: 23.271, update: 0.374
[proc 6] 300 steps, total: 30.444, sample: 1.001, forward: 1.801, backward: 23.800, update: 0.308
[proc 4] 300 steps, total: 30.444, sample: 0.992, forward: 1.946, backward: 23.747, update: 0.255
[proc 0] 300 steps, total: 30.444, sample: 1.127, forward: 1.108, backward: 22.850, update: 0.262
[proc 5] 300 steps, total: 30.444, sample: 1.060, forward: 1.811, backward: 24.056, update: 0.394
[proc 3] 300 steps, total: 30.444, sample: 1.017, forward: 2.064, backward: 24.191, update: 0.410
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.994 ms                  | 129.950 ms                |
| Forward                   | 10.853 ms                 | 17.444 ms                 |
| Backward                  | 231.421 ms                | 350.951 ms                |
| Optimize                  | 3.085 ms                  | 7.736 ms                  |
| BarrierTimeBeforeRank0    | 36.654 ms                 | 224.038 ms                |
| BlockToStepN              | 34.250 us                 | 17.073 ms                 |
| OneStep                   | 287.547 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.994 ms                  | 129.950 ms                |
| Forward                   | 10.861 ms                 | 18.490 ms                 |
| Backward                  | 232.384 ms                | 350.951 ms                |
| Optimize                  | 3.114 ms                  | 7.736 ms                  |
| BarrierTimeBeforeRank0    | 36.056 ms                 | 224.038 ms                |
| BlockToStepN              | 34.518 us                 | 17.073 ms                 |
| OneStep                   | 287.547 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.049 ms                  | 129.950 ms                |
| Forward                   | 10.872 ms                 | 18.490 ms                 |
| Backward                  | 232.819 ms                | 350.951 ms                |
| Optimize                  | 3.171 ms                  | 7.736 ms                  |
| BarrierTimeBeforeRank0    | 34.775 ms                 | 224.038 ms                |
| BlockToStepN              | 34.518 us                 | 18.133 ms                 |
| OneStep                   | 287.531 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.074 ms                  | 117.539 ms                |
| Forward                   | 10.889 ms                 | 17.444 ms                 |
| Backward                  | 232.819 ms                | 299.861 ms                |
| Optimize                  | 3.114 ms                  | 7.481 ms                  |
| BarrierTimeBeforeRank0    | 34.211 ms                 | 219.653 ms                |
| BlockToStepN              | 34.456 us                 | 18.133 ms                 |
| OneStep                   | 286.482 ms                | 488.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.041 ms                  | 117.539 ms                |
| Forward                   | 10.931 ms                 | 17.444 ms                 |
| Backward                  | 232.863 ms                | 299.861 ms                |
| Optimize                  | 3.099 ms                  | 7.481 ms                  |
| BarrierTimeBeforeRank0    | 34.115 ms                 | 219.653 ms                |
| BlockToStepN              | 34.456 us                 | 18.133 ms                 |
| OneStep                   | 286.366 ms                | 488.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.961 ms                  | 117.539 ms                |
| Forward                   | 10.948 ms                 | 17.444 ms                 |
| Backward                  | 233.038 ms                | 299.861 ms                |
| Optimize                  | 3.094 ms                  | 7.481 ms                  |
| BarrierTimeBeforeRank0    | 35.794 ms                 | 220.529 ms                |
| BlockToStepN              | 34.513 us                 | 18.133 ms                 |
| OneStep                   | 287.455 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 30.147, sample: 1.122, forward: 1.954, backward: 19.575, update: 0.302
[proc 2] 400 steps, total: 30.147, sample: 1.070, forward: 1.859, backward: 22.326, update: 0.288
[proc 3] 400 steps, total: 30.147, sample: 1.001, forward: 1.885, backward: 21.552, update: 0.367
[proc 4] 400 steps, total: 30.147, sample: 1.085, forward: 1.993, backward: 20.783, update: 0.338
[proc 6] 400 steps, total: 30.147, sample: 1.031, forward: 1.877, backward: 22.799, update: 0.330
[proc 7] 400 steps, total: 30.147, sample: 1.186, forward: 1.897, backward: 21.626, update: 0.322
[proc 0] 400 steps, total: 30.147, sample: 1.172, forward: 1.152, backward: 22.249, update: 0.327
[proc 5] 400 steps, total: 30.147, sample: 0.988, forward: 1.843, backward: 20.515, update: 0.384
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.994 ms                  | 117.539 ms                |
| Forward                   | 10.971 ms                 | 17.444 ms                 |
| Backward                  | 233.015 ms                | 312.101 ms                |
| Optimize                  | 3.036 ms                  | 7.481 ms                  |
| BarrierTimeBeforeRank0    | 37.025 ms                 | 220.529 ms                |
| BlockToStepN              | 34.606 us                 | 18.133 ms                 |
| OneStep                   | 288.186 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.039 ms                  | 117.539 ms                |
| Forward                   | 10.971 ms                 | 17.444 ms                 |
| Backward                  | 233.173 ms                | 312.101 ms                |
| Optimize                  | 3.001 ms                  | 7.736 ms                  |
| BarrierTimeBeforeRank0    | 37.374 ms                 | 220.529 ms                |
| BlockToStepN              | 34.536 us                 | 18.133 ms                 |
| OneStep                   | 288.976 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.962 ms                  | 117.539 ms                |
| Forward                   | 10.990 ms                 | 17.444 ms                 |
| Backward                  | 233.222 ms                | 312.101 ms                |
| Optimize                  | 2.971 ms                  | 7.736 ms                  |
| BarrierTimeBeforeRank0    | 37.535 ms                 | 220.529 ms                |
| BlockToStepN              | 34.169 us                 | 18.133 ms                 |
| OneStep                   | 290.153 ms                | 504.521 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.938 ms                  | 117.302 ms                |
| Forward                   | 11.007 ms                 | 16.955 ms                 |
| Backward                  | 233.537 ms                | 312.101 ms                |
| Optimize                  | 2.886 ms                  | 7.481 ms                  |
| BarrierTimeBeforeRank0    | 37.821 ms                 | 219.653 ms                |
| BlockToStepN              | 34.000 us                 | 17.073 ms                 |
| OneStep                   | 291.398 ms                | 488.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.948 ms                  | 117.302 ms                |
| Forward                   | 11.025 ms                 | 16.955 ms                 |
| Backward                  | 233.633 ms                | 312.101 ms                |
| Optimize                  | 2.949 ms                  | 7.481 ms                  |
| BarrierTimeBeforeRank0    | 38.019 ms                 | 219.653 ms                |
| BlockToStepN              | 34.023 us                 | 17.073 ms                 |
| OneStep                   | 292.337 ms                | 488.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.960 ms                  | 117.302 ms                |
| Forward                   | 11.016 ms                 | 16.955 ms                 |
| Backward                  | 234.174 ms                | 312.101 ms                |
| Optimize                  | 2.981 ms                  | 7.481 ms                  |
| BarrierTimeBeforeRank0    | 38.604 ms                 | 219.653 ms                |
| BlockToStepN              | 34.000 us                 | 17.073 ms                 |
| OneStep                   | 293.321 ms                | 488.522 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 150.8651294708252 seconds
before call kg_cache_controller.StopThreads()
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
INFO [20549 controller_process.py:421] call rank0 to StopThreads
