WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 10:24:31.643975 52581 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_116', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=8, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [52581 sampler.py:454] Start PreSampling
WARNING [52581 sampler.py:532] Before construct renumbering_dict
WARNING [52581 sampler.py:555] PreSampling done
W20240204 10:24:37.243389 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 10:24:37.243558 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 10:24:37.243598 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 10:24:37.243644 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 10:24:37.243677 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 10:24:37.243716 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 10:24:37.243750 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 10:24:37.243789 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 10:24:37.243831 52581 IPCTensor.h:369] NewIPCTensor: step_r0 [8]0x100003d1a000 64 B 
W20240204 10:24:37.243865 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100003d1c000 8 B 
W20240204 10:24:37.243901 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100003d1e000 8 B 
W20240204 10:24:37.244033 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100003d20000 7.629 MB
W20240204 10:24:37.244086 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000044c3000 7.629 MB
W20240204 10:24:37.244145 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100004c66000 7.629 MB
W20240204 10:24:37.244194 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100005409000 7.629 MB
W20240204 10:24:37.244230 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100005bac000 7.629 MB
W20240204 10:24:37.244297 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x10000634f000 7.629 MB
W20240204 10:24:37.244336 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100006af2000 7.629 MB
W20240204 10:24:37.244372 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100007295000 7.629 MB
W20240204 10:24:37.244410 52581 IPCTensor.h:369] NewIPCTensor: step_r1 [8]0x100007a38000 64 B 
W20240204 10:24:37.244441 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100007a3a000 8 B 
W20240204 10:24:37.244473 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100007a3c000 8 B 
W20240204 10:24:37.244547 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100007a3e000 7.629 MB
W20240204 10:24:37.244601 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000081e1000 7.629 MB
W20240204 10:24:37.244642 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100008984000 7.629 MB
W20240204 10:24:37.244685 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100009127000 7.629 MB
W20240204 10:24:37.244724 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000098ca000 7.629 MB
W20240204 10:24:37.244762 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000a06d000 7.629 MB
W20240204 10:24:37.244801 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000a810000 7.629 MB
W20240204 10:24:37.244846 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000afb3000 7.629 MB
W20240204 10:24:37.244885 52581 IPCTensor.h:369] NewIPCTensor: step_r2 [8]0x10000b756000 64 B 
W20240204 10:24:37.244916 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000b758000 8 B 
W20240204 10:24:37.244953 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000b75a000 8 B 
W20240204 10:24:37.245023 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000b75c000 7.629 MB
W20240204 10:24:37.245071 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000beff000 7.629 MB
W20240204 10:24:37.245110 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000c6a2000 7.629 MB
W20240204 10:24:37.245149 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000ce45000 7.629 MB
W20240204 10:24:37.245188 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10000d5e8000 7.629 MB
W20240204 10:24:37.245235 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10000dd8b000 7.629 MB
W20240204 10:24:37.245271 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10000e52e000 7.629 MB
W20240204 10:24:37.245311 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10000ecd1000 7.629 MB
W20240204 10:24:37.245348 52581 IPCTensor.h:369] NewIPCTensor: step_r3 [8]0x10000f474000 64 B 
W20240204 10:24:37.245374 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10000f476000 8 B 
W20240204 10:24:37.245402 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10000f478000 8 B 
W20240204 10:24:37.245462 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10000f47a000 7.629 MB
W20240204 10:24:37.245499 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x10000fc1d000 7.629 MB
W20240204 10:24:37.245530 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000103c0000 7.629 MB
W20240204 10:24:37.245561 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x100010b63000 7.629 MB
W20240204 10:24:37.245605 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x100011306000 7.629 MB
W20240204 10:24:37.245640 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x100011aa9000 7.629 MB
W20240204 10:24:37.245687 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x10001224c000 7.629 MB
W20240204 10:24:37.245721 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000129ef000 7.629 MB
W20240204 10:24:37.245761 52581 IPCTensor.h:369] NewIPCTensor: step_r4 [8]0x100013192000 64 B 
W20240204 10:24:37.245788 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100013194000 8 B 
W20240204 10:24:37.245816 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100013196000 8 B 
W20240204 10:24:37.245874 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100013198000 7.629 MB
W20240204 10:24:37.245910 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x10001393b000 7.629 MB
W20240204 10:24:37.245949 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000140de000 7.629 MB
W20240204 10:24:37.245985 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x100014881000 7.629 MB
W20240204 10:24:37.246019 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100015024000 7.629 MB
W20240204 10:24:37.246062 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000157c7000 7.629 MB
W20240204 10:24:37.246099 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x100015f6a000 7.629 MB
W20240204 10:24:37.246142 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001670d000 7.629 MB
W20240204 10:24:37.246173 52581 IPCTensor.h:369] NewIPCTensor: step_r5 [8]0x100016eb0000 64 B 
W20240204 10:24:37.246201 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x100016eb2000 8 B 
W20240204 10:24:37.246230 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100016eb4000 8 B 
W20240204 10:24:37.246296 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x100016eb6000 7.629 MB
W20240204 10:24:37.246342 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x100017659000 7.629 MB
W20240204 10:24:37.246378 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x100017dfc000 7.629 MB
W20240204 10:24:37.246415 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001859f000 7.629 MB
W20240204 10:24:37.246451 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x100018d42000 7.629 MB
W20240204 10:24:37.246491 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000194e5000 7.629 MB
W20240204 10:24:37.246527 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x100019c88000 7.629 MB
W20240204 10:24:37.246563 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001a42b000 7.629 MB
W20240204 10:24:37.246594 52581 IPCTensor.h:369] NewIPCTensor: step_r6 [8]0x10001abce000 64 B 
W20240204 10:24:37.246623 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x10001abd0000 8 B 
W20240204 10:24:37.246656 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10001abd2000 8 B 
W20240204 10:24:37.246716 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10001abd4000 7.629 MB
W20240204 10:24:37.246763 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10001b377000 7.629 MB
W20240204 10:24:37.246798 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10001bb1a000 7.629 MB
W20240204 10:24:37.246834 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x10001c2bd000 7.629 MB
W20240204 10:24:37.246871 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10001ca60000 7.629 MB
W20240204 10:24:37.246912 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x10001d203000 7.629 MB
W20240204 10:24:37.246953 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x10001d9a6000 7.629 MB
W20240204 10:24:37.246987 52581 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x10001e149000 7.629 MB
W20240204 10:24:37.247021 52581 IPCTensor.h:369] NewIPCTensor: step_r7 [8]0x10001e8ec000 64 B 
W20240204 10:24:37.247048 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10001e8ee000 8 B 
W20240204 10:24:37.247083 52581 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10001e8f0000 8 B 
W20240204 10:24:37.492902 52581 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x10001e8f2000 22.81 MB
W20240204 10:24:37.589936 52581 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10001ffc4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 744,  988, 1328,  ..., 9338, 9598, 7476]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 6.050 seconds
[Rank1] pid = 53177
[Rank2] pid = 53194
[Rank3] pid = 53305
[Rank4] pid = 53369
[Rank5] pid = 53433
[Rank6] pid = 53434
INFO [52581 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [53177 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [53194 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [53305 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [53369 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [53434 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [53369 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53433 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [53568 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [53434 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53433 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53568 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53305 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53177 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:24:40.276149 53370 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
INFO [53194 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:24:40.277794 53436 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 10:24:40.278151 53437 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240204 10:24:40.278195 53306 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 10:24:40.278221 53178 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 10:24:40.278291 53594 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
INFO [52581 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:24:40.279222 53242 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240204 10:24:40.280736 53569 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 10:24:40.300705 53436 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10001ffd6000 7.629 MB
W20240204 10:24:40.300992 53436 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x100020779000 7.629 MB
W20240204 10:24:40.301084 53436 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x100020f1c000 1.49 GB
W20240204 10:24:40.301147 53436 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1000804ff000 1.49 GB
W20240204 10:24:40.301251 53436 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:24:40.303210 53436 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:24:40.306198 53594 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1000dfaea000 7.629 MB
W20240204 10:24:40.306206 53437 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1000e028d000 7.629 MB
W20240204 10:24:40.306887 53594 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000e0a30000 7.629 MB
W20240204 10:24:40.306893 53437 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1000e11d3000 7.629 MB
W20240204 10:24:40.307135 53437 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1000e1976000 1.49 GB
W20240204 10:24:40.307143 53594 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x100140f59000 1.49 GB
W20240204 10:24:40.307237 53594 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1001a053c000 1.49 GB
W20240204 10:24:40.307260 53437 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1001ffb1f000 1.49 GB
W20240204 10:24:40.307776 53569 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10025f104000 7.629 MB
W20240204 10:24:40.307960 53569 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10025f8a7000 7.629 MB
W20240204 10:24:40.308037 53569 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10026004a000 1.49 GB
W20240204 10:24:40.308089 53437 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:24:40.308095 53569 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1002bf62d000 1.49 GB
W20240204 10:24:40.308104 53594 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:24:40.308176 53569 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:24:40.314049 53306 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10031ec14000 7.629 MB
W20240204 10:24:40.314122 53242 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10031f3b7000 7.629 MB
W20240204 10:24:40.314178 53306 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10031fb5a000 7.629 MB
W20240204 10:24:40.314231 53306 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1003202fd000 1.49 GB
W20240204 10:24:40.314254 53242 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10037f8e0000 7.629 MB
W20240204 10:24:40.314291 53306 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100380083000 1.49 GB
W20240204 10:24:40.314317 53242 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1003df666000 1.49 GB
W20240204 10:24:40.314344 53306 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:24:40.314363 53242 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10043ec49000 1.49 GB
W20240204 10:24:40.314415 53242 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:24:40.314462 53569 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:24:40.314522 53437 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:24:40.314538 53594 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:24:40.314694 53370 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10049e234000 7.629 MB
W20240204 10:24:40.314819 53370 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10049e9d7000 7.629 MB
W20240204 10:24:40.314874 53370 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10049f17a000 1.49 GB
W20240204 10:24:40.314922 53370 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1004fe75d000 1.49 GB
W20240204 10:24:40.314971 53370 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:24:40.316371 53178 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10055dd42000 7.629 MB
W20240204 10:24:40.316480 53178 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10055e4e5000 7.629 MB
W20240204 10:24:40.316535 53178 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10055ec88000 1.49 GB
W20240204 10:24:40.316596 53178 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1005be26b000 1.49 GB
W20240204 10:24:40.316653 53178 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:24:40.326575 53306 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:24:40.326614 53370 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:24:40.326614 53242 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:24:40.326622 53178 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x10001e8f2000
2: KnownLocalCachedEmbedding init done
WARNING [53194 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
6: KnownLocalCachedEmbedding init done
WARNING [53434 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
3: KnownLocalCachedEmbedding init done
WARNING [53305 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
4: KnownLocalCachedEmbedding init done
WARNING [53369 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
7: KnownLocalCachedEmbedding init done
WARNING [53568 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
5: KnownLocalCachedEmbedding init done
WARNING [53433 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 53568
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x10001e8f2000
0: KnownLocalCachedEmbedding init done
WARNING [52581 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
1: KnownLocalCachedEmbedding init done
WARNING [53177 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 10:24:42.320830 53178 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 10:24:42.321561 53306 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:24:42.321635 53436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:24:42.322680 53242 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:24:42.322746 53569 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:24:42.322814 53594 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:24:42.322880 53370 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:24:42.322943 53437 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 10:24:42.326090 53569 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 8,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 10:24:42.326390 53569 grad_base.h:184] Init GradProcessingBase done
I20240204 10:24:42.333705 53569 grad_async_v1.h:203] Use main thread to update emb.
W20240204 10:24:42.333835 53569 kg_controller.h:75] after init GradAsyncProcessing
I20240204 10:24:42.333863 53569 kg_controller.h:84] Construct KGCacheController done
E20240204 10:24:44.131842 53306 recstore.cc:66] init folly done
E20240204 10:24:44.131855 53370 recstore.cc:66] init folly done
E20240204 10:24:44.131865 53594 recstore.cc:66] init folly done
E20240204 10:24:44.132246 53436 recstore.cc:66] init folly done
E20240204 10:24:44.134095 53178 recstore.cc:66] init folly done
E20240204 10:24:44.134390 53437 recstore.cc:66] init folly done
E20240204 10:24:44.134428 53569 recstore.cc:66] init folly done
E20240204 10:24:44.134445 53242 recstore.cc:66] init folly done
I20240204 10:24:44.136341 53569 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 10:24:44.915482 53306 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 10:24:44.917037 53178 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:24:44.919916 53569 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:24:44.946478 53437 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:24:44.949903 53370 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:24:44.949963 53436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:24:44.950024 53594 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:24:44.950187 53242 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 10:24:47.174639 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240204 10:24:47.263013 54191 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.053 ms                  | 9.003 ms                  |
| Forward                   | 13.070 ms                 | 676.769 ms                |
| Backward                  | 6.284 ms                  | 196.949 ms                |
| Optimize                  | 2.871 ms                  | 4.601 ms                  |
| BarrierTimeBeforeRank0    | 9.550 ms                  | 61.722 ms                 |
| AfterBackward             | 50.057 ms                 | 1.282 s                   |
| BlockToStepN              | 3.743 ms                  | 27.718 ms                 |
| OneStep                   | 94.457 ms                 | 2.253 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:24:48.208844 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.503 ms                  | 308.665 ms                |
| ProcessBack:UpdateCache   | 10.088 ms                 | 714.347 ms                |
| ProcessBack:UpsertPq      | 7.332 ms                  | 15.553 ms                 |
| ProcessOneStep            | 25.655 ms                 | 1.281 s                   |
| BlockToStepN              | 15.259 ms                 | 66.447 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 10:24:49.208016 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=22, pq.top=22
W20240204 10:24:50.208020 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=30, pq.top=30
W20240204 10:24:51.208009 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240204 10:24:52.208022 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.250 ms                  | 20.202 ms                 |
| Forward                   | 4.624 ms                  | 676.769 ms                |
| Backward                  | 3.650 ms                  | 196.949 ms                |
| Optimize                  | 1.868 ms                  | 4.601 ms                  |
| BarrierTimeBeforeRank0    | 5.549 ms                  | 61.722 ms                 |
| AfterBackward             | 27.062 ms                 | 1.282 s                   |
| BlockToStepN              | 64.768 ms                 | 130.349 ms                |
| OneStep                   | 120.015 ms                | 2.253 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:24:53.208009 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=48, pq.top=48
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.325 ms                  | 269.552 ms                |
| ProcessBack:UpdateCache   | 10.029 ms                 | 709.809 ms                |
| ProcessBack:UpsertPq      | 9.484 ms                  | 14.347 ms                 |
| ProcessOneStep            | 27.239 ms                 | 329.763 ms                |
| BlockToStepN              | 69.190 ms                 | 160.907 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:24:54.208007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240204 10:24:55.208025 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240204 10:24:56.225594 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=62, pq.top=62
W20240204 10:24:57.225011 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=66, pq.top=66
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.280 ms                  | 19.532 ms                 |
| Forward                   | 4.804 ms                  | 13.070 ms                 |
| Backward                  | 3.639 ms                  | 18.289 ms                 |
| Optimize                  | 1.893 ms                  | 3.356 ms                  |
| BarrierTimeBeforeRank0    | 5.587 ms                  | 27.955 ms                 |
| AfterBackward             | 27.965 ms                 | 329.874 ms                |
| BlockToStepN              | 102.527 ms                | 197.797 ms                |
| OneStep                   | 154.903 ms                | 348.806 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:24:58.225023 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=70, pq.top=70
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.332 ms                  | 269.552 ms                |
| ProcessBack:UpdateCache   | 10.017 ms                 | 709.809 ms                |
| ProcessBack:UpsertPq      | 9.697 ms                  | 15.354 ms                 |
| ProcessOneStep            | 27.802 ms                 | 329.763 ms                |
| BlockToStepN              | 110.036 ms                | 221.224 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:24:59.225008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=74, pq.top=74
W20240204 10:25:00.225021 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=78, pq.top=78
W20240204 10:25:01.242436 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=82, pq.top=82
W20240204 10:25:02.242009 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.345 ms                  | 21.242 ms                 |
| Forward                   | 4.830 ms                  | 13.070 ms                 |
| Backward                  | 3.660 ms                  | 18.289 ms                 |
| Optimize                  | 1.839 ms                  | 3.356 ms                  |
| BarrierTimeBeforeRank0    | 5.605 ms                  | 27.955 ms                 |
| AfterBackward             | 27.877 ms                 | 329.874 ms                |
| BlockToStepN              | 124.112 ms                | 250.601 ms                |
| OneStep                   | 187.834 ms                | 348.806 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:03.242007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.336 ms                  | 11.092 ms                 |
| ProcessBack:UpdateCache   | 10.038 ms                 | 11.216 ms                 |
| ProcessBack:UpsertPq      | 9.697 ms                  | 15.553 ms                 |
| ProcessOneStep            | 27.817 ms                 | 329.763 ms                |
| BlockToStepN              | 136.101 ms                | 255.725 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:04.242013 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=92, pq.top=92
W20240204 10:25:05.242007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=96, pq.top=96
W20240204 10:25:06.242008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 21.638, sample: 0.350, forward: 1.184, backward: 0.873, update: 0.182
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 21.638, sample: 0.352, forward: 1.164, backward: 1.129, update: 0.182
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 21.641, sample: 0.376, forward: 1.225, backward: 1.075, update: 0.188
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 21.638, sample: 0.357, forward: 1.140, backward: 1.133, update: 0.177
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 21.672, sample: 0.333, forward: 1.133, backward: 0.640, update: 0.178
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 21.671, sample: 0.336, forward: 1.063, backward: 0.633, update: 0.187
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 21.637, sample: 0.379, forward: 1.210, backward: 1.121, update: 0.191
train_sampler.Prefill()
-------Step 0-------
tensor([   17,    30,  3491,  3330, 12450, 13160,  1112,   372, 13089, 10697]) tensor([ 1328,  9772,  5992, 11619, 12072,  1057,   639,  5255,  5298, 12863])
-------Step 1-------
tensor([   17,    30,  3491,  3330, 12450, 13160,  1112,   372, 13089, 10697]) tensor([ 4046, 10523, 14485,  1330,  1031,  8028, 14506, 10241,  5657, 13180])
-------Step 2-------
tensor([ 7753, 10010,  5300,  3980, 10635,  8731, 10774,    83, 11200,   915]) tensor([ 2357,  5277,  3972,  6729,  7028,  9070, 13544,  9780, 13810,  8863])
-------Step 3-------
tensor([ 7753, 10010,  5300,  3980, 10635,  8731, 10774,    83, 11200,   915]) tensor([ 9045,  8057,  7791, 11424,  7332,   718,  5715,  2228, 11432,  2004])
-------Step 4-------
tensor([   30,  6766, 10864,  4396,  3533,  3554,    67,  7534,  7884,  1038]) tensor([ 621, 1288, 4193, 2912, 2525, 2366,  372, 7018, 5854, 1736])
-------Step 5-------
tensor([   30,  6766, 10864,  4396,  3533,  3554,    67,  7534,  7884,  1038]) tensor([11526,  4928,  6259,  1775,  3421,   828,   831,  1301,  6232,  6781])
-------Step 6-------
tensor([ 1731,  8592,    27,    42,  4785,  3493,  8217, 11910, 14207, 13346]) tensor([10010,  3058,  7900,  4382,  9558,  8524,  4146,  7887,  8048, 12177])
-------Step 7-------
tensor([ 1731,  8592,    27,    42,  4785,  3493,  8217, 11910, 14207, 13346]) tensor([11830, 11977,  3573,  7941,  1243,   722,  7519,  2373,   118, 14799])
before start barrier
start train
[proc 0] 100 steps, total: 21.668, sample: 0.398, forward: 1.202, backward: 0.628, update: 0.190
W20240204 10:25:07.264117 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.398 ms                  | 21.242 ms                 |
| Forward                   | 4.848 ms                  | 13.070 ms                 |
| Backward                  | 3.662 ms                  | 18.289 ms                 |
| Optimize                  | 1.818 ms                  | 3.356 ms                  |
| BarrierTimeBeforeRank0    | 5.579 ms                  | 27.955 ms                 |
| AfterBackward             | 27.877 ms                 | 329.874 ms                |
| BlockToStepN              | 157.374 ms                | 285.071 ms                |
| OneStep                   | 206.727 ms                | 348.806 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:08.264015 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=106, pq.top=106
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.331 ms                  | 11.092 ms                 |
| ProcessBack:UpdateCache   | 10.034 ms                 | 11.216 ms                 |
| ProcessBack:UpsertPq      | 9.697 ms                  | 15.553 ms                 |
| ProcessOneStep            | 27.852 ms                 | 329.763 ms                |
| BlockToStepN              | 160.907 ms                | 284.990 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:09.264007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240204 10:25:10.264006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240204 10:25:11.281575 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240204 10:25:12.281014 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.400 ms                  | 21.242 ms                 |
| Forward                   | 4.848 ms                  | 20.961 ms                 |
| Backward                  | 3.662 ms                  | 18.289 ms                 |
| Optimize                  | 1.818 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.548 ms                  | 27.955 ms                 |
| AfterBackward             | 27.967 ms                 | 329.874 ms                |
| BlockToStepN              | 166.506 ms                | 302.089 ms                |
| OneStep                   | 228.983 ms                | 359.309 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:13.281013 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=122, pq.top=122
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.345 ms                  | 11.092 ms                 |
| ProcessBack:UpdateCache   | 10.014 ms                 | 11.216 ms                 |
| ProcessBack:UpsertPq      | 9.697 ms                  | 15.553 ms                 |
| ProcessOneStep            | 27.943 ms                 | 329.763 ms                |
| BlockToStepN              | 175.533 ms                | 307.812 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:14.281008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240204 10:25:15.281008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=128, pq.top=128
W20240204 10:25:16.281009 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240204 10:25:17.281016 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=134, pq.top=134
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.459 ms                  | 21.242 ms                 |
| Forward                   | 4.833 ms                  | 20.961 ms                 |
| Backward                  | 3.708 ms                  | 18.289 ms                 |
| Optimize                  | 1.802 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.352 ms                  | 27.955 ms                 |
| AfterBackward             | 27.967 ms                 | 329.874 ms                |
| BlockToStepN              | 182.132 ms                | 307.921 ms                |
| OneStep                   | 238.025 ms                | 376.303 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:18.281013 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.405 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 9.990 ms                  | 11.095 ms                 |
| ProcessBack:UpsertPq      | 9.677 ms                  | 15.354 ms                 |
| ProcessOneStep            | 28.002 ms                 | 329.763 ms                |
| BlockToStepN              | 192.711 ms                | 318.636 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:19.281008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240204 10:25:20.287487 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240204 10:25:21.287009 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240204 10:25:22.287019 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=148, pq.top=148
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.479 ms                  | 22.908 ms                 |
| Forward                   | 4.833 ms                  | 20.961 ms                 |
| Backward                  | 3.706 ms                  | 18.289 ms                 |
| Optimize                  | 1.753 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.344 ms                  | 27.955 ms                 |
| AfterBackward             | 28.026 ms                 | 329.874 ms                |
| BlockToStepN              | 194.470 ms                | 352.346 ms                |
| OneStep                   | 249.500 ms                | 418.992 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:23.287015 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.398 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.012 ms                 | 11.095 ms                 |
| ProcessBack:UpsertPq      | 9.684 ms                  | 15.354 ms                 |
| ProcessOneStep            | 27.943 ms                 | 105.355 ms                |
| BlockToStepN              | 197.718 ms                | 329.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:24.287007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=154, pq.top=154
W20240204 10:25:25.318982 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240204 10:25:26.331804 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240204 10:25:27.331019 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=162, pq.top=162
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.486 ms                  | 22.908 ms                 |
| Forward                   | 4.828 ms                  | 13.070 ms                 |
| Backward                  | 3.707 ms                  | 16.693 ms                 |
| Optimize                  | 1.753 ms                  | 3.356 ms                  |
| BarrierTimeBeforeRank0    | 5.365 ms                  | 18.146 ms                 |
| AfterBackward             | 27.967 ms                 | 105.414 ms                |
| BlockToStepN              | 219.792 ms                | 333.164 ms                |
| OneStep                   | 270.235 ms                | 406.482 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:28.331012 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.400 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.017 ms                 | 11.095 ms                 |
| ProcessBack:UpsertPq      | 9.697 ms                  | 15.354 ms                 |
| ProcessOneStep            | 27.940 ms                 | 105.355 ms                |
| BlockToStepN              | 220.418 ms                | 353.881 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:29.331005 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240204 10:25:30.331007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=170, pq.top=170
W20240204 10:25:31.331008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.509 ms                  | 22.908 ms                 |
| Forward                   | 4.833 ms                  | 13.070 ms                 |
| Backward                  | 3.733 ms                  | 16.693 ms                 |
| Optimize                  | 1.739 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.367 ms                  | 23.358 ms                 |
| AfterBackward             | 28.026 ms                 | 105.414 ms                |
| BlockToStepN              | 228.507 ms                | 356.179 ms                |
| OneStep                   | 279.086 ms                | 418.992 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:32.374082 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=176
W20240204 10:25:33.374013 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=178, pq.top=178
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.409 ms                  | 10.404 ms                 |
| ProcessBack:UpdateCache   | 10.015 ms                 | 11.066 ms                 |
| ProcessBack:UpsertPq      | 9.710 ms                  | 14.347 ms                 |
| ProcessOneStep            | 27.996 ms                 | 105.355 ms                |
| BlockToStepN              | 229.554 ms                | 356.113 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:34.374007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240204 10:25:35.422766 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240204 10:25:36.422008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=186, pq.top=186
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.552 ms                  | 22.908 ms                 |
| Forward                   | 4.833 ms                  | 20.961 ms                 |
| Backward                  | 3.747 ms                  | 16.693 ms                 |
| Optimize                  | 1.733 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.352 ms                  | 24.248 ms                 |
| AfterBackward             | 27.985 ms                 | 105.414 ms                |
| BlockToStepN              | 232.857 ms                | 368.843 ms                |
| OneStep                   | 291.335 ms                | 428.764 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:37.422014 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240204 10:25:38.422012 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.436 ms                  | 10.404 ms                 |
| ProcessBack:UpdateCache   | 10.015 ms                 | 11.168 ms                 |
| ProcessBack:UpsertPq      | 9.744 ms                  | 15.354 ms                 |
| ProcessOneStep            | 27.996 ms                 | 105.355 ms                |
| BlockToStepN              | 233.650 ms                | 368.729 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:39.422006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240204 10:25:40.422008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240204 10:25:41.422006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 7] 200 steps, total: 35.503, sample: 0.323, forward: 0.424, backward: 0.522, update: 0.166
[proc 0] 200 steps, total: 35.502, sample: 0.450, forward: 0.527, backward: 0.652, update: 0.178
[proc 3] 200 steps, total: 35.502, sample: 0.380, forward: 0.449, backward: 0.760, update: 0.176
[proc 5] 200 steps, total: 35.503, sample: 0.380, forward: 0.471, backward: 0.886, update: 0.184
[proc 1] 200 steps, total: 35.502, sample: 0.342, forward: 0.437, backward: 0.412, update: 0.171
[proc 2] 200 steps, total: 35.502, sample: 0.362, forward: 0.435, backward: 0.907, update: 0.186
[proc 6] 200 steps, total: 35.503, sample: 0.361, forward: 0.452, backward: 0.877, update: 0.183
[proc 4] 200 steps, total: 35.502, sample: 0.368, forward: 0.435, backward: 0.816, update: 0.171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.552 ms                  | 22.908 ms                 |
| Forward                   | 4.833 ms                  | 20.961 ms                 |
| Backward                  | 3.764 ms                  | 16.693 ms                 |
| Optimize                  | 1.726 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.385 ms                  | 24.248 ms                 |
| AfterBackward             | 28.033 ms                 | 105.414 ms                |
| BlockToStepN              | 245.779 ms                | 371.480 ms                |
| OneStep                   | 299.073 ms                | 441.059 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:42.422012 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240204 10:25:43.422011 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=204, pq.top=204
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.444 ms                  | 10.446 ms                 |
| ProcessBack:UpdateCache   | 10.020 ms                 | 11.216 ms                 |
| ProcessBack:UpsertPq      | 9.750 ms                  | 15.354 ms                 |
| ProcessOneStep            | 28.054 ms                 | 105.355 ms                |
| BlockToStepN              | 250.494 ms                | 371.357 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:44.422008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240204 10:25:45.422006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240204 10:25:46.459122 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.576 ms                  | 22.908 ms                 |
| Forward                   | 4.833 ms                  | 20.961 ms                 |
| Backward                  | 3.790 ms                  | 16.693 ms                 |
| Optimize                  | 1.726 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.385 ms                  | 24.248 ms                 |
| AfterBackward             | 28.141 ms                 | 105.414 ms                |
| BlockToStepN              | 254.298 ms                | 376.615 ms                |
| OneStep                   | 304.440 ms                | 494.562 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:47.459005 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240204 10:25:48.459007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.463 ms                  | 10.446 ms                 |
| ProcessBack:UpdateCache   | 10.020 ms                 | 11.489 ms                 |
| ProcessBack:UpsertPq      | 9.758 ms                  | 15.354 ms                 |
| ProcessOneStep            | 28.111 ms                 | 105.355 ms                |
| BlockToStepN              | 255.725 ms                | 376.551 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:49.459007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240204 10:25:50.459005 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240204 10:25:51.459015 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=224, pq.top=224
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.564 ms                  | 23.927 ms                 |
| Forward                   | 4.833 ms                  | 20.961 ms                 |
| Backward                  | 3.873 ms                  | 18.289 ms                 |
| Optimize                  | 1.733 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.375 ms                  | 24.248 ms                 |
| AfterBackward             | 28.208 ms                 | 105.414 ms                |
| BlockToStepN              | 258.970 ms                | 388.523 ms                |
| OneStep                   | 315.735 ms                | 494.562 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:52.459007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240204 10:25:53.459007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.462 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.038 ms                 | 11.404 ms                 |
| ProcessBack:UpsertPq      | 9.774 ms                  | 15.354 ms                 |
| ProcessOneStep            | 28.235 ms                 | 105.355 ms                |
| BlockToStepN              | 260.769 ms                | 408.658 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:54.459007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240204 10:25:55.459007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=234, pq.top=234
W20240204 10:25:56.459014 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.578 ms                  | 23.927 ms                 |
| Forward                   | 4.830 ms                  | 20.961 ms                 |
| Backward                  | 3.995 ms                  | 18.289 ms                 |
| Optimize                  | 1.739 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.375 ms                  | 24.248 ms                 |
| AfterBackward             | 28.296 ms                 | 105.414 ms                |
| BlockToStepN              | 268.950 ms                | 434.336 ms                |
| OneStep                   | 320.290 ms                | 494.562 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:57.459008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240204 10:25:58.478029 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.481 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.033 ms                 | 11.489 ms                 |
| ProcessBack:UpsertPq      | 9.774 ms                  | 15.354 ms                 |
| ProcessOneStep            | 28.269 ms                 | 105.355 ms                |
| BlockToStepN              | 270.600 ms                | 433.940 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:25:59.478008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240204 10:26:00.478008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240204 10:26:01.478016 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=248, pq.top=248
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.595 ms                  | 23.927 ms                 |
| Forward                   | 4.830 ms                  | 20.961 ms                 |
| Backward                  | 4.314 ms                  | 18.289 ms                 |
| Optimize                  | 1.740 ms                  | 4.601 ms                  |
| BarrierTimeBeforeRank0    | 5.385 ms                  | 24.248 ms                 |
| AfterBackward             | 28.306 ms                 | 105.414 ms                |
| BlockToStepN              | 273.549 ms                | 436.306 ms                |
| OneStep                   | 323.220 ms                | 505.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:02.478006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
W20240204 10:26:03.478008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=252, pq.top=252
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.488 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.029 ms                 | 11.489 ms                 |
| ProcessBack:UpsertPq      | 9.783 ms                  | 15.553 ms                 |
| ProcessOneStep            | 28.314 ms                 | 50.024 ms                 |
| BlockToStepN              | 274.915 ms                | 436.192 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:04.478006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240204 10:26:05.520684 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240204 10:26:06.520009 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.580 ms                  | 22.908 ms                 |
| Forward                   | 4.828 ms                  | 19.841 ms                 |
| Backward                  | 4.859 ms                  | 16.693 ms                 |
| Optimize                  | 1.740 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.428 ms                  | 23.358 ms                 |
| AfterBackward             | 28.366 ms                 | 50.057 ms                 |
| BlockToStepN              | 282.914 ms                | 436.306 ms                |
| OneStep                   | 335.521 ms                | 501.104 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:07.520006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240204 10:26:08.520006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.497 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.020 ms                 | 11.489 ms                 |
| ProcessBack:UpsertPq      | 9.790 ms                  | 15.553 ms                 |
| ProcessOneStep            | 28.315 ms                 | 50.024 ms                 |
| BlockToStepN              | 284.990 ms                | 443.366 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:09.520007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240204 10:26:10.581491 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
W20240204 10:26:11.581009 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.591 ms                  | 22.908 ms                 |
| Forward                   | 4.828 ms                  | 19.841 ms                 |
| Backward                  | 4.754 ms                  | 16.693 ms                 |
| Optimize                  | 1.740 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.385 ms                  | 23.358 ms                 |
| AfterBackward             | 28.374 ms                 | 50.057 ms                 |
| BlockToStepN              | 290.512 ms                | 445.166 ms                |
| OneStep                   | 342.453 ms                | 505.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:12.581005 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240204 10:26:13.581007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.494 ms                  | 10.404 ms                 |
| ProcessBack:UpdateCache   | 10.029 ms                 | 11.404 ms                 |
| ProcessBack:UpsertPq      | 9.817 ms                  | 16.823 ms                 |
| ProcessOneStep            | 28.352 ms                 | 50.024 ms                 |
| BlockToStepN              | 291.888 ms                | 445.095 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:14.581007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240204 10:26:15.646734 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=282, pq.top=282
W20240204 10:26:16.646009 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.591 ms                  | 23.927 ms                 |
| Forward                   | 4.808 ms                  | 19.841 ms                 |
| Backward                  | 5.518 ms                  | 16.693 ms                 |
| Optimize                  | 1.746 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.385 ms                  | 23.358 ms                 |
| AfterBackward             | 28.379 ms                 | 50.057 ms                 |
| BlockToStepN              | 292.874 ms                | 445.166 ms                |
| OneStep                   | 348.806 ms                | 505.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:17.646006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240204 10:26:18.646006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.505 ms                  | 10.404 ms                 |
| ProcessBack:UpdateCache   | 10.033 ms                 | 11.404 ms                 |
| ProcessBack:UpsertPq      | 9.821 ms                  | 16.949 ms                 |
| ProcessOneStep            | 28.353 ms                 | 50.024 ms                 |
| BlockToStepN              | 293.340 ms                | 445.095 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:19.646006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240204 10:26:20.700737 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=294, pq.top=294
W20240204 10:26:21.700012 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=296, pq.top=296
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.595 ms                  | 23.927 ms                 |
| Forward                   | 4.808 ms                  | 19.841 ms                 |
| Backward                  | 7.332 ms                  | 18.289 ms                 |
| Optimize                  | 1.756 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.490 ms                  | 23.358 ms                 |
| AfterBackward             | 28.467 ms                 | 50.057 ms                 |
| BlockToStepN              | 298.226 ms                | 445.166 ms                |
| OneStep                   | 351.023 ms                | 505.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:22.700011 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=298, pq.top=298
[proc 5] 300 steps, total: 41.520, sample: 0.316, forward: 0.450, backward: 0.875, update: 0.180
[proc 1] 300 steps, total: 41.520, sample: 0.333, forward: 0.425, backward: 0.725, update: 0.178
[proc 6] 300 steps, total: 41.520, sample: 0.320, forward: 0.439, backward: 0.900, update: 0.182
[proc 0] 300 steps, total: 41.520, sample: 0.473, forward: 0.511, backward: 0.802, update: 0.185
[proc 7] 300 steps, total: 41.521, sample: 0.339, forward: 0.425, backward: 0.683, update: 0.172
[proc 3] 300 steps, total: 41.520, sample: 0.384, forward: 0.446, backward: 0.904, update: 0.184
[proc 2] 300 steps, total: 41.520, sample: 0.325, forward: 0.444, backward: 0.891, update: 0.188
[proc 4] 300 steps, total: 41.520, sample: 0.345, forward: 0.447, backward: 0.575, update: 0.161
W20240204 10:26:23.700006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=301, pq.top=301
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.521 ms                  | 10.446 ms                 |
| ProcessBack:UpdateCache   | 10.029 ms                 | 11.404 ms                 |
| ProcessBack:UpsertPq      | 9.821 ms                  | 16.949 ms                 |
| ProcessOneStep            | 28.440 ms                 | 50.024 ms                 |
| BlockToStepN              | 298.957 ms                | 445.095 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:24.700006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240204 10:26:25.700012 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240204 10:26:26.700011 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=307, pq.top=307
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.615 ms                  | 23.927 ms                 |
| Forward                   | 4.804 ms                  | 19.841 ms                 |
| Backward                  | 7.867 ms                  | 18.289 ms                 |
| Optimize                  | 1.770 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.527 ms                  | 23.358 ms                 |
| AfterBackward             | 28.467 ms                 | 50.057 ms                 |
| BlockToStepN              | 300.909 ms                | 445.166 ms                |
| OneStep                   | 354.372 ms                | 505.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:27.700006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240204 10:26:28.700006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=312, pq.top=312
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.519 ms                  | 10.446 ms                 |
| ProcessBack:UpdateCache   | 10.033 ms                 | 11.404 ms                 |
| ProcessBack:UpsertPq      | 9.837 ms                  | 16.949 ms                 |
| ProcessOneStep            | 28.442 ms                 | 50.024 ms                 |
| BlockToStepN              | 302.195 ms                | 445.095 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:29.700007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=314, pq.top=314
W20240204 10:26:30.700007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=316, pq.top=316
W20240204 10:26:31.700016 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.623 ms                  | 23.927 ms                 |
| Forward                   | 4.801 ms                  | 19.841 ms                 |
| Backward                  | 8.246 ms                  | 18.289 ms                 |
| Optimize                  | 1.767 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.527 ms                  | 23.358 ms                 |
| AfterBackward             | 28.489 ms                 | 50.057 ms                 |
| BlockToStepN              | 305.327 ms                | 445.166 ms                |
| OneStep                   | 359.309 ms                | 505.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:32.700006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240204 10:26:33.751152 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=324, pq.top=324
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.527 ms                  | 10.446 ms                 |
| ProcessBack:UpdateCache   | 10.029 ms                 | 11.404 ms                 |
| ProcessBack:UpsertPq      | 9.847 ms                  | 17.676 ms                 |
| ProcessOneStep            | 28.468 ms                 | 50.024 ms                 |
| BlockToStepN              | 305.556 ms                | 445.095 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:34.751006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=326, pq.top=326
W20240204 10:26:35.751008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=328, pq.top=328
W20240204 10:26:36.751015 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=330, pq.top=330
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.623 ms                  | 23.927 ms                 |
| Forward                   | 4.787 ms                  | 19.841 ms                 |
| Backward                  | 8.246 ms                  | 18.289 ms                 |
| Optimize                  | 1.767 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.548 ms                  | 23.358 ms                 |
| AfterBackward             | 28.490 ms                 | 50.057 ms                 |
| BlockToStepN              | 307.281 ms                | 448.631 ms                |
| OneStep                   | 365.454 ms                | 512.047 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:37.751006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240204 10:26:38.751006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.527 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.034 ms                 | 11.489 ms                 |
| ProcessBack:UpsertPq      | 9.847 ms                  | 17.676 ms                 |
| ProcessOneStep            | 28.463 ms                 | 50.024 ms                 |
| BlockToStepN              | 307.812 ms                | 448.495 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:39.751008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240204 10:26:40.751005 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=340, pq.top=340
W20240204 10:26:41.751019 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=342, pq.top=342
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.618 ms                  | 23.927 ms                 |
| Forward                   | 4.801 ms                  | 19.841 ms                 |
| Backward                  | 7.837 ms                  | 18.289 ms                 |
| Optimize                  | 1.756 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.579 ms                  | 23.358 ms                 |
| AfterBackward             | 28.490 ms                 | 50.057 ms                 |
| BlockToStepN              | 308.876 ms                | 448.631 ms                |
| OneStep                   | 366.458 ms                | 512.047 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:42.751011 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=344, pq.top=344
W20240204 10:26:43.751008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=346, pq.top=346
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.525 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.027 ms                 | 11.489 ms                 |
| ProcessBack:UpsertPq      | 9.858 ms                  | 18.384 ms                 |
| ProcessOneStep            | 28.463 ms                 | 50.024 ms                 |
| BlockToStepN              | 309.153 ms                | 453.325 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:44.751006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=349, pq.top=349
W20240204 10:26:45.751006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=351, pq.top=351
W20240204 10:26:46.751024 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=353, pq.top=353
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.628 ms                  | 23.603 ms                 |
| Forward                   | 4.786 ms                  | 16.998 ms                 |
| Backward                  | 6.555 ms                  | 16.693 ms                 |
| Optimize                  | 1.756 ms                  | 3.393 ms                  |
| BarrierTimeBeforeRank0    | 5.605 ms                  | 22.928 ms                 |
| AfterBackward             | 28.489 ms                 | 42.968 ms                 |
| BlockToStepN              | 310.920 ms                | 448.631 ms                |
| OneStep                   | 368.616 ms                | 512.047 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:47.768343 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=356, pq.top=356
W20240204 10:26:48.768007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=358, pq.top=358
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.506 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.028 ms                 | 11.489 ms                 |
| ProcessBack:UpsertPq      | 9.860 ms                  | 18.429 ms                 |
| ProcessOneStep            | 28.461 ms                 | 42.938 ms                 |
| BlockToStepN              | 311.314 ms                | 453.325 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:49.768007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=360, pq.top=360
W20240204 10:26:50.768007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=363, pq.top=363
W20240204 10:26:51.768013 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.636 ms                  | 23.603 ms                 |
| Forward                   | 4.786 ms                  | 16.998 ms                 |
| Backward                  | 5.315 ms                  | 16.693 ms                 |
| Optimize                  | 1.747 ms                  | 3.393 ms                  |
| BarrierTimeBeforeRank0    | 5.615 ms                  | 22.985 ms                 |
| AfterBackward             | 28.470 ms                 | 42.968 ms                 |
| BlockToStepN              | 316.050 ms                | 453.431 ms                |
| OneStep                   | 369.945 ms                | 512.047 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:52.768010 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240204 10:26:53.768007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.505 ms                  | 10.446 ms                 |
| ProcessBack:UpdateCache   | 10.031 ms                 | 11.489 ms                 |
| ProcessBack:UpsertPq      | 9.863 ms                  | 18.429 ms                 |
| ProcessOneStep            | 28.445 ms                 | 42.938 ms                 |
| BlockToStepN              | 316.201 ms                | 453.325 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:54.768007 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240204 10:26:55.807519 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=374, pq.top=374
W20240204 10:26:56.807024 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.647 ms                  | 23.603 ms                 |
| Forward                   | 4.787 ms                  | 16.998 ms                 |
| Backward                  | 4.530 ms                  | 16.693 ms                 |
| Optimize                  | 1.740 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.639 ms                  | 22.985 ms                 |
| AfterBackward             | 28.489 ms                 | 42.968 ms                 |
| BlockToStepN              | 316.823 ms                | 458.513 ms                |
| OneStep                   | 372.427 ms                | 521.819 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:57.807006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=378, pq.top=378
W20240204 10:26:58.807006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=380, pq.top=380
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.496 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.034 ms                 | 11.404 ms                 |
| ProcessBack:UpsertPq      | 9.883 ms                  | 18.429 ms                 |
| ProcessOneStep            | 28.463 ms                 | 42.938 ms                 |
| BlockToStepN              | 317.847 ms                | 458.411 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:26:59.807008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240204 10:27:00.850867 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240204 10:27:01.850008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=387, pq.top=387
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.647 ms                  | 23.603 ms                 |
| Forward                   | 4.787 ms                  | 16.998 ms                 |
| Backward                  | 4.242 ms                  | 16.693 ms                 |
| Optimize                  | 1.739 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.648 ms                  | 22.985 ms                 |
| AfterBackward             | 28.490 ms                 | 42.968 ms                 |
| BlockToStepN              | 318.719 ms                | 458.513 ms                |
| OneStep                   | 376.619 ms                | 521.819 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:27:02.850006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=389, pq.top=389
W20240204 10:27:03.850008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=391, pq.top=391
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.494 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.038 ms                 | 11.404 ms                 |
| ProcessBack:UpsertPq      | 9.903 ms                  | 19.091 ms                 |
| ProcessOneStep            | 28.463 ms                 | 42.938 ms                 |
| BlockToStepN              | 318.711 ms                | 458.411 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:27:04.850006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240204 10:27:05.850013 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=395, pq.top=395
W20240204 10:27:06.850009 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=398, pq.top=398
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.659 ms                  | 23.603 ms                 |
| Forward                   | 4.787 ms                  | 16.998 ms                 |
| Backward                  | 3.995 ms                  | 16.693 ms                 |
| Optimize                  | 1.739 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.639 ms                  | 22.985 ms                 |
| AfterBackward             | 28.490 ms                 | 42.968 ms                 |
| BlockToStepN              | 320.373 ms                | 472.977 ms                |
| OneStep                   | 379.239 ms                | 535.152 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:27:07.850008 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=400, pq.top=400
[proc 2] 400 steps, total: 44.459, sample: 0.328, forward: 0.429, backward: 0.875, update: 0.187
[proc 5] 400 steps, total: 44.459, sample: 0.338, forward: 0.434, backward: 0.877, update: 0.181
[proc 7] 400 steps, total: 44.459, sample: 0.340, forward: 0.426, backward: 0.900, update: 0.175
[proc 4] 400 steps, total: 44.459, sample: 0.349, forward: 0.431, backward: 0.420, update: 0.154
[proc 6] 400 steps, total: 44.459, sample: 0.313, forward: 0.438, backward: 0.885, update: 0.175
[proc 1] 400 steps, total: 44.459, sample: 0.306, forward: 0.443, backward: 0.853, update: 0.178
[proc 3] 400 steps, total: 44.459, sample: 0.311, forward: 0.426, backward: 0.939, update: 0.172
[proc 0] 400 steps, total: 44.459, sample: 0.407, forward: 0.477, backward: 0.490, update: 0.175
W20240204 10:27:08.850006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=402, pq.top=402
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.489 ms                  | 10.416 ms                 |
| ProcessBack:UpdateCache   | 10.041 ms                 | 11.404 ms                 |
| ProcessBack:UpsertPq      | 9.914 ms                  | 19.091 ms                 |
| ProcessOneStep            | 28.468 ms                 | 42.938 ms                 |
| BlockToStepN              | 320.709 ms                | 472.858 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:27:09.888338 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240204 10:27:10.888012 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240204 10:27:11.888011 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=409, pq.top=409
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.661 ms                  | 23.603 ms                 |
| Forward                   | 4.801 ms                  | 16.998 ms                 |
| Backward                  | 3.972 ms                  | 16.693 ms                 |
| Optimize                  | 1.730 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.615 ms                  | 22.985 ms                 |
| AfterBackward             | 28.493 ms                 | 42.968 ms                 |
| BlockToStepN              | 321.852 ms                | 472.977 ms                |
| OneStep                   | 381.928 ms                | 535.152 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:27:12.888006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240204 10:27:13.941498 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.489 ms                  | 10.446 ms                 |
| ProcessBack:UpdateCache   | 10.038 ms                 | 11.404 ms                 |
| ProcessBack:UpsertPq      | 9.930 ms                  | 19.264 ms                 |
| ProcessOneStep            | 28.468 ms                 | 42.938 ms                 |
| BlockToStepN              | 323.970 ms                | 472.858 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:27:14.941006 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=416, pq.top=416
W20240204 10:27:15.947717 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=418, pq.top=418
W20240204 10:27:16.947010 53569 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=420, pq.top=420
Successfully xmh. training takes 152.33514761924744 seconds
before call kg_cache_controller.StopThreads()
W20240204 10:27:17.255252 53569 grad_async_v1.h:243] call StopThreads. PID = 52581
W20240204 10:27:17.255281 53569 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 10:27:17.260848 53569 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 10:27:17.260859 53569 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 10:27:17.328192 53569 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.681 ms                  | 23.603 ms                 |
| Forward                   | 4.787 ms                  | 16.998 ms                 |
| Backward                  | 3.916 ms                  | 16.693 ms                 |
| Optimize                  | 1.730 ms                  | 3.489 ms                  |
| BarrierTimeBeforeRank0    | 5.639 ms                  | 23.358 ms                 |
| AfterBackward             | 28.500 ms                 | 42.968 ms                 |
| BlockToStepN              | 325.017 ms                | 476.454 ms                |
| OneStep                   | 382.878 ms                | 551.958 ms                |
+---------------------------+---------------------------+---------------------------+
