WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 12:39:18.124349 56873 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_113', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=2, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [56873 sampler.py:454] Start PreSampling
WARNING [56873 sampler.py:532] Before construct renumbering_dict
WARNING [56873 sampler.py:555] PreSampling done
W20240205 12:59:41.650053 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 12:59:41.650244 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 12:59:41.650282 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 12:59:41.650321 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 12:59:41.650350 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 12:59:41.650382 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 12:59:41.650408 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 12:59:41.650449 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 12:59:41.650478 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 12:59:41.650509 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 12:59:41.650552 56873 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 12:59:41.650579 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 12:59:41.650602 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 12:59:41.650759 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 12:59:41.650802 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 12:59:41.650831 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 12:59:41.650882 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 12:59:41.650918 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 12:59:41.650950 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 12:59:41.650980 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 12:59:41.651010 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 12:59:41.651036 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 12:59:41.651077 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 12:59:41.651109 56873 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 12:59:41.651131 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 12:59:41.651156 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 12:59:41.651216 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 12:59:41.651252 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 12:59:41.651285 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 12:59:41.651319 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 12:59:41.651347 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 12:59:41.651383 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 12:59:41.651417 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 12:59:41.651448 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 12:59:41.651486 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 12:59:41.651518 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 12:59:41.651551 56873 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 12:59:41.651572 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 12:59:41.651595 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 12:59:41.651662 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 12:59:41.651701 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 12:59:41.651738 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 12:59:41.651773 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 12:59:41.651809 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 12:59:41.651845 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 12:59:41.651878 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 12:59:41.651906 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 12:59:41.651935 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 12:59:41.651970 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 12:59:41.652000 56873 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 12:59:41.652022 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 12:59:41.652046 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 12:59:41.652115 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 12:59:41.652168 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 12:59:41.652195 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 12:59:41.652223 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 12:59:41.652251 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 12:59:41.652287 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 12:59:41.652323 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 12:59:41.652351 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 12:59:41.652386 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 12:59:41.652418 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 12:59:41.652446 56873 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 12:59:41.652470 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 12:59:41.652498 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 12:59:41.652554 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 12:59:41.652591 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 12:59:41.652622 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 12:59:41.652655 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 12:59:41.652688 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 12:59:41.652719 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 12:59:41.652757 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 12:59:41.652791 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 12:59:41.652818 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 12:59:41.652848 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 12:59:41.652879 56873 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 12:59:41.652904 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 12:59:41.652926 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 12:59:41.652982 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 12:59:41.653013 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 12:59:41.653044 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 12:59:41.653072 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 12:59:41.653106 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 12:59:41.653138 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 12:59:41.653173 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 12:59:41.653211 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 12:59:41.653241 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 12:59:41.653277 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 12:59:41.653306 56873 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 12:59:41.653329 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 12:59:41.653352 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 12:59:41.653400 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 12:59:41.653434 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 12:59:41.653461 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 12:59:41.653501 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 12:59:41.653528 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 12:59:41.653555 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 12:59:41.653591 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 12:59:41.653621 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 12:59:41.653648 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 12:59:41.653687 56873 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 12:59:41.653717 56873 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 12:59:41.653739 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 12:59:41.653766 56873 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 12:59:42.095364 56873 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 13:08:16.134696 56873 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302705,  4302711,    91449,  ..., 69315936, 50376532,  5138814]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2240.685 seconds
[Rank1] pid = 20596
[Rank2] pid = 20691
[Rank3] pid = 20760
[Rank4] pid = 20827
[Rank5] pid = 20894
[Rank6] pid = 21026
INFO [56873 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [20596 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [20691 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [20760 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [20827 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [20894 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [21026 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [21190 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [56873 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21190 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20827 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21026 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20596 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20894 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20691 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20760 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 13:16:50.469102 21295 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 13:16:50.470623 21205 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 13:16:50.470711 20828 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 13:16:50.470714 21048 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 13:16:50.470715 20597 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 13:16:50.470754 20692 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 13:16:50.470809 20895 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 13:16:50.471190 20761 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 13:16:50.550273 20828 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102049f52000 7.629 MB
W20240205 13:16:50.550276 21048 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204a6f5000 7.629 MB
W20240205 13:16:50.550266 21295 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1020497af000 7.629 MB
W20240205 13:16:50.550305 20692 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204ae98000 7.629 MB
W20240205 13:16:50.550312 20761 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204b63b000 7.629 MB
W20240205 13:16:50.550324 20895 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204bdde000 7.629 MB
W20240205 13:16:50.550328 21205 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204c581000 7.629 MB
W20240205 13:16:50.550437 21295 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10204cd24000 7.629 MB
W20240205 13:16:50.550468 20828 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204d4c7000 7.629 MB
W20240205 13:16:50.550472 21048 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204dc6a000 7.629 MB
W20240205 13:16:50.550489 20692 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10204e40d000 7.629 MB
W20240205 13:16:50.550491 21295 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10204ebb0000 1.49 GB
W20240205 13:16:50.550518 20895 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1020ae193000 7.629 MB
W20240205 13:16:50.550524 21205 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1020ae936000 7.629 MB
W20240205 13:16:50.550532 20761 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1020af0d9000 7.629 MB
W20240205 13:16:50.550544 21295 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1020af87c000 1.49 GB
W20240205 13:16:50.550570 20828 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10210ee5f000 1.49 GB
W20240205 13:16:50.550576 21048 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10216e442000 1.49 GB
W20240205 13:16:50.550595 20692 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1021cda25000 1.49 GB
W20240205 13:16:50.550601 21295 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 13:16:50.550616 20895 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10222d008000 1.49 GB
W20240205 13:16:50.550632 21205 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10228c5eb000 1.49 GB
W20240205 13:16:50.550650 20828 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1022ebbce000 1.49 GB
W20240205 13:16:50.550658 20761 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10234b1b1000 1.49 GB
W20240205 13:16:50.550684 20692 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1023aa794000 1.49 GB
W20240205 13:16:50.550690 21048 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x102409d77000 1.49 GB
W20240205 13:16:50.550698 20895 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10246935a000 1.49 GB
W20240205 13:16:50.550721 21205 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1024c893d000 1.49 GB
W20240205 13:16:50.550732 20828 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 13:16:50.550752 20761 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102527f20000 1.49 GB
W20240205 13:16:50.550766 21048 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 13:16:50.550766 20692 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 13:16:50.550769 20895 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 13:16:50.550788 21205 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 13:16:50.550807 20761 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 13:16:50.562252 21295 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 13:16:50.562269 20828 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 13:16:50.562283 21048 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 13:16:50.562288 21205 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 13:16:50.562312 20895 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 13:16:50.562315 20692 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 13:16:50.562328 20761 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 13:16:50.574321 20597 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10258751f000 7.629 MB
W20240205 13:16:50.574507 20597 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102587cc4000 7.629 MB
W20240205 13:16:50.574625 20597 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x102588467000 1.49 GB
W20240205 13:16:50.574721 20597 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1025e7a4a000 1.49 GB
W20240205 13:16:50.574800 20597 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 13:16:50.579921 20597 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
[Rank7] pid = 21190
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [56873 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [20760 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [21026 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [20691 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [21190 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [20596 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [20827 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [20894 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 13:17:40.592306 20895 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 13:17:40.593179 20828 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 13:17:40.593225 20597 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 13:17:40.593273 20761 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 13:17:40.593349 21048 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 13:17:40.593421 21205 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 13:17:40.593479 21295 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 13:17:40.593544 20692 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 13:17:40.595829 21295 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 2,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 13:17:40.596441 21295 grad_base.h:184] Init GradProcessingBase done
I20240205 13:17:53.338137 21295 grad_async_v1.h:203] Use main thread to update emb.
W20240205 13:17:53.338371 21295 kg_controller.h:75] after init GradAsyncProcessing
I20240205 13:17:53.338380 21295 kg_controller.h:84] Construct KGCacheController done
E20240205 13:17:55.128834 21048 recstore.cc:66] init folly done
E20240205 13:17:55.128867 20692 recstore.cc:66] init folly done
E20240205 13:17:55.128871 20828 recstore.cc:66] init folly done
E20240205 13:17:55.128885 20895 recstore.cc:66] init folly done
E20240205 13:17:55.128904 20597 recstore.cc:66] init folly done
E20240205 13:17:55.128911 20761 recstore.cc:66] init folly done
E20240205 13:17:55.128927 21205 recstore.cc:66] init folly done
E20240205 13:17:55.128927 21295 recstore.cc:66] init folly done
I20240205 13:17:55.130039 21295 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 13:18:16.587092 20895 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 13:18:16.658746 21205 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 13:18:16.790952 20828 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 13:18:17.899668 20692 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 13:18:18.831362 20761 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 13:18:18.844027 20597 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 13:18:19.375633 21295 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 13:18:20.010567 21048 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 31.087 ms                 | 31.087 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:22.358518 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240205 13:18:23.419337 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240205 13:18:24.419008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.857 ms                  | 345.378 ms                |
| ProcessBack:UpdateCache   | 11.468 ms                 | 660.051 ms                |
| ProcessBack:UpsertPq      | 42.093 ms                 | 52.878 ms                 |
| ProcessOneStep            | 68.097 ms                 | 1.337 s                   |
| BlockToStepN              | 2.338 ms                  | 824.528 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:25.419006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.325 ms                 | 250.440 ms                |
| Forward                   | 6.255 ms                  | 776.641 ms                |
| Backward                  | 10.414 ms                 | 192.595 ms                |
| Optimize                  | 4.278 ms                  | 4.567 ms                  |
| BarrierTimeBeforeRank0    | 4.645 ms                  | 11.992 ms                 |
| AfterBackward             | 68.129 ms                 | 1.338 s                   |
| BlockToStepN              | 403.429 ms                | 826.152 ms                |
| OneStep                   | 502.484 ms                | 3.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:26.419009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240205 13:18:27.419009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240205 13:18:28.419008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240205 13:18:29.419008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.695 ms                  | 345.378 ms                |
| ProcessBack:UpdateCache   | 10.038 ms                 | 660.051 ms                |
| ProcessBack:UpsertPq      | 43.139 ms                 | 101.809 ms                |
| ProcessOneStep            | 68.097 ms                 | 1.337 s                   |
| BlockToStepN              | 3.832 ms                  | 835.130 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:30.419005 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.527 ms                 | 250.440 ms                |
| Forward                   | 5.310 ms                  | 776.641 ms                |
| Backward                  | 10.501 ms                 | 192.595 ms                |
| Optimize                  | 2.823 ms                  | 5.303 ms                  |
| BarrierTimeBeforeRank0    | 58.150 us                 | 11.992 ms                 |
| AfterBackward             | 68.129 ms                 | 1.338 s                   |
| BlockToStepN              | 3.903 ms                  | 835.268 ms                |
| OneStep                   | 239.634 ms                | 3.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:31.419008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240205 13:18:32.419008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240205 13:18:33.419008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240205 13:18:34.419008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.695 ms                  | 311.413 ms                |
| ProcessBack:UpdateCache   | 10.041 ms                 | 659.108 ms                |
| ProcessBack:UpsertPq      | 42.093 ms                 | 95.236 ms                 |
| ProcessOneStep            | 66.987 ms                 | 1.337 s                   |
| BlockToStepN              | 6.994 ms                  | 835.130 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:35.419005 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.262 ms                  | 306.822 ms                |
| Forward                   | 5.310 ms                  | 776.641 ms                |
| Backward                  | 10.501 ms                 | 192.595 ms                |
| Optimize                  | 2.823 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 58.150 us                 | 15.511 ms                 |
| AfterBackward             | 67.017 ms                 | 1.338 s                   |
| BlockToStepN              | 7.031 ms                  | 835.268 ms                |
| OneStep                   | 239.634 ms                | 3.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:36.419010 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240205 13:18:37.419006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240205 13:18:38.419008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240205 13:18:39.419008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.695 ms                  | 311.413 ms                |
| ProcessBack:UpdateCache   | 10.038 ms                 | 659.108 ms                |
| ProcessBack:UpsertPq      | 40.926 ms                 | 95.236 ms                 |
| ProcessOneStep            | 66.518 ms                 | 1.337 s                   |
| BlockToStepN              | 7.594 ms                  | 835.130 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:40.419006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.068 ms                  | 306.822 ms                |
| Forward                   | 5.310 ms                  | 776.641 ms                |
| Backward                  | 10.501 ms                 | 192.595 ms                |
| Optimize                  | 2.823 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 89.190 us                 | 25.281 ms                 |
| AfterBackward             | 66.546 ms                 | 1.338 s                   |
| BlockToStepN              | 7.634 ms                  | 835.268 ms                |
| OneStep                   | 239.634 ms                | 3.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:41.419005 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240205 13:18:42.462239 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=40, pq.top=40
W20240205 13:18:43.567379 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240205 13:18:44.608928 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.742 ms                  | 311.413 ms                |
| ProcessBack:UpdateCache   | 10.070 ms                 | 659.108 ms                |
| ProcessBack:UpsertPq      | 40.926 ms                 | 95.236 ms                 |
| ProcessOneStep            | 67.382 ms                 | 1.337 s                   |
| BlockToStepN              | 7.594 ms                  | 835.130 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.696 ms                  | 306.822 ms                |
| Forward                   | 5.273 ms                  | 776.641 ms                |
| Backward                  | 10.502 ms                 | 192.595 ms                |
| Optimize                  | 2.821 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 324.479 us                | 134.416 ms                |
| AfterBackward             | 67.411 ms                 | 1.338 s                   |
| BlockToStepN              | 7.634 ms                  | 835.268 ms                |
| OneStep                   | 301.571 ms                | 3.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:45.633306 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240205 13:18:46.668825 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240205 13:18:47.792572 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240205 13:18:48.923372 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.789 ms                  | 311.413 ms                |
| ProcessBack:UpdateCache   | 10.409 ms                 | 659.108 ms                |
| ProcessBack:UpsertPq      | 43.139 ms                 | 132.097 ms                |
| ProcessOneStep            | 68.097 ms                 | 198.645 ms                |
| BlockToStepN              | 7.594 ms                  | 824.528 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:50.133584 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.890 ms                  | 286.250 ms                |
| Forward                   | 5.269 ms                  | 30.541 ms                 |
| Backward                  | 10.554 ms                 | 12.238 ms                 |
| Optimize                  | 2.898 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 418.661 us                | 51.619 ms                 |
| AfterBackward             | 68.402 ms                 | 198.689 ms                |
| BlockToStepN              | 7.634 ms                  | 826.152 ms                |
| OneStep                   | 301.571 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:51.247931 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240205 13:18:52.247006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240205 13:18:53.478868 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240205 13:18:54.506675 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.789 ms                  | 311.413 ms                |
| ProcessBack:UpdateCache   | 10.041 ms                 | 659.108 ms                |
| ProcessBack:UpsertPq      | 43.413 ms                 | 132.097 ms                |
| ProcessOneStep            | 68.896 ms                 | 198.645 ms                |
| BlockToStepN              | 7.594 ms                  | 824.528 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:55.507429 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.974 ms                  | 286.250 ms                |
| Forward                   | 5.269 ms                  | 30.541 ms                 |
| Backward                  | 10.518 ms                 | 12.238 ms                 |
| Optimize                  | 2.863 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 194.755 us                | 51.619 ms                 |
| AfterBackward             | 68.493 ms                 | 198.689 ms                |
| BlockToStepN              | 7.634 ms                  | 826.152 ms                |
| OneStep                   | 301.571 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:18:56.529548 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240205 13:18:57.640122 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240205 13:18:58.640007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240205 13:18:59.640007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.745 ms                  | 311.413 ms                |
| ProcessBack:UpdateCache   | 9.997 ms                  | 659.108 ms                |
| ProcessBack:UpsertPq      | 42.093 ms                 | 132.097 ms                |
| ProcessOneStep            | 68.004 ms                 | 198.645 ms                |
| BlockToStepN              | 7.594 ms                  | 824.528 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.898 ms                  | 286.250 ms                |
| Forward                   | 5.229 ms                  | 30.541 ms                 |
| Backward                  | 10.499 ms                 | 12.238 ms                 |
| Optimize                  | 2.877 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 82.048 us                 | 51.619 ms                 |
| AfterBackward             | 67.980 ms                 | 198.689 ms                |
| BlockToStepN              | 8.374 ms                  | 826.152 ms                |
| OneStep                   | 301.571 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:00.640007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240205 13:19:01.640009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240205 13:19:02.640008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240205 13:19:03.640008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240205 13:19:04.640009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.722 ms                  | 17.357 ms                 |
| ProcessBack:UpdateCache   | 9.941 ms                  | 14.468 ms                 |
| ProcessBack:UpsertPq      | 39.723 ms                 | 109.948 ms                |
| ProcessOneStep            | 66.987 ms                 | 198.645 ms                |
| BlockToStepN              | 8.329 ms                  | 824.528 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.372 ms                  | 286.250 ms                |
| Forward                   | 5.226 ms                  | 30.541 ms                 |
| Backward                  | 10.493 ms                 | 12.238 ms                 |
| Optimize                  | 2.898 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 269.748 us                | 51.619 ms                 |
| AfterBackward             | 66.675 ms                 | 198.689 ms                |
| BlockToStepN              | 9.285 ms                  | 826.152 ms                |
| OneStep                   | 301.571 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:05.640004 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240205 13:19:06.640007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240205 13:19:07.640007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240205 13:19:08.640008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240205 13:19:09.640007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 17.357 ms                 |
| ProcessBack:UpdateCache   | 9.884 ms                  | 14.468 ms                 |
| ProcessBack:UpsertPq      | 38.464 ms                 | 109.948 ms                |
| ProcessOneStep            | 65.727 ms                 | 198.645 ms                |
| BlockToStepN              | 9.582 ms                  | 835.130 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.974 ms                  | 286.250 ms                |
| Forward                   | 5.224 ms                  | 30.541 ms                 |
| Backward                  | 10.499 ms                 | 12.238 ms                 |
| Optimize                  | 2.863 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 245.228 us                | 51.619 ms                 |
| AfterBackward             | 65.615 ms                 | 198.689 ms                |
| BlockToStepN              | 9.622 ms                  | 835.268 ms                |
| OneStep                   | 301.571 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:10.640004 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240205 13:19:11.640008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 52.460, sample: 1.521, forward: 1.226, backward: 1.205, update: 0.316
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 55.679, sample: 1.510, forward: 1.260, backward: 1.248, update: 0.280
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 55.812, sample: 1.406, forward: 1.204, backward: 1.031, update: 0.279
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 53.626, sample: 1.694, forward: 1.308, backward: 1.249, update: 0.282
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 54.571, sample: 1.483, forward: 1.269, backward: 1.230, update: 0.268
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 55.883, sample: 1.429, forward: 1.237, backward: 1.215, update: 0.278
train_sampler.Prefill()
-------Step 0-------
tensor([   44205,    44231,    44265,    44294,  5952244,    91541, 59006057,
        16602887, 21287777,    44318]) tensor([ 5278985, 13552741, 61407725, 71226550, 22705292, 33220486, 41461652,
        77803542, 61448282, 28165096])
-------Step 1-------
tensor([   44205,    44231,    44265,    44294,  5952244,    91541, 59006057,
        16602887, 21287777,    44318]) tensor([73398003, 28711810, 11914600, 71256899, 79685701, 48052771, 76978645,
        54271813, 42294962, 12192727])
-------Step 2-------
tensor([  107033,   107061,   107089,    22091,   107107,   107135,   107158,
        22149753,   107184,   107206]) tensor([64004887, 23295528, 84908246, 48755443, 44933385, 27368040, 73743952,
        40196842, 15881566, 47073405])
-------Step 3-------
tensor([  107033,   107061,   107089,    22091,   107107,   107135,   107158,
        22149753,   107184,   107206]) tensor([55430515, 75626121, 32403084, 40440561, 60557302, 56258897, 32253105,
        15208810, 25767879,   789827])
-------Step 4-------
tensor([  169047, 43572503,   169073,   114653,   169102,   114676,   169129,
        42249438,   169158,   169183]) tensor([71986349,  9460122, 85771664, 20372069, 78813072, 43894402, 61468541,
        39686698, 77905052, 52786054])
-------Step 5-------
tensor([  169047, 43572503,   169073,   114653,   169102,   114676,   169129,
        42249438,   169158,   169183]) tensor([31467398, 83278942,   206388, 84772801, 50888030, 60465853, 16632835,
         9995712, 74020227, 44494045])
-------Step 6-------
tensor([  231602,    46391,   231633,   231657,    46423, 69636468,   231674,
          231697,   126082, 38479074]) tensor([14607752, 36168377, 31217227, 72043127, 29508478, 41516677, 21409434,
         6237449, 60495182, 76266413])
-------Step 7-------
tensor([  231602,    46391,   231633,   231657,    46423, 69636468,   231674,
          231697,   126082, 38479074]) tensor([24330680, 45658706, 66921193, 63942143, 72432029, 48919166, 59230427,
        63417983, 33311055, 35826060])
-------Step 8-------
tensor([  292215, 26367138,   292239,   136813,   292257,    57996,   292282,
          292307,   292337,   292362]) tensor([45894708, 21665584, 38659811,  1907893, 43288474, 69419158, 17078495,
        79487495,  1596086, 54745585])
-------Step 9-------
tensor([  292215, 26367138,   292239,   136813,   292257,    57996,   292282,
          292307,   292337,   292362]) tensor([50159012, 33060836, 12373880, 61706091,  9748221, 35883178, 23328744,
        32827736, 85681192, 68747329])
before start barrier
start train
[proc 0] 100 steps, total: 53.095, sample: 2.724, forward: 1.330, backward: 1.188, update: 0.349
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 53.639, sample: 1.593, forward: 1.213, backward: 1.233, update: 0.283
W20240205 13:19:12.640007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240205 13:19:13.722720 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240205 13:19:14.758916 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.853 ms                  | 14.468 ms                 |
| ProcessBack:UpsertPq      | 37.638 ms                 | 109.948 ms                |
| ProcessOneStep            | 64.948 ms                 | 198.645 ms                |
| BlockToStepN              | 9.582 ms                  | 855.936 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.481 ms                  | 286.250 ms                |
| Forward                   | 5.226 ms                  | 30.541 ms                 |
| Backward                  | 10.488 ms                 | 12.238 ms                 |
| Optimize                  | 2.816 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 245.228 us                | 51.619 ms                 |
| AfterBackward             | 64.983 ms                 | 198.689 ms                |
| BlockToStepN              | 379.576 ms                | 856.040 ms                |
| OneStep                   | 502.484 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:15.758008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240205 13:19:16.758008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240205 13:19:17.758008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240205 13:19:18.758008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240205 13:19:19.758008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.730 ms                  | 14.468 ms                 |
| ProcessBack:UpsertPq      | 38.622 ms                 | 109.948 ms                |
| ProcessOneStep            | 65.727 ms                 | 198.645 ms                |
| BlockToStepN              | 9.582 ms                  | 855.936 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.436 ms                  | 286.250 ms                |
| Forward                   | 5.206 ms                  | 30.541 ms                 |
| Backward                  | 10.493 ms                 | 12.238 ms                 |
| Optimize                  | 2.823 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 245.228 us                | 51.619 ms                 |
| AfterBackward             | 65.615 ms                 | 198.689 ms                |
| BlockToStepN              | 9.622 ms                  | 856.040 ms                |
| OneStep                   | 301.571 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:20.758008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240205 13:19:21.854200 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240205 13:19:22.863090 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=120, pq.top=120
W20240205 13:19:23.941655 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=122, pq.top=122
W20240205 13:19:25.030725 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=124, pq.top=124
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.722 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.710 ms                  | 14.468 ms                 |
| ProcessBack:UpsertPq      | 38.473 ms                 | 109.948 ms                |
| ProcessOneStep            | 65.387 ms                 | 198.645 ms                |
| BlockToStepN              | 9.582 ms                  | 859.926 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.738 ms                  | 286.250 ms                |
| Forward                   | 5.186 ms                  | 30.541 ms                 |
| Backward                  | 10.501 ms                 | 12.939 ms                 |
| Optimize                  | 2.863 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 269.748 us                | 53.455 ms                 |
| AfterBackward             | 65.442 ms                 | 198.689 ms                |
| BlockToStepN              | 9.622 ms                  | 860.056 ms                |
| OneStep                   | 301.571 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:26.055119 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=126, pq.top=126
W20240205 13:19:27.076633 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=128, pq.top=128
W20240205 13:19:28.149823 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240205 13:19:29.149005 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.722 ms                  | 18.860 ms                 |
| ProcessBack:UpdateCache   | 9.670 ms                  | 14.181 ms                 |
| ProcessBack:UpsertPq      | 38.249 ms                 | 102.030 ms                |
| ProcessOneStep            | 64.833 ms                 | 198.645 ms                |
| BlockToStepN              | 44.860 ms                 | 859.926 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:30.372181 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.060 ms                  | 286.250 ms                |
| Forward                   | 5.169 ms                  | 30.541 ms                 |
| Backward                  | 10.506 ms                 | 13.225 ms                 |
| Optimize                  | 2.823 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 125.332 us                | 53.455 ms                 |
| AfterBackward             | 64.869 ms                 | 198.689 ms                |
| BlockToStepN              | 44.906 ms                 | 860.056 ms                |
| OneStep                   | 301.571 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:31.385864 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240205 13:19:32.385007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240205 13:19:33.385006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240205 13:19:34.385006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.716 ms                  | 18.860 ms                 |
| ProcessBack:UpdateCache   | 9.639 ms                  | 14.181 ms                 |
| ProcessBack:UpsertPq      | 37.572 ms                 | 102.030 ms                |
| ProcessOneStep            | 63.853 ms                 | 198.645 ms                |
| BlockToStepN              | 44.860 ms                 | 859.926 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:35.402197 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.068 ms                  | 286.250 ms                |
| Forward                   | 5.133 ms                  | 30.541 ms                 |
| Backward                  | 10.535 ms                 | 13.225 ms                 |
| Optimize                  | 2.856 ms                  | 10.426 ms                 |
| BarrierTimeBeforeRank0    | 80.852 us                 | 53.455 ms                 |
| AfterBackward             | 63.702 ms                 | 198.689 ms                |
| BlockToStepN              | 65.196 ms                 | 860.056 ms                |
| OneStep                   | 301.571 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:36.437150 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240205 13:19:37.501600 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240205 13:19:38.714052 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240205 13:19:39.714897 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=152, pq.top=152
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 18.860 ms                 |
| ProcessBack:UpdateCache   | 9.624 ms                  | 14.181 ms                 |
| ProcessBack:UpsertPq      | 37.127 ms                 | 102.030 ms                |
| ProcessOneStep            | 62.977 ms                 | 154.886 ms                |
| BlockToStepN              | 90.876 ms                 | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.372 ms                  | 278.820 ms                |
| Forward                   | 5.156 ms                  | 12.105 ms                 |
| Backward                  | 10.547 ms                 | 12.939 ms                 |
| Optimize                  | 2.821 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 75.040 us                 | 53.455 ms                 |
| AfterBackward             | 63.025 ms                 | 154.928 ms                |
| BlockToStepN              | 90.973 ms                 | 857.188 ms                |
| OneStep                   | 301.571 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:40.754114 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=154, pq.top=154
W20240205 13:19:41.754333 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
W20240205 13:19:42.762475 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=158, pq.top=158
W20240205 13:19:43.772040 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240205 13:19:44.841910 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=162, pq.top=162
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.716 ms                  | 18.860 ms                 |
| ProcessBack:UpdateCache   | 9.643 ms                  | 14.181 ms                 |
| ProcessBack:UpsertPq      | 36.334 ms                 | 102.030 ms                |
| ProcessOneStep            | 61.914 ms                 | 154.886 ms                |
| BlockToStepN              | 102.079 ms                | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.434 ms                  | 278.820 ms                |
| Forward                   | 5.109 ms                  | 12.105 ms                 |
| Backward                  | 10.527 ms                 | 12.939 ms                 |
| Optimize                  | 2.794 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 82.048 us                 | 58.382 ms                 |
| AfterBackward             | 61.944 ms                 | 154.928 ms                |
| BlockToStepN              | 102.128 ms                | 857.188 ms                |
| OneStep                   | 301.571 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:45.841006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240205 13:19:46.841009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240205 13:19:47.841008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240205 13:19:48.841009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240205 13:19:49.841008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 18.860 ms                 |
| ProcessBack:UpdateCache   | 9.639 ms                  | 14.468 ms                 |
| ProcessBack:UpsertPq      | 36.188 ms                 | 102.030 ms                |
| ProcessOneStep            | 61.767 ms                 | 154.886 ms                |
| BlockToStepN              | 145.651 ms                | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.622 ms                  | 278.820 ms                |
| Forward                   | 5.100 ms                  | 12.901 ms                 |
| Backward                  | 10.535 ms                 | 12.939 ms                 |
| Optimize                  | 2.711 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 86.659 us                 | 58.382 ms                 |
| AfterBackward             | 61.804 ms                 | 154.928 ms                |
| BlockToStepN              | 145.711 ms                | 857.188 ms                |
| OneStep                   | 301.571 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:50.841006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240205 13:19:51.841008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240205 13:19:52.841008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240205 13:19:53.841007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240205 13:19:54.841007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.632 ms                  | 14.181 ms                 |
| ProcessBack:UpsertPq      | 36.041 ms                 | 101.809 ms                |
| ProcessOneStep            | 61.556 ms                 | 154.886 ms                |
| BlockToStepN              | 145.651 ms                | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.622 ms                  | 278.820 ms                |
| Forward                   | 5.100 ms                  | 12.901 ms                 |
| Backward                  | 10.527 ms                 | 12.939 ms                 |
| Optimize                  | 2.650 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 86.659 us                 | 58.382 ms                 |
| AfterBackward             | 61.603 ms                 | 154.928 ms                |
| BlockToStepN              | 379.576 ms                | 857.188 ms                |
| OneStep                   | 502.484 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:19:56.021899 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240205 13:19:57.059685 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240205 13:19:58.099112 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240205 13:19:59.157860 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.697 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.639 ms                  | 14.181 ms                 |
| ProcessBack:UpsertPq      | 35.922 ms                 | 101.809 ms                |
| ProcessOneStep            | 61.024 ms                 | 154.886 ms                |
| BlockToStepN              | 379.515 ms                | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:00.157004 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=190, pq.top=190
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.622 ms                  | 278.820 ms                |
| Forward                   | 5.109 ms                  | 14.284 ms                 |
| Backward                  | 10.518 ms                 | 12.939 ms                 |
| Optimize                  | 2.665 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 89.190 us                 | 58.382 ms                 |
| AfterBackward             | 61.067 ms                 | 154.928 ms                |
| BlockToStepN              | 145.711 ms                | 857.188 ms                |
| OneStep                   | 301.571 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:01.157008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=192, pq.top=192
W20240205 13:20:02.208084 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240205 13:20:03.283480 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240205 13:20:04.283011 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.704 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.639 ms                  | 14.468 ms                 |
| ProcessBack:UpsertPq      | 36.106 ms                 | 101.809 ms                |
| ProcessOneStep            | 61.430 ms                 | 154.886 ms                |
| BlockToStepN              | 146.787 ms                | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:05.283005 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.432 ms                  | 278.820 ms                |
| Forward                   | 5.094 ms                  | 14.284 ms                 |
| Backward                  | 10.508 ms                 | 12.939 ms                 |
| Optimize                  | 2.662 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 194.755 us                | 59.064 ms                 |
| AfterBackward             | 61.462 ms                 | 154.928 ms                |
| BlockToStepN              | 146.887 ms                | 857.188 ms                |
| OneStep                   | 301.571 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 7] 200 steps, total: 53.360, sample: 1.300, forward: 0.521, backward: 0.863, update: 0.262
[proc 6] 200 steps, total: 53.360, sample: 1.365, forward: 0.522, backward: 1.001, update: 0.269
[proc 4] 200 steps, total: 53.360, sample: 1.476, forward: 0.534, backward: 0.944, update: 0.266
[proc 1] 200 steps, total: 53.360, sample: 1.976, forward: 0.591, backward: 0.970, update: 0.278
[proc 3] 200 steps, total: 53.360, sample: 1.755, forward: 0.500, backward: 0.993, update: 0.275
[proc 0] 200 steps, total: 53.360, sample: 2.312, forward: 0.547, backward: 1.026, update: 0.317
[proc 5] 200 steps, total: 53.360, sample: 1.333, forward: 0.531, backward: 1.085, update: 0.273
[proc 2] 200 steps, total: 53.360, sample: 1.561, forward: 0.513, backward: 1.038, update: 0.263
W20240205 13:20:06.283006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240205 13:20:07.283008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240205 13:20:08.283007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240205 13:20:09.283007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.670 ms                  | 14.468 ms                 |
| ProcessBack:UpsertPq      | 36.231 ms                 | 101.809 ms                |
| ProcessOneStep            | 61.489 ms                 | 154.886 ms                |
| BlockToStepN              | 379.515 ms                | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:10.334636 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.338 ms                  | 278.820 ms                |
| Forward                   | 5.100 ms                  | 14.284 ms                 |
| Backward                  | 10.508 ms                 | 12.939 ms                 |
| Optimize                  | 2.665 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 222.663 us                | 59.064 ms                 |
| AfterBackward             | 61.559 ms                 | 154.928 ms                |
| BlockToStepN              | 146.887 ms                | 857.188 ms                |
| OneStep                   | 301.571 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:11.334007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=210, pq.top=210
W20240205 13:20:12.334009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240205 13:20:13.405650 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240205 13:20:14.405032 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.702 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.703 ms                  | 14.468 ms                 |
| ProcessBack:UpsertPq      | 36.210 ms                 | 101.809 ms                |
| ProcessOneStep            | 61.430 ms                 | 154.886 ms                |
| BlockToStepN              | 146.787 ms                | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:15.405006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.434 ms                  | 278.820 ms                |
| Forward                   | 5.109 ms                  | 14.284 ms                 |
| Backward                  | 10.506 ms                 | 12.939 ms                 |
| Optimize                  | 2.662 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 194.755 us                | 59.064 ms                 |
| AfterBackward             | 61.462 ms                 | 154.928 ms                |
| BlockToStepN              | 146.887 ms                | 857.188 ms                |
| OneStep                   | 301.571 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:16.405009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240205 13:20:17.405009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240205 13:20:18.405009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240205 13:20:19.405007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.696 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.714 ms                  | 14.468 ms                 |
| ProcessBack:UpsertPq      | 36.333 ms                 | 101.809 ms                |
| ProcessOneStep            | 61.509 ms                 | 154.886 ms                |
| BlockToStepN              | 151.191 ms                | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:20.503901 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.917 ms                  | 278.820 ms                |
| Forward                   | 5.117 ms                  | 14.284 ms                 |
| Backward                  | 10.501 ms                 | 12.939 ms                 |
| Optimize                  | 2.640 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 82.048 us                 | 59.064 ms                 |
| AfterBackward             | 61.559 ms                 | 154.928 ms                |
| BlockToStepN              | 160.345 ms                | 857.188 ms                |
| OneStep                   | 301.571 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:21.503007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240205 13:20:22.508734 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=230, pq.top=230
W20240205 13:20:23.508010 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240205 13:20:24.508008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.696 ms                  | 18.860 ms                 |
| ProcessBack:UpdateCache   | 9.665 ms                  | 14.181 ms                 |
| ProcessBack:UpsertPq      | 36.334 ms                 | 95.236 ms                 |
| ProcessOneStep            | 61.430 ms                 | 154.886 ms                |
| BlockToStepN              | 160.294 ms                | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:25.508005 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.203 ms                  | 278.820 ms                |
| Forward                   | 5.109 ms                  | 14.284 ms                 |
| Backward                  | 10.501 ms                 | 12.939 ms                 |
| Optimize                  | 2.662 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 80.852 us                 | 59.064 ms                 |
| AfterBackward             | 61.462 ms                 | 154.928 ms                |
| BlockToStepN              | 160.345 ms                | 857.188 ms                |
| OneStep                   | 301.571 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:26.508009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240205 13:20:27.508008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240205 13:20:28.508008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240205 13:20:29.508008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.655 ms                  | 18.860 ms                 |
| ProcessBack:UpdateCache   | 9.645 ms                  | 14.181 ms                 |
| ProcessBack:UpsertPq      | 36.231 ms                 | 95.236 ms                 |
| ProcessOneStep            | 60.803 ms                 | 154.886 ms                |
| BlockToStepN              | 182.834 ms                | 857.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:30.508006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.203 ms                  | 278.820 ms                |
| Forward                   | 5.094 ms                  | 14.284 ms                 |
| Backward                  | 10.498 ms                 | 12.939 ms                 |
| Optimize                  | 2.640 ms                  | 10.171 ms                 |
| BarrierTimeBeforeRank0    | 65.349 us                 | 59.064 ms                 |
| AfterBackward             | 60.835 ms                 | 154.928 ms                |
| BlockToStepN              | 379.576 ms                | 857.188 ms                |
| OneStep                   | 502.484 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:31.554783 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240205 13:20:32.596817 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=252, pq.top=252
W20240205 13:20:33.596009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240205 13:20:34.596009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.655 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.624 ms                  | 14.181 ms                 |
| ProcessBack:UpsertPq      | 36.188 ms                 | 95.236 ms                 |
| ProcessOneStep            | 60.803 ms                 | 122.972 ms                |
| BlockToStepN              | 182.834 ms                | 855.936 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:35.596009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.904 ms                  | 273.643 ms                |
| Forward                   | 5.100 ms                  | 14.173 ms                 |
| Backward                  | 10.474 ms                 | 12.238 ms                 |
| Optimize                  | 2.636 ms                  | 10.062 ms                 |
| BarrierTimeBeforeRank0    | 62.944 us                 | 58.382 ms                 |
| AfterBackward             | 60.977 ms                 | 123.007 ms                |
| BlockToStepN              | 182.878 ms                | 856.040 ms                |
| OneStep                   | 301.571 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:36.616488 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240205 13:20:37.667910 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240205 13:20:38.667008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240205 13:20:39.711493 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=268, pq.top=268
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.690 ms                  | 18.881 ms                 |
| ProcessBack:UpdateCache   | 9.602 ms                  | 14.181 ms                 |
| ProcessBack:UpsertPq      | 36.188 ms                 | 95.236 ms                 |
| ProcessOneStep            | 61.024 ms                 | 122.972 ms                |
| BlockToStepN              | 191.119 ms                | 855.936 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.917 ms                  | 273.643 ms                |
| Forward                   | 5.090 ms                  | 14.173 ms                 |
| Backward                  | 10.474 ms                 | 12.939 ms                 |
| Optimize                  | 2.640 ms                  | 10.062 ms                 |
| BarrierTimeBeforeRank0    | 62.944 us                 | 58.382 ms                 |
| AfterBackward             | 61.067 ms                 | 123.007 ms                |
| BlockToStepN              | 191.171 ms                | 856.040 ms                |
| OneStep                   | 301.571 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:40.711007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240205 13:20:41.711009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240205 13:20:42.711009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240205 13:20:43.711009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240205 13:20:44.711009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=278, pq.top=278
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.690 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.591 ms                  | 14.118 ms                 |
| ProcessBack:UpsertPq      | 36.177 ms                 | 89.075 ms                 |
| ProcessOneStep            | 61.024 ms                 | 122.972 ms                |
| BlockToStepN              | 201.616 ms                | 855.936 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.917 ms                  | 273.643 ms                |
| Forward                   | 5.089 ms                  | 14.173 ms                 |
| Backward                  | 10.470 ms                 | 12.939 ms                 |
| Optimize                  | 2.640 ms                  | 10.062 ms                 |
| BarrierTimeBeforeRank0    | 65.349 us                 | 58.382 ms                 |
| AfterBackward             | 61.067 ms                 | 123.007 ms                |
| BlockToStepN              | 201.703 ms                | 856.040 ms                |
| OneStep                   | 304.148 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:45.711006 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240205 13:20:46.711007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240205 13:20:47.711007 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240205 13:20:48.711009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240205 13:20:49.788038 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.655 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.545 ms                  | 14.118 ms                 |
| ProcessBack:UpsertPq      | 36.223 ms                 | 89.075 ms                 |
| ProcessOneStep            | 61.430 ms                 | 122.972 ms                |
| BlockToStepN              | 201.616 ms                | 855.936 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.786 ms                  | 273.643 ms                |
| Forward                   | 5.085 ms                  | 14.173 ms                 |
| Backward                  | 10.465 ms                 | 12.939 ms                 |
| Optimize                  | 2.632 ms                  | 10.062 ms                 |
| BarrierTimeBeforeRank0    | 66.306 us                 | 58.382 ms                 |
| AfterBackward             | 61.545 ms                 | 123.007 ms                |
| BlockToStepN              | 201.703 ms                | 856.040 ms                |
| OneStep                   | 304.148 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 13:20:50.827642 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=294, pq.top=294
W20240205 13:20:51.827008 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240205 13:20:52.827009 21295 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 3] 300 steps, total: 47.852, sample: 1.216, forward: 0.486, backward: 0.965, update: 0.272
[proc 0] 300 steps, total: 47.852, sample: 2.327, forward: 0.512, backward: 0.872, update: 0.314
[proc 6] 300 steps, total: 47.852, sample: 1.211, forward: 0.525, backward: 1.008, update: 0.271
[proc 7] 300 steps, total: 47.852, sample: 1.090, forward: 0.531, backward: 0.880, update: 0.267
[proc 5] 300 steps, total: 47.852, sample: 1.103, forward: 0.530, backward: 1.084, update: 0.285
[proc 1] 300 steps, total: 47.852, sample: 1.780, forward: 0.537, backward: 0.994, update: 0.268
[proc 4] 300 steps, total: 47.852, sample: 1.213, forward: 0.537, backward: 1.008, update: 0.296
Successfully xmh. training takes 154.3068141937256 seconds
[proc 2] 300 steps, total: 47.852, sample: 1.251, forward: 0.500, backward: 0.893, update: 0.253
before call kg_cache_controller.StopThreads()
W20240205 13:20:53.682477 21295 grad_async_v1.h:243] call StopThreads. PID = 56873
W20240205 13:20:53.682503 21295 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 13:20:53.687987 21295 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 13:20:53.688000 21295 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240205 13:20:53.985843 21295 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.648 ms                  | 18.878 ms                 |
| ProcessBack:UpdateCache   | 9.561 ms                  | 14.118 ms                 |
| ProcessBack:UpsertPq      | 36.244 ms                 | 89.724 ms                 |
| ProcessOneStep            | 61.556 ms                 | 122.972 ms                |
| BlockToStepN              | 201.616 ms                | 855.936 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.667 ms                  | 273.643 ms                |
| Forward                   | 5.085 ms                  | 14.173 ms                 |
| Backward                  | 10.454 ms                 | 12.939 ms                 |
| Optimize                  | 2.631 ms                  | 10.062 ms                 |
| BarrierTimeBeforeRank0    | 78.645 us                 | 58.382 ms                 |
| AfterBackward             | 61.603 ms                 | 123.007 ms                |
| BlockToStepN              | 201.703 ms                | 856.040 ms                |
| OneStep                   | 304.148 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
