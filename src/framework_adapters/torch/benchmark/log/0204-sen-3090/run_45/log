WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 01:39:59.488219 30273 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_103', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=2, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [30273 sampler.py:454] Start PreSampling
WARNING [30273 sampler.py:532] Before construct renumbering_dict
WARNING [30273 sampler.py:555] PreSampling done
W20240205 02:00:43.016615 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 02:00:43.016806 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 02:00:43.016849 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 02:00:43.016893 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 02:00:43.016924 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 02:00:43.016959 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 02:00:43.016999 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 02:00:43.017055 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 02:00:43.017087 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 02:00:43.017134 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 02:00:43.017176 30273 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 02:00:43.017218 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 02:00:43.017251 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 02:00:43.017414 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 02:00:43.017462 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 02:00:43.017500 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 02:00:43.017541 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 02:00:43.017573 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 02:00:43.017603 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 02:00:43.017637 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 02:00:43.017671 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 02:00:43.017707 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 02:00:43.017740 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 02:00:43.017773 30273 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 02:00:43.017798 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 02:00:43.017823 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 02:00:43.017879 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 02:00:43.017921 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 02:00:43.017952 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 02:00:43.017984 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 02:00:43.018018 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 02:00:43.018054 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 02:00:43.018087 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 02:00:43.018118 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 02:00:43.018151 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 02:00:43.018194 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 02:00:43.018224 30273 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 02:00:43.018249 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 02:00:43.018273 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 02:00:43.018337 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 02:00:43.018379 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 02:00:43.018414 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 02:00:43.018443 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 02:00:43.018474 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 02:00:43.018512 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 02:00:43.018543 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 02:00:43.018571 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 02:00:43.018615 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 02:00:43.018651 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 02:00:43.018682 30273 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 02:00:43.018705 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 02:00:43.018734 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 02:00:43.018802 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 02:00:43.018841 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 02:00:43.018872 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 02:00:43.018904 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 02:00:43.018936 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 02:00:43.018966 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 02:00:43.018997 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 02:00:43.019037 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 02:00:43.019065 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 02:00:43.019101 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 02:00:43.019134 30273 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 02:00:43.019160 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 02:00:43.019191 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 02:00:43.019248 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 02:00:43.019279 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 02:00:43.019309 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 02:00:43.019347 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 02:00:43.019388 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 02:00:43.019419 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 02:00:43.019455 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 02:00:43.019485 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 02:00:43.019515 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 02:00:43.019552 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 02:00:43.019582 30273 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 02:00:43.019608 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 02:00:43.019636 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 02:00:43.019691 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 02:00:43.019723 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 02:00:43.019759 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 02:00:43.019793 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 02:00:43.019829 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 02:00:43.019861 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 02:00:43.019893 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 02:00:43.019937 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 02:00:43.019973 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 02:00:43.020018 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 02:00:43.020056 30273 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 02:00:43.020100 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 02:00:43.020133 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 02:00:43.020195 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 02:00:43.020231 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 02:00:43.020265 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 02:00:43.020300 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 02:00:43.020334 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 02:00:43.020371 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 02:00:43.020414 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 02:00:43.020459 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 02:00:43.020499 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 02:00:43.020534 30273 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 02:00:43.020568 30273 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 02:00:43.020596 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 02:00:43.020622 30273 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 02:00:43.497349 30273 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 02:09:28.024355 30273 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302711,  4302745,    84243,  ..., 65860179, 63082300,  5082157]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2278.940 seconds
[Rank1] pid = 11925
[Rank2] pid = 12020
[Rank3] pid = 12152
[Rank4] pid = 12318
[Rank5] pid = 12505
[Rank6] pid = 12709
INFO [30273 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [11925 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [12020 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [12318 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [12709 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [12152 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [12505 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [12889 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [12889 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12709 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12505 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12152 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12318 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12020 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [30273 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [11925 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 02:18:10.275928 12953 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 02:18:10.279610 12890 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 02:18:10.280316 11926 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 02:18:10.280489 12021 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 02:18:10.280508 12319 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 02:18:10.280562 12710 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 02:18:10.280592 12153 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 02:18:10.280817 12506 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 02:18:10.364279 12153 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1020497b1000 7.629 MB
W20240205 02:18:10.364413 12021 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102049f54000 7.629 MB
W20240205 02:18:10.364418 12319 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204a6f7000 7.629 MB
W20240205 02:18:10.364434 12710 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204ae9a000 7.629 MB
W20240205 02:18:10.364440 12506 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204b63d000 7.629 MB
W20240205 02:18:10.364552 12153 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10204c583000 7.629 MB
W20240205 02:18:10.364544 12890 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204bde0000 7.629 MB
W20240205 02:18:10.364579 11926 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204cd26000 7.629 MB
W20240205 02:18:10.364586 12953 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204d4c9000 7.629 MB
W20240205 02:18:10.364637 12153 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10204dc6c000 1.49 GB
W20240205 02:18:10.364684 12153 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1020ad24f000 1.49 GB
W20240205 02:18:10.364758 12153 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 02:18:10.366602 12890 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10210c832000 7.629 MB
W20240205 02:18:10.366632 12710 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10210cfd7000 7.629 MB
W20240205 02:18:10.366649 12319 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10210d77a000 7.629 MB
W20240205 02:18:10.366675 11926 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210df1d000 7.629 MB
W20240205 02:18:10.366726 12890 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210e6c0000 1.49 GB
W20240205 02:18:10.366725 12153 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 02:18:10.366752 12710 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10216dca3000 1.49 GB
W20240205 02:18:10.366766 12319 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1021cd286000 1.49 GB
W20240205 02:18:10.366770 12890 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10222c869000 1.49 GB
W20240205 02:18:10.366776 12021 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10228be4c000 7.629 MB
W20240205 02:18:10.366792 12953 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10228c5ef000 7.629 MB
W20240205 02:18:10.366803 11926 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10228cd92000 1.49 GB
W20240205 02:18:10.366827 12710 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1022ec375000 1.49 GB
W20240205 02:18:10.366835 12506 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10234b958000 7.629 MB
W20240205 02:18:10.366840 12319 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10234c0fb000 1.49 GB
W20240205 02:18:10.366878 12953 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1023ab6de000 1.49 GB
W20240205 02:18:10.366884 12021 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10240acc1000 1.49 GB
W20240205 02:18:10.366891 11926 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10246a2a4000 1.49 GB
W20240205 02:18:10.366931 12506 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1024c9887000 1.49 GB
W20240205 02:18:10.366956 12021 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102528e6a000 1.49 GB
W20240205 02:18:10.366962 12953 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10258844d000 1.49 GB
W20240205 02:18:10.366988 12506 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1025e7a30000 1.49 GB
W20240205 02:18:10.368386 12506 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 02:18:10.368395 12953 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 02:18:10.368428 12319 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 02:18:10.368527 12890 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 02:18:10.368551 12021 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 02:18:10.368558 11926 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 02:18:10.368588 12710 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 02:18:10.380616 12890 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 02:18:10.380640 12021 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 02:18:10.380646 11926 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 02:18:10.380650 12953 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 02:18:10.380733 12710 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 02:18:10.380734 12506 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 02:18:10.380735 12319 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [12505 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [12709 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [11925 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 12889
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [30273 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [12318 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [12020 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [12889 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [12152 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 02:18:59.685534 12153 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 02:18:59.685671 12506 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 02:18:59.685760 12953 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 02:18:59.685796 12710 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 02:18:59.685844 12319 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 02:18:59.686038 12890 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 02:18:59.686080 12021 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 02:18:59.686115 11926 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 02:18:59.687225 12890 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 2,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 02:18:59.687374 12890 grad_base.h:184] Init GradProcessingBase done
I20240205 02:19:12.898593 12890 grad_async_v2.h:42] Use main thread to update emb.
W20240205 02:19:12.898895 12890 kg_controller.h:78] after init GradAsyncProcessingV2
I20240205 02:19:12.898906 12890 kg_controller.h:84] Construct KGCacheController done
E20240205 02:19:13.692695 12710 recstore.cc:66] init folly done
E20240205 02:19:13.692699 12021 recstore.cc:66] init folly done
E20240205 02:19:13.692708 12953 recstore.cc:66] init folly done
E20240205 02:19:13.692709 12153 recstore.cc:66] init folly done
E20240205 02:19:13.692744 12319 recstore.cc:66] init folly done
E20240205 02:19:13.693691 11926 recstore.cc:66] init folly done
E20240205 02:19:13.693702 12890 recstore.cc:66] init folly done
E20240205 02:19:13.693713 12506 recstore.cc:66] init folly done
I20240205 02:19:13.694867 12890 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240205 02:19:32.424760 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 02:19:32.425360 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240205 02:19:33.425015 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240205 02:19:33.691706 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 135.789 us                | 244.907 us                |
+---------------------------+---------------------------+---------------------------+
E20240205 02:19:34.425010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240205 02:19:34.854992 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
I20240205 02:19:35.245846 12953 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
E20240205 02:19:35.425020 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 02:19:36.779847 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 02:19:36.796170 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 02:19:36.898718 12506 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 02:19:37.298377 12319 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 02:19:37.796015 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
I20240205 02:19:37.975968 12021 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240205 02:19:38.165405 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
I20240205 02:19:38.589828 12710 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 123.620 us                | 230.658 us                |
+---------------------------+---------------------------+---------------------------+
E20240205 02:19:38.796015 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
E20240205 02:19:39.796012 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 02:19:39.856437 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240205 02:19:39.982681 12153 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 02:19:40.045387 11926 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 02:19:40.796046 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 02:19:40.953704 17467 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
I20240205 02:19:41.661016 12890 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 02:19:41.800701 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=30
W20240205 02:19:42.026875 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 02:19:42.800041 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.033 us                | 271.748 us                |
| ProcessBack:Shuffle       | 285.012 ms                | 319.219 ms                |
+---------------------------+---------------------------+---------------------------+
E20240205 02:19:44.333812 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 02:19:44.425436 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240205 02:19:44.437103 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 02:19:44.485074 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.415 ms                  | 9.601 ms                  |
| Forward                   | 13.960 ms                 | 1.202 s                   |
| Backward                  | 5.477 ms                  | 192.188 ms                |
| Optimize                  | 3.249 ms                  | 5.502 ms                  |
| BarrierTimeBeforeRank0    | 60.375 us                 | 41.189 ms                 |
| AfterBackward             | 107.795 ms                | 1.357 s                   |
| BlockToStepN              | 90.910 us                 | 6.134 ms                  |
| OneStep                   | 136.627 ms                | 2.772 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 02:19:45.333007 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240205 02:19:45.689036 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
W20240205 02:19:45.878450 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=7, pq.top=7
E20240205 02:19:46.333011 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3018
W20240205 02:19:46.744683 17467 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 02:19:47.333014 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240205 02:19:47.999580 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240205 02:19:48.333010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=22
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 156.084 us                | 341.730 us                |
| ProcessBack:Shuffle       | 9.023 ms                  | 319.219 ms                |
| ProcessBack:UpdateCache   | 13.424 ms                 | 695.874 ms                |
| ProcessBack:UpsertPq      | 67.320 ms                 | 129.799 ms                |
| ProcessOneStep            | 126.496 ms                | 1.355 s                   |
| BlockToStepN              | 389.218 us                | 5.376 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 02:19:49.125607 12890 grad_async_v2.h:257] pq is empty
W20240205 02:19:49.131460 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 02:19:49.333009 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=255
W20240205 02:19:49.375982 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.374 ms                  | 103.394 ms                |
| Forward                   | 6.231 ms                  | 1.202 s                   |
| Backward                  | 8.381 ms                  | 192.188 ms                |
| Optimize                  | 2.405 ms                  | 6.110 ms                  |
| BarrierTimeBeforeRank0    | 3.611 ms                  | 378.601 ms                |
| AfterBackward             | 128.547 ms                | 2.156 s                   |
| BlockToStepN              | 344.699 us                | 6.134 ms                  |
| OneStep                   | 198.785 ms                | 2.772 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 02:19:50.333021 14881 parallel_pq_v2.h:79] insert failed, size(hashtable)=2071
W20240205 02:19:50.415174 17467 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240205 02:19:50.457815 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=20, pq.top=20
E20240205 02:19:51.333011 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=243
W20240205 02:19:51.477553 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
W20240205 02:19:51.488330 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=24, pq.top=23
E20240205 02:19:52.231436 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=30, sample_step_cpp_seen_[rank]=29
E20240205 02:19:52.333039 17696 parallel_pq_v2.h:79] insert failed, size(hashtable)=27933
W20240205 02:19:52.528416 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 02:19:53.333011 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
W20240205 02:19:53.537875 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 363.228 us                | 1.534 ms                  |
| ProcessBack:Shuffle       | 8.952 ms                  | 285.012 ms                |
| ProcessBack:UpdateCache   | 10.415 ms                 | 695.337 ms                |
| ProcessBack:UpsertPq      | 62.042 ms                 | 163.630 ms                |
| ProcessOneStep            | 125.167 ms                | 2.156 s                   |
| BlockToStepN              | 440.852 us                | 23.787 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:19:53.753708 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=33, pq.top=33
E20240205 02:19:54.333009 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=433
W20240205 02:19:54.642604 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.983 ms                  | 126.110 ms                |
| Forward                   | 6.095 ms                  | 1.202 s                   |
| Backward                  | 7.995 ms                  | 192.188 ms                |
| Optimize                  | 2.369 ms                  | 6.110 ms                  |
| BarrierTimeBeforeRank0    | 2.482 ms                  | 378.601 ms                |
| AfterBackward             | 125.223 ms                | 2.156 s                   |
| BlockToStepN              | 734.823 us                | 23.867 ms                 |
| OneStep                   | 171.276 ms                | 2.772 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:19:55.226456 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=39, pq.top=39
E20240205 02:19:55.333007 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=7529
W20240205 02:19:55.706303 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
W20240205 02:19:56.332152 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=47, pq.top=47
E20240205 02:19:56.333346 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=24
W20240205 02:19:56.760902 17467 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240205 02:19:57.231009 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=51, sample_step_cpp_seen_[rank]=50
E20240205 02:19:57.333011 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
W20240205 02:19:57.824604 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240205 02:19:58.333009 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1568
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 365.592 us                | 3.072 ms                  |
| ProcessBack:Shuffle       | 8.992 ms                  | 285.012 ms                |
| ProcessBack:UpdateCache   | 11.535 ms                 | 695.337 ms                |
| ProcessBack:UpsertPq      | 43.535 ms                 | 163.630 ms                |
| ProcessOneStep            | 121.095 ms                | 1.355 s                   |
| BlockToStepN              | 679.104 us                | 11.761 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:19:58.921227 17467 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240205 02:19:59.333009 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=15993
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.601 ms                  | 503.557 ms                |
| Forward                   | 6.052 ms                  | 13.960 ms                 |
| Backward                  | 7.427 ms                  | 10.812 ms                 |
| Optimize                  | 2.536 ms                  | 5.752 ms                  |
| BarrierTimeBeforeRank0    | 4.165 ms                  | 303.010 ms                |
| AfterBackward             | 115.336 ms                | 1.357 s                   |
| BlockToStepN              | 561.106 us                | 11.905 ms                 |
| OneStep                   | 167.709 ms                | 2.179 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:19:59.705822 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240205 02:19:59.988600 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240205 02:20:00.333009 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=434
W20240205 02:20:01.114071 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240205 02:20:01.333007 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=147
W20240205 02:20:02.151204 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240205 02:20:02.189635 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 02:20:02.333007 14881 parallel_pq_v2.h:79] insert failed, size(hashtable)=9462
W20240205 02:20:03.196161 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240205 02:20:03.248837 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240205 02:20:03.333015 17720 parallel_pq_v2.h:79] insert failed, size(hashtable)=3153
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 631.092 us                | 9.724 ms                  |
| ProcessBack:Shuffle       | 8.827 ms                  | 74.099 ms                 |
| ProcessBack:UpdateCache   | 11.047 ms                 | 81.660 ms                 |
| ProcessBack:UpsertPq      | 36.058 ms                 | 163.630 ms                |
| ProcessOneStep            | 110.970 ms                | 1.355 s                   |
| BlockToStepN              | 765.604 us                | 11.761 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 02:20:03.747803 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=84, sample_step_cpp_seen_[rank]=83
W20240205 02:20:04.289999 17467 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240205 02:20:04.333005 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=660
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.760 ms                  | 503.557 ms                |
| Forward                   | 5.722 ms                  | 13.960 ms                 |
| Backward                  | 6.242 ms                  | 11.104 ms                 |
| Optimize                  | 2.546 ms                  | 6.110 ms                  |
| BarrierTimeBeforeRank0    | 3.817 ms                  | 303.010 ms                |
| AfterBackward             | 111.231 ms                | 1.357 s                   |
| BlockToStepN              | 816.702 us                | 19.680 ms                 |
| OneStep                   | 157.203 ms                | 2.179 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:05.312284 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240205 02:20:05.333007 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=58
E20240205 02:20:06.333010 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=38041
W20240205 02:20:06.383316 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
W20240205 02:20:06.418926 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=94, pq.top=93
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 29.150, sample: 2.423, forward: 1.431, backward: 1.029, update: 0.251
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 31.880, sample: 1.143, forward: 1.593, backward: 0.823, update: 0.227
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.143, sample: 2.362, forward: 1.409, backward: 0.890, update: 0.268
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 27.081, sample: 2.511, forward: 1.412, backward: 0.817, update: 0.316
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 29.828, sample: 2.866, forward: 1.335, backward: 0.895, update: 0.275
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 30.227, sample: 2.130, forward: 1.383, backward: 0.793, update: 0.265
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 28.536, sample: 1.548, forward: 1.410, backward: 0.695, update: 0.253
train_sampler.Prefill()
-------Step 0-------
tensor([   45463,    45490,    45519,    45544,  5762052,   127742, 49782802,
        16750064, 22594849,    45575]) tensor([ 5223547, 14610811, 52472108, 81745838, 18638980, 29821845, 32699184,
        69462379, 76268955, 30313239])
-------Step 1-------
tensor([   45463,    45490,    45519,    45544,  5762052,   127742, 49782802,
        16750064, 22594849,    45575]) tensor([60659504, 29749906, 10124380, 83407782, 85457206, 40951450, 80962191,
        53989109, 37938052, 12605887])
-------Step 2-------
tensor([  113272,   113300,   113326,    23475,   113350,   113375,   113410,
        26385342,   113440,   113474]) tensor([78833930, 24199648, 74734631, 43040295, 38393287, 30304247, 60938315,
        41961432, 13735864, 40229799])
-------Step 3-------
tensor([  113272,   113300,   113326,    23475,   113350,   113375,   113410,
        26385342,   113440,   113474]) tensor([51500467, 79371930, 30901161, 35415930, 68748884, 62281974, 39792681,
        15543931, 26957195,   696640])
-------Step 4-------
tensor([  182013, 41879890,   182040,   160730,   182069,   160765,   182099,
        37141935,   182131,   182163]) tensor([77363154,  9650677, 73901593, 16601449, 76492286, 47819362, 72590908,
        34731726, 83630246, 49149823])
-------Step 5-------
tensor([  182013, 41879890,   182040,   160730,   182069,   160765,   182099,
        37141935,   182131,   182163]) tensor([34766134, 70684766,   226402, 74658720, 50291149, 48419249, 14338868,
         9908146, 61849526, 36365360])
-------Step 6-------
tensor([  269085,    48880,   269128,   269175,    48905, 80353253,   269218,
          269238,   176774, 33835731]) tensor([12275544, 33702835, 35645408, 79317615, 32751233, 32737448, 25434720,
         6561530, 75658356, 82832393])
-------Step 7-------
tensor([  269085,    48880,   269128,   269175,    48905, 80353253,   269218,
          269238,   176774, 33835731]) tensor([24954737, 48485402, 64562621, 58323597, 84247518, 48389782, 50105038,
        59779518, 31572436, 35550860])
-------Step 8-------
tensor([  362373, 24002736,   362422,   191989,   362460,    61142,   362499,
          362543,   362585,   362632]) tensor([39342351, 22448402, 34189387,  2010153, 45335681, 75938224, 14340345,
        77097929,  1438381, 66773204])
-------Step 9-------
tensor([  362373, 24002736,   362422,   191989,   362460,    61142,   362499,
          362543,   362585,   362632]) tensor([59245521, 32726952, 14219279, 52216592,  8804553, 41468186, 25554421,
        38262984, 75942015, 73099530])
before start barrier
start train
[proc 0] 100 steps, total: 25.465, sample: 3.220, forward: 1.813, backward: 0.842, update: 0.306
E20240205 02:20:07.333019 17693 parallel_pq_v2.h:79] insert failed, size(hashtable)=40661
W20240205 02:20:07.544698 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
W20240205 02:20:07.676975 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=103, pq.top=103
E20240205 02:20:08.333011 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3528
W20240205 02:20:08.552371 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 390.465 us                | 4.146 ms                  |
| ProcessBack:Shuffle       | 8.896 ms                  | 74.099 ms                 |
| ProcessBack:UpdateCache   | 10.788 ms                 | 81.660 ms                 |
| ProcessBack:UpsertPq      | 35.941 ms                 | 164.903 ms                |
| ProcessOneStep            | 109.161 ms                | 1.355 s                   |
| BlockToStepN              | 672.367 us                | 19.583 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:09.209614 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=108, pq.top=108
E20240205 02:20:09.333012 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.072 ms                  | 503.557 ms                |
| Forward                   | 6.009 ms                  | 18.307 ms                 |
| Backward                  | 6.364 ms                  | 11.104 ms                 |
| Optimize                  | 2.550 ms                  | 10.064 ms                 |
| BarrierTimeBeforeRank0    | 3.792 ms                  | 303.010 ms                |
| AfterBackward             | 109.212 ms                | 1.357 s                   |
| BlockToStepN              | 691.709 us                | 19.680 ms                 |
| OneStep                   | 156.311 ms                | 2.179 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:09.729645 17467 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
W20240205 02:20:10.269097 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=117, pq.top=117
E20240205 02:20:10.314455 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=117, sample_step_cpp_seen_[rank]=116
E20240205 02:20:10.333009 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=2621
W20240205 02:20:10.868394 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
E20240205 02:20:11.363428 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 02:20:11.916628 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
W20240205 02:20:11.928666 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=122, pq.top=122
E20240205 02:20:12.372828 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 02:20:13.040602 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240205 02:20:13.096314 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 02:20:13.372015 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3936
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 422.975 us                | 14.066 ms                 |
| ProcessBack:Shuffle       | 9.023 ms                  | 34.811 ms                 |
| ProcessBack:UpdateCache   | 10.578 ms                 | 20.421 ms                 |
| ProcessBack:UpsertPq      | 35.137 ms                 | 164.200 ms                |
| ProcessOneStep            | 106.571 ms                | 1.355 s                   |
| BlockToStepN              | 711.431 us                | 19.583 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:14.185706 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240205 02:20:14.372011 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=555
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.003 ms                  | 503.557 ms                |
| Forward                   | 5.928 ms                  | 18.307 ms                 |
| Backward                  | 7.524 ms                  | 17.523 ms                 |
| Optimize                  | 2.593 ms                  | 10.064 ms                 |
| BarrierTimeBeforeRank0    | 3.817 ms                  | 303.010 ms                |
| AfterBackward             | 106.629 ms                | 1.357 s                   |
| BlockToStepN              | 791.236 us                | 19.680 ms                 |
| OneStep                   | 151.913 ms                | 2.179 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:15.170918 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240205 02:20:15.224115 17467 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240205 02:20:15.372009 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=11424
W20240205 02:20:16.271682 17467 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240205 02:20:16.372009 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=8910
W20240205 02:20:16.419757 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=147, pq.top=147
E20240205 02:20:16.507705 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=147, sample_step_cpp_seen_[rank]=146
W20240205 02:20:17.365082 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
E20240205 02:20:17.372206 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240205 02:20:18.372009 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=146
W20240205 02:20:18.433231 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 440.043 us                | 6.433 ms                  |
| ProcessBack:Shuffle       | 9.032 ms                  | 34.811 ms                 |
| ProcessBack:UpdateCache   | 10.448 ms                 | 20.421 ms                 |
| ProcessBack:UpsertPq      | 32.674 ms                 | 164.200 ms                |
| ProcessOneStep            | 98.177 ms                 | 1.255 s                   |
| BlockToStepN              | 745.186 us                | 30.289 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:18.896203 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=154, pq.top=153
E20240205 02:20:19.373685 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 02:20:19.511145 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.508 ms                  | 358.409 ms                |
| Forward                   | 5.786 ms                  | 13.960 ms                 |
| Backward                  | 7.524 ms                  | 12.009 ms                 |
| Optimize                  | 2.606 ms                  | 8.139 ms                  |
| BarrierTimeBeforeRank0    | 4.182 ms                  | 303.010 ms                |
| AfterBackward             | 97.877 ms                 | 1.255 s                   |
| BlockToStepN              | 848.184 us                | 30.410 ms                 |
| OneStep                   | 148.311 ms                | 1.281 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:20.097980 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=163, pq.top=163
E20240205 02:20:20.373462 17702 parallel_pq_v2.h:79] insert failed, size(hashtable)=35443
W20240205 02:20:20.658402 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240205 02:20:21.373008 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=890
E20240205 02:20:21.507005 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=165, sample_step_cpp_seen_[rank]=164
W20240205 02:20:21.736634 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240205 02:20:22.373787 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=21978
W20240205 02:20:22.647454 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240205 02:20:22.739125 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240205 02:20:23.373009 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=40906
W20240205 02:20:23.670545 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=175, pq.top=175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 546.985 us                | 9.888 ms                  |
| ProcessBack:Shuffle       | 8.952 ms                  | 34.811 ms                 |
| ProcessBack:UpdateCache   | 10.352 ms                 | 20.421 ms                 |
| ProcessBack:UpsertPq      | 30.996 ms                 | 164.200 ms                |
| ProcessOneStep            | 98.177 ms                 | 1.355 s                   |
| BlockToStepN              | 827.822 us                | 44.310 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:23.820420 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240205 02:20:24.373010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=40197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.493 ms                  | 358.409 ms                |
| Forward                   | 5.817 ms                  | 13.960 ms                 |
| Backward                  | 7.524 ms                  | 12.009 ms                 |
| Optimize                  | 2.617 ms                  | 8.139 ms                  |
| BarrierTimeBeforeRank0    | 4.715 ms                  | 305.836 ms                |
| AfterBackward             | 97.877 ms                 | 1.357 s                   |
| BlockToStepN              | 930.419 us                | 44.457 ms                 |
| OneStep                   | 148.091 ms                | 1.749 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:24.909608 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240205 02:20:25.374318 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 02:20:25.828306 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240205 02:20:25.921452 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 02:20:26.388458 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 02:20:26.963186 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
W20240205 02:20:26.972640 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=187, pq.top=187
E20240205 02:20:27.388012 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=1833
W20240205 02:20:28.011559 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240205 02:20:28.070080 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240205 02:20:28.165735 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=196, sample_step_cpp_seen_[rank]=195
E20240205 02:20:28.388007 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=4971
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 416.373 us                | 9.016 ms                  |
| ProcessBack:Shuffle       | 8.952 ms                  | 30.214 ms                 |
| ProcessBack:UpdateCache   | 10.333 ms                 | 17.906 ms                 |
| ProcessBack:UpsertPq      | 29.849 ms                 | 164.200 ms                |
| ProcessOneStep            | 97.771 ms                 | 1.355 s                   |
| BlockToStepN              | 922.695 us                | 48.283 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:29.105031 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
W20240205 02:20:29.327317 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=197, pq.top=197
E20240205 02:20:29.388008 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=6122
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.405 ms                  | 358.409 ms                |
| Forward                   | 5.817 ms                  | 13.960 ms                 |
| Backward                  | 6.917 ms                  | 12.009 ms                 |
| Optimize                  | 2.647 ms                  | 8.139 ms                  |
| BarrierTimeBeforeRank0    | 4.761 ms                  | 305.836 ms                |
| AfterBackward             | 97.877 ms                 | 1.357 s                   |
| BlockToStepN              | 1.003 ms                  | 48.438 ms                 |
| OneStep                   | 148.311 ms                | 1.749 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 22.838, sample: 1.291, forward: 0.591, backward: 0.739, update: 0.316
[proc 5] 200 steps, total: 22.838, sample: 2.265, forward: 0.618, backward: 0.682, update: 0.243
[proc 6] 200 steps, total: 22.838, sample: 1.233, forward: 0.558, backward: 0.526, update: 0.248
[proc 3] 200 steps, total: 22.839, sample: 2.977, forward: 0.602, backward: 0.675, update: 0.257
[proc 4] 200 steps, total: 22.839, sample: 1.830, forward: 0.563, backward: 0.706, update: 0.233
[proc 7] 200 steps, total: 22.839, sample: 1.080, forward: 0.542, backward: 0.482, update: 0.206
[proc 1] 200 steps, total: 22.839, sample: 1.887, forward: 0.514, backward: 0.759, update: 0.231
[proc 2] 200 steps, total: 22.839, sample: 2.115, forward: 0.576, backward: 0.689, update: 0.243
W20240205 02:20:30.107700 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240205 02:20:30.356365 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=203, pq.top=203
E20240205 02:20:30.388016 17707 parallel_pq_v2.h:79] insert failed, size(hashtable)=46260
W20240205 02:20:31.131290 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 02:20:31.388008 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=83
W20240205 02:20:31.460724 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240205 02:20:32.235250 17467 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
E20240205 02:20:32.388010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1138
W20240205 02:20:33.254783 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 02:20:33.388012 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=74826
W20240205 02:20:33.698683 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=218, pq.top=218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 425.483 us                | 6.645 ms                  |
| ProcessBack:Shuffle       | 8.985 ms                  | 30.214 ms                 |
| ProcessBack:UpdateCache   | 10.332 ms                 | 17.906 ms                 |
| ProcessBack:UpsertPq      | 30.186 ms                 | 164.200 ms                |
| ProcessOneStep            | 98.177 ms                 | 1.355 s                   |
| BlockToStepN              | 940.240 us                | 48.283 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:34.283023 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240205 02:20:34.388017 17704 parallel_pq_v2.h:79] insert failed, size(hashtable)=36410
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.385 ms                  | 358.409 ms                |
| Forward                   | 5.878 ms                  | 13.960 ms                 |
| Backward                  | 6.766 ms                  | 12.518 ms                 |
| Optimize                  | 2.738 ms                  | 8.139 ms                  |
| BarrierTimeBeforeRank0    | 4.372 ms                  | 305.836 ms                |
| AfterBackward             | 98.562 ms                 | 1.357 s                   |
| BlockToStepN              | 1.081 ms                  | 71.922 ms                 |
| OneStep                   | 148.311 ms                | 1.749 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:34.780578 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=226, pq.top=226
E20240205 02:20:35.093387 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=228, sample_step_cpp_seen_[rank]=227
E20240205 02:20:35.388007 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=6297
W20240205 02:20:35.446759 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 02:20:36.388020 14881 parallel_pq_v2.h:79] insert failed, size(hashtable)=6931
W20240205 02:20:36.406427 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=230, pq.top=230
W20240205 02:20:36.486909 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 02:20:37.388010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=107813
W20240205 02:20:37.492463 17467 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
W20240205 02:20:37.564370 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=237, pq.top=237
E20240205 02:20:38.388008 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1237
W20240205 02:20:38.538625 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 476.338 us                | 30.547 ms                 |
| ProcessBack:Shuffle       | 8.992 ms                  | 22.207 ms                 |
| ProcessBack:UpdateCache   | 10.250 ms                 | 17.867 ms                 |
| ProcessBack:UpsertPq      | 30.961 ms                 | 164.200 ms                |
| ProcessOneStep            | 104.887 ms                | 1.355 s                   |
| BlockToStepN              | 1.169 ms                  | 80.808 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 02:20:39.388010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=5131
W20240205 02:20:39.664763 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.340 ms                  | 358.409 ms                |
| Forward                   | 5.878 ms                  | 13.960 ms                 |
| Backward                  | 6.839 ms                  | 12.518 ms                 |
| Optimize                  | 2.718 ms                  | 8.139 ms                  |
| BarrierTimeBeforeRank0    | 4.165 ms                  | 305.836 ms                |
| AfterBackward             | 104.944 ms                | 1.357 s                   |
| BlockToStepN              | 1.275 ms                  | 80.959 ms                 |
| OneStep                   | 149.536 ms                | 1.749 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:39.962610 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=244, pq.top=244
E20240205 02:20:40.388008 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3582
W20240205 02:20:40.692062 17467 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240205 02:20:40.962388 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=249, pq.top=249
E20240205 02:20:41.388015 17723 parallel_pq_v2.h:79] insert failed, size(hashtable)=67522
W20240205 02:20:41.774008 17467 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
W20240205 02:20:42.184139 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=257, pq.top=257
E20240205 02:20:42.388020 17712 parallel_pq_v2.h:79] insert failed, size(hashtable)=23737
E20240205 02:20:42.471168 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=259, sample_step_cpp_seen_[rank]=258
W20240205 02:20:42.887755 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 02:20:43.388011 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=6155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 434.875 us                | 5.397 ms                  |
| ProcessBack:Shuffle       | 8.985 ms                  | 22.207 ms                 |
| ProcessBack:UpdateCache   | 10.206 ms                 | 17.867 ms                 |
| ProcessBack:UpsertPq      | 30.536 ms                 | 164.903 ms                |
| ProcessOneStep            | 104.887 ms                | 1.355 s                   |
| BlockToStepN              | 1.217 ms                  | 71.782 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:43.772075 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240205 02:20:43.887094 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 02:20:44.388010 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=595
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.163 ms                  | 230.518 ms                |
| Forward                   | 5.880 ms                  | 11.717 ms                 |
| Backward                  | 7.429 ms                  | 12.348 ms                 |
| Optimize                  | 2.723 ms                  | 7.493 ms                  |
| BarrierTimeBeforeRank0    | 4.165 ms                  | 303.010 ms                |
| AfterBackward             | 104.944 ms                | 1.357 s                   |
| BlockToStepN              | 1.328 ms                  | 71.922 ms                 |
| OneStep                   | 149.661 ms                | 1.415 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:44.780056 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240205 02:20:44.939709 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
E20240205 02:20:45.388010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=7739
W20240205 02:20:45.816501 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240205 02:20:45.944897 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 02:20:46.388011 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=2650
W20240205 02:20:47.115860 17467 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240205 02:20:47.243376 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=276, pq.top=276
E20240205 02:20:47.388020 17694 parallel_pq_v2.h:79] insert failed, size(hashtable)=35107
W20240205 02:20:48.201766 17467 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240205 02:20:48.388020 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=6942
W20240205 02:20:48.555888 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 458.394 us                | 11.649 ms                 |
| ProcessBack:Shuffle       | 9.016 ms                  | 21.935 ms                 |
| ProcessBack:UpdateCache   | 10.105 ms                 | 16.413 ms                 |
| ProcessBack:UpsertPq      | 30.331 ms                 | 164.903 ms                |
| ProcessOneStep            | 105.189 ms                | 1.355 s                   |
| BlockToStepN              | 1.320 ms                  | 71.782 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:49.213398 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240205 02:20:49.388018 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=178
W20240205 02:20:49.652933 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=289, pq.top=289
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.340 ms                  | 230.518 ms                |
| Forward                   | 5.895 ms                  | 11.717 ms                 |
| Backward                  | 7.277 ms                  | 12.348 ms                 |
| Optimize                  | 2.813 ms                  | 7.670 ms                  |
| BarrierTimeBeforeRank0    | 4.077 ms                  | 303.010 ms                |
| AfterBackward             | 105.331 ms                | 1.357 s                   |
| BlockToStepN              | 1.436 ms                  | 71.922 ms                 |
| OneStep                   | 151.913 ms                | 1.415 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:50.299960 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 02:20:50.381266 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=293, sample_step_cpp_seen_[rank]=292
E20240205 02:20:50.388006 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=64505
W20240205 02:20:51.345983 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240205 02:20:51.388005 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=14
W20240205 02:20:51.889794 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240205 02:20:52.377321 17467 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240205 02:20:52.388011 17703 parallel_pq_v2.h:79] insert failed, size(hashtable)=25393
[proc 2] 300 steps, total: 22.561, sample: 1.691, forward: 0.556, backward: 0.599, update: 0.262
[proc 3] 300 steps, total: 22.562, sample: 2.039, forward: 0.525, backward: 0.773, update: 0.221
[proc 0] 300 steps, total: 22.562, sample: 1.925, forward: 0.620, backward: 0.710, update: 0.324
[proc 4] 300 steps, total: 22.561, sample: 1.294, forward: 0.552, backward: 0.783, update: 0.240
[proc 7] 300 steps, total: 22.561, sample: 1.007, forward: 0.546, backward: 0.487, update: 0.225
[proc 5] 300 steps, total: 22.562, sample: 1.534, forward: 0.545, backward: 0.636, update: 0.235
[proc 6] 300 steps, total: 22.562, sample: 1.239, forward: 0.544, backward: 0.499, update: 0.234
[proc 1] 300 steps, total: 22.561, sample: 1.693, forward: 0.578, backward: 0.714, update: 0.243
W20240205 02:20:52.939018 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=303, pq.top=303
E20240205 02:20:53.388010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=677
W20240205 02:20:53.553952 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 616.070 us                | 10.474 ms                 |
| ProcessBack:Shuffle       | 9.007 ms                  | 22.207 ms                 |
| ProcessBack:UpdateCache   | 9.997 ms                  | 16.413 ms                 |
| ProcessBack:UpsertPq      | 30.250 ms                 | 175.949 ms                |
| ProcessOneStep            | 105.271 ms                | 1.355 s                   |
| BlockToStepN              | 1.356 ms                  | 71.782 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 02:20:54.388012 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3351
W20240205 02:20:54.564327 17467 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.444 ms                  | 230.518 ms                |
| Forward                   | 5.893 ms                  | 11.717 ms                 |
| Backward                  | 6.917 ms                  | 12.348 ms                 |
| Optimize                  | 2.813 ms                  | 8.139 ms                  |
| BarrierTimeBeforeRank0    | 3.582 ms                  | 303.010 ms                |
| AfterBackward             | 105.331 ms                | 1.357 s                   |
| BlockToStepN              | 1.465 ms                  | 71.922 ms                 |
| OneStep                   | 153.035 ms                | 1.415 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:54.881904 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=310, pq.top=309
E20240205 02:20:55.388068 17701 parallel_pq_v2.h:79] insert failed, size(hashtable)=72615
W20240205 02:20:55.678598 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
W20240205 02:20:56.045884 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=315, pq.top=315
E20240205 02:20:56.388010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=54271
W20240205 02:20:56.885645 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 02:20:57.059167 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=323, sample_step_cpp_seen_[rank]=322
E20240205 02:20:57.388010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=56
W20240205 02:20:58.005256 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
E20240205 02:20:58.388013 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=872
W20240205 02:20:58.483266 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=325, pq.top=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 402.516 us                | 4.642 ms                  |
| ProcessBack:Shuffle       | 9.013 ms                  | 22.207 ms                 |
| ProcessBack:UpdateCache   | 9.997 ms                  | 16.413 ms                 |
| ProcessBack:UpsertPq      | 30.275 ms                 | 175.949 ms                |
| ProcessOneStep            | 105.271 ms                | 1.355 s                   |
| BlockToStepN              | 1.374 ms                  | 80.808 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:20:59.036032 17467 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240205 02:20:59.388010 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=2262
W20240205 02:20:59.653342 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=333, pq.top=333
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.502 ms                  | 242.133 ms                |
| Forward                   | 5.894 ms                  | 11.717 ms                 |
| Backward                  | 7.429 ms                  | 12.348 ms                 |
| Optimize                  | 2.796 ms                  | 8.139 ms                  |
| BarrierTimeBeforeRank0    | 2.841 ms                  | 303.010 ms                |
| AfterBackward             | 105.625 ms                | 1.357 s                   |
| BlockToStepN              | 1.523 ms                  | 80.959 ms                 |
| OneStep                   | 153.035 ms                | 1.415 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:00.241148 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240205 02:21:00.388010 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=1232
W20240205 02:21:01.323757 17467 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
E20240205 02:21:01.389321 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 02:21:01.973156 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=342, pq.top=342
W20240205 02:21:02.340595 17467 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 02:21:02.389006 17720 parallel_pq_v2.h:79] insert failed, size(hashtable)=67482
W20240205 02:21:03.283010 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=351, pq.top=351
E20240205 02:21:03.389010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=42365
W20240205 02:21:03.629684 17467 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 02:21:03.694623 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=354, sample_step_cpp_seen_[rank]=353
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 496.882 us                | 13.650 ms                 |
| ProcessBack:Shuffle       | 8.979 ms                  | 22.207 ms                 |
| ProcessBack:UpdateCache   | 9.872 ms                  | 16.413 ms                 |
| ProcessBack:UpsertPq      | 30.236 ms                 | 175.949 ms                |
| ProcessOneStep            | 105.189 ms                | 1.327 s                   |
| BlockToStepN              | 1.564 ms                  | 80.808 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 02:21:04.389081 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=18
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.803 ms                  | 230.518 ms                |
| Forward                   | 5.878 ms                  | 11.044 ms                 |
| Backward                  | 7.527 ms                  | 12.009 ms                 |
| Optimize                  | 2.764 ms                  | 8.012 ms                  |
| BarrierTimeBeforeRank0    | 2.790 ms                  | 186.505 ms                |
| AfterBackward             | 105.320 ms                | 1.327 s                   |
| BlockToStepN              | 1.660 ms                  | 80.959 ms                 |
| OneStep                   | 152.496 ms                | 1.390 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:04.754552 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
E20240205 02:21:05.389739 17695 parallel_pq_v2.h:79] insert failed, size(hashtable)=46968
W20240205 02:21:05.757210 17467 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240205 02:21:06.389009 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=118
W20240205 02:21:06.896227 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
W20240205 02:21:07.027796 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=364, pq.top=363
E20240205 02:21:07.389008 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=3543
W20240205 02:21:08.144555 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 02:21:08.389015 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=4821
E20240205 02:21:08.694008 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=371, sample_step_cpp_seen_[rank]=370
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 498.144 us                | 18.739 ms                 |
| ProcessBack:Shuffle       | 8.954 ms                  | 22.207 ms                 |
| ProcessBack:UpdateCache   | 9.827 ms                  | 16.413 ms                 |
| ProcessBack:UpsertPq      | 30.331 ms                 | 176.997 ms                |
| ProcessOneStep            | 105.272 ms                | 1.355 s                   |
| BlockToStepN              | 1.725 ms                  | 80.808 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:09.181706 17467 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240205 02:21:09.319007 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=373, pq.top=373
E20240205 02:21:09.389011 14881 parallel_pq_v2.h:79] insert failed, size(hashtable)=69992
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.731 ms                  | 230.518 ms                |
| Forward                   | 5.864 ms                  | 11.044 ms                 |
| Backward                  | 7.096 ms                  | 12.009 ms                 |
| Optimize                  | 2.802 ms                  | 8.012 ms                  |
| BarrierTimeBeforeRank0    | 3.491 ms                  | 186.505 ms                |
| AfterBackward             | 105.625 ms                | 1.357 s                   |
| BlockToStepN              | 1.804 ms                  | 80.959 ms                 |
| OneStep                   | 152.496 ms                | 1.415 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:10.293900 17467 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240205 02:21:10.389012 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=1430
W20240205 02:21:10.397833 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240205 02:21:11.389014 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=2575
W20240205 02:21:11.492594 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240205 02:21:12.390806 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 02:21:12.525825 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
W20240205 02:21:12.903851 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=387, pq.top=387
E20240205 02:21:13.391217 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 02:21:13.633087 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 517.460 us                | 8.266 ms                  |
| ProcessBack:Shuffle       | 8.982 ms                  | 21.935 ms                 |
| ProcessBack:UpdateCache   | 9.832 ms                  | 16.413 ms                 |
| ProcessBack:UpsertPq      | 30.701 ms                 | 176.997 ms                |
| ProcessOneStep            | 106.366 ms                | 1.355 s                   |
| BlockToStepN              | 1.778 ms                  | 80.808 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:14.131093 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=395, pq.top=395
E20240205 02:21:14.391012 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=151838
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.851 ms                  | 230.518 ms                |
| Forward                   | 5.880 ms                  | 11.717 ms                 |
| Backward                  | 7.116 ms                  | 12.009 ms                 |
| Optimize                  | 2.808 ms                  | 8.139 ms                  |
| BarrierTimeBeforeRank0    | 3.278 ms                  | 186.505 ms                |
| AfterBackward             | 106.125 ms                | 1.357 s                   |
| BlockToStepN              | 1.812 ms                  | 80.959 ms                 |
| OneStep                   | 153.035 ms                | 1.415 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 22.337, sample: 1.677, forward: 0.569, backward: 0.663, update: 0.260
[proc 2] 400 steps, total: 22.337, sample: 1.239, forward: 0.544, backward: 0.717, update: 0.250
[proc 4] 400 steps, total: 22.337, sample: 1.211, forward: 0.575, backward: 0.733, update: 0.253
[proc 7] 400 steps, total: 22.337, sample: 1.173, forward: 0.623, backward: 0.616, update: 0.251
[proc 1] 400 steps, total: 22.337, sample: 1.447, forward: 0.579, backward: 0.670, update: 0.283
[proc 5] 400 steps, total: 22.337, sample: 1.163, forward: 0.562, backward: 0.641, update: 0.242
[proc 6] 400 steps, total: 22.337, sample: 1.148, forward: 0.550, backward: 0.549, update: 0.248
[proc 0] 400 steps, total: 22.337, sample: 1.736, forward: 0.601, backward: 0.683, update: 0.330
E20240205 02:21:14.912005 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=400, sample_step_cpp_seen_[rank]=399
W20240205 02:21:14.935920 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 02:21:15.391010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=15675
W20240205 02:21:15.999410 17467 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240205 02:21:16.147351 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=402, pq.top=402
E20240205 02:21:16.391008 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=69044
W20240205 02:21:17.106184 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
E20240205 02:21:17.391017 17466 parallel_pq_v2.h:79] insert failed, size(hashtable)=75397
W20240205 02:21:17.520650 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240205 02:21:18.150591 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240205 02:21:18.391012 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=2983
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 543.226 us                | 20.088 ms                 |
| ProcessBack:Shuffle       | 8.957 ms                  | 21.935 ms                 |
| ProcessBack:UpdateCache   | 9.783 ms                  | 16.413 ms                 |
| ProcessBack:UpsertPq      | 30.911 ms                 | 177.153 ms                |
| ProcessOneStep            | 105.272 ms                | 1.355 s                   |
| BlockToStepN              | 1.887 ms                  | 81.466 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:19.206821 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240205 02:21:19.397130 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.731 ms                  | 230.518 ms                |
| Forward                   | 5.878 ms                  | 11.717 ms                 |
| Backward                  | 6.766 ms                  | 12.009 ms                 |
| Optimize                  | 2.808 ms                  | 8.139 ms                  |
| BarrierTimeBeforeRank0    | 3.080 ms                  | 186.505 ms                |
| AfterBackward             | 106.125 ms                | 1.357 s                   |
| BlockToStepN              | 1.969 ms                  | 81.606 ms                 |
| OneStep                   | 153.035 ms                | 1.415 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:19.730273 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=420, pq.top=419
W20240205 02:21:20.231835 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240205 02:21:20.397011 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3152
W20240205 02:21:20.815373 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240205 02:21:21.237514 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240205 02:21:21.397017 17721 parallel_pq_v2.h:79] insert failed, size(hashtable)=41088
W20240205 02:21:21.935009 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=435, pq.top=435
E20240205 02:21:22.050326 14881 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=435, sample_step_cpp_seen_[rank]=434
E20240205 02:21:22.397013 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240205 02:21:22.553987 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240205 02:21:23.397011 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=7042
W20240205 02:21:23.564256 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240205 02:21:23.567277 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 464.245 us                | 10.086 ms                 |
| ProcessBack:Shuffle       | 8.929 ms                  | 21.584 ms                 |
| ProcessBack:UpdateCache   | 9.703 ms                  | 16.216 ms                 |
| ProcessBack:UpsertPq      | 30.731 ms                 | 176.997 ms                |
| ProcessOneStep            | 105.189 ms                | 1.355 s                   |
| BlockToStepN              | 1.970 ms                  | 81.466 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 02:21:24.397015 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=45
W20240205 02:21:24.592415 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=445, pq.top=445
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.721 ms                  | 230.518 ms                |
| Forward                   | 5.863 ms                  | 11.717 ms                 |
| Backward                  | 6.602 ms                  | 12.009 ms                 |
| Optimize                  | 2.796 ms                  | 8.139 ms                  |
| BarrierTimeBeforeRank0    | 3.231 ms                  | 186.505 ms                |
| AfterBackward             | 104.944 ms                | 1.357 s                   |
| BlockToStepN              | 2.097 ms                  | 81.606 ms                 |
| OneStep                   | 151.913 ms                | 1.415 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:24.719507 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240205 02:21:25.401860 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 02:21:25.742009 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240205 02:21:26.401012 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=713
W20240205 02:21:26.450565 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=451, pq.top=451
W20240205 02:21:26.792565 17467 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240205 02:21:27.401008 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=679
W20240205 02:21:27.657259 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240205 02:21:27.867117 17467 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
E20240205 02:21:28.401016 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=142413
E20240205 02:21:28.598431 12890 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=466, sample_step_cpp_seen_[rank]=465
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 527.760 us                | 18.760 ms                 |
| ProcessBack:Shuffle       | 8.982 ms                  | 21.584 ms                 |
| ProcessBack:UpdateCache   | 9.791 ms                  | 16.216 ms                 |
| ProcessBack:UpsertPq      | 30.571 ms                 | 176.997 ms                |
| ProcessOneStep            | 103.204 ms                | 1.341 s                   |
| BlockToStepN              | 2.070 ms                  | 81.466 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:29.042951 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240205 02:21:29.401021 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=2812
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.502 ms                  | 195.941 ms                |
| Forward                   | 5.817 ms                  | 11.044 ms                 |
| Backward                  | 6.418 ms                  | 11.934 ms                 |
| Optimize                  | 2.796 ms                  | 8.012 ms                  |
| BarrierTimeBeforeRank0    | 3.524 ms                  | 166.247 ms                |
| AfterBackward             | 103.250 ms                | 1.341 s                   |
| BlockToStepN              | 2.170 ms                  | 81.606 ms                 |
| OneStep                   | 149.536 ms                | 1.390 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:29.840107 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=467, pq.top=466
W20240205 02:21:30.045831 17467 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240205 02:21:30.401012 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=768
W20240205 02:21:30.890611 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240205 02:21:31.050467 17467 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240205 02:21:31.401010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=11923
W20240205 02:21:32.053421 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=481, pq.top=480
W20240205 02:21:32.134279 17467 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 02:21:32.401015 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=38433
W20240205 02:21:33.148388 17467 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240205 02:21:33.401023 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=6142
W20240205 02:21:33.685961 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=485, pq.top=484
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 635.811 us                | 35.252 ms                 |
| ProcessBack:Shuffle       | 9.023 ms                  | 21.295 ms                 |
| ProcessBack:UpdateCache   | 9.805 ms                  | 16.413 ms                 |
| ProcessBack:UpsertPq      | 30.536 ms                 | 175.949 ms                |
| ProcessOneStep            | 100.497 ms                | 1.341 s                   |
| BlockToStepN              | 2.139 ms                  | 81.466 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 02:21:33.778607 12890 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=485, sample_step_cpp_seen_[rank]=484
W20240205 02:21:34.166918 17467 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240205 02:21:34.401012 12890 parallel_pq_v2.h:79] insert failed, size(hashtable)=893
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.721 ms                  | 195.941 ms                |
| Forward                   | 5.768 ms                  | 11.044 ms                 |
| Backward                  | 6.454 ms                  | 11.934 ms                 |
| Optimize                  | 2.726 ms                  | 8.012 ms                  |
| BarrierTimeBeforeRank0    | 3.577 ms                  | 166.247 ms                |
| AfterBackward             | 100.547 ms                | 1.341 s                   |
| BlockToStepN              | 2.278 ms                  | 81.606 ms                 |
| OneStep                   | 149.661 ms                | 1.390 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 02:21:34.871277 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240205 02:21:35.338228 17467 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240205 02:21:35.401008 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=107010
E20240205 02:21:36.401010 17467 parallel_pq_v2.h:79] insert failed, size(hashtable)=3921
W20240205 02:21:36.486526 17467 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
W20240205 02:21:36.917205 12890 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=500, pq.top=500
[proc 0] 500 steps, total: 22.055, sample: 1.132, forward: 0.541, backward: 0.614, update: 0.285
[proc 7] 500 steps, total: 22.056, sample: 0.964, forward: 0.556, backward: 0.514, update: 0.232
[proc 1] 500 steps, total: 22.056, sample: 1.270, forward: 0.542, backward: 0.665, update: 0.245
[proc 3] 500 steps, total: 22.056, sample: 1.632, forward: 0.590, backward: 0.620, update: 0.260
[proc 4] 500 steps, total: 22.056, sample: 1.105, forward: 0.647, backward: 0.666, update: 0.254
Successfully xmh. training takes 115.25835037231445 seconds
[proc 6] 500 steps, total: 22.056, sample: 1.234, forward: 0.516, backward: 0.561, update: 0.228
[proc 2] 500 steps, total: 22.056, sample: 1.135, forward: 0.562, backward: 0.695, update: 0.274
before call kg_cache_controller.StopThreads()
[proc 5] 500 steps, total: 22.056, sample: 1.036, forward: 0.568, backward: 0.709, update: 0.270
W20240205 02:21:36.919512 12890 grad_async_v2.h:84] call StopThreads. PID = 30273
W20240205 02:21:36.919541 12890 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 02:21:36.919836 12890 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 02:21:36.919847 12890 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240205 02:21:36.921234 12890 grad_async_v2.h:105] StopThreads done.
