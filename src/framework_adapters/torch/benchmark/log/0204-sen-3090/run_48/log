WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 06:58:23.430634  2111 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_107', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=8, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [2111 sampler.py:454] Start PreSampling
WARNING [2111 sampler.py:532] Before construct renumbering_dict
WARNING [2111 sampler.py:555] PreSampling done
W20240205 07:14:04.253468  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 07:14:04.253669  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 07:14:04.253706  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 07:14:04.253742  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 07:14:04.253780  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 07:14:04.253813  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 07:14:04.253839  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 07:14:04.253875  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 07:14:04.253909  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 07:14:04.253950  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 07:14:04.253986  2111 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 07:14:04.254016  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 07:14:04.254048  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 07:14:04.254207  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 07:14:04.254249  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 07:14:04.254280  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 07:14:04.254321  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 07:14:04.254355  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 07:14:04.254381  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 07:14:04.254417  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 07:14:04.254448  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 07:14:04.254477  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 07:14:04.254504  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 07:14:04.254536  2111 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 07:14:04.254559  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 07:14:04.254583  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 07:14:04.254637  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 07:14:04.254673  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 07:14:04.254705  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 07:14:04.254732  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 07:14:04.254760  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 07:14:04.254796  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 07:14:04.254832  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 07:14:04.254864  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 07:14:04.254899  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 07:14:04.254925  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 07:14:04.254956  2111 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 07:14:04.254977  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 07:14:04.255002  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 07:14:04.255064  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 07:14:04.255095  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 07:14:04.255123  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 07:14:04.255160  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 07:14:04.255187  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 07:14:04.255213  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 07:14:04.255241  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 07:14:04.255273  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 07:14:04.255299  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 07:14:04.255335  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 07:14:04.255362  2111 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 07:14:04.255383  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 07:14:04.255405  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 07:14:04.255463  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 07:14:04.255491  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 07:14:04.255519  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 07:14:04.255546  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 07:14:04.255578  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 07:14:04.255611  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 07:14:04.255640  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 07:14:04.255667  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 07:14:04.255697  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 07:14:04.255731  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 07:14:04.255759  2111 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 07:14:04.255780  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 07:14:04.255803  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 07:14:04.255854  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 07:14:04.255895  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 07:14:04.255923  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 07:14:04.255949  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 07:14:04.255980  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 07:14:04.256012  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 07:14:04.256045  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 07:14:04.256090  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 07:14:04.256120  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 07:14:04.256147  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 07:14:04.256175  2111 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 07:14:04.256197  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 07:14:04.256219  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 07:14:04.256270  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 07:14:04.256304  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 07:14:04.256331  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 07:14:04.256361  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 07:14:04.256397  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 07:14:04.256431  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 07:14:04.256460  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 07:14:04.256487  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 07:14:04.256520  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 07:14:04.256556  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 07:14:04.256587  2111 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 07:14:04.256610  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 07:14:04.256633  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 07:14:04.256683  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 07:14:04.256714  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 07:14:04.256742  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 07:14:04.256769  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 07:14:04.256803  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 07:14:04.256835  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 07:14:04.256868  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 07:14:04.256901  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 07:14:04.256929  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 07:14:04.256963  2111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 07:14:04.256994  2111 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 07:14:04.257016  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 07:14:04.257040  2111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 07:14:04.684527  2111 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 07:22:43.993527  2111 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302707,  4302717,    93908,  ..., 72338831, 52325582,  4889347]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1970.474 seconds
[Rank1] pid = 33086
[Rank2] pid = 33278
[Rank3] pid = 33465
[Rank4] pid = 33642
[Rank5] pid = 33819
[Rank6] pid = 33970
INFO [2111 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [33086 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [33278 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [33465 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [33819 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [33970 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [33642 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [34136 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [2111 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33819 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34136 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33970 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33642 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33086 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33278 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 07:31:25.527487 34137 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
INFO [33465 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 07:31:25.533941 33820 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 07:31:25.533937 33466 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 07:31:25.534070 33971 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 07:31:25.533941 33279 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 07:31:25.533931 34200 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 07:31:25.534070 33643 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 07:31:25.534071 33087 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 07:31:25.627219 33643 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1020497b1000 7.629 MB
W20240205 07:31:25.627276 34200 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x102049f54000 7.629 MB
W20240205 07:31:25.627292 33820 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204a6f7000 7.629 MB
W20240205 07:31:25.627303 33971 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204ae9a000 7.629 MB
W20240205 07:31:25.627383 33466 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204b63d000 7.629 MB
W20240205 07:31:25.627429 34137 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204bde0000 7.629 MB
W20240205 07:31:25.627454 33087 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204c583000 7.629 MB
W20240205 07:31:25.627461 33279 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204cd26000 7.629 MB
W20240205 07:31:25.627477 33643 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204d4c9000 7.629 MB
W20240205 07:31:25.627553 33643 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10204dc6c000 1.49 GB
W20240205 07:31:25.627604 33643 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1020ad24f000 1.49 GB
W20240205 07:31:25.627676 33643 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 07:31:25.629663 33820 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10210c832000 7.629 MB
W20240205 07:31:25.629719 33279 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10210cfd7000 7.629 MB
W20240205 07:31:25.629727 33971 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10210d77a000 7.629 MB
W20240205 07:31:25.629729 34137 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10210df1d000 7.629 MB
W20240205 07:31:25.629745 33087 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210e6c0000 7.629 MB
W20240205 07:31:25.629755 33466 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10210ee63000 7.629 MB
W20240205 07:31:25.629776 34200 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10210f606000 7.629 MB
W20240205 07:31:25.629803 34137 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210fda9000 1.49 GB
W20240205 07:31:25.629818 33643 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 07:31:25.629825 33971 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10216f38c000 1.49 GB
W20240205 07:31:25.629834 33087 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021ce96f000 1.49 GB
W20240205 07:31:25.629858 34137 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10222df52000 1.49 GB
W20240205 07:31:25.629882 34200 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10228d535000 1.49 GB
W20240205 07:31:25.629925 33971 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1022ecb18000 1.49 GB
W20240205 07:31:25.629933 33087 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10234c0fb000 1.49 GB
W20240205 07:31:25.629951 34200 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1023ab6de000 1.49 GB
W20240205 07:31:25.629971 34137 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 07:31:25.629976 33466 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10240acc1000 1.49 GB
W20240205 07:31:25.629994 33087 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 07:31:25.629995 33279 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10246a2a4000 1.49 GB
W20240205 07:31:25.630002 33820 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1024c9887000 1.49 GB
W20240205 07:31:25.630016 33971 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 07:31:25.630024 34200 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 07:31:25.630043 33466 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102528e6a000 1.49 GB
W20240205 07:31:25.630060 33279 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10258844d000 1.49 GB
W20240205 07:31:25.630079 33820 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1025e7a30000 1.49 GB
W20240205 07:31:25.630107 33466 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 07:31:25.630120 33279 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 07:31:25.630128 33820 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 07:31:25.645001 34137 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 07:31:25.645057 34200 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 07:31:25.645135 33971 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 07:31:25.645139 33087 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 07:31:25.645138 33466 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 07:31:25.645429 33279 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 07:31:25.645449 33820 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [33278 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [33642 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [33465 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [33819 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [34136 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [33970 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 34136
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [2111 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [33086 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 07:32:15.290050 33087 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 07:32:15.290257 34137 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 07:32:15.290305 33971 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 07:32:15.290436 33643 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 07:32:15.290520 34200 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 07:32:15.290567 33279 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 07:32:15.290644 33820 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 07:32:15.290681 33466 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 07:32:15.293009 34137 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 8,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 07:32:15.293130 34137 grad_base.h:184] Init GradProcessingBase done
I20240205 07:32:28.291838 34137 grad_async_v2.h:42] Use main thread to update emb.
W20240205 07:32:28.292165 34137 kg_controller.h:78] after init GradAsyncProcessingV2
I20240205 07:32:28.292176 34137 kg_controller.h:84] Construct KGCacheController done
E20240205 07:32:29.065375 33087 recstore.cc:66] init folly done
E20240205 07:32:29.065685 33466 recstore.cc:66] init folly done
E20240205 07:32:29.065693 34200 recstore.cc:66] init folly done
E20240205 07:32:29.065694 33971 recstore.cc:66] init folly done
E20240205 07:32:29.065698 33820 recstore.cc:66] init folly done
E20240205 07:32:29.065707 33643 recstore.cc:66] init folly done
E20240205 07:32:29.065727 33279 recstore.cc:66] init folly done
E20240205 07:32:29.066030 34137 recstore.cc:66] init folly done
I20240205 07:32:29.067145 34137 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240205 07:32:47.449486 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 07:32:47.450289 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240205 07:32:48.450013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=20
W20240205 07:32:48.561333 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 133.571 us                | 286.690 us                |
+---------------------------+---------------------------+---------------------------+
W20240205 07:32:50.532116 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 07:32:50.548182 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 07:32:50.708664 33643 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 07:32:50.882335 34200 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 07:32:50.907563 33820 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240205 07:32:51.533052 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 07:32:51.548585 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 07:32:51.677456 33279 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 07:32:52.343006 33466 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 07:32:52.548014 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
W20240205 07:32:53.039981 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240205 07:32:53.093664 34137 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 07:32:53.494849 33087 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 07:32:53.548013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 07:32:53.856688 33971 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 148.150 us                | 302.501 us                |
+---------------------------+---------------------------+---------------------------+
W20240205 07:32:54.153564 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 07:32:54.548044 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 36.989 ms                 | 36.989 ms                 |
| Forward                   | 1.074 s                   | 1.074 s                   |
| Backward                  | 184.448 ms                | 184.448 ms                |
| Optimize                  | 4.732 ms                  | 4.732 ms                  |
| BarrierTimeBeforeRank0    | 92.154 us                 | 92.154 us                 |
+---------------------------+---------------------------+---------------------------+
E20240205 07:32:56.598093 36654 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 07:32:56.702644 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240205 07:32:56.708585 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 07:32:57.598008 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=767
W20240205 07:32:57.806443 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
W20240205 07:32:58.071302 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=9, pq.top=9
E20240205 07:32:58.598011 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=345
W20240205 07:32:59.063270 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 271.043 us                | 8.389 ms                  |
| ProcessBack:Shuffle       | 9.075 ms                  | 371.926 ms                |
| ProcessBack:UpdateCache   | 11.266 ms                 | 760.757 ms                |
| ProcessBack:UpsertPq      | 33.922 ms                 | 128.852 ms                |
| ProcessOneStep            | 118.932 ms                | 1.544 s                   |
| BlockToStepN              | 406.603 us                | 2.040 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 07:32:59.222141 34137 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=16, sample_step_cpp_seen_[rank]=15
E20240205 07:32:59.598024 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.171 ms                  | 103.478 ms                |
| Forward                   | 5.488 ms                  | 1.074 s                   |
| Backward                  | 5.158 ms                  | 184.448 ms                |
| Optimize                  | 2.612 ms                  | 20.202 ms                 |
| BarrierTimeBeforeRank0    | 11.026 ms                 | 124.969 ms                |
| AfterBackward             | 118.984 ms                | 1.545 s                   |
| BlockToStepN              | 438.896 us                | 2.134 ms                  |
| OneStep                   | 166.653 ms                | 2.848 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:00.324205 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240205 07:33:00.598011 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=33
E20240205 07:33:01.598049 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
W20240205 07:33:01.703337 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
W20240205 07:33:02.222860 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=17, pq.top=17
E20240205 07:33:02.598016 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240205 07:33:02.825500 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240205 07:33:03.582628 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=23, pq.top=23
E20240205 07:33:03.598040 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=282
W20240205 07:33:03.867061 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 356.006 us                | 3.630 ms                  |
| ProcessBack:Shuffle       | 9.106 ms                  | 334.393 ms                |
| ProcessBack:UpdateCache   | 11.162 ms                 | 759.927 ms                |
| ProcessBack:UpsertPq      | 52.060 ms                 | 153.522 ms                |
| ProcessOneStep            | 123.784 ms                | 3.016 s                   |
| BlockToStepN              | 677.708 us                | 18.725 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:04.598013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=625
E20240205 07:33:04.605913 34137 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=29, sample_step_cpp_seen_[rank]=28
W20240205 07:33:05.065821 38878 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.550 ms                  | 216.910 ms                |
| Forward                   | 5.747 ms                  | 1.074 s                   |
| Backward                  | 5.032 ms                  | 184.448 ms                |
| Optimize                  | 2.612 ms                  | 20.202 ms                 |
| BarrierTimeBeforeRank0    | 6.647 ms                  | 124.969 ms                |
| AfterBackward             | 120.277 ms                | 3.017 s                   |
| BlockToStepN              | 469.030 us                | 18.863 ms                 |
| OneStep                   | 170.927 ms                | 3.074 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:05.601059 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:33:06.082266 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240205 07:33:06.085529 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 07:33:06.601023 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=24
W20240205 07:33:07.299880 38878 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
W20240205 07:33:07.560335 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=39, pq.top=39
E20240205 07:33:07.601027 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
E20240205 07:33:08.601022 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=24
W20240205 07:33:08.695369 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 218.453 us                | 593.220 us                |
| ProcessBack:Shuffle       | 9.340 ms                  | 334.393 ms                |
| ProcessBack:UpdateCache   | 11.119 ms                 | 759.927 ms                |
| ProcessBack:UpsertPq      | 58.165 ms                 | 137.682 ms                |
| ProcessOneStep            | 123.784 ms                | 3.016 s                   |
| BlockToStepN              | 676.435 us                | 18.725 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:09.601014 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=35
E20240205 07:33:09.605023 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=43, sample_step_cpp_seen_[rank]=42
W20240205 07:33:09.791034 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240205 07:33:10.108955 34137 grad_async_v2.h:257] pq is empty
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.960 ms                  | 216.910 ms                |
| Forward                   | 6.134 ms                  | 1.074 s                   |
| Backward                  | 5.241 ms                  | 184.448 ms                |
| Optimize                  | 2.612 ms                  | 20.202 ms                 |
| BarrierTimeBeforeRank0    | 2.764 ms                  | 124.969 ms                |
| AfterBackward             | 123.855 ms                | 3.017 s                   |
| BlockToStepN              | 520.471 us                | 18.863 ms                 |
| OneStep                   | 174.678 ms                | 3.074 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:10.329233 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=45, pq.top=45
E20240205 07:33:10.601012 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=925
W20240205 07:33:10.812521 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
W20240205 07:33:11.429981 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=50, pq.top=50
E20240205 07:33:11.601013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=42814
W20240205 07:33:11.814608 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
W20240205 07:33:12.439014 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=55, pq.top=55
E20240205 07:33:12.601011 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=76
W20240205 07:33:12.924520 38878 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
W20240205 07:33:13.572408 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=63, pq.top=63
E20240205 07:33:13.601011 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=491
W20240205 07:33:13.776743 34137 grad_async_v2.h:257] pq is empty
W20240205 07:33:13.947896 38878 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 355.787 us                | 3.105 ms                  |
| ProcessBack:Shuffle       | 10.070 ms                 | 334.393 ms                |
| ProcessBack:UpdateCache   | 11.277 ms                 | 759.927 ms                |
| ProcessBack:UpsertPq      | 58.165 ms                 | 167.428 ms                |
| ProcessOneStep            | 125.958 ms                | 1.750 s                   |
| BlockToStepN              | 383.778 us                | 8.615 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:14.601015 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=2925
W20240205 07:33:14.629523 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=65, pq.top=65
E20240205 07:33:14.670267 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=65, sample_step_cpp_seen_[rank]=64
W20240205 07:33:14.947393 38878 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.076 ms                  | 197.387 ms                |
| Forward                   | 6.242 ms                  | 11.690 ms                 |
| Backward                  | 5.357 ms                  | 10.063 ms                 |
| Optimize                  | 2.652 ms                  | 18.116 ms                 |
| BarrierTimeBeforeRank0    | 855.480 us                | 104.063 ms                |
| AfterBackward             | 127.262 ms                | 1.750 s                   |
| BlockToStepN              | 601.171 us                | 8.728 ms                  |
| OneStep                   | 179.328 ms                | 2.848 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:15.601013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=38
W20240205 07:33:15.818480 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240205 07:33:15.956223 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
E20240205 07:33:16.601009 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=2044
W20240205 07:33:16.922320 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240205 07:33:17.194578 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 07:33:17.601025 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=23
W20240205 07:33:18.308785 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240205 07:33:18.425410 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=80, pq.top=80
E20240205 07:33:18.601008 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=42245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 467.171 us                | 5.173 ms                  |
| ProcessBack:Shuffle       | 9.595 ms                  | 21.429 ms                 |
| ProcessBack:UpdateCache   | 11.118 ms                 | 25.736 ms                 |
| ProcessBack:UpsertPq      | 48.862 ms                 | 167.428 ms                |
| ProcessOneStep            | 123.784 ms                | 1.750 s                   |
| BlockToStepN              | 807.097 us                | 18.725 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:19.356401 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
W20240205 07:33:19.565302 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=88, pq.top=88
E20240205 07:33:19.624951 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1183
E20240205 07:33:19.989360 34137 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=91, sample_step_cpp_seen_[rank]=90
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.011 ms                  | 197.387 ms                |
| Forward                   | 5.947 ms                  | 29.109 ms                 |
| Backward                  | 5.576 ms                  | 10.063 ms                 |
| Optimize                  | 2.631 ms                  | 20.202 ms                 |
| BarrierTimeBeforeRank0    | 123.114 us                | 104.063 ms                |
| AfterBackward             | 120.277 ms                | 1.750 s                   |
| BlockToStepN              | 953.611 us                | 25.745 ms                 |
| OneStep                   | 168.718 ms                | 2.848 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:20.632601 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:33:20.714779 38878 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
W20240205 07:33:21.585078 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=93, pq.top=93
E20240205 07:33:21.632011 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1492
W20240205 07:33:21.773628 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 31.776, sample: 1.601, forward: 1.285, backward: 0.996, update: 0.270
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 31.603, sample: 1.405, forward: 1.266, backward: 0.961, update: 0.252
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 31.577, sample: 1.445, forward: 1.380, backward: 0.882, update: 0.324
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 30.142, sample: 1.398, forward: 1.314, backward: 0.821, update: 0.255
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 30.807, sample: 1.425, forward: 1.321, backward: 0.920, update: 0.263
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 28.628, sample: 1.526, forward: 1.389, backward: 0.875, update: 0.258
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 28.990, sample: 1.715, forward: 1.340, backward: 0.874, update: 0.283
train_sampler.Prefill()
-------Step 0-------
tensor([   48970,    48996,    49026,    49051,  6169488,    49081, 59865954,
        15349655,    49110,    49134]) tensor([ 5376890, 13398260, 58167779, 78369374, 23355701, 35849781, 30105806,
        81787313, 59362005, 32895685])
-------Step 1-------
tensor([   48970,    48996,    49026,    49051,  6169488,    49081, 59865954,
        15349655,    49110,    49134]) tensor([58175034, 23838306, 11992906, 68758641, 76648132, 50073817, 75263562,
        41953905, 44284017, 11523036])
-------Step 2-------
tensor([  115538,   115561,   115583,    22069,   115608,   115631,   115661,
        21819075,   115682,   115714]) tensor([61569258, 27774846, 79306509, 48304427, 41910945, 24019956, 58468066,
        34386499, 13278841, 49163612])
-------Step 3-------
tensor([  115538,   115561,   115583,    22069,   115608,   115631,   115661,
        21819075,   115682,   115714]) tensor([58042579, 84597417, 31223121, 41662160, 73973392, 55183538, 32796301,
        14197787, 29515156,   682512])
-------Step 4-------
tensor([  180748, 53005436,   180774,   180809,   180840,   180866,   180893,
        43123205,   180924,   180948]) tensor([83115949,  8844770, 71618587, 20690201, 79828685, 42495785, 76622859,
        41013861, 71778286, 60316355])
-------Step 5-------
tensor([  180748, 53005436,   180774,   180809,   180840,   180866,   180893,
        43123205,   180924,   180948]) tensor([31144936, 82164436,   305191, 85088451, 58484768, 46564780, 13813300,
         9272427, 67995985, 34869727])
-------Step 6-------
tensor([  245065,    46671,   245090,   245115,    46702, 81712120,   194351,
          245140,   245168, 40055456]) tensor([14849206, 35290160, 29903171, 69610485, 28919808, 30144085, 21116577,
         6169289, 58200084, 69975758])
-------Step 7-------
tensor([  245065,    46671,   245090,   245115,    46702, 81712120,   194351,
          245140,   245168, 40055456]) tensor([28845016, 44175221, 80435845, 59380171, 74462430, 49115954, 62863208,
        66373249, 32207569, 28192482])
-------Step 8-------
tensor([  307444, 29810083,   307473,   307494,   307520,   261894,   307547,
          307571,   307596,   307626]) tensor([37224026, 21225913, 40426274, 18495028, 41913901, 67929873, 13145791,
        80444421,  1587166, 52505699])
-------Step 9-------
tensor([  307444, 29810083,   307473,   307494,   307520,   261894,   307547,
          307571,   307596,   307626]) tensor([62770832, 37762110, 12107841, 58175405,  9964715, 34257068, 22871552,
        31824189, 84485743, 56992802])
before start barrier
start train
[proc 0] 100 steps, total: 29.391, sample: 2.250, forward: 1.703, backward: 0.779, update: 0.383
W20240205 07:33:22.627380 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=101, pq.top=101
E20240205 07:33:22.632026 39125 parallel_pq_v2.h:79] insert failed, size(hashtable)=34626
W20240205 07:33:23.246223 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 07:33:23.632011 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=144
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 388.465 us                | 2.222 ms                  |
| ProcessBack:Shuffle       | 9.340 ms                  | 21.429 ms                 |
| ProcessBack:UpdateCache   | 10.880 ms                 | 25.736 ms                 |
| ProcessBack:UpsertPq      | 40.155 ms                 | 167.428 ms                |
| ProcessOneStep            | 114.542 ms                | 1.750 s                   |
| BlockToStepN              | 927.396 us                | 43.376 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:24.405077 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240205 07:33:24.632010 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=789
W20240205 07:33:24.695883 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.929 ms                  | 197.387 ms                |
| Forward                   | 5.947 ms                  | 29.109 ms                 |
| Backward                  | 5.757 ms                  | 10.063 ms                 |
| Optimize                  | 2.652 ms                  | 20.202 ms                 |
| BarrierTimeBeforeRank0    | 123.114 us                | 104.063 ms                |
| AfterBackward             | 118.984 ms                | 1.750 s                   |
| BlockToStepN              | 1.072 ms                  | 43.495 ms                 |
| OneStep                   | 168.718 ms                | 2.848 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:25.497687 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
E20240205 07:33:25.632010 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=5351
W20240205 07:33:25.724583 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=111, pq.top=111
E20240205 07:33:26.632009 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=30072
W20240205 07:33:26.689857 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
W20240205 07:33:26.797037 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=117, pq.top=117
E20240205 07:33:27.632972 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240205 07:33:27.823154 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240205 07:33:27.891448 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 07:33:27.962100 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=124, sample_step_cpp_seen_[rank]=123
E20240205 07:33:28.636803 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:33:28.968753 38878 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 271.347 us                | 2.741 ms                  |
| ProcessBack:Shuffle       | 9.315 ms                  | 21.429 ms                 |
| ProcessBack:UpdateCache   | 10.838 ms                 | 25.736 ms                 |
| ProcessBack:UpsertPq      | 39.922 ms                 | 175.908 ms                |
| ProcessOneStep            | 114.114 ms                | 1.750 s                   |
| BlockToStepN              | 996.302 us                | 43.376 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:29.171952 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=125, pq.top=125
E20240205 07:33:29.636027 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=230
W20240205 07:33:29.973213 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.020 ms                  | 197.387 ms                |
| Forward                   | 5.947 ms                  | 29.109 ms                 |
| Backward                  | 5.698 ms                  | 10.063 ms                 |
| Optimize                  | 2.785 ms                  | 20.202 ms                 |
| BarrierTimeBeforeRank0    | 1.636 ms                  | 104.063 ms                |
| AfterBackward             | 113.250 ms                | 1.750 s                   |
| BlockToStepN              | 1.140 ms                  | 43.495 ms                 |
| OneStep                   | 160.278 ms                | 2.848 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:30.639621 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:33:31.029389 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240205 07:33:31.639019 39119 parallel_pq_v2.h:79] insert failed, size(hashtable)=3962
W20240205 07:33:31.934691 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=136, pq.top=136
W20240205 07:33:32.062311 38878 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240205 07:33:32.643146 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=68561
W20240205 07:33:32.985795 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240205 07:33:33.492673 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240205 07:33:33.643014 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1753
E20240205 07:33:33.906592 34137 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=147, sample_step_cpp_seen_[rank]=146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 388.103 us                | 17.703 ms                 |
| ProcessBack:Shuffle       | 9.255 ms                  | 20.588 ms                 |
| ProcessBack:UpdateCache   | 10.689 ms                 | 22.326 ms                 |
| ProcessBack:UpsertPq      | 38.830 ms                 | 175.908 ms                |
| ProcessOneStep            | 113.207 ms                | 1.750 s                   |
| BlockToStepN              | 1.046 ms                  | 64.544 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:34.630800 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240205 07:33:34.643038 39120 parallel_pq_v2.h:79] insert failed, size(hashtable)=18
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.910 ms                  | 197.387 ms                |
| Forward                   | 5.939 ms                  | 29.109 ms                 |
| Backward                  | 5.750 ms                  | 10.063 ms                 |
| Optimize                  | 2.797 ms                  | 20.202 ms                 |
| BarrierTimeBeforeRank0    | 1.636 ms                  | 104.063 ms                |
| AfterBackward             | 113.250 ms                | 1.750 s                   |
| BlockToStepN              | 1.167 ms                  | 64.674 ms                 |
| OneStep                   | 160.278 ms                | 2.848 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:35.456679 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240205 07:33:35.630138 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240205 07:33:35.643345 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240205 07:33:36.643011 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=332
W20240205 07:33:36.705965 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240205 07:33:36.819960 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240205 07:33:37.643018 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=832
W20240205 07:33:37.838729 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240205 07:33:38.643013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=2292
W20240205 07:33:38.854396 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240205 07:33:38.906008 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=164, sample_step_cpp_seen_[rank]=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 317.003 us                | 2.462 ms                  |
| ProcessBack:Shuffle       | 9.349 ms                  | 20.588 ms                 |
| ProcessBack:UpdateCache   | 10.803 ms                 | 22.326 ms                 |
| ProcessBack:UpsertPq      | 37.754 ms                 | 176.579 ms                |
| ProcessOneStep            | 114.114 ms                | 1.544 s                   |
| BlockToStepN              | 1.091 ms                  | 46.353 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:39.643009 36654 parallel_pq_v2.h:79] insert failed, size(hashtable)=34169
W20240205 07:33:39.819785 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=168, pq.top=168
W20240205 07:33:39.909505 38878 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.910 ms                  | 164.624 ms                |
| Forward                   | 5.947 ms                  | 12.888 ms                 |
| Backward                  | 5.576 ms                  | 9.949 ms                  |
| Optimize                  | 2.853 ms                  | 18.116 ms                 |
| BarrierTimeBeforeRank0    | 1.307 ms                  | 80.118 ms                 |
| AfterBackward             | 112.259 ms                | 1.545 s                   |
| BlockToStepN              | 1.184 ms                  | 46.455 ms                 |
| OneStep                   | 160.278 ms                | 1.788 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:40.643010 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=224
W20240205 07:33:41.024752 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240205 07:33:41.643013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=4562
W20240205 07:33:42.044633 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240205 07:33:42.069012 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=178, pq.top=178
E20240205 07:33:42.643009 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=26341
W20240205 07:33:43.077114 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
W20240205 07:33:43.089246 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=183, pq.top=183
E20240205 07:33:43.643030 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=4633
W20240205 07:33:44.091806 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 425.992 us                | 10.622 ms                 |
| ProcessBack:Shuffle       | 9.309 ms                  | 21.429 ms                 |
| ProcessBack:UpdateCache   | 10.636 ms                 | 20.635 ms                 |
| ProcessBack:UpsertPq      | 36.041 ms                 | 175.908 ms                |
| ProcessOneStep            | 108.431 ms                | 1.544 s                   |
| BlockToStepN              | 1.150 ms                  | 46.353 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:44.142596 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 07:33:44.328266 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=193, sample_step_cpp_seen_[rank]=192
E20240205 07:33:44.643013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=300
W20240205 07:33:45.287463 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.011 ms                  | 197.387 ms                |
| Forward                   | 5.871 ms                  | 12.888 ms                 |
| Backward                  | 5.429 ms                  | 9.949 ms                  |
| Optimize                  | 2.785 ms                  | 18.116 ms                 |
| BarrierTimeBeforeRank0    | 1.357 ms                  | 80.118 ms                 |
| AfterBackward             | 108.034 ms                | 1.545 s                   |
| BlockToStepN              | 1.269 ms                  | 46.455 ms                 |
| OneStep                   | 155.116 ms                | 1.788 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:45.643009 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=23
W20240205 07:33:46.377388 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240205 07:33:46.643014 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=44246
[proc 7] 200 steps, total: 24.333, sample: 1.186, forward: 0.557, backward: 0.644, update: 0.267
[proc 5] 200 steps, total: 24.333, sample: 1.515, forward: 0.626, backward: 0.689, update: 0.267
[proc 1] 200 steps, total: 24.333, sample: 1.494, forward: 0.537, backward: 0.757, update: 0.244
[proc 4] 200 steps, total: 24.334, sample: 1.334, forward: 0.591, backward: 0.656, update: 0.273
[proc 6] 200 steps, total: 24.333, sample: 1.248, forward: 0.569, backward: 0.720, update: 0.252
[proc 2] 200 steps, total: 24.333, sample: 1.280, forward: 0.569, backward: 0.598, update: 0.252
[proc 3] 200 steps, total: 24.333, sample: 2.003, forward: 0.598, backward: 0.701, update: 0.256
[proc 0] 200 steps, total: 24.331, sample: 2.104, forward: 0.622, backward: 0.548, update: 0.322
W20240205 07:33:47.221020 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=203, pq.top=203
E20240205 07:33:47.643013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 07:33:47.667227 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240205 07:33:48.643013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=5744
W20240205 07:33:48.677345 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240205 07:33:49.030074 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=210, pq.top=210
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 338.297 us                | 3.571 ms                  |
| ProcessBack:Shuffle       | 9.315 ms                  | 21.429 ms                 |
| ProcessBack:UpdateCache   | 10.751 ms                 | 20.635 ms                 |
| ProcessBack:UpsertPq      | 34.832 ms                 | 175.908 ms                |
| ProcessOneStep            | 106.664 ms                | 1.544 s                   |
| BlockToStepN              | 1.046 ms                  | 46.353 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:49.643239 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:33:49.719522 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
W20240205 07:33:50.211210 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.020 ms                  | 199.518 ms                |
| Forward                   | 5.783 ms                  | 12.888 ms                 |
| Backward                  | 5.385 ms                  | 9.949 ms                  |
| Optimize                  | 2.729 ms                  | 18.116 ms                 |
| BarrierTimeBeforeRank0    | 1.882 ms                  | 81.131 ms                 |
| AfterBackward             | 106.568 ms                | 1.545 s                   |
| BlockToStepN              | 1.185 ms                  | 51.765 ms                 |
| OneStep                   | 155.116 ms                | 1.788 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:33:50.643015 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=3829
W20240205 07:33:51.019382 38878 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 07:33:51.024339 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=224, sample_step_cpp_seen_[rank]=223
E20240205 07:33:51.643016 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=5272
W20240205 07:33:52.069897 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240205 07:33:52.643007 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=20906
W20240205 07:33:52.662671 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240205 07:33:53.299495 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240205 07:33:53.643123 39122 parallel_pq_v2.h:79] insert failed, size(hashtable)=17491
W20240205 07:33:53.662091 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 361.885 us                | 11.076 ms                 |
| ProcessBack:Shuffle       | 9.229 ms                  | 20.588 ms                 |
| ProcessBack:UpdateCache   | 10.751 ms                 | 18.063 ms                 |
| ProcessBack:UpsertPq      | 35.463 ms                 | 174.287 ms                |
| ProcessOneStep            | 105.765 ms                | 1.544 s                   |
| BlockToStepN              | 1.086 ms                  | 54.698 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:54.300868 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240205 07:33:54.643010 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.270 ms                  | 199.518 ms                |
| Forward                   | 5.722 ms                  | 12.888 ms                 |
| Backward                  | 5.315 ms                  | 9.949 ms                  |
| Optimize                  | 2.658 ms                  | 18.116 ms                 |
| BarrierTimeBeforeRank0    | 2.361 ms                  | 81.131 ms                 |
| AfterBackward             | 105.835 ms                | 1.545 s                   |
| BlockToStepN              | 1.184 ms                  | 54.836 ms                 |
| OneStep                   | 152.867 ms                | 1.788 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:55.359560 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240205 07:33:55.587679 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=239, pq.top=239
E20240205 07:33:55.643007 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1490
W20240205 07:33:56.470957 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
E20240205 07:33:56.643013 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=586
W20240205 07:33:56.686007 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=247, pq.top=247
E20240205 07:33:57.070276 34137 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=250, sample_step_cpp_seen_[rank]=249
E20240205 07:33:57.643013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=762
W20240205 07:33:57.651233 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
W20240205 07:33:58.414983 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=253, pq.top=253
E20240205 07:33:58.643007 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=117252
W20240205 07:33:58.691426 38878 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 354.892 us                | 3.724 ms                  |
| ProcessBack:Shuffle       | 9.298 ms                  | 20.588 ms                 |
| ProcessBack:UpdateCache   | 10.774 ms                 | 18.063 ms                 |
| ProcessBack:UpsertPq      | 35.659 ms                 | 174.287 ms                |
| ProcessOneStep            | 105.765 ms                | 1.544 s                   |
| BlockToStepN              | 1.239 ms                  | 54.698 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:33:59.483930 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=261, pq.top=261
E20240205 07:33:59.662207 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:34:00.143219 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.752 ms                  | 197.387 ms                |
| Forward                   | 5.747 ms                  | 11.690 ms                 |
| Backward                  | 5.296 ms                  | 9.067 ms                  |
| Optimize                  | 2.652 ms                  | 14.050 ms                 |
| BarrierTimeBeforeRank0    | 2.214 ms                  | 80.118 ms                 |
| AfterBackward             | 105.829 ms                | 1.545 s                   |
| BlockToStepN              | 1.396 ms                  | 54.836 ms                 |
| OneStep                   | 149.815 ms                | 1.612 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:34:00.662014 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=4743
W20240205 07:34:01.292974 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
E20240205 07:34:01.662122 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=44
W20240205 07:34:02.311506 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240205 07:34:02.393682 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
E20240205 07:34:02.662010 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=8459
E20240205 07:34:03.254808 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=279, sample_step_cpp_seen_[rank]=278
W20240205 07:34:03.521284 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240205 07:34:03.662012 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=4810
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 335.863 us                | 4.100 ms                  |
| ProcessBack:Shuffle       | 9.343 ms                  | 20.497 ms                 |
| ProcessBack:UpdateCache   | 10.830 ms                 | 17.682 ms                 |
| ProcessBack:UpsertPq      | 35.397 ms                 | 167.766 ms                |
| ProcessOneStep            | 105.758 ms                | 1.544 s                   |
| BlockToStepN              | 1.279 ms                  | 54.698 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:04.288482 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240205 07:34:04.612910 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240205 07:34:04.662011 36654 parallel_pq_v2.h:79] insert failed, size(hashtable)=19205
W20240205 07:34:05.301203 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=290, pq.top=290
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.638 ms                  | 197.387 ms                |
| Forward                   | 5.782 ms                  | 11.690 ms                 |
| Backward                  | 5.302 ms                  | 9.067 ms                  |
| Optimize                  | 2.677 ms                  | 14.050 ms                 |
| BarrierTimeBeforeRank0    | 1.882 ms                  | 80.118 ms                 |
| AfterBackward             | 105.659 ms                | 1.545 s                   |
| BlockToStepN              | 1.396 ms                  | 54.836 ms                 |
| OneStep                   | 148.321 ms                | 1.612 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:34:05.664979 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:34:05.727718 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
W20240205 07:34:06.617092 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=293, pq.top=293
E20240205 07:34:06.664011 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
W20240205 07:34:06.727190 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240205 07:34:07.664011 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=114358
[proc 7] 300 steps, total: 20.864, sample: 0.991, forward: 0.546, backward: 0.706, update: 0.244
[proc 0] 300 steps, total: 20.864, sample: 1.693, forward: 0.563, backward: 0.505, update: 0.284
[proc 5] 300 steps, total: 20.864, sample: 1.110, forward: 0.588, backward: 0.649, update: 0.266
[proc 3] 300 steps, total: 20.864, sample: 1.459, forward: 0.662, backward: 0.642, update: 0.267
[proc 2] 300 steps, total: 20.864, sample: 1.078, forward: 0.573, backward: 0.650, update: 0.251
[proc 6] 300 steps, total: 20.864, sample: 1.141, forward: 0.540, backward: 0.674, update: 0.240
[proc 1] 300 steps, total: 20.864, sample: 1.287, forward: 0.538, backward: 0.685, update: 0.287
[proc 4] 300 steps, total: 20.864, sample: 1.052, forward: 0.568, backward: 0.709, update: 0.258
W20240205 07:34:07.803365 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240205 07:34:07.847674 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=301, pq.top=300
E20240205 07:34:08.664055 36654 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 07:34:08.846742 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240205 07:34:08.866886 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=309, sample_step_cpp_seen_[rank]=308
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 392.079 us                | 10.439 ms                 |
| ProcessBack:Shuffle       | 9.426 ms                  | 20.497 ms                 |
| ProcessBack:UpdateCache   | 10.751 ms                 | 17.682 ms                 |
| ProcessBack:UpsertPq      | 33.922 ms                 | 167.766 ms                |
| ProcessOneStep            | 105.287 ms                | 1.544 s                   |
| BlockToStepN              | 1.349 ms                  | 60.340 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 07:34:09.664011 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=5375
W20240205 07:34:09.864699 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.568 ms                  | 197.387 ms                |
| Forward                   | 5.782 ms                  | 11.690 ms                 |
| Backward                  | 5.278 ms                  | 9.067 ms                  |
| Optimize                  | 2.670 ms                  | 14.050 ms                 |
| BarrierTimeBeforeRank0    | 2.362 ms                  | 88.904 ms                 |
| AfterBackward             | 105.333 ms                | 1.545 s                   |
| BlockToStepN              | 1.453 ms                  | 60.517 ms                 |
| OneStep                   | 145.707 ms                | 1.612 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:34:10.678323 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:34:11.048404 38878 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
W20240205 07:34:11.213181 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240205 07:34:11.678012 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=3018
W20240205 07:34:12.187034 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240205 07:34:12.678010 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=667
W20240205 07:34:13.207624 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
W20240205 07:34:13.547358 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=331, pq.top=331
E20240205 07:34:13.678010 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=855
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 465.606 us                | 7.865 ms                  |
| ProcessBack:Shuffle       | 9.406 ms                  | 20.495 ms                 |
| ProcessBack:UpdateCache   | 10.751 ms                 | 17.679 ms                 |
| ProcessBack:UpsertPq      | 33.601 ms                 | 167.428 ms                |
| ProcessOneStep            | 104.431 ms                | 1.544 s                   |
| BlockToStepN              | 1.349 ms                  | 64.544 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:14.340780 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
W20240205 07:34:14.561203 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240205 07:34:14.678009 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=42403
E20240205 07:34:14.961613 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=341, sample_step_cpp_seen_[rank]=340
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.381 ms                  | 197.387 ms                |
| Forward                   | 5.722 ms                  | 11.690 ms                 |
| Backward                  | 5.260 ms                  | 9.067 ms                  |
| Optimize                  | 2.653 ms                  | 14.050 ms                 |
| BarrierTimeBeforeRank0    | 2.865 ms                  | 88.904 ms                 |
| AfterBackward             | 104.219 ms                | 1.545 s                   |
| BlockToStepN              | 1.489 ms                  | 65.045 ms                 |
| OneStep                   | 144.900 ms                | 1.612 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:15.499182 38878 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
E20240205 07:34:15.678012 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=6158
W20240205 07:34:16.123045 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240205 07:34:16.636478 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
E20240205 07:34:16.678012 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=48785
W20240205 07:34:17.234454 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=353, pq.top=353
E20240205 07:34:17.678014 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240205 07:34:17.779269 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
W20240205 07:34:18.311203 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=355, pq.top=355
E20240205 07:34:18.678009 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 07:34:18.816072 38878 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 524.189 us                | 12.879 ms                 |
| ProcessBack:Shuffle       | 9.321 ms                  | 20.495 ms                 |
| ProcessBack:UpdateCache   | 10.625 ms                 | 17.679 ms                 |
| ProcessBack:UpsertPq      | 32.920 ms                 | 167.428 ms                |
| ProcessOneStep            | 102.138 ms                | 1.500 s                   |
| BlockToStepN              | 1.448 ms                  | 64.544 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:19.406103 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=363, pq.top=363
E20240205 07:34:19.678006 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=202
W20240205 07:34:19.835906 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.916 ms                  | 179.192 ms                |
| Forward                   | 5.672 ms                  | 11.260 ms                 |
| Backward                  | 5.240 ms                  | 9.004 ms                  |
| Optimize                  | 2.658 ms                  | 9.693 ms                  |
| BarrierTimeBeforeRank0    | 2.865 ms                  | 81.131 ms                 |
| AfterBackward             | 102.017 ms                | 1.500 s                   |
| BlockToStepN              | 1.577 ms                  | 65.045 ms                 |
| OneStep                   | 143.258 ms                | 1.548 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:20.443845 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=371, pq.top=371
E20240205 07:34:20.628412 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=372, sample_step_cpp_seen_[rank]=371
E20240205 07:34:20.678009 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=6282
W20240205 07:34:20.989594 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240205 07:34:21.678014 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
W20240205 07:34:21.759850 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=373, pq.top=373
W20240205 07:34:22.017727 38878 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 07:34:22.678010 36654 parallel_pq_v2.h:79] insert failed, size(hashtable)=47044
W20240205 07:34:22.886029 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=381, pq.top=380
W20240205 07:34:23.267665 38878 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 07:34:23.678021 39107 parallel_pq_v2.h:79] insert failed, size(hashtable)=39012
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 504.341 us                | 22.174 ms                 |
| ProcessBack:Shuffle       | 9.262 ms                  | 20.419 ms                 |
| ProcessBack:UpdateCache   | 10.525 ms                 | 17.533 ms                 |
| ProcessBack:UpsertPq      | 32.275 ms                 | 162.948 ms                |
| ProcessOneStep            | 101.982 ms                | 1.500 s                   |
| BlockToStepN              | 1.568 ms                  | 98.604 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:24.400944 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
E20240205 07:34:24.678014 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=6228
W20240205 07:34:24.810081 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=389, pq.top=389
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.503 ms                  | 179.192 ms                |
| Forward                   | 5.644 ms                  | 11.260 ms                 |
| Backward                  | 5.244 ms                  | 9.067 ms                  |
| Optimize                  | 2.658 ms                  | 9.693 ms                  |
| BarrierTimeBeforeRank0    | 2.944 ms                  | 81.131 ms                 |
| AfterBackward             | 102.067 ms                | 1.500 s                   |
| BlockToStepN              | 1.728 ms                  | 98.749 ms                 |
| OneStep                   | 143.774 ms                | 1.548 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:25.530536 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
E20240205 07:34:25.678012 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=13225
W20240205 07:34:25.997675 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=397, pq.top=397
[proc 6] 400 steps, total: 18.624, sample: 1.155, forward: 0.587, backward: 0.672, update: 0.268
[proc 2] 400 steps, total: 18.624, sample: 1.084, forward: 0.583, backward: 0.749, update: 0.262
[proc 5] 400 steps, total: 18.624, sample: 1.007, forward: 0.580, backward: 0.722, update: 0.256
[proc 4] 400 steps, total: 18.624, sample: 1.120, forward: 0.581, backward: 0.646, update: 0.326
[proc 3] 400 steps, total: 18.624, sample: 1.181, forward: 0.595, backward: 0.658, update: 0.266
[proc 1] 400 steps, total: 18.624, sample: 1.129, forward: 0.554, backward: 0.675, update: 0.247
[proc 0] 400 steps, total: 18.624, sample: 1.203, forward: 0.522, backward: 0.522, update: 0.271
[proc 7] 400 steps, total: 18.624, sample: 1.020, forward: 0.557, backward: 0.801, update: 0.263
E20240205 07:34:26.562443 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=402, sample_step_cpp_seen_[rank]=401
W20240205 07:34:26.618973 38878 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 07:34:26.678011 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=102
E20240205 07:34:27.686939 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:34:27.771237 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
W20240205 07:34:28.164654 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=404, pq.top=404
E20240205 07:34:28.686012 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=2993
W20240205 07:34:28.821302 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 471.547 us                | 6.418 ms                  |
| ProcessBack:Shuffle       | 9.229 ms                  | 20.497 ms                 |
| ProcessBack:UpdateCache   | 10.461 ms                 | 17.533 ms                 |
| ProcessBack:UpsertPq      | 32.143 ms                 | 162.948 ms                |
| ProcessOneStep            | 100.951 ms                | 1.500 s                   |
| BlockToStepN              | 1.697 ms                  | 98.604 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:29.171676 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=411, pq.top=411
E20240205 07:34:29.686010 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=77748
W20240205 07:34:29.980926 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
W20240205 07:34:30.209076 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=419, pq.top=419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.348 ms                  | 179.192 ms                |
| Forward                   | 5.640 ms                  | 11.260 ms                 |
| Backward                  | 5.280 ms                  | 9.159 ms                  |
| Optimize                  | 2.687 ms                  | 9.693 ms                  |
| BarrierTimeBeforeRank0    | 2.945 ms                  | 81.131 ms                 |
| AfterBackward             | 99.709 ms                 | 1.500 s                   |
| BlockToStepN              | 1.825 ms                  | 98.878 ms                 |
| OneStep                   | 143.202 ms                | 1.548 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 07:34:30.686021 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=2453
W20240205 07:34:31.073097 38878 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
W20240205 07:34:31.466460 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=420, pq.top=419
E20240205 07:34:31.686012 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=2389
W20240205 07:34:32.093241 38878 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
W20240205 07:34:32.551152 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=427, pq.top=426
E20240205 07:34:32.686352 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=230
W20240205 07:34:33.360523 38878 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 07:34:33.415735 36654 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=433, sample_step_cpp_seen_[rank]=432
E20240205 07:34:33.686014 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=5826
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 526.470 us                | 13.603 ms                 |
| ProcessBack:Shuffle       | 9.203 ms                  | 20.497 ms                 |
| ProcessBack:UpdateCache   | 10.367 ms                 | 17.320 ms                 |
| ProcessBack:UpsertPq      | 31.882 ms                 | 162.053 ms                |
| ProcessOneStep            | 99.659 ms                 | 1.500 s                   |
| BlockToStepN              | 1.754 ms                  | 113.643 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:34.519866 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240205 07:34:34.691915 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=6493
W20240205 07:34:35.297879 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=434, pq.top=433
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.295 ms                  | 179.192 ms                |
| Forward                   | 5.630 ms                  | 11.260 ms                 |
| Backward                  | 5.297 ms                  | 9.159 ms                  |
| Optimize                  | 2.677 ms                  | 14.050 ms                 |
| BarrierTimeBeforeRank0    | 2.945 ms                  | 81.131 ms                 |
| AfterBackward             | 99.709 ms                 | 1.545 s                   |
| BlockToStepN              | 1.866 ms                  | 113.816 ms                |
| OneStep                   | 143.258 ms                | 1.548 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:35.539562 38878 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 07:34:35.692523 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=74004
W20240205 07:34:36.446339 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240205 07:34:36.575815 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240205 07:34:36.692029 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=79
E20240205 07:34:37.696252 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:34:37.923357 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240205 07:34:38.415010 34137 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=446, sample_step_cpp_seen_[rank]=445
E20240205 07:34:38.696012 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=1848
W20240205 07:34:38.951426 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 452.425 us                | 7.576 ms                  |
| ProcessBack:Shuffle       | 9.177 ms                  | 20.497 ms                 |
| ProcessBack:UpdateCache   | 10.328 ms                 | 17.320 ms                 |
| ProcessBack:UpsertPq      | 31.464 ms                 | 162.053 ms                |
| ProcessOneStep            | 99.659 ms                 | 1.561 s                   |
| BlockToStepN              | 1.766 ms                  | 113.643 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:39.489118 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=453, pq.top=453
E20240205 07:34:39.696009 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=2396
W20240205 07:34:39.972525 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.117 ms                  | 164.624 ms                |
| Forward                   | 5.630 ms                  | 10.583 ms                 |
| Backward                  | 5.278 ms                  | 9.067 ms                  |
| Optimize                  | 2.670 ms                  | 9.693 ms                  |
| BarrierTimeBeforeRank0    | 3.549 ms                  | 81.131 ms                 |
| AfterBackward             | 99.709 ms                 | 1.545 s                   |
| BlockToStepN              | 1.919 ms                  | 100.254 ms                |
| OneStep                   | 143.202 ms                | 1.612 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:40.658465 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=461, pq.top=461
E20240205 07:34:40.696041 39132 parallel_pq_v2.h:79] insert failed, size(hashtable)=37540
W20240205 07:34:40.984696 38878 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 07:34:41.713529 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240205 07:34:42.035255 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240205 07:34:42.713536 39114 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:34:43.023417 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240205 07:34:43.047868 38878 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240205 07:34:43.713013 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=38255
W20240205 07:34:44.093549 38878 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 558.787 us                | 17.988 ms                 |
| ProcessBack:Shuffle       | 9.201 ms                  | 20.588 ms                 |
| ProcessBack:UpdateCache   | 10.321 ms                 | 17.533 ms                 |
| ProcessBack:UpsertPq      | 31.032 ms                 | 162.053 ms                |
| ProcessOneStep            | 100.951 ms                | 1.544 s                   |
| BlockToStepN              | 1.907 ms                  | 100.015 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:44.139309 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=474, pq.top=474
E20240205 07:34:44.713009 34137 parallel_pq_v2.h:79] insert failed, size(hashtable)=7851
E20240205 07:34:44.927840 34137 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=480, sample_step_cpp_seen_[rank]=479
W20240205 07:34:45.148480 38878 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.974 ms                  | 164.624 ms                |
| Forward                   | 5.627 ms                  | 11.260 ms                 |
| Backward                  | 5.262 ms                  | 9.067 ms                  |
| Optimize                  | 2.691 ms                  | 9.693 ms                  |
| BarrierTimeBeforeRank0    | 3.672 ms                  | 81.131 ms                 |
| AfterBackward             | 101.004 ms                | 1.545 s                   |
| BlockToStepN              | 2.032 ms                  | 100.254 ms                |
| OneStep                   | 143.258 ms                | 1.612 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:45.308759 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=481, pq.top=481
E20240205 07:34:45.723567 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 07:34:46.174927 38878 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
E20240205 07:34:46.723011 36654 parallel_pq_v2.h:79] insert failed, size(hashtable)=3554
W20240205 07:34:46.901794 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240205 07:34:47.215492 38878 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240205 07:34:47.723011 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
W20240205 07:34:48.129017 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=491, pq.top=491
W20240205 07:34:48.241182 38878 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240205 07:34:48.723014 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=767
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 613.210 us                | 13.063 ms                 |
| ProcessBack:Shuffle       | 9.278 ms                  | 20.497 ms                 |
| ProcessBack:UpdateCache   | 10.348 ms                 | 17.320 ms                 |
| ProcessBack:UpsertPq      | 31.018 ms                 | 159.676 ms                |
| ProcessOneStep            | 100.951 ms                | 1.544 s                   |
| BlockToStepN              | 2.023 ms                  | 100.015 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:49.423956 38878 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240205 07:34:49.723827 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240205 07:34:49.927008 34137 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=496, sample_step_cpp_seen_[rank]=495
W20240205 07:34:50.168831 34137 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=497, pq.top=496
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.898 ms                  | 164.624 ms                |
| Forward                   | 5.612 ms                  | 11.260 ms                 |
| Backward                  | 5.267 ms                  | 9.067 ms                  |
| Optimize                  | 2.687 ms                  | 9.693 ms                  |
| BarrierTimeBeforeRank0    | 3.722 ms                  | 81.131 ms                 |
| AfterBackward             | 101.128 ms                | 1.545 s                   |
| BlockToStepN              | 2.132 ms                  | 100.254 ms                |
| OneStep                   | 143.774 ms                | 1.612 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 07:34:50.427187 38878 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
[proc 5] 500 steps, total: 24.341, sample: 1.092, forward: 0.669, backward: 0.690, update: 0.274
[proc 3] 500 steps, total: 24.341, sample: 1.179, forward: 0.578, backward: 0.640, update: 0.265
[proc 2] 500 steps, total: 24.341, sample: 1.014, forward: 0.555, backward: 0.729, update: 0.257
[proc 4] 500 steps, total: 24.341, sample: 0.991, forward: 0.538, backward: 0.780, update: 0.248
[proc 7] 500 steps, total: 24.341, sample: 0.976, forward: 0.549, backward: 0.701, update: 0.263
[proc 1] 500 steps, total: 24.341, sample: 1.293, forward: 0.575, backward: 0.673, update: 0.256
[proc 0] 500 steps, total: 24.341, sample: 1.099, forward: 0.562, backward: 0.529, update: 0.301
[proc 6] 500 steps, total: 24.341, sample: 1.154, forward: 0.593, backward: 0.757, update: 0.255
Successfully xmh. training takes 117.55439734458923 seconds
before call kg_cache_controller.StopThreads()
W20240205 07:34:50.648190 34137 grad_async_v2.h:84] call StopThreads. PID = 2111
W20240205 07:34:50.648224 34137 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 07:34:50.648574 34137 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 07:34:50.648584 34137 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
E20240205 07:34:50.723012 38878 parallel_pq_v2.h:79] insert failed, size(hashtable)=1316
W20240205 07:34:50.919714 34137 grad_async_v2.h:105] StopThreads done.
