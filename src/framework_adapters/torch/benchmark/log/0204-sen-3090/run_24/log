WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 10:54:05.604960 48334 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_130', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=8, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [48334 sampler.py:454] Start PreSampling
WARNING [48334 sampler.py:532] Before construct renumbering_dict
WARNING [48334 sampler.py:555] PreSampling done
W20240204 10:54:11.043686 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 10:54:11.043903 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 10:54:11.043954 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 10:54:11.043998 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 10:54:11.044059 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 10:54:11.044116 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 10:54:11.044158 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 10:54:11.044206 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 10:54:11.044255 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 10:54:11.044302 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 10:54:11.044358 48334 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 10:54:11.044395 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 10:54:11.044431 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 10:54:11.044571 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 10:54:11.044625 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 10:54:11.044667 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 10:54:11.044726 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 10:54:11.044765 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 10:54:11.044812 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 10:54:11.044858 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 10:54:11.044911 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 10:54:11.044958 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 10:54:11.045008 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 10:54:11.045047 48334 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 10:54:11.045084 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 10:54:11.045123 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 10:54:11.045202 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 10:54:11.045251 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 10:54:11.045289 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 10:54:11.045331 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 10:54:11.045385 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 10:54:11.045426 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 10:54:11.045466 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 10:54:11.045518 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 10:54:11.045567 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 10:54:11.045614 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 10:54:11.045661 48334 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 10:54:11.045697 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 10:54:11.045737 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 10:54:11.045825 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 10:54:11.045871 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 10:54:11.045913 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 10:54:11.045955 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 10:54:11.045995 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 10:54:11.046046 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 10:54:11.046094 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 10:54:11.046146 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 10:54:11.046188 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 10:54:11.046233 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 10:54:11.046275 48334 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 10:54:11.046311 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 10:54:11.046344 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 10:54:11.046427 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 10:54:11.046468 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 10:54:11.046509 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 10:54:11.046558 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 10:54:11.046598 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 10:54:11.046648 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 10:54:11.046689 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 10:54:11.046730 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 10:54:11.046778 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 10:54:11.046823 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 10:54:11.046861 48334 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 10:54:11.046896 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 10:54:11.046932 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 10:54:11.047011 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 10:54:11.047060 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 10:54:11.047106 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 10:54:11.047153 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 10:54:11.047197 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 10:54:11.047253 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 10:54:11.047294 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 10:54:11.047348 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 10:54:11.047397 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 10:54:11.047446 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 10:54:11.047493 48334 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 10:54:11.047528 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 10:54:11.047567 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 10:54:11.047641 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 10:54:11.047693 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 10:54:11.047734 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 10:54:11.047775 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 10:54:11.047816 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 10:54:11.047861 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 10:54:11.047909 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 10:54:11.047955 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 10:54:11.047996 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 10:54:11.048038 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 10:54:11.048090 48334 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 10:54:11.048125 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 10:54:11.048158 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 10:54:11.048239 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 10:54:11.048292 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 10:54:11.048354 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 10:54:11.048398 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 10:54:11.048439 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 10:54:11.048480 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 10:54:11.048529 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 10:54:11.048571 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 10:54:11.048621 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 10:54:11.048667 48334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 10:54:11.048712 48334 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 10:54:11.048748 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 10:54:11.048789 48334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 10:54:11.296906 48334 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240204 10:54:11.385847 48334 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 756, 1204, 1743,  ..., 6351, 6517, 5437]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.879 seconds
[Rank1] pid = 48762
[Rank2] pid = 48782
[Rank3] pid = 48890
[Rank4] pid = 48912
[Rank5] pid = 49000
[Rank6] pid = 49082
INFO [48334 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [48762 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [48782 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [48912 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [48890 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [49000 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [49082 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [49085 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [49082 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49000 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49085 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [48912 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [48890 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [48782 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [48334 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [48762 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:54:14.104954 49086 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 10:54:14.105111 49216 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240204 10:54:14.105235 48891 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 10:54:14.105358 49019 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240204 10:54:14.105430 49083 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 10:54:14.105444 48955 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240204 10:54:14.105619 48827 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240204 10:54:14.106488 48763 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 10:54:14.143937 49083 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100027a14000 7.629 MB
W20240204 10:54:14.143993 49216 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1000281b7000 7.629 MB
W20240204 10:54:14.144004 48827 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10002895a000 7.629 MB
W20240204 10:54:14.144155 48891 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000290fd000 7.629 MB
W20240204 10:54:14.144207 49019 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1000298a0000 7.629 MB
W20240204 10:54:14.144228 49086 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10002a043000 7.629 MB
W20240204 10:54:14.144271 48763 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10002a7e6000 7.629 MB
W20240204 10:54:14.144287 48955 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10002af89000 7.629 MB
W20240204 10:54:14.144506 49086 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10002b72c000 7.629 MB
W20240204 10:54:14.144608 49086 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10002becf000 1.49 GB
W20240204 10:54:14.144716 49086 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10008b4b2000 1.49 GB
W20240204 10:54:14.144744 48955 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1000eaa95000 7.629 MB
W20240204 10:54:14.144764 49019 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1000eb238000 7.629 MB
W20240204 10:54:14.144771 48891 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000eb9db000 7.629 MB
W20240204 10:54:14.144786 48763 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000ec17e000 7.629 MB
W20240204 10:54:14.144794 49083 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000ec921000 7.629 MB
W20240204 10:54:14.144804 49086 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:54:14.144891 48763 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1000ed0c4000 1.49 GB
W20240204 10:54:14.144908 48955 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10014c6a7000 1.49 GB
W20240204 10:54:14.144959 48763 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1001abc8a000 1.49 GB
W20240204 10:54:14.144979 48955 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10020b26d000 1.49 GB
W20240204 10:54:14.145011 49216 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10026a850000 7.629 MB
W20240204 10:54:14.145054 48827 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10026aff3000 7.629 MB
W20240204 10:54:14.147207 48955 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:54:14.147210 48763 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:54:14.147224 48827 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10026b796000 1.49 GB
W20240204 10:54:14.147238 49216 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1002cad79000 1.49 GB
W20240204 10:54:14.147276 49083 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10032a35c000 1.49 GB
W20240204 10:54:14.147292 48891 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10038993f000 1.49 GB
W20240204 10:54:14.147301 48827 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1003e8f22000 1.49 GB
W20240204 10:54:14.147310 49019 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x100448505000 1.49 GB
W20240204 10:54:14.147329 49216 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1004a7ae8000 1.49 GB
W20240204 10:54:14.147367 48891 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1005070cb000 1.49 GB
W20240204 10:54:14.147374 49083 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1005666ae000 1.49 GB
W20240204 10:54:14.147403 49216 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:54:14.147405 49019 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1005c5c91000 1.49 GB
W20240204 10:54:14.147428 48827 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:54:14.147449 49083 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:54:14.147468 49019 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:54:14.149076 48891 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:54:14.156296 49086 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:54:14.160430 49216 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:54:14.160529 48891 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:54:14.171645 48827 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:54:14.180410 49083 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:54:14.190152 49019 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:54:14.197434 48955 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:54:14.204704 48763 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [48782 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [48762 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [48890 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [49085 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [48912 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [49082 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [49000 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 49085
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [48334 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 10:54:16.444674 49086 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 10:54:16.445137 49083 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:54:16.446524 49019 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:54:16.446681 48763 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:54:16.446856 48891 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:54:16.447021 48827 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:54:16.447134 49216 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:54:16.447264 48955 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 10:54:16.450145 49086 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 8,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 10:54:16.450287 49086 grad_base.h:184] Init GradProcessingBase done
I20240204 10:54:16.452975 49086 grad_async_v1.h:203] Use main thread to update emb.
W20240204 10:54:16.453032 49086 kg_controller.h:75] after init GradAsyncProcessing
I20240204 10:54:16.453042 49086 kg_controller.h:84] Construct KGCacheController done
E20240204 10:54:17.211354 49083 recstore.cc:66] init folly done
E20240204 10:54:17.211544 48891 recstore.cc:66] init folly done
E20240204 10:54:17.211582 48763 recstore.cc:66] init folly done
E20240204 10:54:17.211582 48827 recstore.cc:66] init folly done
E20240204 10:54:17.211583 48955 recstore.cc:66] init folly done
E20240204 10:54:17.211607 49086 recstore.cc:66] init folly done
E20240204 10:54:17.211730 49019 recstore.cc:66] init folly done
E20240204 10:54:17.211886 49216 recstore.cc:66] init folly done
I20240204 10:54:17.213277 49086 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 10:54:18.025435 49083 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 10:54:18.028211 49086 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:54:18.037511 48763 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:54:18.038288 48827 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:54:18.040536 48891 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:54:18.043867 49019 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:54:18.046504 48955 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:54:18.047566 49216 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 10:54:20.400513 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240204 10:54:21.285166 49861 grad_async_v1.h:533] Stalled in ProcessBackward: rank=3, step_no=14, sample_step_cpp_seen_[rank]=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.133 ms                  | 17.773 ms                 |
| Forward                   | 4.605 ms                  | 663.361 ms                |
| Backward                  | 4.239 ms                  | 203.559 ms                |
| Optimize                  | 2.324 ms                  | 8.316 ms                  |
| BarrierTimeBeforeRank0    | 3.100 ms                  | 9.612 ms                  |
| AfterBackward             | 26.411 ms                 | 1.478 s                   |
| BlockToStepN              | 59.675 us                 | 114.991 ms                |
| OneStep                   | 49.664 ms                 | 2.398 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:21.763934 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.508 ms                  | 372.359 ms                |
| ProcessBack:UpdateCache   | 10.358 ms                 | 766.535 ms                |
| ProcessBack:UpsertPq      | 8.123 ms                  | 22.016 ms                 |
| ProcessOneStep            | 26.903 ms                 | 1.477 s                   |
| BlockToStepN              | 236.766 us                | 248.304 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:22.763012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=20, pq.top=20
W20240204 10:54:23.763060 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240204 10:54:24.763006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=34, pq.top=34
W20240204 10:54:25.807245 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.200 ms                  | 22.087 ms                 |
| Forward                   | 4.611 ms                  | 663.361 ms                |
| Backward                  | 7.807 ms                  | 203.559 ms                |
| Optimize                  | 1.880 ms                  | 8.316 ms                  |
| BarrierTimeBeforeRank0    | 754.893 us                | 13.665 ms                 |
| AfterBackward             | 27.406 ms                 | 1.478 s                   |
| BlockToStepN              | 94.593 ms                 | 248.610 ms                |
| OneStep                   | 141.838 ms                | 2.398 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:26.827993 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 330.390 ms                |
| ProcessBack:UpdateCache   | 9.717 ms                  | 765.955 ms                |
| ProcessBack:UpsertPq      | 9.074 ms                  | 20.681 ms                 |
| ProcessOneStep            | 27.426 ms                 | 1.477 s                   |
| BlockToStepN              | 95.012 ms                 | 248.304 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:27.868199 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240204 10:54:28.868011 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=58, pq.top=58
W20240204 10:54:29.895310 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=64, pq.top=64
W20240204 10:54:30.895006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.247 ms                  | 19.940 ms                 |
| Forward                   | 4.647 ms                  | 19.035 ms                 |
| Backward                  | 8.731 ms                  | 17.061 ms                 |
| Optimize                  | 1.861 ms                  | 5.696 ms                  |
| BarrierTimeBeforeRank0    | 393.174 us                | 13.665 ms                 |
| AfterBackward             | 27.860 ms                 | 494.515 ms                |
| BlockToStepN              | 109.788 ms                | 161.596 ms                |
| OneStep                   | 164.378 ms                | 607.651 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:31.895007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=74, pq.top=74
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.775 ms                  | 330.390 ms                |
| ProcessBack:UpdateCache   | 9.420 ms                  | 765.955 ms                |
| ProcessBack:UpsertPq      | 9.320 ms                  | 20.681 ms                 |
| ProcessOneStep            | 27.920 ms                 | 494.437 ms                |
| BlockToStepN              | 110.657 ms                | 170.297 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:32.895009 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240204 10:54:33.895012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=84, pq.top=84
W20240204 10:54:34.895011 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=88, pq.top=88
W20240204 10:54:35.895006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.282 ms                  | 19.940 ms                 |
| Forward                   | 4.655 ms                  | 19.035 ms                 |
| Backward                  | 8.753 ms                  | 17.061 ms                 |
| Optimize                  | 1.863 ms                  | 5.696 ms                  |
| BarrierTimeBeforeRank0    | 156.745 us                | 13.665 ms                 |
| AfterBackward             | 27.974 ms                 | 494.515 ms                |
| BlockToStepN              | 125.642 ms                | 184.656 ms                |
| OneStep                   | 175.041 ms                | 607.651 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:36.895012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.859 ms                  | 13.674 ms                 |
| ProcessBack:UpdateCache   | 9.419 ms                  | 16.441 ms                 |
| ProcessBack:UpsertPq      | 9.450 ms                  | 20.455 ms                 |
| ProcessOneStep            | 27.931 ms                 | 494.437 ms                |
| BlockToStepN              | 126.497 ms                | 185.205 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 19.540, sample: 0.356, forward: 1.071, backward: 0.716, update: 0.175
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 19.518, sample: 0.316, forward: 1.045, backward: 1.076, update: 0.179
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 19.527, sample: 0.327, forward: 1.072, backward: 1.103, update: 0.193
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 19.525, sample: 0.333, forward: 1.063, backward: 1.062, update: 0.177
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 19.528, sample: 0.326, forward: 1.059, backward: 0.887, update: 0.179
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 19.522, sample: 0.330, forward: 1.023, backward: 0.752, update: 0.174
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 19.519, sample: 0.336, forward: 1.078, backward: 1.029, update: 0.183
train_sampler.Prefill()
-------Step 0-------
tensor([ 1558,    47,  4358,  3532,  9019,  9538,  1084,   442, 14142, 13652]) tensor([ 1743, 11463,  4112, 12341, 13370,  1129,   577,  6733,   499, 13590])
-------Step 1-------
tensor([ 1558,    47,  4358,  3532,  9019,  9538,  1084,   442, 14142, 13652]) tensor([ 3961, 11438, 13172,  1936,   948,  7675, 14467, 11205,  6613, 14139])
-------Step 2-------
tensor([ 9699, 13181,  7121,  5137, 11981, 11101,  7305,    89,  8005,   957]) tensor([ 3912,  3622,  5143, 11274,  6551, 11213,  9764, 11879, 14050,  6949])
-------Step 3-------
tensor([ 9699, 13181,  7121,  5137, 11981, 11101,  7305,    89,  8005,   957]) tensor([10732,  7545,  5633,  8170,  7069,   713,  7116,  2097,  9050,  1688])
-------Step 4-------
tensor([   47, 12147, 12187,  7277,  6210,  3339,    78,  4985,  5475,  1056]) tensor([ 591, 1040, 5465, 3502, 4212, 3483,  442, 6741, 6412, 1479])
-------Step 5-------
tensor([   47, 12147, 12187,  7277,  6210,  3339,    78,  4985,  5475,  1056]) tensor([12646,  5530,  5982,  1922,  3198,   821,   790,  1176,  5988,  4669])
-------Step 6-------
tensor([ 1378,  5847,    43,    67,  8854,  2245, 10977,  8146, 14694, 13665]) tensor([13181,  3891,  7539,  5164,  6821, 11935,  4665,  9919, 12372,  8471])
-------Step 7-------
tensor([ 1378,  5847,    43,    67,  8854,  2245, 10977,  8146, 14694, 13665]) tensor([ 9374, 13641,  6149,  7426,  1588,  6524,  7272,  3943,   132, 13396])
-------Step 8-------
tensor([ 4711,  8399,  5752,  9104,    32,    92, 11024, 13259,    64,  1630]) tensor([ 6828,  4043,  5220, 10365,  2757, 10316, 12094,  1730, 10379,  2484])
-------Step 9-------
tensor([ 4711,  8399,  5752,  9104,    32,    92, 11024, 13259,    64,  1630]) tensor([ 9119,  5261,  9369,  8078, 10948, 12536, 14181, 11205,   662, 12332])
before start barrier
start train
[proc 0] 100 steps, total: 19.538, sample: 0.388, forward: 1.160, backward: 0.963, update: 0.213
W20240204 10:54:37.895012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=102, pq.top=102
W20240204 10:54:38.895015 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=106, pq.top=106
W20240204 10:54:39.925666 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240204 10:54:40.925006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.307 ms                  | 20.838 ms                 |
| Forward                   | 4.655 ms                  | 19.035 ms                 |
| Backward                  | 8.721 ms                  | 17.061 ms                 |
| Optimize                  | 1.882 ms                  | 5.696 ms                  |
| BarrierTimeBeforeRank0    | 853.792 us                | 15.022 ms                 |
| AfterBackward             | 27.946 ms                 | 494.515 ms                |
| BlockToStepN              | 134.111 ms                | 211.445 ms                |
| OneStep                   | 188.310 ms                | 607.651 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:41.925016 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.804 ms                  | 13.674 ms                 |
| ProcessBack:UpdateCache   | 9.493 ms                  | 16.441 ms                 |
| ProcessBack:UpsertPq      | 9.547 ms                  | 20.455 ms                 |
| ProcessOneStep            | 27.931 ms                 | 494.437 ms                |
| BlockToStepN              | 138.554 ms                | 211.404 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:42.925014 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240204 10:54:43.925021 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=128, pq.top=128
W20240204 10:54:44.969929 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=132, pq.top=132
W20240204 10:54:46.007222 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=136, pq.top=136
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.330 ms                  | 22.725 ms                 |
| Forward                   | 4.647 ms                  | 19.035 ms                 |
| Backward                  | 8.499 ms                  | 17.061 ms                 |
| Optimize                  | 1.863 ms                  | 5.696 ms                  |
| BarrierTimeBeforeRank0    | 1.699 ms                  | 15.022 ms                 |
| AfterBackward             | 28.234 ms                 | 494.515 ms                |
| BlockToStepN              | 144.372 ms                | 242.357 ms                |
| OneStep                   | 194.732 ms                | 607.651 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:47.007021 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.756 ms                  | 10.859 ms                 |
| ProcessBack:UpdateCache   | 9.810 ms                  | 16.381 ms                 |
| ProcessBack:UpsertPq      | 9.628 ms                  | 20.364 ms                 |
| ProcessOneStep            | 28.205 ms                 | 494.437 ms                |
| BlockToStepN              | 149.367 ms                | 248.304 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:48.007009 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240204 10:54:49.007009 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240204 10:54:50.007009 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240204 10:54:51.007017 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.341 ms                  | 22.579 ms                 |
| Forward                   | 4.639 ms                  | 15.558 ms                 |
| Backward                  | 5.338 ms                  | 11.748 ms                 |
| Optimize                  | 1.851 ms                  | 5.021 ms                  |
| BarrierTimeBeforeRank0    | 2.597 ms                  | 19.659 ms                 |
| AfterBackward             | 28.279 ms                 | 38.089 ms                 |
| BlockToStepN              | 154.691 ms                | 242.357 ms                |
| OneStep                   | 208.306 ms                | 311.774 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:52.007007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.692 ms                  | 10.859 ms                 |
| ProcessBack:UpdateCache   | 9.888 ms                  | 16.381 ms                 |
| ProcessBack:UpsertPq      | 9.742 ms                  | 20.364 ms                 |
| ProcessOneStep            | 28.250 ms                 | 37.925 ms                 |
| BlockToStepN              | 157.169 ms                | 244.684 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:53.007007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=162, pq.top=162
W20240204 10:54:54.007007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240204 10:54:55.007017 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240204 10:54:56.007017 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.348 ms                  | 22.579 ms                 |
| Forward                   | 4.655 ms                  | 15.558 ms                 |
| Backward                  | 4.568 ms                  | 11.748 ms                 |
| Optimize                  | 1.843 ms                  | 5.021 ms                  |
| BarrierTimeBeforeRank0    | 3.573 ms                  | 22.936 ms                 |
| AfterBackward             | 28.392 ms                 | 41.471 ms                 |
| BlockToStepN              | 163.173 ms                | 244.855 ms                |
| OneStep                   | 216.661 ms                | 311.774 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:57.070086 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 10.293 ms                 |
| ProcessBack:UpdateCache   | 9.926 ms                  | 12.998 ms                 |
| ProcessBack:UpsertPq      | 9.768 ms                  | 18.816 ms                 |
| ProcessOneStep            | 28.365 ms                 | 41.428 ms                 |
| BlockToStepN              | 164.025 ms                | 244.684 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:54:58.070008 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240204 10:54:59.070008 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240204 10:55:00.123433 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240204 10:55:01.123018 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.350 ms                  | 22.579 ms                 |
| Forward                   | 4.661 ms                  | 15.558 ms                 |
| Backward                  | 4.440 ms                  | 11.748 ms                 |
| Optimize                  | 1.839 ms                  | 5.021 ms                  |
| BarrierTimeBeforeRank0    | 4.067 ms                  | 22.995 ms                 |
| AfterBackward             | 28.330 ms                 | 41.471 ms                 |
| BlockToStepN              | 170.413 ms                | 248.610 ms                |
| OneStep                   | 220.560 ms                | 329.295 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:02.123009 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.667 ms                  | 10.293 ms                 |
| ProcessBack:UpdateCache   | 9.964 ms                  | 12.998 ms                 |
| ProcessBack:UpsertPq      | 9.807 ms                  | 18.816 ms                 |
| ProcessOneStep            | 28.365 ms                 | 41.428 ms                 |
| BlockToStepN              | 170.733 ms                | 248.304 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:03.168471 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 2] 200 steps, total: 26.111, sample: 0.351, forward: 0.413, backward: 0.875, update: 0.185
[proc 6] 200 steps, total: 26.111, sample: 0.359, forward: 0.439, backward: 0.890, update: 0.175
[proc 0] 200 steps, total: 26.110, sample: 0.438, forward: 0.456, backward: 0.437, update: 0.182
[proc 4] 200 steps, total: 26.111, sample: 0.360, forward: 0.436, backward: 0.850, update: 0.177
[proc 7] 200 steps, total: 26.111, sample: 0.350, forward: 0.435, backward: 0.577, update: 0.167
[proc 3] 200 steps, total: 26.111, sample: 0.383, forward: 0.440, backward: 0.837, update: 0.171
[proc 1] 200 steps, total: 26.111, sample: 0.350, forward: 0.446, backward: 0.856, update: 0.179
[proc 5] 200 steps, total: 26.111, sample: 0.350, forward: 0.429, backward: 0.674, update: 0.171
W20240204 10:55:04.168008 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=202, pq.top=202
W20240204 10:55:05.168015 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240204 10:55:06.168015 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.350 ms                  | 22.579 ms                 |
| Forward                   | 4.679 ms                  | 15.558 ms                 |
| Backward                  | 4.403 ms                  | 11.748 ms                 |
| Optimize                  | 1.832 ms                  | 5.021 ms                  |
| BarrierTimeBeforeRank0    | 4.222 ms                  | 22.995 ms                 |
| AfterBackward             | 28.392 ms                 | 41.471 ms                 |
| BlockToStepN              | 175.833 ms                | 256.911 ms                |
| OneStep                   | 225.843 ms                | 341.947 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:07.168007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.667 ms                  | 10.293 ms                 |
| ProcessBack:UpdateCache   | 9.981 ms                  | 12.998 ms                 |
| ProcessBack:UpsertPq      | 9.854 ms                  | 18.816 ms                 |
| ProcessOneStep            | 28.366 ms                 | 41.428 ms                 |
| BlockToStepN              | 175.880 ms                | 256.807 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:08.168009 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=216, pq.top=216
W20240204 10:55:09.168006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
W20240204 10:55:10.168017 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240204 10:55:11.168013 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=226, pq.top=226
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.351 ms                  | 22.579 ms                 |
| Forward                   | 4.679 ms                  | 15.558 ms                 |
| Backward                  | 4.542 ms                  | 15.947 ms                 |
| Optimize                  | 1.843 ms                  | 5.021 ms                  |
| BarrierTimeBeforeRank0    | 4.331 ms                  | 22.995 ms                 |
| AfterBackward             | 28.392 ms                 | 41.471 ms                 |
| BlockToStepN              | 180.068 ms                | 264.687 ms                |
| OneStep                   | 235.361 ms                | 356.385 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:12.168007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=230, pq.top=230
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.672 ms                  | 10.293 ms                 |
| ProcessBack:UpdateCache   | 9.979 ms                  | 12.939 ms                 |
| ProcessBack:UpsertPq      | 9.848 ms                  | 18.721 ms                 |
| ProcessOneStep            | 28.365 ms                 | 41.428 ms                 |
| BlockToStepN              | 181.844 ms                | 264.608 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:13.168007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240204 10:55:14.221920 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240204 10:55:15.221015 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
W20240204 10:55:16.266999 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=244, pq.top=244
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.354 ms                  | 22.579 ms                 |
| Forward                   | 4.681 ms                  | 15.558 ms                 |
| Backward                  | 4.702 ms                  | 15.947 ms                 |
| Optimize                  | 1.839 ms                  | 5.021 ms                  |
| BarrierTimeBeforeRank0    | 4.331 ms                  | 22.995 ms                 |
| AfterBackward             | 28.392 ms                 | 41.471 ms                 |
| BlockToStepN              | 187.154 ms                | 268.829 ms                |
| OneStep                   | 242.051 ms                | 356.385 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.678 ms                  | 10.293 ms                 |
| ProcessBack:UpdateCache   | 9.974 ms                  | 12.939 ms                 |
| ProcessBack:UpsertPq      | 9.813 ms                  | 18.721 ms                 |
| ProcessOneStep            | 28.319 ms                 | 41.428 ms                 |
| BlockToStepN              | 188.239 ms                | 278.225 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:17.266007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240204 10:55:18.266006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
W20240204 10:55:19.300179 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=254, pq.top=254
W20240204 10:55:20.300009 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240204 10:55:21.300024 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.378 ms                  | 22.197 ms                 |
| Forward                   | 4.680 ms                  | 12.597 ms                 |
| Backward                  | 6.144 ms                  | 14.337 ms                 |
| Optimize                  | 1.843 ms                  | 4.969 ms                  |
| BarrierTimeBeforeRank0    | 4.331 ms                  | 22.995 ms                 |
| AfterBackward             | 28.403 ms                 | 38.089 ms                 |
| BlockToStepN              | 193.144 ms                | 277.168 ms                |
| OneStep                   | 247.105 ms                | 347.438 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.678 ms                  | 10.293 ms                 |
| ProcessBack:UpdateCache   | 9.968 ms                  | 12.939 ms                 |
| ProcessBack:UpsertPq      | 9.833 ms                  | 18.721 ms                 |
| ProcessOneStep            | 28.373 ms                 | 37.925 ms                 |
| BlockToStepN              | 193.310 ms                | 278.225 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:22.300005 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240204 10:55:23.336846 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240204 10:55:24.336007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
W20240204 10:55:25.371830 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240204 10:55:26.371011 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.386 ms                  | 22.197 ms                 |
| Forward                   | 4.679 ms                  | 15.558 ms                 |
| Backward                  | 7.271 ms                  | 14.337 ms                 |
| Optimize                  | 1.847 ms                  | 4.969 ms                  |
| BarrierTimeBeforeRank0    | 4.330 ms                  | 22.995 ms                 |
| AfterBackward             | 28.392 ms                 | 38.089 ms                 |
| BlockToStepN              | 195.500 ms                | 281.476 ms                |
| OneStep                   | 251.709 ms                | 356.385 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.683 ms                  | 10.293 ms                 |
| ProcessBack:UpdateCache   | 9.965 ms                  | 11.927 ms                 |
| ProcessBack:UpsertPq      | 9.810 ms                  | 17.662 ms                 |
| ProcessOneStep            | 28.365 ms                 | 37.925 ms                 |
| BlockToStepN              | 196.981 ms                | 281.413 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:27.371006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=280, pq.top=280
W20240204 10:55:28.416182 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240204 10:55:29.416007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240204 10:55:30.447289 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=290, pq.top=290
W20240204 10:55:31.447012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.392 ms                  | 22.725 ms                 |
| Forward                   | 4.679 ms                  | 15.558 ms                 |
| Backward                  | 8.525 ms                  | 14.337 ms                 |
| Optimize                  | 1.850 ms                  | 4.969 ms                  |
| BarrierTimeBeforeRank0    | 4.366 ms                  | 22.995 ms                 |
| AfterBackward             | 28.393 ms                 | 38.089 ms                 |
| BlockToStepN              | 200.677 ms                | 288.929 ms                |
| OneStep                   | 255.853 ms                | 363.716 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.683 ms                  | 10.624 ms                 |
| ProcessBack:UpdateCache   | 9.964 ms                  | 11.927 ms                 |
| ProcessBack:UpsertPq      | 9.813 ms                  | 17.782 ms                 |
| ProcessOneStep            | 28.366 ms                 | 37.925 ms                 |
| BlockToStepN              | 200.625 ms                | 288.877 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:32.463624 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240204 10:55:33.463006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=300, pq.top=300
[proc 4] 300 steps, total: 30.006, sample: 0.319, forward: 0.435, backward: 0.878, update: 0.184
[proc 7] 300 steps, total: 30.006, sample: 0.352, forward: 0.444, backward: 0.884, update: 0.182
[proc 2] 300 steps, total: 30.006, sample: 0.330, forward: 0.434, backward: 0.904, update: 0.191
[proc 1] 300 steps, total: 30.006, sample: 0.352, forward: 0.461, backward: 0.885, update: 0.183
[proc 3] 300 steps, total: 30.006, sample: 0.329, forward: 0.432, backward: 0.855, update: 0.179
[proc 6] 300 steps, total: 30.006, sample: 0.339, forward: 0.457, backward: 0.880, update: 0.187
[proc 5] 300 steps, total: 30.006, sample: 0.343, forward: 0.436, backward: 0.871, update: 0.187
[proc 0] 300 steps, total: 30.006, sample: 0.406, forward: 0.496, backward: 0.852, update: 0.190
W20240204 10:55:34.463006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240204 10:55:35.463013 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=306, pq.top=306
W20240204 10:55:36.463012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.392 ms                  | 22.725 ms                 |
| Forward                   | 4.661 ms                  | 15.558 ms                 |
| Backward                  | 8.525 ms                  | 14.337 ms                 |
| Optimize                  | 1.848 ms                  | 4.969 ms                  |
| BarrierTimeBeforeRank0    | 4.450 ms                  | 23.655 ms                 |
| AfterBackward             | 28.393 ms                 | 38.089 ms                 |
| BlockToStepN              | 203.148 ms                | 302.427 ms                |
| OneStep                   | 263.006 ms                | 383.623 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.673 ms                  | 10.624 ms                 |
| ProcessBack:UpdateCache   | 9.964 ms                  | 11.927 ms                 |
| ProcessBack:UpsertPq      | 9.813 ms                  | 18.721 ms                 |
| ProcessOneStep            | 28.366 ms                 | 37.925 ms                 |
| BlockToStepN              | 203.886 ms                | 302.319 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:37.463006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=312, pq.top=312
W20240204 10:55:38.463007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240204 10:55:39.463007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=318, pq.top=318
W20240204 10:55:40.463014 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240204 10:55:41.463011 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.417 ms                  | 22.725 ms                 |
| Forward                   | 4.658 ms                  | 15.558 ms                 |
| Backward                  | 7.271 ms                  | 14.337 ms                 |
| Optimize                  | 1.843 ms                  | 4.969 ms                  |
| BarrierTimeBeforeRank0    | 4.515 ms                  | 23.655 ms                 |
| AfterBackward             | 28.403 ms                 | 39.906 ms                 |
| BlockToStepN              | 206.910 ms                | 302.427 ms                |
| OneStep                   | 265.228 ms                | 383.623 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.657 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 9.965 ms                  | 11.699 ms                 |
| ProcessBack:UpsertPq      | 9.838 ms                  | 18.816 ms                 |
| ProcessOneStep            | 28.373 ms                 | 39.878 ms                 |
| BlockToStepN              | 207.525 ms                | 302.319 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:42.463006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=328, pq.top=328
W20240204 10:55:43.463007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240204 10:55:44.463006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=334, pq.top=334
W20240204 10:55:45.463006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240204 10:55:46.463022 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=340, pq.top=340
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.424 ms                  | 22.739 ms                 |
| Forward                   | 4.655 ms                  | 15.558 ms                 |
| Backward                  | 6.249 ms                  | 14.337 ms                 |
| Optimize                  | 1.839 ms                  | 4.969 ms                  |
| BarrierTimeBeforeRank0    | 4.541 ms                  | 23.705 ms                 |
| AfterBackward             | 28.426 ms                 | 39.906 ms                 |
| BlockToStepN              | 211.445 ms                | 305.871 ms                |
| OneStep                   | 268.454 ms                | 383.623 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.648 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 9.964 ms                  | 11.699 ms                 |
| ProcessBack:UpsertPq      | 9.857 ms                  | 18.816 ms                 |
| ProcessOneStep            | 28.383 ms                 | 39.878 ms                 |
| BlockToStepN              | 212.330 ms                | 323.419 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:47.463008 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240204 10:55:48.463007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=346, pq.top=346
W20240204 10:55:49.478482 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=350, pq.top=350
W20240204 10:55:50.478006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240204 10:55:51.478014 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=356, pq.top=356
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.427 ms                  | 22.725 ms                 |
| Forward                   | 4.654 ms                  | 12.597 ms                 |
| Backward                  | 7.571 ms                  | 12.047 ms                 |
| Optimize                  | 1.839 ms                  | 4.656 ms                  |
| BarrierTimeBeforeRank0    | 4.550 ms                  | 23.655 ms                 |
| AfterBackward             | 28.413 ms                 | 38.089 ms                 |
| BlockToStepN              | 216.523 ms                | 305.871 ms                |
| OneStep                   | 271.861 ms                | 383.623 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.646 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 9.952 ms                  | 11.699 ms                 |
| ProcessBack:UpsertPq      | 9.874 ms                  | 18.816 ms                 |
| ProcessOneStep            | 28.383 ms                 | 37.925 ms                 |
| BlockToStepN              | 216.740 ms                | 305.799 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:52.478011 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240204 10:55:53.478006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=362, pq.top=362
W20240204 10:55:54.478008 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240204 10:55:55.478006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=368, pq.top=368
W20240204 10:55:56.478018 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=371, pq.top=371
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.443 ms                  | 22.725 ms                 |
| Forward                   | 4.654 ms                  | 12.597 ms                 |
| Backward                  | 8.525 ms                  | 12.047 ms                 |
| Optimize                  | 1.839 ms                  | 4.656 ms                  |
| BarrierTimeBeforeRank0    | 4.550 ms                  | 23.655 ms                 |
| AfterBackward             | 28.437 ms                 | 38.089 ms                 |
| BlockToStepN              | 219.214 ms                | 328.323 ms                |
| OneStep                   | 275.570 ms                | 409.461 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.650 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 9.952 ms                  | 11.699 ms                 |
| ProcessBack:UpsertPq      | 9.885 ms                  | 19.536 ms                 |
| ProcessOneStep            | 28.406 ms                 | 37.925 ms                 |
| BlockToStepN              | 219.209 ms                | 333.858 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:55:57.478008 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=374, pq.top=374
W20240204 10:55:58.478006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=377, pq.top=377
W20240204 10:55:59.478006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=381, pq.top=381
W20240204 10:56:00.479537 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=384, pq.top=384
W20240204 10:56:01.479012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=386, pq.top=386
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.449 ms                  | 22.725 ms                 |
| Forward                   | 4.647 ms                  | 12.597 ms                 |
| Backward                  | 8.652 ms                  | 12.047 ms                 |
| Optimize                  | 1.838 ms                  | 4.656 ms                  |
| BarrierTimeBeforeRank0    | 4.546 ms                  | 23.655 ms                 |
| AfterBackward             | 28.462 ms                 | 39.842 ms                 |
| BlockToStepN              | 221.676 ms                | 333.972 ms                |
| OneStep                   | 278.641 ms                | 410.368 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.657 ms                  | 10.359 ms                 |
| ProcessBack:UpdateCache   | 9.946 ms                  | 11.647 ms                 |
| ProcessBack:UpsertPq      | 9.910 ms                  | 19.793 ms                 |
| ProcessOneStep            | 28.456 ms                 | 39.808 ms                 |
| BlockToStepN              | 221.839 ms                | 339.636 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:02.479007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=389, pq.top=389
W20240204 10:56:03.483631 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240204 10:56:04.483006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=396, pq.top=396
W20240204 10:56:05.483014 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 4] 400 steps, total: 32.286, sample: 0.347, forward: 0.429, backward: 0.510, update: 0.168
[proc 7] 400 steps, total: 32.286, sample: 0.308, forward: 0.434, backward: 0.655, update: 0.172
[proc 6] 400 steps, total: 32.286, sample: 0.349, forward: 0.433, backward: 0.828, update: 0.170
[proc 5] 400 steps, total: 32.286, sample: 0.339, forward: 0.427, backward: 0.488, update: 0.167
[proc 3] 400 steps, total: 32.286, sample: 0.331, forward: 0.425, backward: 0.750, update: 0.171
[proc 1] 400 steps, total: 32.286, sample: 0.324, forward: 0.418, backward: 0.843, update: 0.164
[proc 2] 400 steps, total: 32.286, sample: 0.336, forward: 0.420, backward: 0.886, update: 0.179
[proc 0] 400 steps, total: 32.286, sample: 0.382, forward: 0.443, backward: 0.706, update: 0.182
W20240204 10:56:06.483011 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=402, pq.top=402
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.464 ms                  | 22.725 ms                 |
| Forward                   | 4.644 ms                  | 12.597 ms                 |
| Backward                  | 8.693 ms                  | 12.047 ms                 |
| Optimize                  | 1.836 ms                  | 4.656 ms                  |
| BarrierTimeBeforeRank0    | 4.529 ms                  | 23.655 ms                 |
| AfterBackward             | 28.470 ms                 | 39.842 ms                 |
| BlockToStepN              | 222.593 ms                | 339.838 ms                |
| OneStep                   | 281.633 ms                | 410.368 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.659 ms                  | 10.359 ms                 |
| ProcessBack:UpdateCache   | 9.944 ms                  | 11.647 ms                 |
| ProcessBack:UpsertPq      | 9.908 ms                  | 19.793 ms                 |
| ProcessOneStep            | 28.444 ms                 | 39.808 ms                 |
| BlockToStepN              | 222.601 ms                | 339.636 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:07.483007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240204 10:56:08.483006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=408, pq.top=408
W20240204 10:56:09.483006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240204 10:56:10.483016 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=413, pq.top=413
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.469 ms                  | 22.725 ms                 |
| Forward                   | 4.644 ms                  | 12.597 ms                 |
| Backward                  | 8.708 ms                  | 12.047 ms                 |
| Optimize                  | 1.832 ms                  | 4.656 ms                  |
| BarrierTimeBeforeRank0    | 4.521 ms                  | 23.655 ms                 |
| AfterBackward             | 28.512 ms                 | 39.842 ms                 |
| BlockToStepN              | 224.230 ms                | 361.684 ms                |
| OneStep                   | 282.684 ms                | 432.109 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:11.526532 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.667 ms                  | 10.433 ms                 |
| ProcessBack:UpdateCache   | 9.940 ms                  | 11.927 ms                 |
| ProcessBack:UpsertPq      | 9.917 ms                  | 19.793 ms                 |
| ProcessOneStep            | 28.480 ms                 | 39.808 ms                 |
| BlockToStepN              | 224.766 ms                | 361.561 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:12.526007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
W20240204 10:56:13.544529 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240204 10:56:14.571074 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=426, pq.top=426
W20240204 10:56:15.571012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=429, pq.top=429
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.474 ms                  | 23.583 ms                 |
| Forward                   | 4.639 ms                  | 12.597 ms                 |
| Backward                  | 8.721 ms                  | 12.047 ms                 |
| Optimize                  | 1.831 ms                  | 4.656 ms                  |
| BarrierTimeBeforeRank0    | 4.495 ms                  | 23.655 ms                 |
| AfterBackward             | 28.527 ms                 | 39.842 ms                 |
| BlockToStepN              | 225.958 ms                | 375.549 ms                |
| OneStep                   | 283.926 ms                | 439.089 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:16.619603 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=432, pq.top=432
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.667 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 9.930 ms                  | 11.699 ms                 |
| ProcessBack:UpsertPq      | 9.922 ms                  | 19.536 ms                 |
| ProcessOneStep            | 28.483 ms                 | 39.808 ms                 |
| BlockToStepN              | 225.922 ms                | 375.439 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:17.619005 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240204 10:56:18.644778 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240204 10:56:19.687181 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240204 10:56:20.687007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=443, pq.top=443
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.477 ms                  | 23.583 ms                 |
| Forward                   | 4.610 ms                  | 12.597 ms                 |
| Backward                  | 8.732 ms                  | 12.047 ms                 |
| Optimize                  | 1.832 ms                  | 4.656 ms                  |
| BarrierTimeBeforeRank0    | 4.458 ms                  | 23.705 ms                 |
| AfterBackward             | 28.536 ms                 | 39.906 ms                 |
| BlockToStepN              | 227.070 ms                | 375.549 ms                |
| OneStep                   | 286.617 ms                | 439.089 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:21.716301 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=447, pq.top=447
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.672 ms                  | 10.624 ms                 |
| ProcessBack:UpdateCache   | 9.928 ms                  | 11.927 ms                 |
| ProcessBack:UpsertPq      | 9.932 ms                  | 19.793 ms                 |
| ProcessOneStep            | 28.506 ms                 | 39.878 ms                 |
| BlockToStepN              | 227.147 ms                | 375.439 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:22.716010 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=450, pq.top=450
W20240204 10:56:23.716012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=452, pq.top=452
W20240204 10:56:24.716006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240204 10:56:25.716008 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=458, pq.top=458
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.484 ms                  | 22.739 ms                 |
| Forward                   | 4.609 ms                  | 10.289 ms                 |
| Backward                  | 8.742 ms                  | 11.748 ms                 |
| Optimize                  | 1.831 ms                  | 4.624 ms                  |
| BarrierTimeBeforeRank0    | 4.458 ms                  | 23.705 ms                 |
| AfterBackward             | 28.527 ms                 | 39.842 ms                 |
| BlockToStepN              | 227.827 ms                | 370.371 ms                |
| OneStep                   | 287.517 ms                | 432.109 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:26.716006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=461, pq.top=461
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.676 ms                  | 10.624 ms                 |
| ProcessBack:UpdateCache   | 9.924 ms                  | 11.927 ms                 |
| ProcessBack:UpsertPq      | 9.927 ms                  | 19.793 ms                 |
| ProcessOneStep            | 28.498 ms                 | 39.808 ms                 |
| BlockToStepN              | 227.764 ms                | 370.224 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:27.716012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=464, pq.top=464
W20240204 10:56:28.716018 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240204 10:56:29.716006 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=470, pq.top=470
W20240204 10:56:30.766615 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=473, pq.top=473
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.490 ms                  | 22.739 ms                 |
| Forward                   | 4.606 ms                  | 10.289 ms                 |
| Backward                  | 8.746 ms                  | 12.047 ms                 |
| Optimize                  | 1.832 ms                  | 4.624 ms                  |
| BarrierTimeBeforeRank0    | 4.458 ms                  | 23.705 ms                 |
| AfterBackward             | 28.536 ms                 | 39.906 ms                 |
| BlockToStepN              | 229.544 ms                | 370.371 ms                |
| OneStep                   | 288.673 ms                | 432.109 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:31.766005 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=476, pq.top=476
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.678 ms                  | 10.433 ms                 |
| ProcessBack:UpdateCache   | 9.924 ms                  | 11.699 ms                 |
| ProcessBack:UpsertPq      | 9.940 ms                  | 19.960 ms                 |
| ProcessOneStep            | 28.506 ms                 | 39.878 ms                 |
| BlockToStepN              | 229.743 ms                | 370.224 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:32.803519 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=479, pq.top=479
W20240204 10:56:33.803012 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240204 10:56:34.858568 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=484, pq.top=484
W20240204 10:56:35.858007 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=486, pq.top=486
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.498 ms                  | 22.739 ms                 |
| Forward                   | 4.606 ms                  | 10.289 ms                 |
| Backward                  | 8.749 ms                  | 14.337 ms                 |
| Optimize                  | 1.828 ms                  | 4.624 ms                  |
| BarrierTimeBeforeRank0    | 4.466 ms                  | 23.705 ms                 |
| AfterBackward             | 28.555 ms                 | 41.471 ms                 |
| BlockToStepN              | 230.981 ms                | 375.549 ms                |
| OneStep                   | 289.839 ms                | 439.089 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:36.879490 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=490, pq.top=490
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 10.624 ms                 |
| ProcessBack:UpdateCache   | 9.924 ms                  | 11.699 ms                 |
| ProcessBack:UpsertPq      | 9.942 ms                  | 20.681 ms                 |
| ProcessOneStep            | 28.519 ms                 | 41.428 ms                 |
| BlockToStepN              | 230.916 ms                | 375.439 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:56:37.919654 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240204 10:56:38.919025 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=495, pq.top=495
W20240204 10:56:39.919009 49086 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=498, pq.top=498
[proc 4] 500 steps, total: 34.743, sample: 0.311, forward: 0.437, backward: 0.382, update: 0.165
[proc 5] 500 steps, total: 34.742, sample: 0.301, forward: 0.435, backward: 0.522, update: 0.169
[proc 0] 500 steps, total: 34.742, sample: 0.407, forward: 0.451, backward: 0.892, update: 0.192
[proc 6] 500 steps, total: 34.743, sample: 0.304, forward: 0.440, backward: 0.861, update: 0.170
Successfully xmh. training takes 142.68367791175842 seconds
before call kg_cache_controller.StopThreads()
W20240204 10:56:40.711831 49086 grad_async_v1.h:243] call StopThreads. PID = 48334
W20240204 10:56:40.711861 49086 grad_base.h:212] before processOneStepNegThread_.join();
[proc 3] 500 steps, total: 34.743, sample: 0.343, forward: 0.463, backward: 0.777, update: 0.170
[proc 7] 500 steps, total: 34.743, sample: 0.363, forward: 0.467, backward: 0.644, update: 0.170
[proc 2] 500 steps, total: 34.742, sample: 0.384, forward: 0.435, backward: 0.895, update: 0.183
[proc 1] 500 steps, total: 34.742, sample: 0.328, forward: 0.437, backward: 0.612, update: 0.164
W20240204 10:56:40.720770 49086 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 10:56:40.720826 49086 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 10:56:40.752840 49086 grad_async_v1.h:264] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f50a497c510>
