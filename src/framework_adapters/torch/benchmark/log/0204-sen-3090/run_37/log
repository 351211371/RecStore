WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 14:45:01.770645  7079 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_95', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [7079 sampler.py:454] Start PreSampling
WARNING [7079 sampler.py:532] Before construct renumbering_dict
WARNING [7079 sampler.py:555] PreSampling done
W20240204 15:05:27.431599  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 15:05:27.431790  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 15:05:27.431823  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 15:05:27.431860  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 15:05:27.431891  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 15:05:27.431926  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 15:05:27.431962  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 15:05:27.432008  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 15:05:27.432040  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 15:05:27.432078  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 15:05:27.432132  7079 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 15:05:27.432164  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 15:05:27.432188  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 15:05:27.432361  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 15:05:27.432397  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 15:05:27.432427  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 15:05:27.432473  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 15:05:27.432507  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 15:05:27.432538  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 15:05:27.432574  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 15:05:27.432603  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 15:05:27.432646  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 15:05:27.432682  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 15:05:27.432711  7079 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 15:05:27.432734  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 15:05:27.432757  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 15:05:27.432814  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 15:05:27.432852  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 15:05:27.432883  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 15:05:27.432910  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 15:05:27.432945  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 15:05:27.432979  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 15:05:27.433014  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 15:05:27.433045  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 15:05:27.433074  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 15:05:27.433106  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 15:05:27.433136  7079 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 15:05:27.433158  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 15:05:27.433182  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 15:05:27.433256  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 15:05:27.433286  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 15:05:27.433312  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 15:05:27.433339  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 15:05:27.433369  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 15:05:27.433403  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 15:05:27.433439  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 15:05:27.433465  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 15:05:27.433492  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 15:05:27.433532  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 15:05:27.433560  7079 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 15:05:27.433583  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 15:05:27.433605  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 15:05:27.433662  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 15:05:27.433692  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 15:05:27.433722  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 15:05:27.433748  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 15:05:27.433777  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 15:05:27.433806  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 15:05:27.433833  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 15:05:27.433864  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 15:05:27.433897  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 15:05:27.433923  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 15:05:27.433954  7079 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 15:05:27.433975  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 15:05:27.434000  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 15:05:27.434049  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 15:05:27.434082  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 15:05:27.434118  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 15:05:27.434147  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 15:05:27.434190  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 15:05:27.434217  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 15:05:27.434250  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 15:05:27.434276  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 15:05:27.434303  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 15:05:27.434335  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 15:05:27.434368  7079 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 15:05:27.434391  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 15:05:27.434413  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 15:05:27.434461  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 15:05:27.434490  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 15:05:27.434517  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 15:05:27.434547  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 15:05:27.434576  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 15:05:27.434609  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 15:05:27.434639  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 15:05:27.434671  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 15:05:27.434705  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 15:05:27.434741  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 15:05:27.434768  7079 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 15:05:27.434792  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 15:05:27.434818  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 15:05:27.434875  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 15:05:27.434908  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 15:05:27.434935  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 15:05:27.434962  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 15:05:27.434989  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 15:05:27.435029  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 15:05:27.435065  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 15:05:27.435091  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 15:05:27.435123  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 15:05:27.435158  7079 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 15:05:27.435185  7079 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 15:05:27.435207  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 15:05:27.435235  7079 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 15:05:27.850376  7079 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240204 15:14:01.265501  7079 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302711,  4302733,    85302,  ..., 66217296, 64197527,  5170445]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2249.865 seconds
[Rank1] pid = 33588
[Rank2] pid = 33781
[Rank3] pid = 33955
[Rank4] pid = 34163
[Rank5] pid = 34372
[Rank6] pid = 34576
INFO [7079 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [33588 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [33781 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [33955 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [34372 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [34163 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [34780 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [34576 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [33781 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7079 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33588 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34163 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34576 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34372 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34780 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33955 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 15:22:44.767231 34781 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240204 15:22:44.768460 33589 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240204 15:22:44.768486 33782 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240204 15:22:44.768592 34164 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240204 15:22:44.771970 34373 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240204 15:22:44.772763 34845 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240204 15:22:44.773093 34577 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240204 15:22:44.773114 33956 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240204 15:22:44.847179 34164 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1020497a5000 7.629 MB
W20240204 15:22:44.847234 34781 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102049f4e000 7.629 MB
W20240204 15:22:44.847368 33782 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204a6f7000 7.629 MB
W20240204 15:22:44.847376 33589 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204ae9a000 7.629 MB
W20240204 15:22:44.847415 34164 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204b63d000 7.629 MB
W20240204 15:22:44.847435 34845 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204bde0000 7.629 MB
W20240204 15:22:44.847535 34164 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10204c583000 1.49 GB
W20240204 15:22:44.847573 33782 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1020abb66000 7.629 MB
W20240204 15:22:44.847594 34781 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020ac309000 7.629 MB
W20240204 15:22:44.847613 34164 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1020acaac000 1.49 GB
W20240204 15:22:44.847630 33589 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210c08f000 7.629 MB
W20240204 15:22:44.847636 34845 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10210c832000 7.629 MB
W20240204 15:22:44.847652 34781 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210cfd5000 1.49 GB
W20240204 15:22:44.847700 33782 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10216cd5b000 1.49 GB
W20240204 15:22:44.847702 34781 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1021cc33e000 1.49 GB
W20240204 15:22:44.847695 34577 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10216c5b8000 7.629 MB
W20240204 15:22:44.847714 33956 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10222b921000 7.629 MB
W20240204 15:22:44.847733 34164 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 15:22:44.847741 34373 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10222c0c4000 7.629 MB
W20240204 15:22:44.847754 34845 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10222c867000 1.49 GB
W20240204 15:22:44.847767 34781 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 15:22:44.847769 33589 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10228be4a000 1.49 GB
W20240204 15:22:44.847795 33782 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022eb42d000 1.49 GB
W20240204 15:22:44.847826 34845 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10234aa10000 1.49 GB
W20240204 15:22:44.849285 34845 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 15:22:44.850818 34373 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1023a9ff3000 7.629 MB
W20240204 15:22:44.850836 33956 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1023aa796000 7.629 MB
W20240204 15:22:44.850852 33782 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 15:22:44.850857 33589 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1023aaf39000 1.49 GB
W20240204 15:22:44.850911 34577 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10240a51c000 7.629 MB
W20240204 15:22:44.850930 33589 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 15:22:44.852602 34373 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10240acbf000 1.49 GB
W20240204 15:22:44.854068 34373 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10246a2a2000 1.49 GB
W20240204 15:22:44.854084 34577 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1024c9885000 1.49 GB
W20240204 15:22:44.854089 33956 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x102528e68000 1.49 GB
W20240204 15:22:44.854143 34577 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10258844b000 1.49 GB
W20240204 15:22:44.854153 34373 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 15:22:44.854157 33956 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240204 15:22:44.855492 33956 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 15:22:44.855500 34577 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 15:22:44.855777 34164 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 15:22:44.860401 34781 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 15:22:44.862237 34845 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 15:22:44.862388 33782 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 15:22:44.863927 33589 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 15:22:44.867130 33956 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 15:22:44.867141 34373 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 15:22:44.867146 34577 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
[Rank7] pid = 34780
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [7079 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [34163 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [34576 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [34780 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [33955 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [33588 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [34372 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [33781 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 15:23:36.992996 33782 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 15:23:36.993357 33589 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 15:23:36.993396 34164 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 15:23:36.993482 33956 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 15:23:36.993528 34577 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 15:23:36.993609 34845 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 15:23:36.993669 34373 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 15:23:36.993697 34781 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 15:23:36.995430 34781 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 15:23:36.995750 34781 grad_base.h:184] Init GradProcessingBase done
I20240204 15:23:50.040745 34781 grad_async_v2.h:42] Use main thread to update emb.
W20240204 15:23:50.040997 34781 kg_controller.h:78] after init GradAsyncProcessingV2
I20240204 15:23:50.041007 34781 kg_controller.h:84] Construct KGCacheController done
E20240204 15:23:51.812853 34373 recstore.cc:66] init folly done
E20240204 15:23:51.813309 33782 recstore.cc:66] init folly done
E20240204 15:23:51.813304 34577 recstore.cc:66] init folly done
E20240204 15:23:51.813319 33589 recstore.cc:66] init folly done
E20240204 15:23:51.813331 34845 recstore.cc:66] init folly done
E20240204 15:23:51.813737 33956 recstore.cc:66] init folly done
E20240204 15:23:51.813737 34164 recstore.cc:66] init folly done
E20240204 15:23:51.813802 34781 recstore.cc:66] init folly done
I20240204 15:23:51.814777 34781 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240204 15:24:10.278478 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 15:24:10.279008 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240204 15:24:11.279024 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240204 15:24:11.676919 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 142.272 us                | 268.211 us                |
+---------------------------+---------------------------+---------------------------+
E20240204 15:24:12.567247 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 15:24:13.306041 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240204 15:24:13.489897 34373 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
E20240204 15:24:13.567011 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
I20240204 15:24:13.653885 34845 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 15:24:14.546059 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 15:24:14.567010 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
I20240204 15:24:14.728374 34164 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 15:24:15.293345 33782 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240204 15:24:15.575326 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 15:24:16.501639 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 15:24:16.577452 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 15:24:16.678794 33956 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 188.645 us                | 328.884 us                |
+---------------------------+---------------------------+---------------------------+
I20240204 15:24:16.847036 34781 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 15:24:16.931226 33589 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 15:24:17.232992 34577 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240204 15:24:17.577026 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
W20240204 15:24:17.587260 41069 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
E20240204 15:24:19.717527 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 15:24:19.819037 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240204 15:24:19.835917 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 15:24:19.931123 34781 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=1, sample_step_cpp_seen_[rank]=0
E20240204 15:24:20.717065 38043 parallel_pq_v2.h:79] insert failed, size(hashtable)=12
W20240204 15:24:20.980962 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240204 15:24:21.029974 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
E20240204 15:24:21.717015 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=3404
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 249.003 us                | 4.314 ms                  |
| ProcessBack:Shuffle       | 8.334 ms                  | 317.350 ms                |
| ProcessBack:UpdateCache   | 10.425 ms                 | 705.756 ms                |
| ProcessBack:UpsertPq      | 78.347 ms                 | 195.469 ms                |
| ProcessOneStep            | 140.093 ms                | 1.450 s                   |
| BlockToStepN              | 1.134 ms                  | 2.738 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 36.105 ms                 | 119.100 ms                |
| Forward                   | 5.241 ms                  | 802.370 ms                |
| Backward                  | 5.344 ms                  | 198.326 ms                |
| Optimize                  | 2.183 ms                  | 4.357 ms                  |
| BarrierTimeBeforeRank0    | 12.000 ms                 | 148.602 ms                |
| AfterBackward             | 140.163 ms                | 1.450 s                   |
| BlockToStepN              | 1.233 ms                  | 2.837 ms                  |
| OneStep                   | 260.446 ms                | 2.600 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:24:22.018776 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240204 15:24:22.097602 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240204 15:24:22.717038 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240204 15:24:23.227903 41069 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240204 15:24:23.722004 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 15:24:24.508778 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240204 15:24:24.721012 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=43
W20240204 15:24:24.887987 34781 grad_async_v2.h:257] pq is empty
W20240204 15:24:25.074472 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240204 15:24:25.693645 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240204 15:24:25.721024 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=38880
W20240204 15:24:26.524837 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=23, pq.top=23
E20240204 15:24:26.725010 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 261.161 us                | 1.697 ms                  |
| ProcessBack:Shuffle       | 7.947 ms                  | 317.350 ms                |
| ProcessBack:UpdateCache   | 10.544 ms                 | 705.756 ms                |
| ProcessBack:UpsertPq      | 75.239 ms                 | 195.469 ms                |
| ProcessOneStep            | 127.884 ms                | 2.385 s                   |
| BlockToStepN              | 804.292 us                | 8.872 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 18.093 ms                 | 203.458 ms                |
| Forward                   | 5.226 ms                  | 802.370 ms                |
| Backward                  | 5.293 ms                  | 198.326 ms                |
| Optimize                  | 2.057 ms                  | 5.723 ms                  |
| BarrierTimeBeforeRank0    | 54.219 us                 | 148.602 ms                |
| AfterBackward             | 127.924 ms                | 2.385 s                   |
| BlockToStepN              | 1.144 ms                  | 8.999 ms                  |
| OneStep                   | 185.849 ms                | 2.600 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:24:27.021036 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240204 15:24:27.066709 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=26, sample_step_cpp_seen_[rank]=25
E20240204 15:24:27.724027 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=168
W20240204 15:24:28.059504 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
E20240204 15:24:28.724011 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=248
W20240204 15:24:28.724400 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240204 15:24:29.096273 41069 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
E20240204 15:24:29.724010 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=5341
W20240204 15:24:29.820178 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240204 15:24:30.213801 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240204 15:24:30.724009 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
W20240204 15:24:30.903039 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240204 15:24:31.227499 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 15:24:31.724012 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=826
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 289.673 us                | 1.821 ms                  |
| ProcessBack:Shuffle       | 8.169 ms                  | 257.202 ms                |
| ProcessBack:UpdateCache   | 11.318 ms                 | 705.295 ms                |
| ProcessBack:UpsertPq      | 48.169 ms                 | 173.315 ms                |
| ProcessOneStep            | 120.850 ms                | 2.385 s                   |
| BlockToStepN              | 825.918 us                | 8.872 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.103 ms                 | 551.432 ms                |
| Forward                   | 5.387 ms                  | 802.370 ms                |
| Backward                  | 5.331 ms                  | 198.326 ms                |
| Optimize                  | 2.183 ms                  | 11.148 ms                 |
| BarrierTimeBeforeRank0    | 56.081 us                 | 148.602 ms                |
| AfterBackward             | 120.895 ms                | 2.385 s                   |
| BlockToStepN              | 949.123 us                | 8.999 ms                  |
| OneStep                   | 157.359 ms                | 2.600 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 15:24:32.066007 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=45, sample_step_cpp_seen_[rank]=44
W20240204 15:24:32.281888 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240204 15:24:32.724009 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=180
W20240204 15:24:32.766705 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240204 15:24:33.522442 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240204 15:24:33.724011 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=2319
W20240204 15:24:33.951946 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240204 15:24:34.665303 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240204 15:24:34.724005 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=131
W20240204 15:24:35.317080 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=60, pq.top=60
W20240204 15:24:35.679227 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240204 15:24:35.724009 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=11003
W20240204 15:24:36.519780 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=71, pq.top=71
E20240204 15:24:36.724009 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=2418
W20240204 15:24:36.809602 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 454.623 us                | 9.917 ms                  |
| ProcessBack:Shuffle       | 8.082 ms                  | 257.202 ms                |
| ProcessBack:UpdateCache   | 10.929 ms                 | 705.295 ms                |
| ProcessBack:UpsertPq      | 32.112 ms                 | 173.315 ms                |
| ProcessOneStep            | 100.993 ms                | 1.450 s                   |
| BlockToStepN              | 791.174 us                | 8.872 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.405 ms                  | 280.889 ms                |
| Forward                   | 5.463 ms                  | 29.914 ms                 |
| Backward                  | 5.334 ms                  | 8.626 ms                  |
| Optimize                  | 2.613 ms                  | 5.723 ms                  |
| BarrierTimeBeforeRank0    | 382.303 us                | 119.628 ms                |
| AfterBackward             | 101.038 ms                | 1.450 s                   |
| BlockToStepN              | 883.972 us                | 8.999 ms                  |
| OneStep                   | 137.220 ms                | 2.408 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 15:24:37.066004 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=72, sample_step_cpp_seen_[rank]=71
E20240204 15:24:37.724068 41068 parallel_pq_v2.h:79] insert failed, size(hashtable)=37537
W20240204 15:24:37.767557 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240204 15:24:37.826130 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 15:24:38.724030 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=16336
W20240204 15:24:38.784196 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240204 15:24:38.893368 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240204 15:24:39.724013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 15:24:40.012852 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240204 15:24:40.724021 41417 parallel_pq_v2.h:79] insert failed, size(hashtable)=1778
W20240204 15:24:40.820423 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240204 15:24:41.049887 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240204 15:24:41.724022 41433 parallel_pq_v2.h:79] insert failed, size(hashtable)=25845
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 432.346 us                | 16.823 ms                 |
| ProcessBack:Shuffle       | 8.176 ms                  | 41.412 ms                 |
| ProcessBack:UpdateCache   | 11.090 ms                 | 37.791 ms                 |
| ProcessBack:UpsertPq      | 35.075 ms                 | 162.690 ms                |
| ProcessOneStep            | 100.562 ms                | 1.450 s                   |
| BlockToStepN              | 904.521 us                | 14.351 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 15:24:41.951392 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.280 ms                  | 346.615 ms                |
| Forward                   | 5.454 ms                  | 29.914 ms                 |
| Backward                  | 5.354 ms                  | 8.626 ms                  |
| Optimize                  | 2.604 ms                  | 5.723 ms                  |
| BarrierTimeBeforeRank0    | 1.071 ms                  | 119.628 ms                |
| AfterBackward             | 101.038 ms                | 1.450 s                   |
| BlockToStepN              | 1.015 ms                  | 14.454 ms                 |
| OneStep                   | 133.482 ms                | 2.408 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:24:42.068280 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240204 15:24:42.188670 34781 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=99, sample_step_cpp_seen_[rank]=98
E20240204 15:24:42.724012 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=991
W20240204 15:24:43.082372 41069 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
W20240204 15:24:43.273216 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=100, pq.top=100
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 27.981, sample: 1.523, forward: 1.243, backward: 0.820, update: 0.236
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 29.785, sample: 1.470, forward: 1.287, backward: 0.833, update: 0.238
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 29.621, sample: 1.524, forward: 1.345, backward: 0.900, update: 0.234
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 26.596, sample: 1.403, forward: 1.323, backward: 0.853, update: 0.232
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 26.343, sample: 1.702, forward: 1.310, backward: 0.929, update: 0.235
train_sampler.Prefill()
-------Step 0-------
tensor([   44220,    44254,    44288,    44313,  6003769,    96681, 59010911,
        15798698, 18404684,    44345]) tensor([ 5300464, 13628664, 68050314, 66329230, 19722562, 33083156, 41008299,
        69538360, 62047916, 27470594])
-------Step 1-------
tensor([   44220,    44254,    44288,    44313,  6003769,    96681, 59010911,
        15798698, 18404684,    44345]) tensor([63117854, 31506045, 10579951, 71596832, 82798236, 46305139, 79539772,
        42422869, 39650671, 11877429])
-------Step 2-------
tensor([  110136,   110167,   110187,    30219,   110210,   110240,   110269,
        29127467,   110296,   110331]) tensor([63576539, 27976769, 81851579, 55811388, 47599636, 24559156, 63407580,
        45272004, 15739123, 45343340])
-------Step 3-------
tensor([  110136,   110167,   110187,    30219,   110210,   110240,   110269,
        29127467,   110296,   110331]) tensor([52610960, 75268397, 39585139, 40408052, 58633678, 55311576, 42059463,
        14559710, 24969140,   697846])
-------Step 4-------
tensor([  176186, 51497604,   176214,   121621,   176237,   121641,   176263,
        42211455,   176287,   176319]) tensor([71596718,  9222739, 85825695, 17389126, 76628994, 47651452, 62087734,
        39620969, 85357287, 44773779])
-------Step 5-------
tensor([  176186, 51497604,   176214,   121621,   176237,   121641,   176263,
        42211455,   176287,   176319]) tensor([33648029, 72667794,   222271, 84510365, 51960911, 57828576, 16270772,
         8547932, 79137181, 41897301])
-------Step 6-------
tensor([  243394,    63432,   243424,   243448,    63468, 70056145,   243476,
          243509,   133805, 38532540]) tensor([12542541, 43295662, 40771586, 71152385, 32011621, 41058617, 28183243,
         7061499, 60106354, 84518400])
-------Step 7-------
tensor([  243394,    63432,   243424,   243448,    63468, 70056145,   243476,
          243509,   133805, 38532540]) tensor([29029041, 45004272, 79294771, 65499770, 83957243, 47256373, 50627743,
        60452953, 40499219, 28230315])
-------Step 8-------
tensor([  309401, 25379605,   309426,   145507,   309453,    79372,   309468,
          309495,   309518,   309539]) tensor([40817753, 21574297, 36008515,  1894179, 42862105, 74421654, 16674470,
        77458801,  1601821, 70687063])
-------Step 9-------
tensor([  309401, 25379605,   309426,   145507,   309453,    79372,   309468,
          309495,   309518,   309539]) tensor([50788453, 33112751, 15900498, 58686072,  9960191, 46678224, 23100965,
        32848854, 77545794, 60085448])
before start barrier
start train
[proc 0] 100 steps, total: 26.427, sample: 2.783, forward: 1.389, backward: 0.738, update: 0.290
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 26.042, sample: 1.381, forward: 1.234, backward: 0.885, update: 0.251
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 28.546, sample: 1.681, forward: 1.359, backward: 0.819, update: 0.257
E20240204 15:24:43.725298 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 15:24:44.143658 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
W20240204 15:24:44.336608 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=107, pq.top=107
E20240204 15:24:44.725010 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=158
W20240204 15:24:45.220211 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240204 15:24:45.725014 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=5913
W20240204 15:24:46.237246 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240204 15:24:46.382225 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=115, pq.top=115
E20240204 15:24:46.725010 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=52722
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 356.072 us                | 4.770 ms                  |
| ProcessBack:Shuffle       | 8.264 ms                  | 41.412 ms                 |
| ProcessBack:UpdateCache   | 11.167 ms                 | 37.791 ms                 |
| ProcessBack:UpsertPq      | 37.030 ms                 | 162.690 ms                |
| ProcessOneStep            | 99.769 ms                 | 1.450 s                   |
| BlockToStepN              | 1.026 ms                  | 17.660 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.990 ms                  | 346.615 ms                |
| Forward                   | 5.437 ms                  | 29.914 ms                 |
| Backward                  | 5.359 ms                  | 9.850 ms                  |
| Optimize                  | 2.602 ms                  | 11.148 ms                 |
| BarrierTimeBeforeRank0    | 1.684 ms                  | 119.628 ms                |
| AfterBackward             | 100.615 ms                | 1.450 s                   |
| BlockToStepN              | 1.129 ms                  | 17.784 ms                 |
| OneStep                   | 135.781 ms                | 2.408 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:24:47.273548 41069 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
W20240204 15:24:47.461447 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=123, pq.top=123
E20240204 15:24:47.725009 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=116
E20240204 15:24:48.071040 34781 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=128, sample_step_cpp_seen_[rank]=127
W20240204 15:24:48.415486 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240204 15:24:48.725013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=6346
W20240204 15:24:49.310621 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240204 15:24:49.443578 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240204 15:24:49.725018 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=1185
W20240204 15:24:50.399345 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240204 15:24:50.506029 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
E20240204 15:24:50.725014 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=43
W20240204 15:24:51.653962 41069 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240204 15:24:51.725011 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=6257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 351.389 us                | 8.544 ms                  |
| ProcessBack:Shuffle       | 8.447 ms                  | 31.235 ms                 |
| ProcessBack:UpdateCache   | 11.352 ms                 | 18.100 ms                 |
| ProcessBack:UpsertPq      | 37.451 ms                 | 149.707 ms                |
| ProcessOneStep            | 100.562 ms                | 1.450 s                   |
| BlockToStepN              | 1.078 ms                  | 29.282 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.600 ms                  | 346.615 ms                |
| Forward                   | 5.357 ms                  | 29.914 ms                 |
| Backward                  | 5.373 ms                  | 9.850 ms                  |
| Optimize                  | 2.587 ms                  | 11.148 ms                 |
| BarrierTimeBeforeRank0    | 2.213 ms                  | 144.219 ms                |
| AfterBackward             | 100.615 ms                | 1.450 s                   |
| BlockToStepN              | 1.183 ms                  | 29.363 ms                 |
| OneStep                   | 132.781 ms                | 2.408 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:24:52.590510 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240204 15:24:52.679987 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240204 15:24:52.725011 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=868
W20240204 15:24:53.718297 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=154, pq.top=154
E20240204 15:24:53.725011 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=57
W20240204 15:24:53.782896 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240204 15:24:54.725013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=109835
W20240204 15:24:54.810084 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=162, pq.top=162
E20240204 15:24:55.007388 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=163, sample_step_cpp_seen_[rank]=162
W20240204 15:24:55.035241 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 15:24:55.725013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=4941
W20240204 15:24:56.092100 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240204 15:24:56.725011 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=68499
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 351.092 us                | 9.249 ms                  |
| ProcessBack:Shuffle       | 8.511 ms                  | 31.235 ms                 |
| ProcessBack:UpdateCache   | 11.315 ms                 | 19.213 ms                 |
| ProcessBack:UpsertPq      | 36.059 ms                 | 151.277 ms                |
| ProcessOneStep            | 100.562 ms                | 1.409 s                   |
| BlockToStepN              | 1.134 ms                  | 29.282 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.573 ms                  | 280.889 ms                |
| Forward                   | 5.437 ms                  | 17.405 ms                 |
| Backward                  | 5.393 ms                  | 8.626 ms                  |
| Optimize                  | 2.604 ms                  | 8.073 ms                  |
| BarrierTimeBeforeRank0    | 2.214 ms                  | 119.628 ms                |
| AfterBackward             | 99.813 ms                 | 1.410 s                   |
| BlockToStepN              | 1.198 ms                  | 29.363 ms                 |
| OneStep                   | 134.983 ms                | 1.442 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:24:57.139429 41069 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
W20240204 15:24:57.323287 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=171, pq.top=171
E20240204 15:24:57.725010 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=49
W20240204 15:24:58.176836 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
W20240204 15:24:58.436107 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=179, pq.top=179
E20240204 15:24:58.725010 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=3889
W20240204 15:24:59.313575 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240204 15:24:59.725220 41429 parallel_pq_v2.h:79] insert failed, size(hashtable)=7368
W20240204 15:25:00.200500 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240204 15:25:00.335075 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 15:25:00.725013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=189
W20240204 15:25:01.392971 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240204 15:25:01.542312 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=191, pq.top=191
E20240204 15:25:01.725009 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=2837
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 574.018 us                | 8.707 ms                  |
| ProcessBack:Shuffle       | 8.599 ms                  | 29.521 ms                 |
| ProcessBack:UpdateCache   | 11.345 ms                 | 18.739 ms                 |
| ProcessBack:UpsertPq      | 34.888 ms                 | 168.080 ms                |
| ProcessOneStep            | 100.993 ms                | 1.409 s                   |
| BlockToStepN              | 1.135 ms                  | 29.282 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.990 ms                  | 280.889 ms                |
| Forward                   | 5.458 ms                  | 17.405 ms                 |
| Backward                  | 5.471 ms                  | 8.626 ms                  |
| Optimize                  | 2.604 ms                  | 8.073 ms                  |
| BarrierTimeBeforeRank0    | 2.213 ms                  | 119.628 ms                |
| AfterBackward             | 100.615 ms                | 1.410 s                   |
| BlockToStepN              | 1.212 ms                  | 29.363 ms                 |
| OneStep                   | 135.781 ms                | 1.442 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 15:25:02.291371 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=197, sample_step_cpp_seen_[rank]=196
W20240204 15:25:02.677213 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240204 15:25:02.725008 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=5960
W20240204 15:25:03.706223 41069 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240204 15:25:03.725020 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=11875
[proc 7] 200 steps, total: 20.808, sample: 1.170, forward: 0.560, backward: 0.609, update: 0.232
[proc 0] 200 steps, total: 20.808, sample: 1.906, forward: 0.571, backward: 0.566, update: 0.317
[proc 2] 200 steps, total: 20.808, sample: 1.686, forward: 0.620, backward: 0.661, update: 0.255
[proc 4] 200 steps, total: 20.807, sample: 1.691, forward: 0.560, backward: 0.649, update: 0.236
[proc 3] 200 steps, total: 20.808, sample: 1.166, forward: 0.571, backward: 0.697, update: 0.227
[proc 6] 200 steps, total: 20.807, sample: 1.256, forward: 0.601, backward: 0.692, update: 0.243
[proc 1] 200 steps, total: 20.808, sample: 1.816, forward: 0.617, backward: 0.623, update: 0.240
[proc 5] 200 steps, total: 20.808, sample: 1.050, forward: 0.580, backward: 0.653, update: 0.229
W20240204 15:25:04.314896 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=202, pq.top=201
E20240204 15:25:04.725018 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=25432
W20240204 15:25:04.845682 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
W20240204 15:25:05.482828 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=211, pq.top=211
E20240204 15:25:05.725013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=11029
W20240204 15:25:05.967546 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240204 15:25:06.725013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=834
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 336.595 us                | 3.348 ms                  |
| ProcessBack:Shuffle       | 8.630 ms                  | 29.521 ms                 |
| ProcessBack:UpdateCache   | 11.442 ms                 | 18.739 ms                 |
| ProcessBack:UpsertPq      | 34.754 ms                 | 168.080 ms                |
| ProcessOneStep            | 100.993 ms                | 1.409 s                   |
| BlockToStepN              | 1.161 ms                  | 32.849 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.052 ms                  | 280.889 ms                |
| Forward                   | 5.466 ms                  | 17.405 ms                 |
| Backward                  | 5.509 ms                  | 8.626 ms                  |
| Optimize                  | 2.597 ms                  | 9.170 ms                  |
| BarrierTimeBeforeRank0    | 1.823 ms                  | 119.628 ms                |
| AfterBackward             | 101.038 ms                | 1.410 s                   |
| BlockToStepN              | 1.256 ms                  | 32.935 ms                 |
| OneStep                   | 136.450 ms                | 1.442 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:07.051085 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240204 15:25:07.057104 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 15:25:07.725020 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=6326
W20240204 15:25:08.051359 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240204 15:25:08.117705 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240204 15:25:08.725011 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=305
W20240204 15:25:09.051129 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=227, pq.top=227
E20240204 15:25:09.105309 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=227, sample_step_cpp_seen_[rank]=226
W20240204 15:25:09.285002 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240204 15:25:09.731894 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 15:25:10.290755 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240204 15:25:10.332851 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=228, pq.top=228
E20240204 15:25:10.731010 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=1352
W20240204 15:25:11.388955 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240204 15:25:11.391882 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240204 15:25:11.731063 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 425.775 us                | 10.155 ms                 |
| ProcessBack:Shuffle       | 8.733 ms                  | 21.381 ms                 |
| ProcessBack:UpdateCache   | 11.495 ms                 | 18.100 ms                 |
| ProcessBack:UpsertPq      | 34.754 ms                 | 162.690 ms                |
| ProcessOneStep            | 100.562 ms                | 1.409 s                   |
| BlockToStepN              | 1.213 ms                  | 38.316 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.280 ms                  | 280.889 ms                |
| Forward                   | 5.463 ms                  | 17.405 ms                 |
| Backward                  | 5.555 ms                  | 8.626 ms                  |
| Optimize                  | 2.587 ms                  | 9.170 ms                  |
| BarrierTimeBeforeRank0    | 1.657 ms                  | 119.628 ms                |
| AfterBackward             | 100.615 ms                | 1.410 s                   |
| BlockToStepN              | 1.310 ms                  | 38.447 ms                 |
| OneStep                   | 138.429 ms                | 1.442 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:12.437199 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240204 15:25:12.731019 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=2524
W20240204 15:25:13.518785 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240204 15:25:13.731010 38043 parallel_pq_v2.h:79] insert failed, size(hashtable)=16025
W20240204 15:25:13.838016 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240204 15:25:14.620448 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
E20240204 15:25:14.735366 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 15:25:14.847604 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=249, pq.top=249
E20240204 15:25:15.703907 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=256, sample_step_cpp_seen_[rank]=255
W20240204 15:25:15.729609 41069 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240204 15:25:15.735006 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=2517
W20240204 15:25:15.887929 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=257, pq.top=257
E20240204 15:25:16.735013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=5296
W20240204 15:25:16.770808 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 328.270 us                | 3.346 ms                  |
| ProcessBack:Shuffle       | 8.832 ms                  | 21.381 ms                 |
| ProcessBack:UpdateCache   | 11.376 ms                 | 18.187 ms                 |
| ProcessBack:UpsertPq      | 34.273 ms                 | 162.690 ms                |
| ProcessOneStep            | 101.090 ms                | 1.409 s                   |
| BlockToStepN              | 1.271 ms                  | 38.316 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.104 ms                  | 244.868 ms                |
| Forward                   | 5.488 ms                  | 12.367 ms                 |
| Backward                  | 5.562 ms                  | 8.540 ms                  |
| Optimize                  | 2.610 ms                  | 8.960 ms                  |
| BarrierTimeBeforeRank0    | 1.684 ms                  | 108.773 ms                |
| AfterBackward             | 101.135 ms                | 1.410 s                   |
| BlockToStepN              | 1.368 ms                  | 38.447 ms                 |
| OneStep                   | 143.293 ms                | 1.442 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:17.038398 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=259, pq.top=259
E20240204 15:25:17.735009 38043 parallel_pq_v2.h:79] insert failed, size(hashtable)=16949
W20240204 15:25:17.806632 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
W20240204 15:25:18.119769 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=265, pq.top=265
E20240204 15:25:18.735013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=8794
W20240204 15:25:18.985744 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240204 15:25:19.735016 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=6438
W20240204 15:25:20.041985 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 15:25:20.735013 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
W20240204 15:25:21.063936 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
W20240204 15:25:21.622728 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=281, pq.top=280
E20240204 15:25:21.735750 41423 parallel_pq_v2.h:79] insert failed, size(hashtable)=55846
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 497.125 us                | 22.328 ms                 |
| ProcessBack:Shuffle       | 8.934 ms                  | 21.156 ms                 |
| ProcessBack:UpdateCache   | 11.352 ms                 | 18.100 ms                 |
| ProcessBack:UpsertPq      | 34.754 ms                 | 168.080 ms                |
| ProcessOneStep            | 101.164 ms                | 1.409 s                   |
| BlockToStepN              | 1.329 ms                  | 53.302 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.042 ms                  | 244.868 ms                |
| Forward                   | 5.509 ms                  | 17.405 ms                 |
| Backward                  | 5.587 ms                  | 8.626 ms                  |
| Optimize                  | 2.640 ms                  | 9.170 ms                  |
| BarrierTimeBeforeRank0    | 1.684 ms                  | 108.773 ms                |
| AfterBackward             | 102.488 ms                | 1.410 s                   |
| BlockToStepN              | 1.447 ms                  | 53.391 ms                 |
| OneStep                   | 143.763 ms                | 1.442 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:22.215166 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
W20240204 15:25:22.640472 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=289, pq.top=289
E20240204 15:25:22.735018 41406 parallel_pq_v2.h:79] insert failed, size(hashtable)=47318
E20240204 15:25:22.801623 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=290, sample_step_cpp_seen_[rank]=289
W20240204 15:25:23.380316 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240204 15:25:23.735024 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
W20240204 15:25:23.988534 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240204 15:25:24.381955 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240204 15:25:24.735008 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=53881
W20240204 15:25:25.179984 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=299, pq.top=298
[proc 0] 300 steps, total: 21.197, sample: 1.626, forward: 0.589, backward: 0.609, update: 0.325
[proc 7] 300 steps, total: 21.197, sample: 0.986, forward: 0.548, backward: 0.659, update: 0.236
[proc 3] 300 steps, total: 21.197, sample: 1.159, forward: 0.539, backward: 0.703, update: 0.246
[proc 6] 300 steps, total: 21.197, sample: 1.114, forward: 0.558, backward: 0.677, update: 0.244
[proc 1] 300 steps, total: 21.197, sample: 1.872, forward: 0.568, backward: 0.665, update: 0.249
[proc 2] 300 steps, total: 21.197, sample: 1.185, forward: 0.531, backward: 0.622, update: 0.234
[proc 4] 300 steps, total: 21.197, sample: 1.209, forward: 0.581, backward: 0.632, update: 0.245
[proc 5] 300 steps, total: 21.197, sample: 1.232, forward: 0.583, backward: 0.583, update: 0.236
W20240204 15:25:25.467952 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240204 15:25:25.735013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=91719
W20240204 15:25:26.582542 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240204 15:25:26.735013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=1665
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 402.638 us                | 18.825 ms                 |
| ProcessBack:Shuffle       | 9.047 ms                  | 21.156 ms                 |
| ProcessBack:UpdateCache   | 11.413 ms                 | 18.100 ms                 |
| ProcessBack:UpsertPq      | 33.827 ms                 | 168.080 ms                |
| ProcessOneStep            | 101.164 ms                | 1.409 s                   |
| BlockToStepN              | 1.366 ms                  | 53.302 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.953 ms                  | 244.868 ms                |
| Forward                   | 5.524 ms                  | 17.405 ms                 |
| Backward                  | 5.592 ms                  | 9.850 ms                  |
| Optimize                  | 2.634 ms                  | 11.148 ms                 |
| BarrierTimeBeforeRank0    | 1.906 ms                  | 108.773 ms                |
| AfterBackward             | 101.207 ms                | 1.410 s                   |
| BlockToStepN              | 1.491 ms                  | 53.391 ms                 |
| OneStep                   | 143.293 ms                | 1.442 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:27.627981 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240204 15:25:27.735016 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=5005
W20240204 15:25:28.715279 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=317, pq.top=317
E20240204 15:25:28.735055 41409 parallel_pq_v2.h:79] insert failed, size(hashtable)=143332
W20240204 15:25:28.879792 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240204 15:25:29.322404 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=321, sample_step_cpp_seen_[rank]=320
E20240204 15:25:29.735025 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=5400
W20240204 15:25:29.984323 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
W20240204 15:25:30.678923 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=324, pq.top=324
E20240204 15:25:30.735011 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=1080
W20240204 15:25:31.004571 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
E20240204 15:25:31.735013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=3131
W20240204 15:25:31.754226 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=330, pq.top=330
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 442.694 us                | 11.733 ms                 |
| ProcessBack:Shuffle       | 9.029 ms                  | 21.082 ms                 |
| ProcessBack:UpdateCache   | 11.315 ms                 | 17.905 ms                 |
| ProcessBack:UpsertPq      | 33.552 ms                 | 162.690 ms                |
| ProcessOneStep            | 102.765 ms                | 1.409 s                   |
| BlockToStepN              | 1.337 ms                  | 54.458 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.862 ms                  | 244.868 ms                |
| Forward                   | 5.526 ms                  | 17.405 ms                 |
| Backward                  | 5.600 ms                  | 9.850 ms                  |
| Optimize                  | 2.640 ms                  | 11.148 ms                 |
| BarrierTimeBeforeRank0    | 1.947 ms                  | 119.628 ms                |
| AfterBackward             | 102.825 ms                | 1.410 s                   |
| BlockToStepN              | 1.482 ms                  | 54.570 ms                 |
| OneStep                   | 142.031 ms                | 1.442 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:32.100219 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240204 15:25:32.735018 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240204 15:25:33.013592 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240204 15:25:33.168283 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240204 15:25:33.735013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240204 15:25:34.077359 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=341, pq.top=341
W20240204 15:25:34.208523 41069 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240204 15:25:34.735014 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=8226
W20240204 15:25:35.141317 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=348, pq.top=348
W20240204 15:25:35.255220 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240204 15:25:35.735018 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=55255
W20240204 15:25:36.215855 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=355, pq.top=355
W20240204 15:25:36.265209 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240204 15:25:36.385672 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=356, sample_step_cpp_seen_[rank]=355
E20240204 15:25:36.735013 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=1612
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 459.772 us                | 25.364 ms                 |
| ProcessBack:Shuffle       | 9.040 ms                  | 21.629 ms                 |
| ProcessBack:UpdateCache   | 11.315 ms                 | 17.905 ms                 |
| ProcessBack:UpsertPq      | 33.193 ms                 | 162.690 ms                |
| ProcessOneStep            | 101.164 ms                | 1.386 s                   |
| BlockToStepN              | 1.444 ms                  | 54.458 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.801 ms                  | 230.785 ms                |
| Forward                   | 5.524 ms                  | 12.590 ms                 |
| Backward                  | 5.615 ms                  | 9.850 ms                  |
| Optimize                  | 2.661 ms                  | 9.170 ms                  |
| BarrierTimeBeforeRank0    | 1.956 ms                  | 108.773 ms                |
| AfterBackward             | 101.207 ms                | 1.386 s                   |
| BlockToStepN              | 1.558 ms                  | 54.570 ms                 |
| OneStep                   | 143.293 ms                | 1.411 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:37.316856 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
W20240204 15:25:37.593171 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240204 15:25:37.736405 41405 parallel_pq_v2.h:79] insert failed, size(hashtable)=1948
W20240204 15:25:38.349238 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
W20240204 15:25:38.601397 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=363, pq.top=363
E20240204 15:25:38.736019 41411 parallel_pq_v2.h:79] insert failed, size(hashtable)=124607
W20240204 15:25:39.480556 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240204 15:25:39.736351 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=68960
W20240204 15:25:39.793603 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240204 15:25:40.690639 41069 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240204 15:25:40.736011 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=65
E20240204 15:25:41.385011 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=373, sample_step_cpp_seen_[rank]=372
W20240204 15:25:41.699846 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 15:25:41.736014 41429 parallel_pq_v2.h:79] insert failed, size(hashtable)=30215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 363.979 us                | 3.873 ms                  |
| ProcessBack:Shuffle       | 8.993 ms                  | 21.629 ms                 |
| ProcessBack:UpdateCache   | 11.269 ms                 | 17.905 ms                 |
| ProcessBack:UpsertPq      | 33.386 ms                 | 162.690 ms                |
| ProcessOneStep            | 102.434 ms                | 1.386 s                   |
| BlockToStepN              | 1.501 ms                  | 56.075 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:41.854923 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.717 ms                  | 230.785 ms                |
| Forward                   | 5.515 ms                  | 17.405 ms                 |
| Backward                  | 5.603 ms                  | 9.850 ms                  |
| Optimize                  | 2.653 ms                  | 9.170 ms                  |
| BarrierTimeBeforeRank0    | 1.947 ms                  | 119.628 ms                |
| AfterBackward             | 102.488 ms                | 1.386 s                   |
| BlockToStepN              | 1.606 ms                  | 56.207 ms                 |
| OneStep                   | 144.309 ms                | 1.411 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 15:25:42.736012 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=2072
W20240204 15:25:42.841521 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
W20240204 15:25:42.882953 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=384, pq.top=384
E20240204 15:25:43.736014 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
W20240204 15:25:43.888342 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240204 15:25:44.736012 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=248
W20240204 15:25:44.924855 41069 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240204 15:25:45.500722 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=391, pq.top=391
E20240204 15:25:45.736014 41434 parallel_pq_v2.h:79] insert failed, size(hashtable)=8415
W20240204 15:25:45.937706 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
W20240204 15:25:46.500362 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=398, pq.top=398
E20240204 15:25:46.736115 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
[proc 0] 400 steps, total: 21.488, sample: 1.350, forward: 0.574, backward: 0.593, update: 0.310
[proc 4] 400 steps, total: 21.488, sample: 1.685, forward: 0.565, backward: 0.648, update: 0.264
[proc 3] 400 steps, total: 21.488, sample: 1.101, forward: 0.575, backward: 0.593, update: 0.245
[proc 5] 400 steps, total: 21.488, sample: 0.942, forward: 0.558, backward: 0.601, update: 0.235
[proc 1] 400 steps, total: 21.488, sample: 1.541, forward: 0.537, backward: 0.744, update: 0.224
[proc 7] 400 steps, total: 21.488, sample: 1.120, forward: 0.582, backward: 0.619, update: 0.291
[proc 6] 400 steps, total: 21.488, sample: 1.044, forward: 0.570, backward: 0.633, update: 0.243
[proc 2] 400 steps, total: 21.488, sample: 1.091, forward: 0.529, backward: 0.638, update: 0.242
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 541.737 us                | 14.783 ms                 |
| ProcessBack:Shuffle       | 8.974 ms                  | 21.381 ms                 |
| ProcessBack:UpdateCache   | 11.167 ms                 | 17.881 ms                 |
| ProcessBack:UpsertPq      | 32.994 ms                 | 162.690 ms                |
| ProcessOneStep            | 102.434 ms                | 1.386 s                   |
| BlockToStepN              | 1.587 ms                  | 91.003 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.573 ms                  | 230.785 ms                |
| Forward                   | 5.524 ms                  | 17.405 ms                 |
| Backward                  | 5.618 ms                  | 10.200 ms                 |
| Optimize                  | 2.670 ms                  | 9.170 ms                  |
| BarrierTimeBeforeRank0    | 1.931 ms                  | 119.628 ms                |
| AfterBackward             | 102.825 ms                | 1.386 s                   |
| BlockToStepN              | 1.743 ms                  | 91.158 ms                 |
| OneStep                   | 144.309 ms                | 1.411 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:47.122767 41069 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240204 15:25:47.509604 34781 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=405, sample_step_cpp_seen_[rank]=404
E20240204 15:25:47.736009 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=12685
W20240204 15:25:48.215348 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240204 15:25:48.736008 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=167
W20240204 15:25:49.238736 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240204 15:25:49.261325 41069 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
E20240204 15:25:49.736011 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=70848
W20240204 15:25:50.270946 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240204 15:25:50.478298 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240204 15:25:50.736014 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=195
W20240204 15:25:51.526253 41069 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240204 15:25:51.736012 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=104
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 481.681 us                | 24.952 ms                 |
| ProcessBack:Shuffle       | 8.960 ms                  | 21.381 ms                 |
| ProcessBack:UpdateCache   | 11.140 ms                 | 17.881 ms                 |
| ProcessBack:UpsertPq      | 32.994 ms                 | 162.690 ms                |
| ProcessOneStep            | 102.765 ms                | 1.386 s                   |
| BlockToStepN              | 1.782 ms                  | 98.800 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.639 ms                  | 230.785 ms                |
| Forward                   | 5.534 ms                  | 17.405 ms                 |
| Backward                  | 5.617 ms                  | 10.202 ms                 |
| Optimize                  | 2.670 ms                  | 9.170 ms                  |
| BarrierTimeBeforeRank0    | 1.908 ms                  | 119.628 ms                |
| AfterBackward             | 102.825 ms                | 1.386 s                   |
| BlockToStepN              | 1.872 ms                  | 98.996 ms                 |
| OneStep                   | 144.379 ms                | 1.411 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:52.568270 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240204 15:25:52.736016 41417 parallel_pq_v2.h:79] insert failed, size(hashtable)=148675
W20240204 15:25:53.144688 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=432, pq.top=432
E20240204 15:25:53.736012 41411 parallel_pq_v2.h:79] insert failed, size(hashtable)=29468
W20240204 15:25:53.758651 41069 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
W20240204 15:25:54.420456 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240204 15:25:54.527259 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=439, sample_step_cpp_seen_[rank]=438
E20240204 15:25:54.736016 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=5512
W20240204 15:25:54.915092 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
W20240204 15:25:55.688887 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=441, pq.top=441
E20240204 15:25:55.736078 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240204 15:25:55.944545 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
W20240204 15:25:56.711210 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=450, pq.top=450
E20240204 15:25:56.736142 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=65219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 460.035 us                | 22.873 ms                 |
| ProcessBack:Shuffle       | 8.916 ms                  | 21.381 ms                 |
| ProcessBack:UpdateCache   | 10.955 ms                 | 17.792 ms                 |
| ProcessBack:UpsertPq      | 32.135 ms                 | 158.945 ms                |
| ProcessOneStep            | 101.164 ms                | 1.386 s                   |
| BlockToStepN              | 1.802 ms                  | 123.075 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.850 ms                  | 203.458 ms                |
| Forward                   | 5.525 ms                  | 14.205 ms                 |
| Backward                  | 5.635 ms                  | 10.200 ms                 |
| Optimize                  | 2.662 ms                  | 8.960 ms                  |
| BarrierTimeBeforeRank0    | 1.870 ms                  | 108.773 ms                |
| AfterBackward             | 101.207 ms                | 1.301 s                   |
| BlockToStepN              | 1.905 ms                  | 98.996 ms                 |
| OneStep                   | 144.309 ms                | 1.335 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:25:57.148929 41069 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 15:25:57.737582 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 15:25:58.189476 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
W20240204 15:25:58.433733 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=455, pq.top=455
E20240204 15:25:58.737012 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=46895
W20240204 15:25:59.249809 41069 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
W20240204 15:25:59.466380 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=464, pq.top=464
E20240204 15:25:59.737011 34781 parallel_pq_v2.h:79] insert failed, size(hashtable)=4980
E20240204 15:25:59.935309 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=468, sample_step_cpp_seen_[rank]=467
W20240204 15:26:00.353001 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240204 15:26:00.737012 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=7450
W20240204 15:26:01.375960 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240204 15:26:01.737015 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=69455
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 499.267 us                | 12.363 ms                 |
| ProcessBack:Shuffle       | 8.899 ms                  | 21.381 ms                 |
| ProcessBack:UpdateCache   | 10.873 ms                 | 17.792 ms                 |
| ProcessBack:UpsertPq      | 31.759 ms                 | 162.690 ms                |
| ProcessOneStep            | 101.090 ms                | 1.339 s                   |
| BlockToStepN              | 1.865 ms                  | 98.800 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.850 ms                  | 203.458 ms                |
| Forward                   | 5.514 ms                  | 14.205 ms                 |
| Backward                  | 5.638 ms                  | 10.200 ms                 |
| Optimize                  | 2.656 ms                  | 8.960 ms                  |
| BarrierTimeBeforeRank0    | 1.870 ms                  | 108.773 ms                |
| AfterBackward             | 101.207 ms                | 1.339 s                   |
| BlockToStepN              | 1.944 ms                  | 98.996 ms                 |
| OneStep                   | 143.763 ms                | 1.366 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:26:02.438860 41069 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240204 15:26:02.737010 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=135768
W20240204 15:26:02.981909 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=479, pq.top=478
W20240204 15:26:03.473783 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240204 15:26:03.737030 41425 parallel_pq_v2.h:79] insert failed, size(hashtable)=160711
W20240204 15:26:04.230406 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240204 15:26:04.501410 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240204 15:26:04.741176 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240204 15:26:04.935011 38043 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=487, sample_step_cpp_seen_[rank]=486
W20240204 15:26:05.581753 41069 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240204 15:26:05.741011 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=7975
W20240204 15:26:05.980630 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=489, pq.top=489
W20240204 15:26:06.708287 41069 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
E20240204 15:26:06.741006 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=1310
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 404.028 us                | 8.049 ms                  |
| ProcessBack:Shuffle       | 8.901 ms                  | 21.156 ms                 |
| ProcessBack:UpdateCache   | 10.809 ms                 | 17.745 ms                 |
| ProcessBack:UpsertPq      | 31.759 ms                 | 168.080 ms                |
| ProcessOneStep            | 101.090 ms                | 1.386 s                   |
| BlockToStepN              | 1.967 ms                  | 123.075 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.960 ms                  | 216.054 ms                |
| Forward                   | 5.534 ms                  | 14.205 ms                 |
| Backward                  | 5.635 ms                  | 10.200 ms                 |
| Optimize                  | 2.656 ms                  | 8.960 ms                  |
| BarrierTimeBeforeRank0    | 1.719 ms                  | 108.773 ms                |
| AfterBackward             | 101.207 ms                | 1.386 s                   |
| BlockToStepN              | 2.062 ms                  | 123.199 ms                |
| OneStep                   | 144.309 ms                | 1.411 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 15:26:07.139806 34781 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=497, pq.top=497
[proc 3] 500 steps, total: 20.850, sample: 1.017, forward: 0.521, backward: 0.747, update: 0.232
[proc 0] 500 steps, total: 20.850, sample: 2.062, forward: 0.575, backward: 0.572, update: 0.267
[proc 2] 500 steps, total: 20.850, sample: 1.183, forward: 0.565, backward: 0.752, update: 0.242
[proc 4] 500 steps, total: 20.850, sample: 1.160, forward: 0.559, backward: 0.642, update: 0.243
[proc 6] 500 steps, total: 20.850, sample: 1.116, forward: 0.583, backward: 0.629, update: 0.251
[proc 7] 500 steps, total: 20.850, sample: 0.911, forward: 0.569, backward: 0.593, update: 0.244
Successfully xmh. training takes 110.7706093788147 seconds
[proc 1] 500 steps, total: 20.850, sample: 1.415, forward: 0.621, backward: 0.533, update: 0.246
before call kg_cache_controller.StopThreads()
[proc 5] 500 steps, total: 20.850, sample: 0.984, forward: 0.591, backward: 0.652, update: 0.233
W20240204 15:26:07.617713 34781 grad_async_v2.h:84] call StopThreads. PID = 7079
W20240204 15:26:07.617754 34781 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 15:26:07.618692 34781 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 15:26:07.618721 34781 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
E20240204 15:26:07.741017 41069 parallel_pq_v2.h:79] insert failed, size(hashtable)=34002
W20240204 15:26:07.937197 41069 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 15:26:08.742305 41421 parallel_pq_v2.h:79] insert failed, size(hashtable)=1888
W20240204 15:26:08.876009 34781 grad_async_v2.h:105] StopThreads done.
