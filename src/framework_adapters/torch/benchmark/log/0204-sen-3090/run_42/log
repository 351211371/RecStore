WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 22:23:40.266359 25932 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_100', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=8, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [25932 sampler.py:454] Start PreSampling
WARNING [25932 sampler.py:532] Before construct renumbering_dict
WARNING [25932 sampler.py:555] PreSampling done
W20240204 22:43:41.910079 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 22:43:41.910264 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 22:43:41.910305 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 22:43:41.910341 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 22:43:41.910372 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 22:43:41.910408 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 22:43:41.910447 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 22:43:41.910481 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 22:43:41.910517 25932 IPCTensor.h:369] NewIPCTensor: step_r0 [8]0x100003d1a000 64 B 
W20240204 22:43:41.910543 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100003d1c000 8 B 
W20240204 22:43:41.910573 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100003d1e000 8 B 
W20240204 22:43:41.910738 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100003d20000 7.629 MB
W20240204 22:43:41.910778 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000044c3000 7.629 MB
W20240204 22:43:41.910806 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100004c66000 7.629 MB
W20240204 22:43:41.910835 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100005409000 7.629 MB
W20240204 22:43:41.910868 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100005bac000 7.629 MB
W20240204 22:43:41.910907 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x10000634f000 7.629 MB
W20240204 22:43:41.910938 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100006af2000 7.629 MB
W20240204 22:43:41.910969 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100007295000 7.629 MB
W20240204 22:43:41.910998 25932 IPCTensor.h:369] NewIPCTensor: step_r1 [8]0x100007a38000 64 B 
W20240204 22:43:41.911022 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100007a3a000 8 B 
W20240204 22:43:41.911051 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100007a3c000 8 B 
W20240204 22:43:41.911103 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100007a3e000 7.629 MB
W20240204 22:43:41.911134 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000081e1000 7.629 MB
W20240204 22:43:41.911159 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100008984000 7.629 MB
W20240204 22:43:41.911188 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100009127000 7.629 MB
W20240204 22:43:41.911216 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000098ca000 7.629 MB
W20240204 22:43:41.911250 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000a06d000 7.629 MB
W20240204 22:43:41.911279 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000a810000 7.629 MB
W20240204 22:43:41.911309 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000afb3000 7.629 MB
W20240204 22:43:41.911339 25932 IPCTensor.h:369] NewIPCTensor: step_r2 [8]0x10000b756000 64 B 
W20240204 22:43:41.911361 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000b758000 8 B 
W20240204 22:43:41.911383 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000b75a000 8 B 
W20240204 22:43:41.911439 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000b75c000 7.629 MB
W20240204 22:43:41.911469 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000beff000 7.629 MB
W20240204 22:43:41.911497 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000c6a2000 7.629 MB
W20240204 22:43:41.911526 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000ce45000 7.629 MB
W20240204 22:43:41.911553 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10000d5e8000 7.629 MB
W20240204 22:43:41.911584 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10000dd8b000 7.629 MB
W20240204 22:43:41.911617 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10000e52e000 7.629 MB
W20240204 22:43:41.911643 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10000ecd1000 7.629 MB
W20240204 22:43:41.911676 25932 IPCTensor.h:369] NewIPCTensor: step_r3 [8]0x10000f474000 64 B 
W20240204 22:43:41.911698 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10000f476000 8 B 
W20240204 22:43:41.911720 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10000f478000 8 B 
W20240204 22:43:41.911769 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10000f47a000 7.629 MB
W20240204 22:43:41.911809 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x10000fc1d000 7.629 MB
W20240204 22:43:41.911842 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000103c0000 7.629 MB
W20240204 22:43:41.911870 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x100010b63000 7.629 MB
W20240204 22:43:41.911896 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x100011306000 7.629 MB
W20240204 22:43:41.911922 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x100011aa9000 7.629 MB
W20240204 22:43:41.911948 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x10001224c000 7.629 MB
W20240204 22:43:41.911981 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000129ef000 7.629 MB
W20240204 22:43:41.912011 25932 IPCTensor.h:369] NewIPCTensor: step_r4 [8]0x100013192000 64 B 
W20240204 22:43:41.912034 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100013194000 8 B 
W20240204 22:43:41.912066 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100013196000 8 B 
W20240204 22:43:41.912120 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100013198000 7.629 MB
W20240204 22:43:41.912153 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x10001393b000 7.629 MB
W20240204 22:43:41.912184 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000140de000 7.629 MB
W20240204 22:43:41.912212 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x100014881000 7.629 MB
W20240204 22:43:41.912243 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100015024000 7.629 MB
W20240204 22:43:41.912276 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000157c7000 7.629 MB
W20240204 22:43:41.912309 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x100015f6a000 7.629 MB
W20240204 22:43:41.912340 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001670d000 7.629 MB
W20240204 22:43:41.912374 25932 IPCTensor.h:369] NewIPCTensor: step_r5 [8]0x100016eb0000 64 B 
W20240204 22:43:41.912396 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x100016eb2000 8 B 
W20240204 22:43:41.912420 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100016eb4000 8 B 
W20240204 22:43:41.912470 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x100016eb6000 7.629 MB
W20240204 22:43:41.912505 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x100017659000 7.629 MB
W20240204 22:43:41.912532 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x100017dfc000 7.629 MB
W20240204 22:43:41.912564 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001859f000 7.629 MB
W20240204 22:43:41.912593 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x100018d42000 7.629 MB
W20240204 22:43:41.912623 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000194e5000 7.629 MB
W20240204 22:43:41.912662 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x100019c88000 7.629 MB
W20240204 22:43:41.912698 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001a42b000 7.629 MB
W20240204 22:43:41.912725 25932 IPCTensor.h:369] NewIPCTensor: step_r6 [8]0x10001abce000 64 B 
W20240204 22:43:41.912747 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x10001abd0000 8 B 
W20240204 22:43:41.912775 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10001abd2000 8 B 
W20240204 22:43:41.912823 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10001abd4000 7.629 MB
W20240204 22:43:41.912854 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10001b377000 7.629 MB
W20240204 22:43:41.912881 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10001bb1a000 7.629 MB
W20240204 22:43:41.912909 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x10001c2bd000 7.629 MB
W20240204 22:43:41.912937 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10001ca60000 7.629 MB
W20240204 22:43:41.912971 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x10001d203000 7.629 MB
W20240204 22:43:41.912997 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x10001d9a6000 7.629 MB
W20240204 22:43:41.913028 25932 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x10001e149000 7.629 MB
W20240204 22:43:41.913072 25932 IPCTensor.h:369] NewIPCTensor: step_r7 [8]0x10001e8ec000 64 B 
W20240204 22:43:41.913095 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10001e8ee000 8 B 
W20240204 22:43:41.913127 25932 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10001e8f0000 8 B 
W20240204 22:43:42.338379 25932 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x10001e8f2000 128.2 GB
W20240204 22:52:20.172425 25932 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10202d52a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302722,  4302755,   102606,  ..., 58460792, 52866882,  5150762]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2230.288 seconds
[Rank1] pid = 51947
[Rank2] pid = 52042
[Rank3] pid = 52111
[Rank4] pid = 52270
[Rank5] pid = 52448
[Rank6] pid = 52613
INFO [25932 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [51947 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [52042 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [52111 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [52448 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [52270 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [52613 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [52801 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [52801 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52613 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52270 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52111 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 23:01:00.948508 52802 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240204 23:01:00.948691 52271 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240204 23:01:00.948693 52614 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
INFO [52448 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 23:01:00.949690 52112 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
INFO [25932 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51947 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52042 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 23:01:00.953739 52873 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240204 23:01:00.954732 52449 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240204 23:01:00.955294 52043 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240204 23:01:00.955539 51948 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240204 23:01:01.025703 52271 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102041d73000 7.629 MB
W20240204 23:01:01.025880 52271 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204251c000 7.629 MB
W20240204 23:01:01.025950 52271 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x102042cc1000 1.49 GB
W20240204 23:01:01.025995 52271 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1020a22a4000 1.49 GB
W20240204 23:01:01.026031 52271 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 23:01:01.026051 52449 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x102101887000 7.629 MB
W20240204 23:01:01.026063 52043 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10210202a000 7.629 MB
W20240204 23:01:01.026072 51948 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1021027cd000 7.629 MB
W20240204 23:01:01.026073 52802 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x102102f70000 7.629 MB
W20240204 23:01:01.026227 52449 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102103713000 7.629 MB
W20240204 23:01:01.026243 52043 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102103eb6000 7.629 MB
W20240204 23:01:01.026273 51948 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102104659000 7.629 MB
W20240204 23:01:01.026293 52802 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x102104dfc000 7.629 MB
W20240204 23:01:01.026319 52449 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10210559f000 1.49 GB
W20240204 23:01:01.026337 52043 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102164b82000 1.49 GB
W20240204 23:01:01.026368 52449 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1021c4165000 1.49 GB
W20240204 23:01:01.026391 52043 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102223748000 1.49 GB
W20240204 23:01:01.026399 51948 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x102282d2b000 1.49 GB
W20240204 23:01:01.026433 52449 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 23:01:01.026435 52802 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1022e230e000 1.49 GB
W20240204 23:01:01.026443 52043 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 23:01:01.026480 51948 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1023418f1000 1.49 GB
W20240204 23:01:01.026513 52802 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1023a0ed4000 1.49 GB
W20240204 23:01:01.026546 51948 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 23:01:01.026568 52802 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 23:01:01.043604 52873 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1024004b9000 7.629 MB
W20240204 23:01:01.043740 52873 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102400c5c000 7.629 MB
W20240204 23:01:01.043792 52873 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1024013ff000 1.49 GB
W20240204 23:01:01.043830 52873 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1024609e2000 1.49 GB
W20240204 23:01:01.043871 52873 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 23:01:01.054003 52449 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 23:01:01.054009 52043 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 23:01:01.054013 51948 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 23:01:01.054013 52802 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 23:01:01.054023 52271 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 23:01:01.054029 52873 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 23:01:01.054147 52112 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1024bffd3000 7.629 MB
W20240204 23:01:01.054337 52112 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1024c0776000 7.629 MB
W20240204 23:01:01.054422 52112 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1024c0f19000 1.49 GB
W20240204 23:01:01.054478 52112 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1025204fc000 1.49 GB
W20240204 23:01:01.054528 52112 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 23:01:01.065928 52614 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10257fae1000 7.629 MB
W20240204 23:01:01.066200 52614 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10258028e000 7.629 MB
W20240204 23:01:01.066354 52614 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x102580a31000 1.49 GB
W20240204 23:01:01.066452 52614 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1025e0014000 1.49 GB
W20240204 23:01:01.066555 52614 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 23:01:01.066684 52112 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 23:01:01.071779 52614 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
cudaHostRegister 0x10001e8f2000
7: KnownLocalCachedEmbedding init done
WARNING [52801 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x10001e8f2000
4: KnownLocalCachedEmbedding init done
WARNING [52270 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [52042 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 52801
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x10001e8f2000
0: KnownLocalCachedEmbedding init done
WARNING [25932 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
3: KnownLocalCachedEmbedding init done
WARNING [52111 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
6: KnownLocalCachedEmbedding init done
WARNING [52613 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
1: KnownLocalCachedEmbedding init done
WARNING [51947 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001e8f2000
5: KnownLocalCachedEmbedding init done
WARNING [52448 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 23:01:52.141683 51948 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 23:01:52.141786 52449 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 23:01:52.142045 52112 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 23:01:52.142349 52802 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 23:01:52.142630 52271 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 23:01:52.142773 52614 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 23:01:52.142841 52873 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 23:01:52.142964 52043 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 23:01:52.145841 52873 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 8,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 23:01:52.146135 52873 grad_base.h:184] Init GradProcessingBase done
I20240204 23:02:04.749673 52873 grad_async_v1.h:203] Use main thread to update emb.
W20240204 23:02:04.749819 52873 kg_controller.h:75] after init GradAsyncProcessing
I20240204 23:02:04.749830 52873 kg_controller.h:84] Construct KGCacheController done
E20240204 23:02:05.553366 51948 recstore.cc:66] init folly done
E20240204 23:02:05.553431 52043 recstore.cc:66] init folly done
E20240204 23:02:05.553431 52614 recstore.cc:66] init folly done
E20240204 23:02:05.553464 52112 recstore.cc:66] init folly done
E20240204 23:02:05.553500 52873 recstore.cc:66] init folly done
E20240204 23:02:05.553516 52802 recstore.cc:66] init folly done
E20240204 23:02:05.553676 52449 recstore.cc:66] init folly done
E20240204 23:02:05.553725 52271 recstore.cc:66] init folly done
I20240204 23:02:05.554688 52873 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 23:02:28.761701 52449 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 23:02:28.801266 52802 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 23:02:28.807868 52112 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 23:02:29.314998 52271 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 23:02:30.498625 52043 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 23:02:31.849484 51948 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 23:02:32.420286 52873 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 23:02:33.459326 52614 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 307.065 ms                | 334.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:02:35.677762 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240204 23:02:36.678799 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.069 ms                  | 9.576 ms                  |
| Forward                   | 6.471 ms                  | 727.415 ms                |
| Backward                  | 9.694 ms                  | 193.166 ms                |
| Optimize                  | 2.631 ms                  | 2.682 ms                  |
| BarrierTimeBeforeRank0    | 497.587 us                | 21.559 ms                 |
| AfterBackward             | 56.024 ms                 | 1.263 s                   |
| BlockToStepN              | 11.677 ms                 | 828.791 ms                |
| OneStep                   | 88.439 ms                 | 3.048 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:02:37.678006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240204 23:02:38.678007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240204 23:02:39.678702 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.856 ms                  | 334.410 ms                |
| ProcessBack:UpdateCache   | 10.326 ms                 | 655.003 ms                |
| ProcessBack:UpsertPq      | 35.428 ms                 | 48.670 ms                 |
| ProcessOneStep            | 60.701 ms                 | 1.263 s                   |
| BlockToStepN              | 765.461 ms                | 826.628 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:02:40.767462 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=10, pq.top=10
W20240204 23:02:41.767006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=12, pq.top=12
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.068 ms                  | 86.190 ms                 |
| Forward                   | 5.034 ms                  | 727.415 ms                |
| Backward                  | 9.372 ms                  | 193.166 ms                |
| Optimize                  | 2.682 ms                  | 4.981 ms                  |
| BarrierTimeBeforeRank0    | 3.020 ms                  | 148.382 ms                |
| AfterBackward             | 56.387 ms                 | 1.263 s                   |
| BlockToStepN              | 11.677 ms                 | 832.270 ms                |
| OneStep                   | 290.344 ms                | 3.048 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:02:42.767014 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240204 23:02:43.767007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240204 23:02:44.767009 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.577 ms                  | 334.410 ms                |
| ProcessBack:UpdateCache   | 10.421 ms                 | 655.003 ms                |
| ProcessBack:UpsertPq      | 35.963 ms                 | 71.908 ms                 |
| ProcessOneStep            | 62.170 ms                 | 1.263 s                   |
| BlockToStepN              | 11.629 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:02:45.767005 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240204 23:02:46.767015 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.678 ms                  | 86.190 ms                 |
| Forward                   | 5.412 ms                  | 727.415 ms                |
| Backward                  | 4.841 ms                  | 193.166 ms                |
| Optimize                  | 2.682 ms                  | 4.981 ms                  |
| BarrierTimeBeforeRank0    | 5.317 ms                  | 148.382 ms                |
| AfterBackward             | 62.311 ms                 | 1.263 s                   |
| BlockToStepN              | 11.677 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 3.048 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:02:47.767007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240204 23:02:48.767006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240204 23:02:49.767007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.697 ms                  | 307.065 ms                |
| ProcessBack:UpdateCache   | 11.134 ms                 | 654.067 ms                |
| ProcessBack:UpsertPq      | 39.063 ms                 | 85.823 ms                 |
| ProcessOneStep            | 67.198 ms                 | 1.263 s                   |
| BlockToStepN              | 11.629 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:02:50.767005 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240204 23:02:51.767009 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.444 ms                  | 117.030 ms                |
| Forward                   | 5.477 ms                  | 727.415 ms                |
| Backward                  | 5.228 ms                  | 193.166 ms                |
| Optimize                  | 2.738 ms                  | 5.183 ms                  |
| BarrierTimeBeforeRank0    | 5.317 ms                  | 148.382 ms                |
| AfterBackward             | 67.236 ms                 | 1.263 s                   |
| BlockToStepN              | 11.677 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 3.048 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:02:52.767009 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240204 23:02:53.767010 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240204 23:02:54.767009 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.757 ms                  | 307.065 ms                |
| ProcessBack:UpdateCache   | 11.426 ms                 | 654.067 ms                |
| ProcessBack:UpsertPq      | 38.288 ms                 | 85.823 ms                 |
| ProcessOneStep            | 63.835 ms                 | 1.263 s                   |
| BlockToStepN              | 12.421 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:02:55.767006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240204 23:02:56.767005 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.525 ms                  | 117.030 ms                |
| Forward                   | 5.578 ms                  | 727.415 ms                |
| Backward                  | 5.121 ms                  | 193.166 ms                |
| Optimize                  | 2.708 ms                  | 5.183 ms                  |
| BarrierTimeBeforeRank0    | 5.317 ms                  | 148.382 ms                |
| AfterBackward             | 62.311 ms                 | 1.263 s                   |
| BlockToStepN              | 12.474 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 3.048 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:02:57.820137 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240204 23:02:58.868016 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240204 23:02:59.908872 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=46, pq.top=46
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.743 ms                  | 307.065 ms                |
| ProcessBack:UpdateCache   | 11.460 ms                 | 654.067 ms                |
| ProcessBack:UpsertPq      | 36.510 ms                 | 85.823 ms                 |
| ProcessOneStep            | 62.275 ms                 | 1.263 s                   |
| BlockToStepN              | 12.421 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:00.908010 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240204 23:03:01.908010 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.392 ms                  | 117.030 ms                |
| Forward                   | 5.477 ms                  | 727.415 ms                |
| Backward                  | 5.086 ms                  | 193.166 ms                |
| Optimize                  | 2.682 ms                  | 8.616 ms                  |
| BarrierTimeBeforeRank0    | 5.317 ms                  | 148.382 ms                |
| AfterBackward             | 62.311 ms                 | 1.263 s                   |
| BlockToStepN              | 12.474 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 3.048 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:02.908007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240204 23:03:03.908010 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240204 23:03:04.908010 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.810 ms                  | 307.065 ms                |
| ProcessBack:UpdateCache   | 11.510 ms                 | 654.067 ms                |
| ProcessBack:UpsertPq      | 37.693 ms                 | 85.823 ms                 |
| ProcessOneStep            | 64.970 ms                 | 120.718 ms                |
| BlockToStepN              | 765.461 ms                | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:05.908015 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240204 23:03:06.963400 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.444 ms                  | 110.797 ms                |
| Forward                   | 5.425 ms                  | 11.619 ms                 |
| Backward                  | 5.121 ms                  | 9.694 ms                  |
| Optimize                  | 2.666 ms                  | 5.183 ms                  |
| BarrierTimeBeforeRank0    | 5.392 ms                  | 66.723 ms                 |
| AfterBackward             | 64.417 ms                 | 120.751 ms                |
| BlockToStepN              | 12.474 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:07.963007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240204 23:03:08.963007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240204 23:03:10.012945 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.810 ms                  | 307.065 ms                |
| ProcessBack:UpdateCache   | 11.728 ms                 | 654.067 ms                |
| ProcessBack:UpsertPq      | 37.693 ms                 | 85.823 ms                 |
| ProcessOneStep            | 64.102 ms                 | 120.718 ms                |
| BlockToStepN              | 12.421 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:11.076292 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240204 23:03:12.090132 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=68, pq.top=68
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.444 ms                  | 110.797 ms                |
| Forward                   | 5.361 ms                  | 11.619 ms                 |
| Backward                  | 5.248 ms                  | 11.267 ms                 |
| Optimize                  | 2.666 ms                  | 5.183 ms                  |
| BarrierTimeBeforeRank0    | 5.317 ms                  | 66.723 ms                 |
| AfterBackward             | 63.841 ms                 | 120.751 ms                |
| BlockToStepN              | 12.474 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:13.090008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240204 23:03:14.090008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240204 23:03:15.090008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.797 ms                  | 307.065 ms                |
| ProcessBack:UpdateCache   | 11.537 ms                 | 654.067 ms                |
| ProcessBack:UpsertPq      | 36.510 ms                 | 85.823 ms                 |
| ProcessOneStep            | 62.170 ms                 | 120.718 ms                |
| BlockToStepN              | 12.421 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:16.090008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240204 23:03:17.090008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.451 ms                  | 110.797 ms                |
| Forward                   | 5.335 ms                  | 11.619 ms                 |
| Backward                  | 5.276 ms                  | 11.267 ms                 |
| Optimize                  | 2.682 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.392 ms                  | 66.723 ms                 |
| AfterBackward             | 61.631 ms                 | 120.751 ms                |
| BlockToStepN              | 12.474 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:18.119587 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240204 23:03:19.121006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240204 23:03:20.136180 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.797 ms                  | 27.830 ms                 |
| ProcessBack:UpdateCache   | 11.510 ms                 | 14.635 ms                 |
| ProcessBack:UpsertPq      | 35.998 ms                 | 84.696 ms                 |
| ProcessOneStep            | 61.593 ms                 | 120.718 ms                |
| BlockToStepN              | 12.421 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:21.136008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.329 ms                  | 110.797 ms                |
| Forward                   | 5.317 ms                  | 11.619 ms                 |
| Backward                  | 5.344 ms                  | 11.267 ms                 |
| Optimize                  | 2.708 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.019 ms                  | 66.723 ms                 |
| AfterBackward             | 61.434 ms                 | 120.751 ms                |
| BlockToStepN              | 12.474 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:22.305910 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240204 23:03:23.401567 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240204 23:03:24.433152 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240204 23:03:25.468703 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.768 ms                  | 27.830 ms                 |
| ProcessBack:UpdateCache   | 11.502 ms                 | 14.635 ms                 |
| ProcessBack:UpsertPq      | 36.510 ms                 | 84.696 ms                 |
| ProcessOneStep            | 62.170 ms                 | 120.718 ms                |
| BlockToStepN              | 12.421 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:26.468014 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.392 ms                  | 110.797 ms                |
| Forward                   | 5.311 ms                  | 11.619 ms                 |
| Backward                  | 5.373 ms                  | 11.267 ms                 |
| Optimize                  | 2.708 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.392 ms                  | 80.195 ms                 |
| AfterBackward             | 61.631 ms                 | 120.751 ms                |
| BlockToStepN              | 12.474 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:27.468006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 59.566, sample: 1.296, forward: 1.265, backward: 1.094, update: 0.274
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 57.830, sample: 1.293, forward: 1.244, backward: 0.982, update: 0.263
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 59.013, sample: 1.416, forward: 1.260, backward: 0.809, update: 0.278
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 56.479, sample: 1.303, forward: 1.263, backward: 1.036, update: 0.262
train_sampler.Prefill()
-------Step 0-------
tensor([   72713,    72750,    72788,    72825,  5871736,   158974, 51644184,
        18149440, 19990360,    72851]) tensor([ 5211960, 15614372, 64134770, 70462558, 21252989, 29780236, 34410590,
        73984642, 74550979, 28199064])
-------Step 1-------
tensor([   72713,    72750,    72788,    72825,  5871736,   158974, 51644184,
        18149440, 19990360,    72851]) tensor([72682340, 29545154, 11034252, 83759231, 77494011, 44854788, 78102654,
        45217953, 35422458, 13296160])
-------Step 2-------
tensor([  185465,   185509,   185563,    38272,   185619,   185677,   185726,
        23680830,   185783,   185825]) tensor([66806778, 25430900, 83655341, 51929501, 43720741, 26916110, 73044240,
        43124292, 14263096, 43928453])
-------Step 3-------
tensor([  185465,   185509,   185563,    38272,   185619,   185677,   185726,
        23680830,   185783,   185825]) tensor([46541470, 80406697, 36361265, 35880210, 62020324, 68247306, 34331888,
        16713315, 25783364,   800401])
-------Step 4-------
tensor([  287598, 47879406,   287625,   200952,   287651,   200998,   287688,
        37496157,   287712,   287744]) tensor([76647262,  9827629, 78229351, 18868499, 67338272, 45315359, 61483791,
        35227449, 84762009, 48485459])
-------Step 5-------
tensor([  287598, 47879406,   287625,   200952,   287651,   200998,   287688,
        37496157,   287712,   287744]) tensor([35579831, 82374575,   317431, 78180690, 54398511, 57794446, 14971309,
         9376383, 76205883, 42359019])
-------Step 6-------
tensor([  350629,    78211,   350652,   350669,    78256, 69759575,   350698,
          350725,   222146, 34225898]) tensor([13616483, 39924138, 33545186, 83647392, 33829790, 34453051, 22934255,
         6798555, 63323086, 83919690])
-------Step 7-------
tensor([  350629,    78211,   350652,   350669,    78256, 69759575,   350698,
          350725,   222146, 34225898]) tensor([26390152, 55142256, 76030355, 61964683, 76464840, 51821507, 57293103,
        53313405, 37215226, 30393088])
before start barrier
start train
[proc 0] 100 steps, total: 55.908, sample: 1.614, forward: 1.277, backward: 0.803, update: 0.310
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 54.869, sample: 1.382, forward: 1.283, backward: 0.961, update: 0.257
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 59.520, sample: 1.465, forward: 1.242, backward: 1.042, update: 0.292
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 59.527, sample: 1.928, forward: 1.353, backward: 1.055, update: 0.268
W20240204 23:03:28.468006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240204 23:03:29.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240204 23:03:30.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.773 ms                  | 27.830 ms                 |
| ProcessBack:UpdateCache   | 11.450 ms                 | 14.635 ms                 |
| ProcessBack:UpsertPq      | 36.177 ms                 | 84.696 ms                 |
| ProcessOneStep            | 60.701 ms                 | 120.718 ms                |
| BlockToStepN              | 12.421 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:31.468006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.444 ms                  | 110.797 ms                |
| Forward                   | 5.317 ms                  | 11.619 ms                 |
| Backward                  | 5.344 ms                  | 11.424 ms                 |
| Optimize                  | 2.708 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.456 ms                  | 80.195 ms                 |
| AfterBackward             | 60.735 ms                 | 120.751 ms                |
| BlockToStepN              | 12.474 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:32.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240204 23:03:33.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240204 23:03:34.468006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240204 23:03:35.468005 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=114, pq.top=114
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.768 ms                  | 27.830 ms                 |
| ProcessBack:UpdateCache   | 11.410 ms                 | 14.635 ms                 |
| ProcessBack:UpsertPq      | 35.783 ms                 | 84.696 ms                 |
| ProcessOneStep            | 59.600 ms                 | 120.718 ms                |
| BlockToStepN              | 12.432 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:36.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.329 ms                  | 110.797 ms                |
| Forward                   | 5.311 ms                  | 11.619 ms                 |
| Backward                  | 5.445 ms                  | 11.424 ms                 |
| Optimize                  | 2.682 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.019 ms                  | 80.195 ms                 |
| AfterBackward             | 59.394 ms                 | 120.751 ms                |
| BlockToStepN              | 13.693 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:37.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240204 23:03:38.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240204 23:03:39.468006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240204 23:03:40.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.797 ms                  | 27.830 ms                 |
| ProcessBack:UpdateCache   | 11.134 ms                 | 14.635 ms                 |
| ProcessBack:UpsertPq      | 35.428 ms                 | 84.696 ms                 |
| ProcessOneStep            | 58.639 ms                 | 120.718 ms                |
| BlockToStepN              | 71.386 ms                 | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:41.468006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.392 ms                  | 110.797 ms                |
| Forward                   | 5.317 ms                  | 11.720 ms                 |
| Backward                  | 5.417 ms                  | 11.424 ms                 |
| Optimize                  | 2.671 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.161 ms                  | 99.903 ms                 |
| AfterBackward             | 58.536 ms                 | 120.751 ms                |
| BlockToStepN              | 71.430 ms                 | 976.170 ms                |
| OneStep                   | 290.344 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:42.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240204 23:03:43.468009 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240204 23:03:44.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240204 23:03:45.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.810 ms                  | 23.089 ms                 |
| ProcessBack:UpdateCache   | 11.395 ms                 | 14.184 ms                 |
| ProcessBack:UpsertPq      | 35.198 ms                 | 78.575 ms                 |
| ProcessOneStep            | 58.347 ms                 | 120.718 ms                |
| BlockToStepN              | 109.578 ms                | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:46.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.361 ms                  | 110.797 ms                |
| Forward                   | 5.311 ms                  | 11.720 ms                 |
| Backward                  | 5.344 ms                  | 11.424 ms                 |
| Optimize                  | 2.668 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.456 ms                  | 99.903 ms                 |
| AfterBackward             | 58.378 ms                 | 120.751 ms                |
| BlockToStepN              | 109.718 ms                | 976.170 ms                |
| OneStep                   | 290.344 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:47.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240204 23:03:48.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240204 23:03:49.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240204 23:03:50.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.813 ms                  | 23.089 ms                 |
| ProcessBack:UpdateCache   | 11.435 ms                 | 14.184 ms                 |
| ProcessBack:UpsertPq      | 35.148 ms                 | 78.575 ms                 |
| ProcessOneStep            | 58.304 ms                 | 120.718 ms                |
| BlockToStepN              | 109.578 ms                | 976.050 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:51.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.296 ms                  | 117.030 ms                |
| Forward                   | 5.311 ms                  | 11.720 ms                 |
| Backward                  | 5.343 ms                  | 11.424 ms                 |
| Optimize                  | 2.664 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.513 ms                  | 99.903 ms                 |
| AfterBackward             | 58.378 ms                 | 120.751 ms                |
| BlockToStepN              | 387.782 ms                | 976.170 ms                |
| OneStep                   | 470.400 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:52.468008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240204 23:03:53.468006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240204 23:03:54.554777 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240204 23:03:55.554006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=152, pq.top=152
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.773 ms                  | 23.089 ms                 |
| ProcessBack:UpdateCache   | 11.450 ms                 | 14.184 ms                 |
| ProcessBack:UpsertPq      | 35.304 ms                 | 78.575 ms                 |
| ProcessOneStep            | 58.498 ms                 | 105.835 ms                |
| BlockToStepN              | 387.679 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:56.554008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.329 ms                  | 110.797 ms                |
| Forward                   | 5.320 ms                  | 11.619 ms                 |
| Backward                  | 5.326 ms                  | 11.409 ms                 |
| Optimize                  | 2.632 ms                  | 5.418 ms                  |
| BarrierTimeBeforeRank0    | 5.714 ms                  | 82.084 ms                 |
| AfterBackward             | 58.612 ms                 | 105.885 ms                |
| BlockToStepN              | 124.249 ms                | 946.490 ms                |
| OneStep                   | 290.344 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:03:57.554008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240204 23:03:58.554008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240204 23:03:59.554021 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240204 23:04:00.554006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.740 ms                  | 23.089 ms                 |
| ProcessBack:UpdateCache   | 11.460 ms                 | 14.184 ms                 |
| ProcessBack:UpsertPq      | 35.301 ms                 | 78.575 ms                 |
| ProcessOneStep            | 58.639 ms                 | 105.835 ms                |
| BlockToStepN              | 124.196 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:01.554008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.451 ms                  | 110.797 ms                |
| Forward                   | 5.320 ms                  | 11.619 ms                 |
| Backward                  | 5.343 ms                  | 11.409 ms                 |
| Optimize                  | 2.664 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.714 ms                  | 82.084 ms                 |
| AfterBackward             | 58.612 ms                 | 105.885 ms                |
| BlockToStepN              | 124.249 ms                | 946.490 ms                |
| OneStep                   | 290.344 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:02.554008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240204 23:04:03.554006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240204 23:04:04.554008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240204 23:04:05.554005 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.765 ms                  | 23.089 ms                 |
| ProcessBack:UpdateCache   | 11.450 ms                 | 14.184 ms                 |
| ProcessBack:UpsertPq      | 35.343 ms                 | 78.575 ms                 |
| ProcessOneStep            | 58.988 ms                 | 105.835 ms                |
| BlockToStepN              | 124.196 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:06.554006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.522 ms                  | 110.797 ms                |
| Forward                   | 5.317 ms                  | 11.619 ms                 |
| Backward                  | 5.373 ms                  | 11.409 ms                 |
| Optimize                  | 2.632 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.929 ms                  | 82.084 ms                 |
| AfterBackward             | 58.825 ms                 | 105.885 ms                |
| BlockToStepN              | 124.249 ms                | 946.490 ms                |
| OneStep                   | 290.344 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:07.604373 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240204 23:04:08.667794 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240204 23:04:09.719552 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.810 ms                  | 18.640 ms                 |
| ProcessBack:UpdateCache   | 11.436 ms                 | 14.145 ms                 |
| ProcessBack:UpsertPq      | 35.269 ms                 | 76.933 ms                 |
| ProcessOneStep            | 58.569 ms                 | 105.835 ms                |
| BlockToStepN              | 387.679 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:10.814133 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240204 23:04:11.851039 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.606 ms                  | 110.797 ms                |
| Forward                   | 5.320 ms                  | 11.619 ms                 |
| Backward                  | 5.355 ms                  | 11.409 ms                 |
| Optimize                  | 2.630 ms                  | 6.058 ms                  |
| BarrierTimeBeforeRank0    | 5.929 ms                  | 82.084 ms                 |
| AfterBackward             | 58.494 ms                 | 105.885 ms                |
| BlockToStepN              | 124.249 ms                | 946.490 ms                |
| OneStep                   | 290.344 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:13.030856 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240204 23:04:14.063954 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240204 23:04:15.092780 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.820 ms                  | 18.640 ms                 |
| ProcessBack:UpdateCache   | 11.436 ms                 | 14.184 ms                 |
| ProcessBack:UpsertPq      | 35.125 ms                 | 76.933 ms                 |
| ProcessOneStep            | 58.460 ms                 | 105.835 ms                |
| BlockToStepN              | 124.196 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:16.092007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240204 23:04:17.104909 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=192, pq.top=192
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.525 ms                  | 110.797 ms                |
| Forward                   | 5.333 ms                  | 11.619 ms                 |
| Backward                  | 5.380 ms                  | 11.409 ms                 |
| Optimize                  | 2.630 ms                  | 6.058 ms                  |
| BarrierTimeBeforeRank0    | 5.730 ms                  | 82.084 ms                 |
| AfterBackward             | 58.494 ms                 | 105.885 ms                |
| BlockToStepN              | 387.782 ms                | 946.490 ms                |
| OneStep                   | 470.400 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:18.199801 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240204 23:04:19.258342 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240204 23:04:20.258008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.835 ms                  | 18.640 ms                 |
| ProcessBack:UpdateCache   | 11.433 ms                 | 14.184 ms                 |
| ProcessBack:UpsertPq      | 35.124 ms                 | 76.933 ms                 |
| ProcessOneStep            | 58.304 ms                 | 105.835 ms                |
| BlockToStepN              | 174.303 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:21.258010 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 0] 200 steps, total: 53.279, sample: 1.604, forward: 0.547, backward: 0.700, update: 0.302
[proc 7] 200 steps, total: 53.279, sample: 1.804, forward: 0.553, backward: 1.063, update: 0.297
[proc 5] 200 steps, total: 53.279, sample: 1.188, forward: 0.608, backward: 0.630, update: 0.259
[proc 1] 200 steps, total: 53.279, sample: 1.142, forward: 0.575, backward: 0.779, update: 0.251
[proc 6] 200 steps, total: 53.279, sample: 1.235, forward: 0.537, backward: 0.847, update: 0.260
[proc 4] 200 steps, total: 53.279, sample: 1.163, forward: 0.563, backward: 0.819, update: 0.271
[proc 2] 200 steps, total: 53.279, sample: 1.116, forward: 0.531, backward: 0.756, update: 0.281
[proc 3] 200 steps, total: 53.279, sample: 1.388, forward: 0.576, backward: 0.578, update: 0.252
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.522 ms                  | 110.797 ms                |
| Forward                   | 5.333 ms                  | 11.619 ms                 |
| Backward                  | 5.445 ms                  | 11.409 ms                 |
| Optimize                  | 2.628 ms                  | 6.058 ms                  |
| BarrierTimeBeforeRank0    | 5.717 ms                  | 82.084 ms                 |
| AfterBackward             | 58.345 ms                 | 105.885 ms                |
| BlockToStepN              | 174.408 ms                | 946.490 ms                |
| OneStep                   | 290.344 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:22.258004 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240204 23:04:23.258008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240204 23:04:24.258008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240204 23:04:25.258008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.845 ms                  | 18.640 ms                 |
| ProcessBack:UpdateCache   | 11.426 ms                 | 14.184 ms                 |
| ProcessBack:UpsertPq      | 35.035 ms                 | 76.933 ms                 |
| ProcessOneStep            | 58.296 ms                 | 105.835 ms                |
| BlockToStepN              | 174.303 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:26.258005 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.479 ms                  | 110.797 ms                |
| Forward                   | 5.346 ms                  | 11.619 ms                 |
| Backward                  | 5.380 ms                  | 11.409 ms                 |
| Optimize                  | 2.630 ms                  | 6.058 ms                  |
| BarrierTimeBeforeRank0    | 5.833 ms                  | 82.084 ms                 |
| AfterBackward             | 58.345 ms                 | 105.885 ms                |
| BlockToStepN              | 174.408 ms                | 946.490 ms                |
| OneStep                   | 290.344 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:27.258005 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240204 23:04:28.258008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240204 23:04:29.258008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240204 23:04:30.335997 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=216, pq.top=216
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.824 ms                  | 18.640 ms                 |
| ProcessBack:UpdateCache   | 11.432 ms                 | 20.515 ms                 |
| ProcessBack:UpsertPq      | 35.035 ms                 | 76.933 ms                 |
| ProcessOneStep            | 58.338 ms                 | 105.835 ms                |
| BlockToStepN              | 174.303 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:31.335007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.467 ms                  | 110.797 ms                |
| Forward                   | 5.343 ms                  | 11.619 ms                 |
| Backward                  | 5.381 ms                  | 11.409 ms                 |
| Optimize                  | 2.632 ms                  | 6.058 ms                  |
| BarrierTimeBeforeRank0    | 5.971 ms                  | 82.084 ms                 |
| AfterBackward             | 58.494 ms                 | 105.885 ms                |
| BlockToStepN              | 174.408 ms                | 946.490 ms                |
| OneStep                   | 290.344 ms                | 1.084 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:32.335007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240204 23:04:33.335008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240204 23:04:34.335007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240204 23:04:35.335006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.830 ms                  | 18.640 ms                 |
| ProcessBack:UpdateCache   | 11.418 ms                 | 20.515 ms                 |
| ProcessBack:UpsertPq      | 35.256 ms                 | 76.933 ms                 |
| ProcessOneStep            | 58.593 ms                 | 105.835 ms                |
| BlockToStepN              | 174.303 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:36.412021 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.451 ms                  | 110.797 ms                |
| Forward                   | 5.335 ms                  | 11.619 ms                 |
| Backward                  | 5.448 ms                  | 11.424 ms                 |
| Optimize                  | 2.631 ms                  | 6.058 ms                  |
| BarrierTimeBeforeRank0    | 5.730 ms                  | 82.084 ms                 |
| AfterBackward             | 58.625 ms                 | 105.885 ms                |
| BlockToStepN              | 174.408 ms                | 946.490 ms                |
| OneStep                   | 290.344 ms                | 1.084 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:37.412005 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240204 23:04:38.412006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=230, pq.top=230
W20240204 23:04:39.412012 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240204 23:04:40.412014 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.848 ms                  | 17.822 ms                 |
| ProcessBack:UpdateCache   | 11.392 ms                 | 14.635 ms                 |
| ProcessBack:UpsertPq      | 35.269 ms                 | 71.908 ms                 |
| ProcessOneStep            | 58.639 ms                 | 105.835 ms                |
| BlockToStepN              | 174.303 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:41.412007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.525 ms                  | 117.030 ms                |
| Forward                   | 5.361 ms                  | 11.619 ms                 |
| Backward                  | 5.499 ms                  | 11.424 ms                 |
| Optimize                  | 2.628 ms                  | 6.058 ms                  |
| BarrierTimeBeforeRank0    | 5.696 ms                  | 82.084 ms                 |
| AfterBackward             | 58.825 ms                 | 105.885 ms                |
| BlockToStepN              | 174.408 ms                | 946.490 ms                |
| OneStep                   | 290.344 ms                | 1.115 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:42.412005 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240204 23:04:43.412006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240204 23:04:44.422286 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240204 23:04:45.422006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.857 ms                  | 18.640 ms                 |
| ProcessBack:UpdateCache   | 11.360 ms                 | 14.635 ms                 |
| ProcessBack:UpsertPq      | 35.407 ms                 | 71.908 ms                 |
| ProcessOneStep            | 58.901 ms                 | 105.835 ms                |
| BlockToStepN              | 174.303 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:46.424063 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=244, pq.top=244
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.675 ms                  | 117.030 ms                |
| Forward                   | 5.375 ms                  | 11.619 ms                 |
| Backward                  | 5.519 ms                  | 11.424 ms                 |
| Optimize                  | 2.628 ms                  | 6.058 ms                  |
| BarrierTimeBeforeRank0    | 5.392 ms                  | 82.084 ms                 |
| AfterBackward             | 58.980 ms                 | 105.885 ms                |
| BlockToStepN              | 174.408 ms                | 946.490 ms                |
| OneStep                   | 290.344 ms                | 1.115 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:47.424006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240204 23:04:48.424008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240204 23:04:49.424007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240204 23:04:50.424007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.866 ms                  | 18.640 ms                 |
| ProcessBack:UpdateCache   | 11.315 ms                 | 14.635 ms                 |
| ProcessBack:UpsertPq      | 35.428 ms                 | 71.908 ms                 |
| ProcessOneStep            | 58.991 ms                 | 105.752 ms                |
| BlockToStepN              | 174.303 ms                | 946.410 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:51.424007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.698 ms                  | 110.797 ms                |
| Forward                   | 5.382 ms                  | 9.979 ms                  |
| Backward                  | 5.553 ms                  | 11.409 ms                 |
| Optimize                  | 2.626 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.317 ms                  | 80.195 ms                 |
| AfterBackward             | 59.024 ms                 | 105.799 ms                |
| BlockToStepN              | 387.782 ms                | 946.072 ms                |
| OneStep                   | 470.400 ms                | 1.084 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:52.424006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240204 23:04:53.472455 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240204 23:04:54.472007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240204 23:04:55.472008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.866 ms                  | 18.640 ms                 |
| ProcessBack:UpdateCache   | 11.246 ms                 | 14.635 ms                 |
| ProcessBack:UpsertPq      | 35.426 ms                 | 71.908 ms                 |
| ProcessOneStep            | 58.988 ms                 | 105.752 ms                |
| BlockToStepN              | 387.679 ms                | 945.952 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:56.472008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.796 ms                  | 110.797 ms                |
| Forward                   | 5.388 ms                  | 9.979 ms                  |
| Backward                  | 5.659 ms                  | 11.409 ms                 |
| Optimize                  | 2.622 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.019 ms                  | 80.195 ms                 |
| AfterBackward             | 59.032 ms                 | 105.799 ms                |
| BlockToStepN              | 387.782 ms                | 946.490 ms                |
| OneStep                   | 470.400 ms                | 1.084 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:04:57.472007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240204 23:04:58.472007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240204 23:04:59.472007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240204 23:05:00.472007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.857 ms                  | 18.640 ms                 |
| ProcessBack:UpdateCache   | 11.112 ms                 | 14.635 ms                 |
| ProcessBack:UpsertPq      | 35.428 ms                 | 71.908 ms                 |
| ProcessOneStep            | 58.997 ms                 | 105.752 ms                |
| BlockToStepN              | 241.833 ms                | 953.438 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:05:01.472007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.796 ms                  | 110.797 ms                |
| Forward                   | 5.389 ms                  | 9.979 ms                  |
| Backward                  | 5.535 ms                  | 11.409 ms                 |
| Optimize                  | 2.623 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.335 ms                  | 80.195 ms                 |
| AfterBackward             | 59.064 ms                 | 105.799 ms                |
| BlockToStepN              | 387.782 ms                | 953.578 ms                |
| OneStep                   | 470.400 ms                | 1.115 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:05:02.472007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240204 23:05:03.567301 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240204 23:05:04.567006 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.856 ms                  | 18.524 ms                 |
| ProcessBack:UpdateCache   | 11.066 ms                 | 14.253 ms                 |
| ProcessBack:UpsertPq      | 35.428 ms                 | 71.908 ms                 |
| ProcessOneStep            | 59.095 ms                 | 105.752 ms                |
| BlockToStepN              | 387.679 ms                | 953.438 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 23:05:05.587729 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=276, pq.top=276
W20240204 23:05:06.587007 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.709 ms                  | 110.797 ms                |
| Forward                   | 5.412 ms                  | 9.979 ms                  |
| Backward                  | 5.513 ms                  | 11.409 ms                 |
| Optimize                  | 2.623 ms                  | 5.754 ms                  |
| BarrierTimeBeforeRank0    | 5.456 ms                  | 80.195 ms                 |
| AfterBackward             | 59.349 ms                 | 105.799 ms                |
| BlockToStepN              | 241.900 ms                | 953.578 ms                |
| OneStep                   | 327.278 ms                | 1.115 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 23:05:07.587008 52873 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
Successfully xmh. training takes 155.69419407844543 seconds
before call kg_cache_controller.StopThreads()
W20240204 23:05:08.114580 52873 grad_async_v1.h:243] call StopThreads. PID = 25932
W20240204 23:05:08.114612 52873 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 23:05:08.119241 52873 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 23:05:08.119261 52873 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 23:05:08.139240 52873 grad_async_v1.h:264] StopThreads done.
