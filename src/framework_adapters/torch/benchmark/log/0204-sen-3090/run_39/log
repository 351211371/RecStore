WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 17:11:19.536855 51701 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_97', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=2, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [51701 sampler.py:454] Start PreSampling
WARNING [51701 sampler.py:532] Before construct renumbering_dict
WARNING [51701 sampler.py:555] PreSampling done
W20240204 17:31:27.476087 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 17:31:27.476277 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 17:31:27.476317 51701 IPCTensor.h:369] NewIPCTensor: step_r0 [2]0x100000f48000 16 B 
W20240204 17:31:27.476349 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100000f4a000 8 B 
W20240204 17:31:27.476385 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100000f4c000 8 B 
W20240204 17:31:27.476541 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100000f4e000 7.629 MB
W20240204 17:31:27.476585 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000016f1000 7.629 MB
W20240204 17:31:27.476621 51701 IPCTensor.h:369] NewIPCTensor: step_r1 [2]0x100001e94000 16 B 
W20240204 17:31:27.476648 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100001e96000 8 B 
W20240204 17:31:27.476670 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100001e98000 8 B 
W20240204 17:31:27.476727 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100001e9a000 7.629 MB
W20240204 17:31:27.476770 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000263d000 7.629 MB
W20240204 17:31:27.476806 51701 IPCTensor.h:369] NewIPCTensor: step_r2 [2]0x100002de0000 16 B 
W20240204 17:31:27.476830 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x100002de2000 8 B 
W20240204 17:31:27.476857 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100002de4000 8 B 
W20240204 17:31:27.476924 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100002de6000 7.629 MB
W20240204 17:31:27.476971 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x100003589000 7.629 MB
W20240204 17:31:27.477008 51701 IPCTensor.h:369] NewIPCTensor: step_r3 [2]0x100003d2c000 16 B 
W20240204 17:31:27.477031 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x100003d2e000 8 B 
W20240204 17:31:27.477056 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100003d30000 8 B 
W20240204 17:31:27.477111 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100003d32000 7.629 MB
W20240204 17:31:27.477144 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000044d5000 7.629 MB
W20240204 17:31:27.477188 51701 IPCTensor.h:369] NewIPCTensor: step_r4 [2]0x100004c78000 16 B 
W20240204 17:31:27.477210 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100004c7a000 8 B 
W20240204 17:31:27.477233 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100004c7c000 8 B 
W20240204 17:31:27.477285 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100004c7e000 7.629 MB
W20240204 17:31:27.477314 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100005421000 7.629 MB
W20240204 17:31:27.477339 51701 IPCTensor.h:369] NewIPCTensor: step_r5 [2]0x100005bc4000 16 B 
W20240204 17:31:27.477361 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x100005bc6000 8 B 
W20240204 17:31:27.477384 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100005bc8000 8 B 
W20240204 17:31:27.477435 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x100005bca000 7.629 MB
W20240204 17:31:27.477466 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10000636d000 7.629 MB
W20240204 17:31:27.477504 51701 IPCTensor.h:369] NewIPCTensor: step_r6 [2]0x100006b10000 16 B 
W20240204 17:31:27.477526 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x100006b12000 8 B 
W20240204 17:31:27.477550 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100006b14000 8 B 
W20240204 17:31:27.477598 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x100006b16000 7.629 MB
W20240204 17:31:27.477633 51701 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000072b9000 7.629 MB
W20240204 17:31:27.477659 51701 IPCTensor.h:369] NewIPCTensor: step_r7 [2]0x100007a5c000 16 B 
W20240204 17:31:27.477680 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x100007a5e000 8 B 
W20240204 17:31:27.477702 51701 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100007a60000 8 B 
W20240204 17:31:27.948688 51701 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100007a62000 128.2 GB
W20240204 17:40:09.093355 51701 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10201669a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302710,  4302738,    88682,  ..., 59874437, 64821305,  4931054]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2239.435 seconds
[Rank1] pid = 12777
[Rank2] pid = 12872
[Rank3] pid = 12942
[Rank4] pid = 13099
[Rank5] pid = 13279
[Rank6] pid = 13492
INFO [51701 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [12777 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [12872 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [12942 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [13099 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [13279 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [13692 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [13492 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [13692 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [13492 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [13099 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [13279 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12942 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12872 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 17:48:51.219008 13703 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
INFO [51701 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12777 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 17:48:51.223374 13109 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240204 17:48:51.223351 13503 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240204 17:48:51.223490 12873 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240204 17:48:51.223532 13704 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240204 17:48:51.223594 12943 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240204 17:48:51.223595 13302 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240204 17:48:51.224661 12778 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240204 17:48:51.332734 12943 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10202aee5000 7.629 MB
W20240204 17:48:51.332867 13704 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10202b688000 7.629 MB
W20240204 17:48:51.333001 12943 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10202be2d000 7.629 MB
W20240204 17:48:51.333087 12943 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10202c5d2000 1.49 GB
W20240204 17:48:51.333137 13302 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10208bbb5000 7.629 MB
W20240204 17:48:51.333163 12943 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10208c358000 1.49 GB
W20240204 17:48:51.333196 13704 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020eb93b000 7.629 MB
W20240204 17:48:51.333235 12943 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 17:48:51.333282 13704 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1020ec0de000 1.49 GB
W20240204 17:48:51.333328 13704 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10214be64000 1.49 GB
W20240204 17:48:51.333331 13109 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10214b6c1000 7.629 MB
W20240204 17:48:51.333359 13302 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1021ab447000 7.629 MB
W20240204 17:48:51.333423 13704 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 17:48:51.333485 13302 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1021abbea000 1.49 GB
W20240204 17:48:51.333552 13302 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10220b1cd000 1.49 GB
W20240204 17:48:51.333581 13109 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10226a7b0000 7.629 MB
W20240204 17:48:51.333695 13109 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10226af53000 1.49 GB
W20240204 17:48:51.333791 13109 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1022ca536000 1.49 GB
W20240204 17:48:51.335408 13109 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 17:48:51.335418 13302 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 17:48:51.338116 13703 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x102329b1b000 7.629 MB
W20240204 17:48:51.338351 13703 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10232a2be000 7.629 MB
W20240204 17:48:51.338462 13703 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10232aa61000 1.49 GB
W20240204 17:48:51.338550 13703 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10238a044000 1.49 GB
W20240204 17:48:51.338639 13703 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 17:48:51.340435 13503 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1023e962b000 7.629 MB
W20240204 17:48:51.340487 12778 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1023e9dce000 7.629 MB
W20240204 17:48:51.340672 13503 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1023ea571000 7.629 MB
W20240204 17:48:51.340762 12778 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1023ead14000 7.629 MB
W20240204 17:48:51.340812 13503 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1023eb4b7000 1.49 GB
W20240204 17:48:51.340907 12778 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10244aa9a000 1.49 GB
W20240204 17:48:51.340919 13503 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1024aa07d000 1.49 GB
W20240204 17:48:51.341015 12778 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x102509660000 1.49 GB
W20240204 17:48:51.341035 13503 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 17:48:51.341102 12778 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 17:48:51.344583 12943 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 17:48:51.351702 13704 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 17:48:51.353659 13302 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 17:48:51.355417 13703 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 17:48:51.357097 12778 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 17:48:51.357105 13503 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 17:48:51.367708 13109 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 17:48:51.367903 12873 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102568c5f000 7.629 MB
W20240204 17:48:51.368175 12873 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102569402000 7.629 MB
W20240204 17:48:51.368326 12873 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102569ba5000 1.49 GB
W20240204 17:48:51.368443 12873 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1025c9188000 1.49 GB
W20240204 17:48:51.368558 12873 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 17:48:51.375607 12873 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100007a62000
6: KnownLocalCachedEmbedding init done
WARNING [13492 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
5: KnownLocalCachedEmbedding init done
WARNING [13279 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
7: KnownLocalCachedEmbedding init done
WARNING [13692 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
4: KnownLocalCachedEmbedding init done
WARNING [13099 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100007a62000
1: KnownLocalCachedEmbedding init done
WARNING [12872 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [12777 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 13692
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100007a62000
0: KnownLocalCachedEmbedding init done
WARNING [51701 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
3: KnownLocalCachedEmbedding init done
WARNING [12942 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 17:49:42.393785 13704 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 17:49:42.393958 12943 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 17:49:42.394142 13109 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 17:49:42.394256 12873 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 17:49:42.394337 13703 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 17:49:42.394562 13302 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 17:49:42.394816 13503 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 17:49:42.394898 12778 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 17:49:42.397081 13704 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 2,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 17:49:42.397235 13704 grad_base.h:184] Init GradProcessingBase done
I20240204 17:49:55.217262 13704 grad_async_v1.h:203] Use main thread to update emb.
W20240204 17:49:55.217381 13704 kg_controller.h:75] after init GradAsyncProcessing
I20240204 17:49:55.217389 13704 kg_controller.h:84] Construct KGCacheController done
E20240204 17:49:55.957489 13302 recstore.cc:66] init folly done
E20240204 17:49:55.958385 12943 recstore.cc:66] init folly done
E20240204 17:49:55.958447 13704 recstore.cc:66] init folly done
E20240204 17:49:55.958447 12873 recstore.cc:66] init folly done
E20240204 17:49:55.958565 13503 recstore.cc:66] init folly done
E20240204 17:49:55.958810 13703 recstore.cc:66] init folly done
E20240204 17:49:55.958868 12778 recstore.cc:66] init folly done
E20240204 17:49:55.958880 13109 recstore.cc:66] init folly done
I20240204 17:49:55.959882 13704 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 17:50:17.254992 13703 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 17:50:17.281327 13302 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 17:50:17.344995 13109 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 17:50:18.546002 12873 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 17:50:19.754356 12778 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 17:50:19.880867 12943 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 17:50:20.256258 13704 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 17:50:21.196233 13503 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.506 ms                 | 10.506 ms                 |
| Forward                   | 678.062 ms                | 678.062 ms                |
| Backward                  | 209.703 ms                | 209.703 ms                |
| Optimize                  | 5.240 ms                  | 5.240 ms                  |
| BarrierTimeBeforeRank0    | 58.433 ms                 | 58.433 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:23.505666 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240204 17:50:24.512941 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
E20240204 17:50:24.847129 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=3, sample_step_cpp_seen_[rank]=2
W20240204 17:50:25.512012 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.370 ms                  | 398.635 ms                |
| ProcessBack:UpdateCache   | 9.561 ms                  | 653.842 ms                |
| ProcessBack:UpsertPq      | 40.251 ms                 | 215.174 ms                |
| ProcessOneStep            | 66.346 ms                 | 1.347 s                   |
| BlockToStepN              | 9.083 ms                  | 806.694 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:26.869624 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.676 ms                  | 10.506 ms                 |
| Forward                   | 5.269 ms                  | 678.062 ms                |
| Backward                  | 11.463 ms                 | 209.703 ms                |
| Optimize                  | 2.571 ms                  | 5.240 ms                  |
| BarrierTimeBeforeRank0    | 2.727 ms                  | 58.433 ms                 |
| AfterBackward             | 75.484 ms                 | 1.347 s                   |
| BlockToStepN              | 9.159 ms                  | 808.413 ms                |
| OneStep                   | 423.218 ms                | 3.125 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:28.370654 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240204 17:50:29.370010 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
E20240204 17:50:29.882723 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=15, sample_step_cpp_seen_[rank]=14
W20240204 17:50:30.370009 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.631 ms                  | 398.635 ms                |
| ProcessBack:UpdateCache   | 9.926 ms                  | 653.842 ms                |
| ProcessBack:UpsertPq      | 40.862 ms                 | 215.174 ms                |
| ProcessOneStep            | 66.346 ms                 | 1.347 s                   |
| BlockToStepN              | 9.083 ms                  | 806.694 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:31.653120 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.257 ms                  | 90.332 ms                 |
| Forward                   | 5.362 ms                  | 678.062 ms                |
| Backward                  | 11.367 ms                 | 209.703 ms                |
| Optimize                  | 2.580 ms                  | 5.240 ms                  |
| BarrierTimeBeforeRank0    | 710.576 us                | 222.227 ms                |
| AfterBackward             | 66.383 ms                 | 1.347 s                   |
| BlockToStepN              | 174.448 ms                | 808.413 ms                |
| OneStep                   | 384.512 ms                | 3.125 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:32.848284 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240204 17:50:34.052119 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240204 17:50:35.052007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.888 ms                  | 363.080 ms                |
| ProcessBack:UpdateCache   | 9.926 ms                  | 653.045 ms                |
| ProcessBack:UpsertPq      | 41.421 ms                 | 214.090 ms                |
| ProcessOneStep            | 72.231 ms                 | 1.347 s                   |
| BlockToStepN              | 174.262 ms                | 806.694 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:36.239734 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240204 17:50:37.239007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.297 ms                  | 99.003 ms                 |
| Forward                   | 5.269 ms                  | 678.062 ms                |
| Backward                  | 11.367 ms                 | 209.703 ms                |
| Optimize                  | 2.666 ms                  | 5.738 ms                  |
| BarrierTimeBeforeRank0    | 1.616 ms                  | 397.318 ms                |
| AfterBackward             | 68.673 ms                 | 1.347 s                   |
| BlockToStepN              | 9.159 ms                  | 808.413 ms                |
| OneStep                   | 382.330 ms                | 3.125 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 17:50:37.800828 13704 grad_async_v1.h:533] Stalled in ProcessBackward: rank=3, step_no=35, sample_step_cpp_seen_[rank]=34
W20240204 17:50:38.239012 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240204 17:50:39.239005 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240204 17:50:40.239004 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.933 ms                  | 363.080 ms                |
| ProcessBack:UpdateCache   | 10.022 ms                 | 653.045 ms                |
| ProcessBack:UpsertPq      | 39.737 ms                 | 214.090 ms                |
| ProcessOneStep            | 64.012 ms                 | 1.347 s                   |
| BlockToStepN              | 9.083 ms                  | 806.694 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:41.239004 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240204 17:50:42.239006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.311 ms                  | 128.316 ms                |
| Forward                   | 5.279 ms                  | 678.062 ms                |
| Backward                  | 11.337 ms                 | 209.703 ms                |
| Optimize                  | 2.873 ms                  | 10.010 ms                 |
| BarrierTimeBeforeRank0    | 2.379 ms                  | 397.318 ms                |
| AfterBackward             | 63.583 ms                 | 1.347 s                   |
| BlockToStepN              | 10.687 ms                 | 808.413 ms                |
| OneStep                   | 382.330 ms                | 3.125 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:43.239006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
E20240204 17:50:44.041079 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=1, step_no=51, sample_step_cpp_seen_[rank]=50
W20240204 17:50:44.362483 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240204 17:50:45.560132 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.033 ms                  | 363.080 ms                |
| ProcessBack:UpdateCache   | 10.231 ms                 | 653.045 ms                |
| ProcessBack:UpsertPq      | 37.300 ms                 | 214.090 ms                |
| ProcessOneStep            | 62.815 ms                 | 414.446 ms                |
| BlockToStepN              | 36.186 ms                 | 676.491 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:46.833487 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=60, pq.top=60
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.595 ms                  | 99.003 ms                 |
| Forward                   | 5.269 ms                  | 11.333 ms                 |
| Backward                  | 11.084 ms                 | 13.414 ms                 |
| Optimize                  | 2.890 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.593 ms                  | 222.227 ms                |
| AfterBackward             | 62.214 ms                 | 414.506 ms                |
| BlockToStepN              | 36.245 ms                 | 676.629 ms                |
| OneStep                   | 382.330 ms                | 1.063 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:47.833006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240204 17:50:48.833005 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
E20240204 17:50:49.205866 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=2, step_no=65, sample_step_cpp_seen_[rank]=64
W20240204 17:50:49.833007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.033 ms                  | 363.080 ms                |
| ProcessBack:UpdateCache   | 10.465 ms                 | 653.045 ms                |
| ProcessBack:UpsertPq      | 36.176 ms                 | 214.090 ms                |
| ProcessOneStep            | 60.955 ms                 | 414.446 ms                |
| BlockToStepN              | 174.262 ms                | 676.491 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:51.170714 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240204 17:50:52.170007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.257 ms                  | 106.328 ms                |
| Forward                   | 5.314 ms                  | 11.333 ms                 |
| Backward                  | 11.084 ms                 | 13.414 ms                 |
| Optimize                  | 2.890 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 1.903 ms                  | 222.227 ms                |
| AfterBackward             | 60.405 ms                 | 414.506 ms                |
| BlockToStepN              | 174.448 ms                | 676.629 ms                |
| OneStep                   | 384.512 ms                | 1.063 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:53.170006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240204 17:50:54.170007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240204 17:50:55.189553 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.131 ms                  | 25.016 ms                 |
| ProcessBack:UpdateCache   | 10.858 ms                 | 14.589 ms                 |
| ProcessBack:UpsertPq      | 35.546 ms                 | 154.410 ms                |
| ProcessOneStep            | 60.365 ms                 | 414.446 ms                |
| BlockToStepN              | 164.291 ms                | 766.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:56.189007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
E20240204 17:50:56.400023 13704 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=83, sample_step_cpp_seen_[rank]=82
W20240204 17:50:57.189006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=86, pq.top=86
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.005 ms                  | 106.328 ms                |
| Forward                   | 5.314 ms                  | 11.333 ms                 |
| Backward                  | 10.978 ms                 | 13.414 ms                 |
| Optimize                  | 2.890 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 3.429 ms                  | 266.199 ms                |
| AfterBackward             | 60.995 ms                 | 414.506 ms                |
| BlockToStepN              | 55.881 ms                 | 766.127 ms                |
| OneStep                   | 376.969 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:50:58.306074 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240204 17:50:59.306007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240204 17:51:00.306007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.141 ms                  | 25.016 ms                 |
| ProcessBack:UpdateCache   | 11.189 ms                 | 17.408 ms                 |
| ProcessBack:UpsertPq      | 35.581 ms                 | 154.410 ms                |
| ProcessOneStep            | 60.955 ms                 | 414.446 ms                |
| BlockToStepN              | 59.294 ms                 | 766.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:01.306020 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240204 17:51:02.306018 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.167 ms                  | 128.316 ms                |
| Forward                   | 5.314 ms                  | 20.098 ms                 |
| Backward                  | 10.996 ms                 | 20.428 ms                 |
| Optimize                  | 2.890 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 3.485 ms                  | 266.199 ms                |
| AfterBackward             | 61.864 ms                 | 414.506 ms                |
| BlockToStepN              | 59.365 ms                 | 779.721 ms                |
| OneStep                   | 376.969 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 17:51:02.600040 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=2, step_no=97, sample_step_cpp_seen_[rank]=96
W20240204 17:51:03.306008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 43.889, sample: 3.062, forward: 1.200, backward: 1.299, update: 0.270
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 42.447, sample: 1.619, forward: 1.204, backward: 1.143, update: 0.268
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 46.299, sample: 1.481, forward: 1.237, backward: 1.351, update: 0.292
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 43.763, sample: 2.213, forward: 1.231, backward: 1.254, update: 0.272
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 46.389, sample: 1.691, forward: 1.198, backward: 0.953, update: 0.284
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 46.362, sample: 2.527, forward: 1.210, backward: 1.180, update: 0.261
train_sampler.Prefill()
-------Step 0-------
tensor([   66533,    66569,    66613,    66648,  5762938,    88585, 48875525,
        17799937, 22218548,    66690]) tensor([ 5196482, 16088447, 68776519, 66750431, 18857001, 28745149, 40223579,
        83344117, 76605195, 25837368])
-------Step 1-------
tensor([   66533,    66569,    66613,    66648,  5762938,    88585, 48875525,
        17799937, 22218548,    66690]) tensor([76171891, 31254761, 10473077, 81549631, 76777533, 37897368, 62766535,
        41356827, 34674230, 13290661])
before start barrier
start train
[proc 0] 100 steps, total: 43.387, sample: 1.685, forward: 1.239, backward: 1.289, update: 0.346
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 45.098, sample: 2.907, forward: 1.196, backward: 1.238, update: 0.264
W20240204 17:51:04.473699 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240204 17:51:05.721697 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.151 ms                  | 25.016 ms                 |
| ProcessBack:UpdateCache   | 10.858 ms                 | 17.408 ms                 |
| ProcessBack:UpsertPq      | 35.542 ms                 | 154.410 ms                |
| ProcessOneStep            | 60.955 ms                 | 414.446 ms                |
| BlockToStepN              | 64.781 ms                 | 779.453 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:06.721007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.488 ms                  | 128.316 ms                |
| Forward                   | 5.364 ms                  | 20.098 ms                 |
| Backward                  | 10.978 ms                 | 20.428 ms                 |
| Optimize                  | 2.807 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.840 ms                  | 266.199 ms                |
| AfterBackward             | 60.405 ms                 | 414.506 ms                |
| BlockToStepN              | 164.359 ms                | 779.721 ms                |
| OneStep                   | 376.969 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:07.783738 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240204 17:51:08.783007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
E20240204 17:51:08.983994 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=113, sample_step_cpp_seen_[rank]=112
W20240204 17:51:09.783007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240204 17:51:10.783006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.107 ms                  | 25.016 ms                 |
| ProcessBack:UpdateCache   | 10.634 ms                 | 17.408 ms                 |
| ProcessBack:UpsertPq      | 34.887 ms                 | 154.410 ms                |
| ProcessOneStep            | 60.313 ms                 | 414.446 ms                |
| BlockToStepN              | 75.488 ms                 | 779.453 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:11.783008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.595 ms                  | 144.491 ms                |
| Forward                   | 5.362 ms                  | 20.098 ms                 |
| Backward                  | 10.913 ms                 | 20.428 ms                 |
| Optimize                  | 2.873 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.840 ms                  | 266.199 ms                |
| AfterBackward             | 60.344 ms                 | 414.506 ms                |
| BlockToStepN              | 108.270 ms                | 779.721 ms                |
| OneStep                   | 366.195 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:12.783008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240204 17:51:14.084335 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240204 17:51:15.084007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
E20240204 17:51:15.467469 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=1, step_no=129, sample_step_cpp_seen_[rank]=128
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.043 ms                  | 21.772 ms                 |
| ProcessBack:UpdateCache   | 10.557 ms                 | 14.589 ms                 |
| ProcessBack:UpsertPq      | 34.152 ms                 | 144.009 ms                |
| ProcessOneStep            | 60.190 ms                 | 414.446 ms                |
| BlockToStepN              | 108.197 ms                | 779.453 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:16.084005 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240204 17:51:17.084007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.595 ms                  | 144.491 ms                |
| Forward                   | 5.321 ms                  | 20.098 ms                 |
| Backward                  | 10.870 ms                 | 20.428 ms                 |
| Optimize                  | 2.807 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 3.104 ms                  | 266.199 ms                |
| AfterBackward             | 60.219 ms                 | 414.506 ms                |
| BlockToStepN              | 108.270 ms                | 779.721 ms                |
| OneStep                   | 366.195 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:18.084009 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240204 17:51:19.325891 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240204 17:51:20.325007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.998 ms                  | 21.772 ms                 |
| ProcessBack:UpdateCache   | 10.472 ms                 | 14.589 ms                 |
| ProcessBack:UpsertPq      | 34.211 ms                 | 144.009 ms                |
| ProcessOneStep            | 60.265 ms                 | 414.446 ms                |
| BlockToStepN              | 108.197 ms                | 779.453 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:21.325004 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240204 17:51:22.325058 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.740 ms                  | 162.782 ms                |
| Forward                   | 5.362 ms                  | 20.098 ms                 |
| Backward                  | 10.852 ms                 | 20.428 ms                 |
| Optimize                  | 2.784 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 3.197 ms                  | 266.199 ms                |
| AfterBackward             | 60.219 ms                 | 414.506 ms                |
| BlockToStepN              | 108.270 ms                | 779.721 ms                |
| OneStep                   | 366.195 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 17:51:22.731213 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=3, step_no=145, sample_step_cpp_seen_[rank]=144
W20240204 17:51:23.325007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240204 17:51:24.326582 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240204 17:51:25.326005 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.999 ms                  | 21.772 ms                 |
| ProcessBack:UpdateCache   | 10.352 ms                 | 14.589 ms                 |
| ProcessBack:UpsertPq      | 34.050 ms                 | 144.009 ms                |
| ProcessOneStep            | 60.190 ms                 | 396.778 ms                |
| BlockToStepN              | 113.447 ms                | 766.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:26.326004 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240204 17:51:27.326006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.925 ms                  | 155.226 ms                |
| Forward                   | 5.325 ms                  | 16.084 ms                 |
| Backward                  | 10.841 ms                 | 13.414 ms                 |
| Optimize                  | 2.784 ms                  | 6.372 ms                  |
| BarrierTimeBeforeRank0    | 2.860 ms                  | 222.227 ms                |
| AfterBackward             | 60.069 ms                 | 396.831 ms                |
| BlockToStepN              | 164.359 ms                | 766.127 ms                |
| OneStep                   | 369.859 ms                | 1.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:28.326007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240204 17:51:29.326007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
E20240204 17:51:30.356460 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=161, sample_step_cpp_seen_[rank]=160
W20240204 17:51:30.551815 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.973 ms                  | 21.772 ms                 |
| ProcessBack:UpdateCache   | 10.359 ms                 | 14.589 ms                 |
| ProcessBack:UpsertPq      | 33.312 ms                 | 144.009 ms                |
| ProcessOneStep            | 59.870 ms                 | 396.778 ms                |
| BlockToStepN              | 164.291 ms                | 766.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:31.551007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.146 ms                  | 155.226 ms                |
| Forward                   | 5.330 ms                  | 16.084 ms                 |
| Backward                  | 10.771 ms                 | 13.414 ms                 |
| Optimize                  | 2.778 ms                  | 6.372 ms                  |
| BarrierTimeBeforeRank0    | 2.860 ms                  | 222.227 ms                |
| AfterBackward             | 59.854 ms                 | 396.831 ms                |
| BlockToStepN              | 113.971 ms                | 766.127 ms                |
| OneStep                   | 365.436 ms                | 1.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:32.551008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240204 17:51:33.551008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240204 17:51:34.932729 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.959 ms                  | 21.772 ms                 |
| ProcessBack:UpdateCache   | 10.254 ms                 | 14.589 ms                 |
| ProcessBack:UpsertPq      | 32.778 ms                 | 144.009 ms                |
| ProcessOneStep            | 59.478 ms                 | 396.778 ms                |
| BlockToStepN              | 120.761 ms                | 766.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:36.123507 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240204 17:51:37.123005 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.558 ms                  | 155.226 ms                |
| Forward                   | 5.321 ms                  | 16.084 ms                 |
| Backward                  | 10.740 ms                 | 13.414 ms                 |
| Optimize                  | 2.771 ms                  | 6.372 ms                  |
| BarrierTimeBeforeRank0    | 3.104 ms                  | 222.227 ms                |
| AfterBackward             | 59.327 ms                 | 396.831 ms                |
| BlockToStepN              | 120.832 ms                | 766.127 ms                |
| OneStep                   | 365.436 ms                | 1.175 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 17:51:37.549157 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=177, sample_step_cpp_seen_[rank]=176
W20240204 17:51:38.123008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240204 17:51:39.123008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240204 17:51:40.250708 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.930 ms                  | 19.625 ms                 |
| ProcessBack:UpdateCache   | 10.196 ms                 | 14.001 ms                 |
| ProcessBack:UpsertPq      | 32.319 ms                 | 143.888 ms                |
| ProcessOneStep            | 59.257 ms                 | 396.778 ms                |
| BlockToStepN              | 164.291 ms                | 766.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:41.275804 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=186, pq.top=186
W20240204 17:51:42.308276 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.558 ms                  | 155.226 ms                |
| Forward                   | 5.309 ms                  | 16.084 ms                 |
| Backward                  | 10.725 ms                 | 15.698 ms                 |
| Optimize                  | 2.771 ms                  | 6.372 ms                  |
| BarrierTimeBeforeRank0    | 3.197 ms                  | 222.227 ms                |
| AfterBackward             | 59.290 ms                 | 396.831 ms                |
| BlockToStepN              | 120.832 ms                | 766.127 ms                |
| OneStep                   | 365.436 ms                | 1.175 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 17:51:42.933991 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=5, step_no=189, sample_step_cpp_seen_[rank]=188
W20240204 17:51:43.513269 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240204 17:51:44.513010 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240204 17:51:45.582000 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.926 ms                  | 19.625 ms                 |
| ProcessBack:UpdateCache   | 10.145 ms                 | 14.001 ms                 |
| ProcessBack:UpsertPq      | 32.812 ms                 | 143.888 ms                |
| ProcessOneStep            | 59.289 ms                 | 396.778 ms                |
| BlockToStepN              | 120.761 ms                | 766.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:46.581008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 7] 200 steps, total: 43.495, sample: 1.344, forward: 0.525, backward: 0.998, update: 0.259
[proc 6] 200 steps, total: 43.495, sample: 1.365, forward: 0.559, backward: 0.729, update: 0.251
[proc 4] 200 steps, total: 43.495, sample: 1.446, forward: 0.524, backward: 1.088, update: 0.279
[proc 5] 200 steps, total: 43.495, sample: 1.743, forward: 0.559, backward: 0.888, update: 0.290
[proc 3] 200 steps, total: 43.495, sample: 2.527, forward: 0.541, backward: 0.953, update: 0.246
[proc 2] 200 steps, total: 43.495, sample: 2.079, forward: 0.522, backward: 0.885, update: 0.253
[proc 0] 200 steps, total: 43.495, sample: 1.912, forward: 0.559, backward: 0.997, update: 0.328
[proc 1] 200 steps, total: 43.495, sample: 2.330, forward: 0.523, backward: 0.975, update: 0.258
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.274 ms                  | 155.226 ms                |
| Forward                   | 5.313 ms                  | 16.084 ms                 |
| Backward                  | 10.658 ms                 | 15.698 ms                 |
| Optimize                  | 2.771 ms                  | 6.372 ms                  |
| BarrierTimeBeforeRank0    | 3.197 ms                  | 222.227 ms                |
| AfterBackward             | 59.327 ms                 | 396.831 ms                |
| BlockToStepN              | 120.832 ms                | 766.127 ms                |
| OneStep                   | 360.433 ms                | 1.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:47.581008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240204 17:51:48.581019 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
E20240204 17:51:48.742118 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=203, sample_step_cpp_seen_[rank]=202
W20240204 17:51:49.581009 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240204 17:51:50.581007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.906 ms                  | 19.625 ms                 |
| ProcessBack:UpdateCache   | 10.049 ms                 | 14.001 ms                 |
| ProcessBack:UpsertPq      | 32.934 ms                 | 143.888 ms                |
| ProcessOneStep            | 59.257 ms                 | 396.778 ms                |
| BlockToStepN              | 128.064 ms                | 766.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:51.815019 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.558 ms                  | 155.226 ms                |
| Forward                   | 5.314 ms                  | 16.084 ms                 |
| Backward                  | 10.648 ms                 | 15.698 ms                 |
| Optimize                  | 2.764 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.840 ms                  | 222.227 ms                |
| AfterBackward             | 59.237 ms                 | 396.831 ms                |
| BlockToStepN              | 164.359 ms                | 766.127 ms                |
| OneStep                   | 364.838 ms                | 1.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:52.815006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240204 17:51:53.815007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240204 17:51:54.815007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240204 17:51:55.815008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.896 ms                  | 19.625 ms                 |
| ProcessBack:UpdateCache   | 10.023 ms                 | 14.001 ms                 |
| ProcessBack:UpsertPq      | 32.807 ms                 | 143.888 ms                |
| ProcessOneStep            | 58.736 ms                 | 396.778 ms                |
| BlockToStepN              | 146.611 ms                | 766.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:56.815007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.676 ms                  | 155.226 ms                |
| Forward                   | 5.309 ms                  | 16.084 ms                 |
| Backward                  | 10.625 ms                 | 15.698 ms                 |
| Optimize                  | 2.764 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.840 ms                  | 222.227 ms                |
| AfterBackward             | 58.639 ms                 | 396.831 ms                |
| BlockToStepN              | 164.359 ms                | 766.127 ms                |
| OneStep                   | 364.838 ms                | 1.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:51:57.885543 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240204 17:51:58.885005 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
E20240204 17:51:59.292711 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=225, sample_step_cpp_seen_[rank]=224
W20240204 17:51:59.885007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240204 17:52:00.885007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.888 ms                  | 19.039 ms                 |
| ProcessBack:UpdateCache   | 9.990 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 32.660 ms                 | 137.882 ms                |
| ProcessOneStep            | 58.374 ms                 | 396.778 ms                |
| BlockToStepN              | 174.262 ms                | 766.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:02.149713 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.577 ms                  | 155.226 ms                |
| Forward                   | 5.286 ms                  | 16.084 ms                 |
| Backward                  | 10.609 ms                 | 15.698 ms                 |
| Optimize                  | 2.768 ms                  | 9.782 ms                  |
| BarrierTimeBeforeRank0    | 3.104 ms                  | 222.227 ms                |
| AfterBackward             | 58.404 ms                 | 396.831 ms                |
| BlockToStepN              | 164.359 ms                | 766.127 ms                |
| OneStep                   | 360.433 ms                | 1.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:03.149008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=234, pq.top=234
W20240204 17:52:04.183547 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240204 17:52:05.183008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.884 ms                  | 19.039 ms                 |
| ProcessBack:UpdateCache   | 9.987 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 32.630 ms                 | 137.882 ms                |
| ProcessOneStep            | 58.365 ms                 | 396.778 ms                |
| BlockToStepN              | 189.927 ms                | 774.006 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:06.183005 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240204 17:52:07.183007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
E20240204 17:52:07.299252 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=2, step_no=241, sample_step_cpp_seen_[rank]=240
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.608 ms                  | 155.226 ms                |
| Forward                   | 5.309 ms                  | 16.084 ms                 |
| Backward                  | 10.592 ms                 | 16.616 ms                 |
| Optimize                  | 2.760 ms                  | 9.782 ms                  |
| BarrierTimeBeforeRank0    | 2.860 ms                  | 222.227 ms                |
| AfterBackward             | 58.404 ms                 | 396.831 ms                |
| BlockToStepN              | 190.605 ms                | 774.117 ms                |
| OneStep                   | 364.838 ms                | 1.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:08.183007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=244, pq.top=244
W20240204 17:52:09.183007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240204 17:52:10.183007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.882 ms                  | 19.039 ms                 |
| ProcessBack:UpdateCache   | 9.942 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 32.778 ms                 | 137.882 ms                |
| ProcessOneStep            | 58.507 ms                 | 396.778 ms                |
| BlockToStepN              | 190.526 ms                | 779.453 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:11.183007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240204 17:52:12.183007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.608 ms                  | 144.491 ms                |
| Forward                   | 5.287 ms                  | 11.535 ms                 |
| Backward                  | 10.560 ms                 | 15.698 ms                 |
| Optimize                  | 2.764 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.840 ms                  | 201.968 ms                |
| AfterBackward             | 58.560 ms                 | 391.720 ms                |
| BlockToStepN              | 191.821 ms                | 792.075 ms                |
| OneStep                   | 360.433 ms                | 1.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:13.183007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240204 17:52:14.415051 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240204 17:52:15.455971 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
E20240204 17:52:15.970896 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=1, step_no=257, sample_step_cpp_seen_[rank]=256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 19.039 ms                 |
| ProcessBack:UpdateCache   | 9.911 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 32.807 ms                 | 137.882 ms                |
| ProcessOneStep            | 58.507 ms                 | 391.659 ms                |
| BlockToStepN              | 198.583 ms                | 779.453 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:16.455008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.724 ms                  | 144.491 ms                |
| Forward                   | 5.313 ms                  | 12.887 ms                 |
| Backward                  | 10.547 ms                 | 15.698 ms                 |
| Optimize                  | 2.759 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.593 ms                  | 201.968 ms                |
| AfterBackward             | 58.560 ms                 | 391.720 ms                |
| BlockToStepN              | 191.821 ms                | 779.721 ms                |
| OneStep                   | 360.433 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:17.455004 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240204 17:52:18.455008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240204 17:52:19.455008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240204 17:52:20.522248 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.876 ms                  | 19.039 ms                 |
| ProcessBack:UpdateCache   | 9.841 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 33.015 ms                 | 137.882 ms                |
| ProcessOneStep            | 58.606 ms                 | 391.659 ms                |
| BlockToStepN              | 198.583 ms                | 785.998 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:21.522007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=268, pq.top=268
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.904 ms                  | 144.491 ms                |
| Forward                   | 5.313 ms                  | 12.887 ms                 |
| Backward                  | 10.535 ms                 | 15.698 ms                 |
| Optimize                  | 2.760 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.593 ms                  | 201.968 ms                |
| AfterBackward             | 58.639 ms                 | 391.720 ms                |
| BlockToStepN              | 201.981 ms                | 786.102 ms                |
| OneStep                   | 360.433 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:22.544337 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
W20240204 17:52:23.544008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240204 17:52:24.544008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
E20240204 17:52:24.652994 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=273, sample_step_cpp_seen_[rank]=272
W20240204 17:52:25.544008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.876 ms                  | 17.839 ms                 |
| ProcessBack:UpdateCache   | 9.821 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 32.934 ms                 | 68.762 ms                 |
| ProcessOneStep            | 58.606 ms                 | 391.659 ms                |
| BlockToStepN              | 204.982 ms                | 785.998 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:26.544004 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.904 ms                  | 144.491 ms                |
| Forward                   | 5.314 ms                  | 12.887 ms                 |
| Backward                  | 10.515 ms                 | 15.698 ms                 |
| Optimize                  | 2.762 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.577 ms                  | 201.968 ms                |
| AfterBackward             | 58.771 ms                 | 391.720 ms                |
| BlockToStepN              | 205.069 ms                | 786.102 ms                |
| OneStep                   | 360.433 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:27.544008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240204 17:52:28.544008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240204 17:52:29.544008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240204 17:52:30.606351 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.873 ms                  | 17.839 ms                 |
| ProcessBack:UpdateCache   | 9.803 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 32.934 ms                 | 68.762 ms                 |
| ProcessOneStep            | 58.507 ms                 | 391.659 ms                |
| BlockToStepN              | 207.477 ms                | 787.983 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:31.606009 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.962 ms                  | 144.491 ms                |
| Forward                   | 5.313 ms                  | 12.887 ms                 |
| Backward                  | 10.480 ms                 | 15.698 ms                 |
| Optimize                  | 2.764 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.379 ms                  | 201.968 ms                |
| AfterBackward             | 58.560 ms                 | 391.720 ms                |
| BlockToStepN              | 211.164 ms                | 788.081 ms                |
| OneStep                   | 360.433 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:32.606006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
E20240204 17:52:33.553681 13704 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=289, sample_step_cpp_seen_[rank]=288
W20240204 17:52:33.902305 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240204 17:52:34.902007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240204 17:52:35.911617 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 19.039 ms                 |
| ProcessBack:UpdateCache   | 9.783 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 33.015 ms                 | 68.762 ms                 |
| ProcessOneStep            | 58.420 ms                 | 391.659 ms                |
| BlockToStepN              | 211.112 ms                | 791.956 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:36.911007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=296, pq.top=296
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.962 ms                  | 144.491 ms                |
| Forward                   | 5.313 ms                  | 12.887 ms                 |
| Backward                  | 10.335 ms                 | 15.698 ms                 |
| Optimize                  | 2.764 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.727 ms                  | 201.968 ms                |
| AfterBackward             | 58.560 ms                 | 391.720 ms                |
| BlockToStepN              | 211.164 ms                | 792.075 ms                |
| OneStep                   | 360.433 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:38.016203 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=298, pq.top=298
W20240204 17:52:39.016007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 6] 300 steps, total: 52.268, sample: 1.380, forward: 0.555, backward: 0.437, update: 0.233
[proc 5] 300 steps, total: 52.268, sample: 1.431, forward: 0.563, backward: 0.999, update: 0.262
[proc 7] 300 steps, total: 52.268, sample: 1.293, forward: 0.561, backward: 0.995, update: 0.278
[proc 0] 300 steps, total: 52.268, sample: 1.659, forward: 0.558, backward: 0.976, update: 0.344
[proc 1] 300 steps, total: 52.268, sample: 1.671, forward: 0.529, backward: 0.936, update: 0.257
[proc 3] 300 steps, total: 52.268, sample: 1.976, forward: 0.570, backward: 1.093, update: 0.252
[proc 4] 300 steps, total: 52.268, sample: 1.202, forward: 0.570, backward: 0.921, update: 0.279
[proc 2] 300 steps, total: 52.268, sample: 1.558, forward: 0.525, backward: 0.984, update: 0.268
W20240204 17:52:40.016007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=301, pq.top=301
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.873 ms                  | 19.039 ms                 |
| ProcessBack:UpdateCache   | 9.803 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 33.122 ms                 | 68.762 ms                 |
| ProcessOneStep            | 58.606 ms                 | 391.659 ms                |
| BlockToStepN              | 214.086 ms                | 793.155 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:41.016005 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240204 17:52:42.016006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.966 ms                  | 144.491 ms                |
| Forward                   | 5.314 ms                  | 12.887 ms                 |
| Backward                  | 10.265 ms                 | 16.616 ms                 |
| Optimize                  | 2.768 ms                  | 8.959 ms                  |
| BarrierTimeBeforeRank0    | 2.860 ms                  | 201.968 ms                |
| AfterBackward             | 58.771 ms                 | 391.720 ms                |
| BlockToStepN              | 214.174 ms                | 793.279 ms                |
| OneStep                   | 360.433 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 17:52:42.550578 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=3, step_no=305, sample_step_cpp_seen_[rank]=304
W20240204 17:52:43.016008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240204 17:52:44.016007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240204 17:52:45.016006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.876 ms                  | 19.039 ms                 |
| ProcessBack:UpdateCache   | 9.780 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 33.193 ms                 | 68.762 ms                 |
| ProcessOneStep            | 58.817 ms                 | 391.659 ms                |
| BlockToStepN              | 228.991 ms                | 793.155 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:46.080443 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240204 17:52:47.080008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=314, pq.top=314
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.962 ms                  | 144.491 ms                |
| Forward                   | 5.320 ms                  | 12.887 ms                 |
| Backward                  | 10.182 ms                 | 16.616 ms                 |
| Optimize                  | 2.768 ms                  | 9.782 ms                  |
| BarrierTimeBeforeRank0    | 2.840 ms                  | 201.968 ms                |
| AfterBackward             | 58.855 ms                 | 391.720 ms                |
| BlockToStepN              | 223.710 ms                | 793.279 ms                |
| OneStep                   | 364.838 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:48.134747 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=316, pq.top=316
W20240204 17:52:49.134028 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240204 17:52:50.134008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.876 ms                  | 19.039 ms                 |
| ProcessBack:UpdateCache   | 9.742 ms                  | 13.782 ms                 |
| ProcessBack:UpsertPq      | 33.254 ms                 | 68.762 ms                 |
| ProcessOneStep            | 59.092 ms                 | 391.659 ms                |
| BlockToStepN              | 228.991 ms                | 793.155 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:51.134004 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240204 17:52:51.637733 16753 grad_async_v1.h:533] Stalled in ProcessBackward: rank=1, step_no=321, sample_step_cpp_seen_[rank]=320
W20240204 17:52:52.134008 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.040 ms                  | 144.491 ms                |
| Forward                   | 5.321 ms                  | 12.887 ms                 |
| Backward                  | 10.014 ms                 | 16.616 ms                 |
| Optimize                  | 2.764 ms                  | 9.782 ms                  |
| BarrierTimeBeforeRank0    | 2.580 ms                  | 201.968 ms                |
| AfterBackward             | 59.181 ms                 | 391.720 ms                |
| BlockToStepN              | 229.084 ms                | 793.279 ms                |
| OneStep                   | 364.838 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:53.134006 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240204 17:52:54.134007 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=326, pq.top=326
W20240204 17:52:55.170396 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=328, pq.top=328
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 17.839 ms                 |
| ProcessBack:UpdateCache   | 9.692 ms                  | 13.260 ms                 |
| ProcessBack:UpsertPq      | 33.254 ms                 | 66.854 ms                 |
| ProcessOneStep            | 59.147 ms                 | 391.659 ms                |
| BlockToStepN              | 233.997 ms                | 794.904 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 17:52:56.170004 13704 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=329, pq.top=329
Successfully xmh. training takes 156.35491847991943 seconds
before call kg_cache_controller.StopThreads()
W20240204 17:52:56.611347 13704 grad_async_v1.h:243] call StopThreads. PID = 51701
W20240204 17:52:56.611375 13704 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 17:52:56.616758 13704 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 17:52:56.616770 13704 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 17:52:56.667656 13704 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.102 ms                  | 144.491 ms                |
| Forward                   | 5.313 ms                  | 12.887 ms                 |
| Backward                  | 9.899 ms                  | 16.616 ms                 |
| Optimize                  | 2.760 ms                  | 9.782 ms                  |
| BarrierTimeBeforeRank0    | 2.379 ms                  | 201.968 ms                |
| AfterBackward             | 59.126 ms                 | 391.720 ms                |
| BlockToStepN              | 235.777 ms                | 795.003 ms                |
| OneStep                   | 364.838 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
