WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 10:21:17.061398 31670 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_115', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=6, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [31670 sampler.py:454] Start PreSampling
WARNING [31670 sampler.py:532] Before construct renumbering_dict
WARNING [31670 sampler.py:555] PreSampling done
W20240204 10:21:22.563557 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 10:21:22.563846 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 10:21:22.563900 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 10:21:22.563951 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 10:21:22.563989 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 10:21:22.564021 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 10:21:22.564077 31670 IPCTensor.h:369] NewIPCTensor: step_r0 [6]0x100002dd4000 48 B 
W20240204 10:21:22.564105 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100002dd6000 8 B 
W20240204 10:21:22.564131 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100002dd8000 8 B 
W20240204 10:21:22.564256 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100002dda000 7.629 MB
W20240204 10:21:22.564291 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x10000357d000 7.629 MB
W20240204 10:21:22.564318 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100003d20000 7.629 MB
W20240204 10:21:22.564385 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000044c3000 7.629 MB
W20240204 10:21:22.564422 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100004c66000 7.629 MB
W20240204 10:21:22.564460 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100005409000 7.629 MB
W20240204 10:21:22.564494 31670 IPCTensor.h:369] NewIPCTensor: step_r1 [6]0x100005bac000 48 B 
W20240204 10:21:22.564534 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100005bae000 8 B 
W20240204 10:21:22.564566 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100005bb0000 8 B 
W20240204 10:21:22.564623 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100005bb2000 7.629 MB
W20240204 10:21:22.564666 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100006355000 7.629 MB
W20240204 10:21:22.564708 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100006af8000 7.629 MB
W20240204 10:21:22.564735 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000729b000 7.629 MB
W20240204 10:21:22.564774 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x100007a3e000 7.629 MB
W20240204 10:21:22.564803 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000081e1000 7.629 MB
W20240204 10:21:22.564831 31670 IPCTensor.h:369] NewIPCTensor: step_r2 [6]0x100008984000 48 B 
W20240204 10:21:22.564855 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x100008986000 8 B 
W20240204 10:21:22.564883 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100008988000 8 B 
W20240204 10:21:22.564935 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000898a000 7.629 MB
W20240204 10:21:22.564970 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000912d000 7.629 MB
W20240204 10:21:22.565006 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000098d0000 7.629 MB
W20240204 10:21:22.565034 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000a073000 7.629 MB
W20240204 10:21:22.565091 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10000a816000 7.629 MB
W20240204 10:21:22.565124 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10000afb9000 7.629 MB
W20240204 10:21:22.565150 31670 IPCTensor.h:369] NewIPCTensor: step_r3 [6]0x10000b75c000 48 B 
W20240204 10:21:22.565174 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10000b75e000 8 B 
W20240204 10:21:22.565207 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10000b760000 8 B 
W20240204 10:21:22.565258 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10000b762000 7.629 MB
W20240204 10:21:22.565289 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x10000bf05000 7.629 MB
W20240204 10:21:22.565320 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x10000c6a8000 7.629 MB
W20240204 10:21:22.565346 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10000ce4b000 7.629 MB
W20240204 10:21:22.565373 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10000d5ee000 7.629 MB
W20240204 10:21:22.565400 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x10000dd91000 7.629 MB
W20240204 10:21:22.565431 31670 IPCTensor.h:369] NewIPCTensor: step_r4 [6]0x10000e534000 48 B 
W20240204 10:21:22.565455 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x10000e536000 8 B 
W20240204 10:21:22.565486 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x10000e538000 8 B 
W20240204 10:21:22.565536 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x10000e53a000 7.629 MB
W20240204 10:21:22.565568 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x10000ecdd000 7.629 MB
W20240204 10:21:22.565596 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x10000f480000 7.629 MB
W20240204 10:21:22.565631 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x10000fc23000 7.629 MB
W20240204 10:21:22.565666 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000103c6000 7.629 MB
W20240204 10:21:22.565702 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x100010b69000 7.629 MB
W20240204 10:21:22.565730 31670 IPCTensor.h:369] NewIPCTensor: step_r5 [6]0x10001130c000 48 B 
W20240204 10:21:22.565760 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001130e000 8 B 
W20240204 10:21:22.565784 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100011310000 8 B 
W20240204 10:21:22.565841 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x100011312000 7.629 MB
W20240204 10:21:22.565888 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x100011ab5000 7.629 MB
W20240204 10:21:22.565922 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x100012258000 7.629 MB
W20240204 10:21:22.565956 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000129fb000 7.629 MB
W20240204 10:21:22.565994 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001319e000 7.629 MB
W20240204 10:21:22.566022 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x100013941000 7.629 MB
W20240204 10:21:22.566056 31670 IPCTensor.h:369] NewIPCTensor: step_r6 [6]0x1000140e4000 48 B 
W20240204 10:21:22.566080 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000140e6000 8 B 
W20240204 10:21:22.566110 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000140e8000 8 B 
W20240204 10:21:22.566162 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000140ea000 7.629 MB
W20240204 10:21:22.566202 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10001488d000 7.629 MB
W20240204 10:21:22.566231 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100015030000 7.629 MB
W20240204 10:21:22.566265 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000157d3000 7.629 MB
W20240204 10:21:22.566301 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x100015f76000 7.629 MB
W20240204 10:21:22.566339 31670 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100016719000 7.629 MB
W20240204 10:21:22.566370 31670 IPCTensor.h:369] NewIPCTensor: step_r7 [6]0x100016ebc000 48 B 
W20240204 10:21:22.566393 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x100016ebe000 8 B 
W20240204 10:21:22.566417 31670 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100016ec0000 8 B 
W20240204 10:21:22.853823 31670 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100016ec2000 22.81 MB
W20240204 10:21:22.942104 31670 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100018594000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 763, 1053, 1538,  ..., 9565, 8944, 7634]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.981 seconds
[Rank1] pid = 32255
[Rank2] pid = 32274
[Rank3] pid = 32383
[Rank4] pid = 32384
[Rank5] pid = 32385
[Rank6] pid = 32444
INFO [31670 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [32255 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [32274 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [32383 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [32385 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [32384 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [32444 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [32516 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [32444 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [32516 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [32385 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31670 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [32255 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [32383 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [32384 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [32274 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:21:25.729539 32579 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 10:21:25.730506 32515 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 10:21:25.730543 32386 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240204 10:21:25.730562 32642 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240204 10:21:25.730726 32256 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 10:21:25.730723 32433 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 10:21:25.730782 32320 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240204 10:21:25.730780 32397 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240204 10:21:25.759312 32642 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1000185a6000 7.629 MB
W20240204 10:21:25.759511 32642 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x100018d4b000 7.629 MB
W20240204 10:21:25.759591 32642 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1000194ee000 1.49 GB
W20240204 10:21:25.759663 32642 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x100079274000 1.49 GB
W20240204 10:21:25.759662 32515 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100078ad1000 7.629 MB
W20240204 10:21:25.759725 32642 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:21:25.759846 32515 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000d8857000 7.629 MB
W20240204 10:21:25.759930 32515 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1000d8ffa000 1.49 GB
W20240204 10:21:25.759999 32515 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1001385dd000 1.49 GB
W20240204 10:21:25.760061 32515 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:21:25.764408 32579 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100197bc2000 7.629 MB
W20240204 10:21:25.764547 32579 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100198365000 7.629 MB
W20240204 10:21:25.764606 32579 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x100198b08000 1.49 GB
W20240204 10:21:25.764652 32579 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1001f80eb000 1.49 GB
W20240204 10:21:25.764699 32579 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:21:25.766907 32642 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:21:25.766983 32515 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:21:25.766988 32386 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1002576dc000 7.629 MB
W20240204 10:21:25.767071 32397 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100257e7f000 7.629 MB
W20240204 10:21:25.767077 32256 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100258622000 7.629 MB
W20240204 10:21:25.767094 32320 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100258dc5000 7.629 MB
W20240204 10:21:25.767130 32433 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100259568000 7.629 MB
W20240204 10:21:25.767179 32386 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100259d0b000 7.629 MB
W20240204 10:21:25.767236 32397 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10025a4ae000 7.629 MB
W20240204 10:21:25.767249 32256 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10025ac51000 7.629 MB
W20240204 10:21:25.767256 32320 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10025b3f4000 7.629 MB
W20240204 10:21:25.767262 32386 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10025bb97000 1.49 GB
W20240204 10:21:25.767309 32433 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1002bb17a000 7.629 MB
W20240204 10:21:25.767331 32397 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1002bb91d000 1.49 GB
W20240204 10:21:25.767354 32320 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10031af00000 1.49 GB
W20240204 10:21:25.767364 32386 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10037a4e3000 1.49 GB
W20240204 10:21:25.767372 32256 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1003d9ac6000 1.49 GB
W20240204 10:21:25.767418 32433 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1004390a9000 1.49 GB
W20240204 10:21:25.767427 32397 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10049868c000 1.49 GB
W20240204 10:21:25.767439 32386 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:21:25.767446 32320 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1004f7c6f000 1.49 GB
W20240204 10:21:25.767477 32256 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100557252000 1.49 GB
W20240204 10:21:25.767493 32397 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:21:25.767496 32433 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1005b6835000 1.49 GB
W20240204 10:21:25.767510 32320 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:21:25.767529 32256 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:21:25.767549 32433 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:21:25.780057 32579 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:21:25.783051 32397 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:21:25.783078 32256 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:21:25.783087 32433 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:21:25.783082 32386 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:21:25.783108 32320 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100016ec2000
4: KnownLocalCachedEmbedding init done
WARNING [32384 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
7: KnownLocalCachedEmbedding init done
WARNING [32516 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
2: KnownLocalCachedEmbedding init done
WARNING [32274 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
1: KnownLocalCachedEmbedding init done
WARNING [32255 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
5: KnownLocalCachedEmbedding init done
WARNING [32385 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 32516
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100016ec2000
0: KnownLocalCachedEmbedding init done
WARNING [31670 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
3: KnownLocalCachedEmbedding init done
WARNING [32383 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
6: KnownLocalCachedEmbedding init done
WARNING [32444 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 10:21:28.630878 32515 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 10:21:28.630944 32397 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:21:28.631107 32256 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:21:28.631516 32320 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:21:28.631743 32579 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:21:28.631870 32386 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:21:28.631992 32433 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:21:28.632565 32642 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 10:21:28.636981 32579 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 6,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 10:21:28.637312 32579 grad_base.h:184] Init GradProcessingBase done
I20240204 10:21:28.642884 32579 grad_async_v1.h:203] Use main thread to update emb.
W20240204 10:21:28.642971 32579 kg_controller.h:75] after init GradAsyncProcessing
I20240204 10:21:28.642987 32579 kg_controller.h:84] Construct KGCacheController done
E20240204 10:21:30.443076 32515 recstore.cc:66] init folly done
E20240204 10:21:30.443091 32642 recstore.cc:66] init folly done
E20240204 10:21:30.443121 32320 recstore.cc:66] init folly done
E20240204 10:21:30.443713 32256 recstore.cc:66] init folly done
E20240204 10:21:30.444198 32433 recstore.cc:66] init folly done
E20240204 10:21:30.444319 32386 recstore.cc:66] init folly done
E20240204 10:21:30.444344 32579 recstore.cc:66] init folly done
E20240204 10:21:30.444351 32397 recstore.cc:66] init folly done
I20240204 10:21:30.445706 32579 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 10:21:31.259883 32579 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 10:21:31.272322 32320 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:21:31.276018 32397 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:21:31.277657 32256 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:21:31.280668 32642 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:21:31.283236 32386 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:21:31.284227 32433 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:21:31.284292 32515 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 812.523 us                | 812.523 us                |
| Forward                   | 727.580 ms                | 727.580 ms                |
| Backward                  | 209.404 ms                | 209.404 ms                |
| Optimize                  | 4.309 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 152.554 us                | 152.554 us                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:33.883034 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=0
E20240204 10:21:33.993881 33366 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
W20240204 10:21:34.883037 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=10, pq.top=10
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.803 ms                  | 415.271 ms                |
| ProcessBack:UpdateCache   | 9.260 ms                  | 934.600 ms                |
| ProcessBack:UpsertPq      | 13.093 ms                 | 19.821 ms                 |
| ProcessOneStep            | 31.941 ms                 | 1.654 s                   |
| BlockToStepN              | 4.332 ms                  | 165.392 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:35.922641 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=14, pq.top=14
W20240204 10:21:36.922037 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240204 10:21:37.922008 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=20, pq.top=20
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.996 ms                  | 19.577 ms                 |
| Forward                   | 5.544 ms                  | 727.580 ms                |
| Backward                  | 9.409 ms                  | 209.404 ms                |
| Optimize                  | 1.832 ms                  | 6.394 ms                  |
| BarrierTimeBeforeRank0    | 48.914 us                 | 21.208 ms                 |
| AfterBackward             | 31.692 ms                 | 1.655 s                   |
| BlockToStepN              | 165.614 ms                | 290.995 ms                |
| OneStep                   | 281.517 ms                | 2.656 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:38.922015 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240204 10:21:39.922005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=26, pq.top=26
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.398 ms                  | 382.197 ms                |
| ProcessBack:UpdateCache   | 10.118 ms                 | 933.930 ms                |
| ProcessBack:UpsertPq      | 10.480 ms                 | 18.788 ms                 |
| ProcessOneStep            | 30.534 ms                 | 1.654 s                   |
| BlockToStepN              | 220.817 ms                | 357.967 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:40.922005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=28, pq.top=28
W20240204 10:21:41.922019 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240204 10:21:42.922006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.321 ms                  | 22.895 ms                 |
| Forward                   | 5.018 ms                  | 727.580 ms                |
| Backward                  | 9.059 ms                  | 209.404 ms                |
| Optimize                  | 1.793 ms                  | 6.394 ms                  |
| BarrierTimeBeforeRank0    | 68.593 us                 | 21.208 ms                 |
| AfterBackward             | 29.833 ms                 | 1.655 s                   |
| BlockToStepN              | 246.824 ms                | 358.030 ms                |
| OneStep                   | 315.893 ms                | 2.656 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:43.922005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=38, pq.top=38
W20240204 10:21:44.922006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=40, pq.top=40
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.229 ms                  | 382.197 ms                |
| ProcessBack:UpdateCache   | 9.603 ms                  | 933.930 ms                |
| ProcessBack:UpsertPq      | 10.026 ms                 | 18.788 ms                 |
| ProcessOneStep            | 29.445 ms                 | 1.654 s                   |
| BlockToStepN              | 264.478 ms                | 366.017 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:45.926173 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240204 10:21:46.926012 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240204 10:21:47.926008 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.171 ms                  | 22.895 ms                 |
| Forward                   | 4.982 ms                  | 727.580 ms                |
| Backward                  | 8.859 ms                  | 209.404 ms                |
| Optimize                  | 1.786 ms                  | 6.394 ms                  |
| BarrierTimeBeforeRank0    | 425.008 us                | 21.208 ms                 |
| AfterBackward             | 28.686 ms                 | 1.655 s                   |
| BlockToStepN              | 284.557 ms                | 397.840 ms                |
| OneStep                   | 348.062 ms                | 2.656 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:48.926005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=50, pq.top=50
W20240204 10:21:49.926007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=52, pq.top=52
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.144 ms                  | 382.197 ms                |
| ProcessBack:UpdateCache   | 9.190 ms                  | 933.930 ms                |
| ProcessBack:UpsertPq      | 9.718 ms                  | 18.788 ms                 |
| ProcessOneStep            | 28.651 ms                 | 314.610 ms                |
| BlockToStepN              | 290.922 ms                | 394.846 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:50.926020 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=54, pq.top=54
W20240204 10:21:51.926016 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240204 10:21:52.936245 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.189 ms                  | 19.577 ms                 |
| Forward                   | 4.913 ms                  | 14.333 ms                 |
| Backward                  | 8.940 ms                  | 22.219 ms                 |
| Optimize                  | 1.786 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 152.554 us                | 13.797 ms                 |
| AfterBackward             | 28.613 ms                 | 314.661 ms                |
| BlockToStepN              | 317.835 ms                | 446.228 ms                |
| OneStep                   | 373.870 ms                | 497.968 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:53.936005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240204 10:21:54.936019 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.144 ms                  | 382.197 ms                |
| ProcessBack:UpdateCache   | 9.201 ms                  | 933.930 ms                |
| ProcessBack:UpsertPq      | 9.646 ms                  | 18.788 ms                 |
| ProcessOneStep            | 28.572 ms                 | 314.610 ms                |
| BlockToStepN              | 318.337 ms                | 449.190 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:55.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240204 10:21:56.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240204 10:21:57.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.165 ms                  | 19.577 ms                 |
| Forward                   | 4.892 ms                  | 14.333 ms                 |
| Backward                  | 8.879 ms                  | 22.219 ms                 |
| Optimize                  | 1.786 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 772.044 us                | 13.797 ms                 |
| AfterBackward             | 28.607 ms                 | 314.661 ms                |
| BlockToStepN              | 333.680 ms                | 452.588 ms                |
| OneStep                   | 387.403 ms                | 502.836 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:21:58.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240204 10:21:59.936018 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.970 ms                  | 382.197 ms                |
| ProcessBack:UpdateCache   | 9.412 ms                  | 933.930 ms                |
| ProcessBack:UpsertPq      | 9.692 ms                  | 18.788 ms                 |
| ProcessOneStep            | 28.547 ms                 | 314.610 ms                |
| BlockToStepN              | 336.483 ms                | 454.126 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:00.936010 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240204 10:22:01.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240204 10:22:02.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.165 ms                  | 26.974 ms                 |
| Forward                   | 4.881 ms                  | 14.333 ms                 |
| Backward                  | 8.858 ms                  | 22.219 ms                 |
| Optimize                  | 1.786 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 1.437 ms                  | 14.485 ms                 |
| AfterBackward             | 28.607 ms                 | 314.661 ms                |
| BlockToStepN              | 348.807 ms                | 478.641 ms                |
| OneStep                   | 410.035 ms                | 549.054 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:03.936014 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240204 10:22:04.936012 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.004 ms                  | 28.599 ms                 |
| ProcessBack:UpdateCache   | 9.603 ms                  | 13.831 ms                 |
| ProcessBack:UpsertPq      | 9.718 ms                  | 18.396 ms                 |
| ProcessOneStep            | 28.572 ms                 | 314.610 ms                |
| BlockToStepN              | 358.720 ms                | 478.575 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:05.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240204 10:22:06.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240204 10:22:07.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.169 ms                  | 26.974 ms                 |
| Forward                   | 4.881 ms                  | 14.333 ms                 |
| Backward                  | 8.850 ms                  | 22.219 ms                 |
| Optimize                  | 1.815 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 1.594 ms                  | 14.485 ms                 |
| AfterBackward             | 28.613 ms                 | 314.661 ms                |
| BlockToStepN              | 366.079 ms                | 482.137 ms                |
| OneStep                   | 424.500 ms                | 549.054 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:08.936017 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240204 10:22:09.936012 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.117 ms                  | 28.599 ms                 |
| ProcessBack:UpdateCache   | 9.683 ms                  | 13.831 ms                 |
| ProcessBack:UpsertPq      | 9.787 ms                  | 18.396 ms                 |
| ProcessOneStep            | 28.576 ms                 | 314.610 ms                |
| BlockToStepN              | 374.781 ms                | 482.649 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:10.936005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240204 10:22:11.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240204 10:22:12.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.165 ms                  | 26.974 ms                 |
| Forward                   | 4.814 ms                  | 14.333 ms                 |
| Backward                  | 8.858 ms                  | 22.219 ms                 |
| Optimize                  | 1.793 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 1.594 ms                  | 14.485 ms                 |
| AfterBackward             | 28.686 ms                 | 314.661 ms                |
| BlockToStepN              | 387.210 ms                | 486.146 ms                |
| OneStep                   | 440.162 ms                | 560.758 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 42.451, sample: 0.378, forward: 1.153, backward: 1.124, update: 0.203
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 42.457, sample: 0.378, forward: 1.127, backward: 0.699, update: 0.178
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 42.451, sample: 0.384, forward: 1.089, backward: 1.100, update: 0.188
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 42.454, sample: 0.369, forward: 1.057, backward: 0.627, update: 0.171
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 42.451, sample: 0.371, forward: 1.130, backward: 1.188, update: 0.189
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 42.462, sample: 0.372, forward: 1.092, backward: 1.083, update: 0.184
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 42.459, sample: 0.346, forward: 1.033, backward: 1.047, update: 0.182
train_sampler.Prefill()
-------Step 0-------
tensor([ 2087,    63,  3555,  3421, 12752, 13238,  1150,   427, 13340,  8667]) tensor([ 1538,  5556,  6232, 11618, 12229,  1109,   558,  5351,   518,  7318])
-------Step 1-------
tensor([ 2087,    63,  3555,  3421, 12752, 13238,  1150,   427, 13340,  8667]) tensor([ 4242, 10628, 12957,  1198,   987,  6811, 14516, 10355,  5744, 13495])
-------Step 2-------
tensor([ 8176,  8129,  5270,  4111, 10760,  9142, 10904,    85, 11224,   934]) tensor([ 3273,  4875,  4117,  5066,  5322,  9428, 13918, 10124, 13805, 10391])
-------Step 3-------
tensor([ 8176,  8129,  5270,  4111, 10760,  9142, 10904,    85, 11224,   934]) tensor([ 9177,  6065,  7938, 11458,  7702,   692,  5824,  2259, 12984,  2292])
-------Step 4-------
tensor([   63, 10232,  6156,  5022,  5111,  3645,    29,  7575,  8241,  1067]) tensor([ 614, 1283, 4348, 3526, 2056, 2028,  427, 7249, 6280, 1946])
-------Step 5-------
tensor([   63, 10232,  6156,  5022,  5111,  3645,    29,  7575,  8241,  1067]) tensor([6498, 4929, 6496, 1810, 3496,  872,  825, 1287, 6659, 7131])
before start barrier
start train
[proc 0] 100 steps, total: 42.475, sample: 0.459, forward: 1.244, backward: 0.987, update: 0.195
W20240204 10:22:13.936018 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240204 10:22:14.936010 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.118 ms                  | 28.599 ms                 |
| ProcessBack:UpdateCache   | 9.701 ms                  | 13.831 ms                 |
| ProcessBack:UpsertPq      | 9.757 ms                  | 18.788 ms                 |
| ProcessOneStep            | 28.583 ms                 | 314.610 ms                |
| BlockToStepN              | 391.562 ms                | 502.368 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:15.936013 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240204 10:22:16.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=106, pq.top=106
W20240204 10:22:17.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=108, pq.top=108
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.171 ms                  | 26.974 ms                 |
| Forward                   | 4.818 ms                  | 14.333 ms                 |
| Backward                  | 8.850 ms                  | 22.219 ms                 |
| Optimize                  | 1.793 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 1.594 ms                  | 14.485 ms                 |
| AfterBackward             | 28.686 ms                 | 314.661 ms                |
| BlockToStepN              | 394.933 ms                | 511.742 ms                |
| OneStep                   | 450.139 ms                | 576.267 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:18.936017 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=110, pq.top=110
W20240204 10:22:19.936012 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=112, pq.top=112
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.085 ms                  | 28.599 ms                 |
| ProcessBack:UpdateCache   | 10.021 ms                 | 13.831 ms                 |
| ProcessBack:UpsertPq      | 9.777 ms                  | 18.788 ms                 |
| ProcessOneStep            | 28.669 ms                 | 314.610 ms                |
| BlockToStepN              | 394.860 ms                | 511.546 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:20.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=114, pq.top=114
W20240204 10:22:21.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240204 10:22:22.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=118, pq.top=118
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.171 ms                  | 26.974 ms                 |
| Forward                   | 4.814 ms                  | 14.333 ms                 |
| Backward                  | 8.714 ms                  | 22.219 ms                 |
| Optimize                  | 1.793 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 2.327 ms                  | 14.485 ms                 |
| AfterBackward             | 28.874 ms                 | 314.661 ms                |
| BlockToStepN              | 406.789 ms                | 511.742 ms                |
| OneStep                   | 459.043 ms                | 576.267 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:23.936013 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=120, pq.top=120
W20240204 10:22:24.936012 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=122, pq.top=122
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.025 ms                  | 28.599 ms                 |
| ProcessBack:UpdateCache   | 10.117 ms                 | 13.831 ms                 |
| ProcessBack:UpsertPq      | 9.822 ms                  | 18.788 ms                 |
| ProcessOneStep            | 28.844 ms                 | 314.610 ms                |
| BlockToStepN              | 409.769 ms                | 511.546 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:25.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=124, pq.top=124
W20240204 10:22:26.936005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=126, pq.top=126
W20240204 10:22:27.936008 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.171 ms                  | 26.974 ms                 |
| Forward                   | 4.763 ms                  | 14.333 ms                 |
| Backward                  | 7.695 ms                  | 22.219 ms                 |
| Optimize                  | 1.784 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 2.638 ms                  | 14.485 ms                 |
| AfterBackward             | 28.874 ms                 | 314.661 ms                |
| BlockToStepN              | 414.425 ms                | 511.742 ms                |
| OneStep                   | 469.509 ms                | 576.267 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:28.936022 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240204 10:22:29.936008 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.970 ms                  | 20.247 ms                 |
| ProcessBack:UpdateCache   | 10.166 ms                 | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.827 ms                  | 18.396 ms                 |
| ProcessOneStep            | 28.844 ms                 | 314.610 ms                |
| BlockToStepN              | 421.934 ms                | 514.795 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:30.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240204 10:22:31.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240204 10:22:32.936017 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.171 ms                  | 26.974 ms                 |
| Forward                   | 4.763 ms                  | 14.333 ms                 |
| Backward                  | 6.803 ms                  | 22.219 ms                 |
| Optimize                  | 1.772 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 3.242 ms                  | 14.485 ms                 |
| AfterBackward             | 28.896 ms                 | 314.661 ms                |
| BlockToStepN              | 424.296 ms                | 529.078 ms                |
| OneStep                   | 475.277 ms                | 585.593 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:33.936012 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240204 10:22:34.936012 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.909 ms                  | 20.247 ms                 |
| ProcessBack:UpdateCache   | 10.210 ms                 | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.875 ms                  | 18.396 ms                 |
| ProcessOneStep            | 28.880 ms                 | 314.610 ms                |
| BlockToStepN              | 424.722 ms                | 528.996 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:35.936008 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=142, pq.top=142
W20240204 10:22:36.936005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=144, pq.top=144
W20240204 10:22:37.936014 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=146, pq.top=146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.226 ms                  | 26.974 ms                 |
| Forward                   | 4.779 ms                  | 16.312 ms                 |
| Backward                  | 6.413 ms                  | 22.219 ms                 |
| Optimize                  | 1.773 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 3.436 ms                  | 21.780 ms                 |
| AfterBackward             | 28.917 ms                 | 314.661 ms                |
| BlockToStepN              | 427.310 ms                | 529.078 ms                |
| OneStep                   | 483.030 ms                | 592.510 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:38.936007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=148, pq.top=148
W20240204 10:22:39.936004 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=150, pq.top=150
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.907 ms                  | 20.247 ms                 |
| ProcessBack:UpdateCache   | 10.221 ms                 | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.889 ms                  | 18.396 ms                 |
| ProcessOneStep            | 28.889 ms                 | 101.600 ms                |
| BlockToStepN              | 431.394 ms                | 528.996 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:40.960496 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=152, pq.top=151
W20240204 10:22:41.960007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240204 10:22:42.960019 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.226 ms                  | 24.821 ms                 |
| Forward                   | 4.783 ms                  | 14.333 ms                 |
| Backward                  | 5.937 ms                  | 16.082 ms                 |
| Optimize                  | 1.769 ms                  | 3.992 ms                  |
| BarrierTimeBeforeRank0    | 3.379 ms                  | 21.208 ms                 |
| AfterBackward             | 28.925 ms                 | 101.837 ms                |
| BlockToStepN              | 437.328 ms                | 529.078 ms                |
| OneStep                   | 490.791 ms                | 592.510 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:43.960006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240204 10:22:44.960006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.900 ms                  | 20.247 ms                 |
| ProcessBack:UpdateCache   | 10.268 ms                 | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.920 ms                  | 18.396 ms                 |
| ProcessOneStep            | 28.897 ms                 | 101.600 ms                |
| BlockToStepN              | 439.458 ms                | 536.603 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:45.960006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240204 10:22:46.960006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240204 10:22:47.960027 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=164, pq.top=164
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.219 ms                  | 24.821 ms                 |
| Forward                   | 4.783 ms                  | 14.333 ms                 |
| Backward                  | 5.444 ms                  | 16.082 ms                 |
| Optimize                  | 1.769 ms                  | 3.992 ms                  |
| BarrierTimeBeforeRank0    | 3.693 ms                  | 21.780 ms                 |
| AfterBackward             | 28.934 ms                 | 101.837 ms                |
| BlockToStepN              | 443.848 ms                | 536.821 ms                |
| OneStep                   | 497.968 ms                | 608.318 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:48.960006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240204 10:22:49.960006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=168, pq.top=168
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.890 ms                  | 20.247 ms                 |
| ProcessBack:UpdateCache   | 10.279 ms                 | 13.629 ms                 |
| ProcessBack:UpsertPq      | 9.920 ms                  | 18.396 ms                 |
| ProcessOneStep            | 28.991 ms                 | 101.600 ms                |
| BlockToStepN              | 443.765 ms                | 536.603 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:50.960006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=170, pq.top=170
W20240204 10:22:51.967468 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=172, pq.top=171
W20240204 10:22:52.967013 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=174, pq.top=174
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.219 ms                  | 24.821 ms                 |
| Forward                   | 4.771 ms                  | 14.333 ms                 |
| Backward                  | 4.933 ms                  | 16.082 ms                 |
| Optimize                  | 1.769 ms                  | 3.992 ms                  |
| BarrierTimeBeforeRank0    | 3.777 ms                  | 23.458 ms                 |
| AfterBackward             | 29.003 ms                 | 101.837 ms                |
| BlockToStepN              | 444.092 ms                | 537.282 ms                |
| OneStep                   | 499.020 ms                | 608.318 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:54.024469 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=175
W20240204 10:22:55.024008 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.880 ms                  | 13.850 ms                 |
| ProcessBack:UpdateCache   | 10.292 ms                 | 13.144 ms                 |
| ProcessBack:UpsertPq      | 9.945 ms                  | 17.858 ms                 |
| ProcessOneStep            | 28.983 ms                 | 101.600 ms                |
| BlockToStepN              | 445.459 ms                | 540.084 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:56.024006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240204 10:22:57.024006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240204 10:22:58.024066 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.226 ms                  | 24.821 ms                 |
| Forward                   | 4.783 ms                  | 16.312 ms                 |
| Backward                  | 4.717 ms                  | 16.082 ms                 |
| Optimize                  | 1.771 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 3.912 ms                  | 23.458 ms                 |
| AfterBackward             | 29.011 ms                 | 101.837 ms                |
| BlockToStepN              | 449.263 ms                | 540.212 ms                |
| OneStep                   | 504.211 ms                | 611.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:22:59.024006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240204 10:23:00.024006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.867 ms                  | 13.850 ms                 |
| ProcessBack:UpdateCache   | 10.313 ms                 | 13.144 ms                 |
| ProcessBack:UpsertPq      | 9.956 ms                  | 17.858 ms                 |
| ProcessOneStep            | 28.991 ms                 | 101.600 ms                |
| BlockToStepN              | 449.190 ms                | 540.084 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:01.028421 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=188
W20240204 10:23:02.028007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240204 10:23:03.028017 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=192, pq.top=192
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.226 ms                  | 24.821 ms                 |
| Forward                   | 4.779 ms                  | 16.312 ms                 |
| Backward                  | 4.667 ms                  | 16.082 ms                 |
| Optimize                  | 1.771 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.039 ms                  | 23.458 ms                 |
| AfterBackward             | 29.102 ms                 | 101.837 ms                |
| BlockToStepN              | 449.983 ms                | 540.212 ms                |
| OneStep                   | 505.466 ms                | 611.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:04.028005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240204 10:23:05.028007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.862 ms                  | 13.850 ms                 |
| ProcessBack:UpdateCache   | 10.338 ms                 | 13.144 ms                 |
| ProcessBack:UpsertPq      | 9.998 ms                  | 17.858 ms                 |
| ProcessOneStep            | 29.075 ms                 | 101.600 ms                |
| BlockToStepN              | 452.360 ms                | 541.300 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:06.091993 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=197
W20240204 10:23:07.141292 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=200, pq.top=199
[proc 5] 200 steps, total: 53.836, sample: 0.359, forward: 0.443, backward: 1.020, update: 0.179
[proc 4] 200 steps, total: 53.836, sample: 0.372, forward: 0.447, backward: 0.722, update: 0.178
[proc 7] 200 steps, total: 53.836, sample: 0.330, forward: 0.433, backward: 0.802, update: 0.180
[proc 6] 200 steps, total: 53.837, sample: 0.373, forward: 0.450, backward: 0.895, update: 0.194
[proc 1] 200 steps, total: 53.836, sample: 0.334, forward: 0.422, backward: 0.730, update: 0.171
[proc 3] 200 steps, total: 53.836, sample: 0.358, forward: 0.467, backward: 0.952, update: 0.176
[proc 2] 200 steps, total: 53.836, sample: 0.345, forward: 0.422, backward: 0.712, update: 0.175
[proc 0] 200 steps, total: 53.836, sample: 0.460, forward: 0.514, backward: 0.481, update: 0.189
W20240204 10:23:08.141014 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=202, pq.top=202
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.206 ms                  | 24.821 ms                 |
| Forward                   | 4.771 ms                  | 16.312 ms                 |
| Backward                  | 4.619 ms                  | 16.082 ms                 |
| Optimize                  | 1.773 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.278 ms                  | 23.458 ms                 |
| AfterBackward             | 29.121 ms                 | 101.837 ms                |
| BlockToStepN              | 452.588 ms                | 545.034 ms                |
| OneStep                   | 508.050 ms                | 611.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:09.141016 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240204 10:23:10.141012 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.824 ms                  | 13.850 ms                 |
| ProcessBack:UpdateCache   | 10.338 ms                 | 13.144 ms                 |
| ProcessBack:UpsertPq      | 10.007 ms                 | 17.858 ms                 |
| ProcessOneStep            | 29.095 ms                 | 101.600 ms                |
| BlockToStepN              | 453.554 ms                | 544.798 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:11.141006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240204 10:23:12.141007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240204 10:23:13.141007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.206 ms                  | 24.821 ms                 |
| Forward                   | 4.779 ms                  | 16.312 ms                 |
| Backward                  | 4.544 ms                  | 16.082 ms                 |
| Optimize                  | 1.786 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.443 ms                  | 23.458 ms                 |
| AfterBackward             | 29.162 ms                 | 101.837 ms                |
| BlockToStepN              | 454.134 ms                | 552.175 ms                |
| OneStep                   | 509.970 ms                | 611.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:14.141016 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240204 10:23:15.141016 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=216, pq.top=216
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.831 ms                  | 13.850 ms                 |
| ProcessBack:UpdateCache   | 10.333 ms                 | 13.144 ms                 |
| ProcessBack:UpsertPq      | 10.026 ms                 | 18.396 ms                 |
| ProcessOneStep            | 29.132 ms                 | 101.600 ms                |
| BlockToStepN              | 453.554 ms                | 552.071 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:16.142776 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
W20240204 10:23:17.142006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
W20240204 10:23:18.142006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.219 ms                  | 24.821 ms                 |
| Forward                   | 4.779 ms                  | 16.312 ms                 |
| Backward                  | 4.504 ms                  | 16.082 ms                 |
| Optimize                  | 1.778 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.471 ms                  | 23.458 ms                 |
| AfterBackward             | 29.162 ms                 | 101.837 ms                |
| BlockToStepN              | 454.307 ms                | 552.175 ms                |
| OneStep                   | 510.063 ms                | 611.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:19.142022 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240204 10:23:20.142011 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.809 ms                  | 13.809 ms                 |
| ProcessBack:UpdateCache   | 10.338 ms                 | 13.065 ms                 |
| ProcessBack:UpsertPq      | 10.026 ms                 | 18.396 ms                 |
| ProcessOneStep            | 29.126 ms                 | 101.600 ms                |
| BlockToStepN              | 454.604 ms                | 552.678 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:21.142007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240204 10:23:22.142005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240204 10:23:23.142005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.206 ms                  | 24.821 ms                 |
| Forward                   | 4.771 ms                  | 16.312 ms                 |
| Backward                  | 4.482 ms                  | 16.082 ms                 |
| Optimize                  | 1.778 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.660 ms                  | 23.458 ms                 |
| AfterBackward             | 29.162 ms                 | 101.837 ms                |
| BlockToStepN              | 455.262 ms                | 552.818 ms                |
| OneStep                   | 511.207 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:24.154425 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=232
W20240204 10:23:25.154009 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=234, pq.top=234
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.822 ms                  | 13.809 ms                 |
| ProcessBack:UpdateCache   | 10.342 ms                 | 13.065 ms                 |
| ProcessBack:UpsertPq      | 10.044 ms                 | 18.396 ms                 |
| ProcessOneStep            | 29.207 ms                 | 101.600 ms                |
| BlockToStepN              | 455.806 ms                | 552.678 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:26.154006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240204 10:23:27.154007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240204 10:23:28.154016 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.194 ms                  | 24.821 ms                 |
| Forward                   | 4.779 ms                  | 16.312 ms                 |
| Backward                  | 4.531 ms                  | 16.082 ms                 |
| Optimize                  | 1.783 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.637 ms                  | 23.458 ms                 |
| AfterBackward             | 29.267 ms                 | 101.837 ms                |
| BlockToStepN              | 457.009 ms                | 552.818 ms                |
| OneStep                   | 513.033 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:29.154011 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240204 10:23:30.154006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=244, pq.top=244
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.824 ms                  | 13.809 ms                 |
| ProcessBack:UpdateCache   | 10.340 ms                 | 13.065 ms                 |
| ProcessBack:UpsertPq      | 10.025 ms                 | 18.396 ms                 |
| ProcessOneStep            | 29.132 ms                 | 101.600 ms                |
| BlockToStepN              | 457.053 ms                | 558.055 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:31.163975 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=246, pq.top=245
W20240204 10:23:32.163007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240204 10:23:33.163017 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.171 ms                  | 24.821 ms                 |
| Forward                   | 4.771 ms                  | 16.312 ms                 |
| Backward                  | 4.619 ms                  | 16.082 ms                 |
| Optimize                  | 1.778 ms                  | 6.394 ms                  |
| BarrierTimeBeforeRank0    | 4.660 ms                  | 23.458 ms                 |
| AfterBackward             | 29.228 ms                 | 101.837 ms                |
| BlockToStepN              | 458.946 ms                | 558.250 ms                |
| OneStep                   | 514.570 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:34.163007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240204 10:23:35.163008 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.852 ms                  | 13.809 ms                 |
| ProcessBack:UpdateCache   | 10.338 ms                 | 13.065 ms                 |
| ProcessBack:UpsertPq      | 10.026 ms                 | 18.396 ms                 |
| ProcessOneStep            | 29.200 ms                 | 50.261 ms                 |
| BlockToStepN              | 459.444 ms                | 552.678 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:36.163007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240204 10:23:37.163007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240204 10:23:38.163022 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.194 ms                  | 23.607 ms                 |
| Forward                   | 4.771 ms                  | 14.333 ms                 |
| Backward                  | 4.702 ms                  | 15.591 ms                 |
| Optimize                  | 1.773 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.660 ms                  | 23.384 ms                 |
| AfterBackward             | 29.267 ms                 | 50.352 ms                 |
| BlockToStepN              | 460.345 ms                | 552.818 ms                |
| OneStep                   | 516.155 ms                | 611.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:39.163010 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240204 10:23:40.163007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=262, pq.top=262
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.851 ms                  | 13.809 ms                 |
| ProcessBack:UpdateCache   | 10.324 ms                 | 13.065 ms                 |
| ProcessBack:UpsertPq      | 10.041 ms                 | 18.396 ms                 |
| ProcessOneStep            | 29.237 ms                 | 50.261 ms                 |
| BlockToStepN              | 460.478 ms                | 552.678 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:41.163005 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240204 10:23:42.163017 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240204 10:23:43.163012 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.194 ms                  | 24.061 ms                 |
| Forward                   | 4.779 ms                  | 14.333 ms                 |
| Backward                  | 4.787 ms                  | 15.591 ms                 |
| Optimize                  | 1.783 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.637 ms                  | 23.384 ms                 |
| AfterBackward             | 29.284 ms                 | 50.352 ms                 |
| BlockToStepN              | 461.094 ms                | 558.250 ms                |
| OneStep                   | 518.209 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:44.163007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240204 10:23:45.164345 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.860 ms                  | 13.809 ms                 |
| ProcessBack:UpdateCache   | 10.316 ms                 | 13.065 ms                 |
| ProcessBack:UpsertPq      | 10.044 ms                 | 19.299 ms                 |
| ProcessOneStep            | 29.263 ms                 | 50.261 ms                 |
| BlockToStepN              | 461.812 ms                | 558.055 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:46.164006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240204 10:23:47.164026 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240204 10:23:48.187199 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.189 ms                  | 24.061 ms                 |
| Forward                   | 4.783 ms                  | 14.333 ms                 |
| Backward                  | 4.964 ms                  | 15.591 ms                 |
| Optimize                  | 1.785 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.660 ms                  | 23.384 ms                 |
| AfterBackward             | 29.289 ms                 | 50.352 ms                 |
| BlockToStepN              | 463.011 ms                | 558.250 ms                |
| OneStep                   | 519.199 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:49.226256 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=278
W20240204 10:23:50.226007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=280, pq.top=280
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.862 ms                  | 12.363 ms                 |
| ProcessBack:UpdateCache   | 10.313 ms                 | 12.971 ms                 |
| ProcessBack:UpsertPq      | 10.041 ms                 | 19.030 ms                 |
| ProcessOneStep            | 29.288 ms                 | 50.261 ms                 |
| BlockToStepN              | 462.700 ms                | 558.055 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:51.226015 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=282, pq.top=282
W20240204 10:23:52.226011 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240204 10:23:53.226007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.189 ms                  | 24.061 ms                 |
| Forward                   | 4.779 ms                  | 14.333 ms                 |
| Backward                  | 4.797 ms                  | 15.591 ms                 |
| Optimize                  | 1.784 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.637 ms                  | 23.384 ms                 |
| AfterBackward             | 29.348 ms                 | 50.352 ms                 |
| BlockToStepN              | 463.098 ms                | 558.250 ms                |
| OneStep                   | 519.199 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:54.226006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=288, pq.top=288
W20240204 10:23:55.226006 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=290, pq.top=290
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.824 ms                  | 12.363 ms                 |
| ProcessBack:UpdateCache   | 10.308 ms                 | 12.971 ms                 |
| ProcessBack:UpsertPq      | 10.044 ms                 | 19.030 ms                 |
| ProcessOneStep            | 29.237 ms                 | 50.261 ms                 |
| BlockToStepN              | 464.451 ms                | 558.055 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:56.226015 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240204 10:23:57.226014 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240204 10:23:58.226007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.171 ms                  | 24.061 ms                 |
| Forward                   | 4.783 ms                  | 14.333 ms                 |
| Backward                  | 4.787 ms                  | 15.591 ms                 |
| Optimize                  | 1.783 ms                  | 4.309 ms                  |
| BarrierTimeBeforeRank0    | 4.697 ms                  | 23.384 ms                 |
| AfterBackward             | 29.289 ms                 | 50.352 ms                 |
| BlockToStepN              | 465.457 ms                | 559.276 ms                |
| OneStep                   | 521.169 ms                | 633.991 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:23:59.245834 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=296
W20240204 10:24:00.245007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=298, pq.top=298
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.824 ms                  | 12.363 ms                 |
| ProcessBack:UpdateCache   | 10.308 ms                 | 12.971 ms                 |
| ProcessBack:UpsertPq      | 10.041 ms                 | 19.030 ms                 |
| ProcessOneStep            | 29.237 ms                 | 50.261 ms                 |
| BlockToStepN              | 465.304 ms                | 559.187 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:24:01.245007 32579 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=300, pq.top=300
[proc 4] 300 steps, total: 53.944, sample: 0.332, forward: 0.428, backward: 0.865, update: 0.174
[proc 2] 300 steps, total: 53.943, sample: 0.297, forward: 0.411, backward: 0.745, update: 0.172
[proc 3] 300 steps, total: 53.943, sample: 0.374, forward: 0.435, backward: 0.865, update: 0.174
[proc 7] 300 steps, total: 53.944, sample: 0.325, forward: 0.424, backward: 0.781, update: 0.180
[proc 6] 300 steps, total: 53.943, sample: 0.326, forward: 0.436, backward: 0.517, update: 0.181
[proc 5] 300 steps, total: 53.944, sample: 0.327, forward: 0.446, backward: 0.937, update: 0.182
[proc 1] 300 steps, total: 53.943, sample: 0.317, forward: 0.410, backward: 0.838, update: 0.172
[proc 0] 300 steps, total: 53.943, sample: 0.498, forward: 0.471, backward: 0.687, update: 0.185
Successfully xmh. training takes 150.25539922714233 seconds
before call kg_cache_controller.StopThreads()
W20240204 10:24:01.515214 32579 grad_async_v1.h:243] call StopThreads. PID = 31670
W20240204 10:24:01.515233 32579 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 10:24:01.518529 32579 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 10:24:01.518541 32579 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 10:24:01.605571 32579 grad_async_v1.h:264] StopThreads done.
