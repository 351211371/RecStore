WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 10:40:20.385923 25179 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_124', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=16, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [25179 sampler.py:454] Start PreSampling
WARNING [25179 sampler.py:532] Before construct renumbering_dict
WARNING [25179 sampler.py:555] PreSampling done
W20240204 10:40:26.038146 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 10:40:26.038410 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 10:40:26.038458 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 10:40:26.038511 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 10:40:26.038561 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 10:40:26.038619 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 10:40:26.038666 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 10:40:26.038726 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 10:40:26.038775 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 10:40:26.038820 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 10:40:26.038866 25179 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 10:40:26.038905 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 10:40:26.038944 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 10:40:26.039105 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 10:40:26.039156 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 10:40:26.039203 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 10:40:26.039258 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 10:40:26.039304 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 10:40:26.039345 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 10:40:26.039405 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 10:40:26.039448 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 10:40:26.039495 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 10:40:26.039541 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 10:40:26.039580 25179 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 10:40:26.039614 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 10:40:26.039650 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 10:40:26.039733 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 10:40:26.039788 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 10:40:26.039837 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 10:40:26.039880 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 10:40:26.039952 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 10:40:26.040009 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 10:40:26.040074 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 10:40:26.040115 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 10:40:26.040159 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 10:40:26.040218 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 10:40:26.040257 25179 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 10:40:26.040292 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 10:40:26.040329 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 10:40:26.040407 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 10:40:26.040465 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 10:40:26.040506 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 10:40:26.040555 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 10:40:26.040596 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 10:40:26.040647 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 10:40:26.040701 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 10:40:26.040750 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 10:40:26.040796 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 10:40:26.040836 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 10:40:26.040876 25179 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 10:40:26.040910 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 10:40:26.040956 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 10:40:26.041042 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 10:40:26.041087 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 10:40:26.041160 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 10:40:26.041204 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 10:40:26.041253 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 10:40:26.041293 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 10:40:26.041333 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 10:40:26.041383 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 10:40:26.041447 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 10:40:26.041496 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 10:40:26.041536 25179 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 10:40:26.041571 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 10:40:26.041605 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 10:40:26.041678 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 10:40:26.041723 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 10:40:26.041762 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 10:40:26.041802 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 10:40:26.041851 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 10:40:26.041899 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 10:40:26.041949 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 10:40:26.041998 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 10:40:26.042039 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 10:40:26.042080 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 10:40:26.042129 25179 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 10:40:26.042162 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 10:40:26.042200 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 10:40:26.042281 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 10:40:26.042332 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 10:40:26.042380 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 10:40:26.042421 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 10:40:26.042479 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 10:40:26.042528 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 10:40:26.042577 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 10:40:26.042622 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 10:40:26.042670 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 10:40:26.042717 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 10:40:26.042769 25179 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 10:40:26.042804 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 10:40:26.042838 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 10:40:26.042912 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 10:40:26.042979 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 10:40:26.043027 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 10:40:26.043076 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 10:40:26.043126 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 10:40:26.043172 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 10:40:26.043224 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 10:40:26.043267 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 10:40:26.043308 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 10:40:26.043354 25179 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 10:40:26.043395 25179 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 10:40:26.043429 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 10:40:26.043478 25179 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 10:40:26.302592 25179 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240204 10:40:26.415086 25179 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([  752,  1111,  1715,  ..., 10858,  5524,  4246]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 6.128 seconds
[Rank1] pid = 25606
[Rank2] pid = 25627
[Rank3] pid = 25672
[Rank4] pid = 25736
[Rank5] pid = 25737
[Rank6] pid = 25782
INFO [25179 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [25606 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [25627 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [25737 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [25672 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [25782 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [25736 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [25737 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25929 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [25672 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25782 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25736 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25929 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:40:29.132442 25781 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
INFO [25627 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25179 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:40:29.136528 25928 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 10:40:29.136523 26056 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240204 10:40:29.136526 25738 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 10:40:29.136500 25783 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
INFO [25606 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:40:29.137674 25992 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 10:40:29.138315 25671 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240204 10:40:29.140285 25607 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 10:40:29.171015 25781 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x100027a14000 7.629 MB
W20240204 10:40:29.171048 26056 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1000281b7000 7.629 MB
W20240204 10:40:29.171053 25928 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10002895a000 7.629 MB
W20240204 10:40:29.171061 25738 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000290fd000 7.629 MB
W20240204 10:40:29.171141 25671 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1000298a0000 7.629 MB
W20240204 10:40:29.171165 25992 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10002a043000 7.629 MB
W20240204 10:40:29.171203 25783 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10002a7e6000 7.629 MB
W20240204 10:40:29.171211 25607 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10002af89000 7.629 MB
W20240204 10:40:29.171360 25781 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10002b72c000 7.629 MB
W20240204 10:40:29.171485 25781 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10002becf000 1.49 GB
W20240204 10:40:29.171584 25781 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10008b4b2000 1.49 GB
W20240204 10:40:29.171635 25992 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000eaa95000 7.629 MB
W20240204 10:40:29.171644 25783 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1000eb238000 7.629 MB
W20240204 10:40:29.171662 25781 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:40:29.171687 25928 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000eb9db000 7.629 MB
W20240204 10:40:29.171716 25607 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000ec17e000 7.629 MB
W20240204 10:40:29.171770 25671 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1000ec921000 7.629 MB
W20240204 10:40:29.171787 25738 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000ed0c4000 7.629 MB
W20240204 10:40:29.171792 26056 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000ed867000 7.629 MB
W20240204 10:40:29.171864 25992 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1000ee00a000 1.49 GB
W20240204 10:40:29.171893 26056 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10014d5ed000 1.49 GB
W20240204 10:40:29.171901 25607 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1001acbd0000 1.49 GB
W20240204 10:40:29.171932 25928 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10020c1b3000 1.49 GB
W20240204 10:40:29.171941 25783 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10026b796000 1.49 GB
W20240204 10:40:29.171942 25992 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1002cad79000 1.49 GB
W20240204 10:40:29.173444 25992 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:40:29.173446 25928 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10032a35c000 1.49 GB
W20240204 10:40:29.173485 25607 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10038993f000 1.49 GB
W20240204 10:40:29.173544 25607 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:40:29.175190 25928 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:40:29.175199 25783 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1003e8f22000 1.49 GB
W20240204 10:40:29.175223 26056 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x100448505000 1.49 GB
W20240204 10:40:29.175246 25738 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1004a7ae8000 1.49 GB
W20240204 10:40:29.175261 25671 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1005070cb000 1.49 GB
W20240204 10:40:29.175282 25783 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:40:29.175289 26056 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:40:29.175321 25738 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1005666ae000 1.49 GB
W20240204 10:40:29.175328 25671 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1005c5c91000 1.49 GB
W20240204 10:40:29.175380 25738 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:40:29.175382 25671 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:40:29.177217 25781 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:40:29.187150 25992 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:40:29.187520 25607 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:40:29.189170 25783 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:40:29.192346 26056 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:40:29.192353 25671 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:40:29.192368 25928 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:40:29.192371 25738 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [25782 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [25929 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [25627 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [25672 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [25606 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 25929
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [25179 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [25737 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [25736 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 10:40:32.083009 25783 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 10:40:32.083207 25928 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:40:32.084669 25781 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:40:32.084762 25671 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:40:32.084863 25738 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:40:32.084935 26056 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:40:32.085016 25607 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:40:32.085111 25992 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 10:40:32.088441 25992 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 16,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 10:40:32.088768 25992 grad_base.h:184] Init GradProcessingBase done
I20240204 10:40:32.099941 25992 grad_async_v2.h:42] Use main thread to update emb.
W20240204 10:40:32.100064 25992 kg_controller.h:78] after init GradAsyncProcessingV2
I20240204 10:40:32.100085 25992 kg_controller.h:84] Construct KGCacheController done
E20240204 10:40:32.925374 25992 recstore.cc:66] init folly done
E20240204 10:40:32.925463 25928 recstore.cc:66] init folly done
E20240204 10:40:32.925485 25671 recstore.cc:66] init folly done
E20240204 10:40:32.925508 26056 recstore.cc:66] init folly done
E20240204 10:40:32.925666 25783 recstore.cc:66] init folly done
E20240204 10:40:32.925673 25607 recstore.cc:66] init folly done
E20240204 10:40:32.926033 25738 recstore.cc:66] init folly done
E20240204 10:40:32.926160 25781 recstore.cc:66] init folly done
I20240204 10:40:32.927482 25992 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240204 10:40:33.756929 27272 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 10:40:33.757598 27272 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
I20240204 10:40:33.794313 25992 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 10:40:33.794891 25607 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:40:33.795006 25928 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:40:33.795629 25781 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:40:33.796201 25783 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:40:33.798163 26056 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:40:33.800887 25671 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:40:33.806274 25738 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240204 10:40:36.068473 26670 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 10:40:36.110613 27272 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240204 10:40:36.526686 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=7, pq.top=7
E20240204 10:40:37.068037 25992 parallel_pq_v2.h:79] insert failed, size(hashtable)=186
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.025 ms                  | 27.187 ms                 |
| Forward                   | 5.333 ms                  | 677.938 ms                |
| Backward                  | 5.153 ms                  | 201.866 ms                |
| Optimize                  | 2.108 ms                  | 6.488 ms                  |
| BarrierTimeBeforeRank0    | 2.196 ms                  | 15.505 ms                 |
| AfterBackward             | 43.228 ms                 | 1.405 s                   |
| BlockToStepN              | 114.769 us                | 1.230 ms                  |
| OneStep                   | 71.778 ms                 | 2.302 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:40:37.146818 27272 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
W20240204 10:40:37.599457 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 328.131 us                | 8.792 ms                  |
| ProcessBack:Shuffle       | 8.718 ms                  | 353.993 ms                |
| ProcessBack:UpdateCache   | 10.250 ms                 | 775.703 ms                |
| ProcessBack:UpsertPq      | 25.177 ms                 | 42.355 ms                 |
| ProcessOneStep            | 46.143 ms                 | 1.404 s                   |
| BlockToStepN              | 37.219 us                 | 1.144 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:40:38.068006 26670 parallel_pq_v2.h:79] insert failed, size(hashtable)=1283
W20240204 10:40:38.160528 27272 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240204 10:40:38.728790 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=35, pq.top=35
E20240204 10:40:39.068008 26670 parallel_pq_v2.h:79] insert failed, size(hashtable)=375
W20240204 10:40:39.167349 27272 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 10:40:40.068063 27272 parallel_pq_v2.h:79] insert failed, size(hashtable)=155
W20240204 10:40:40.099267 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=54, pq.top=54
W20240204 10:40:40.170011 27272 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 10:40:41.068149 27283 parallel_pq_v2.h:79] insert failed, size(hashtable)=9017
W20240204 10:40:41.171078 27272 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240204 10:40:41.347805 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=70, pq.top=70
E20240204 10:40:42.068007 25992 parallel_pq_v2.h:79] insert failed, size(hashtable)=10793
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.576 ms                  | 21.523 ms                 |
| Forward                   | 5.243 ms                  | 11.173 ms                 |
| Backward                  | 4.843 ms                  | 15.112 ms                 |
| Optimize                  | 2.243 ms                  | 12.577 ms                 |
| BarrierTimeBeforeRank0    | 2.101 ms                  | 23.374 ms                 |
| AfterBackward             | 48.468 ms                 | 79.061 ms                 |
| BlockToStepN              | 406.537 us                | 1.575 ms                  |
| OneStep                   | 71.778 ms                 | 113.671 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:40:42.171522 27272 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240204 10:40:42.432083 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 344.140 us                | 7.056 ms                  |
| ProcessBack:Shuffle       | 8.633 ms                  | 13.318 ms                 |
| ProcessBack:UpdateCache   | 10.695 ms                 | 16.012 ms                 |
| ProcessBack:UpsertPq      | 27.496 ms                 | 51.212 ms                 |
| ProcessOneStep            | 48.422 ms                 | 79.014 ms                 |
| BlockToStepN              | 353.985 us                | 1.483 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:40:43.068042 27298 parallel_pq_v2.h:79] insert failed, size(hashtable)=3338
W20240204 10:40:43.171900 27272 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240204 10:40:43.502966 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=100, pq.top=100
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 9.706, sample: 0.379, forward: 1.141, backward: 0.726, update: 0.200
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 9.708, sample: 0.349, forward: 1.103, backward: 0.677, update: 0.190
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 9.697, sample: 0.424, forward: 1.176, backward: 0.714, update: 0.190
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 9.708, sample: 0.373, forward: 1.116, backward: 0.766, update: 0.190
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 9.709, sample: 0.389, forward: 1.145, backward: 0.791, update: 0.185
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 9.709, sample: 0.437, forward: 1.136, backward: 0.731, update: 0.197
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 9.703, sample: 0.348, forward: 1.114, backward: 0.663, update: 0.174
train_sampler.Prefill()
-------Step 0-------
tensor([ 2476,    64,  4433,  3578, 12249,  7525,  1245,   440,  7602, 12627]) tensor([ 1715,  5552,  7964, 12355, 12745,  1114,   590,  3243,   520,  7344])
-------Step 1-------
tensor([ 2476,    64,  4433,  3578, 12249,  7525,  1245,   440,  7602, 12627]) tensor([ 4884, 10748, 14722,  1575,   887,  9594, 14251, 10519,  6299, 13744])
-------Step 2-------
tensor([ 9558, 12097,  7036,  2453, 10937,  5037, 11698,    92,  6288,   969]) tensor([ 3897,  3170,  5133,  9408,  3634,  5380, 14185,  5647, 13525, 11329])
-------Step 3-------
tensor([ 9558, 12097,  7036,  2453, 10937,  5037, 11698,    92,  6288,   969]) tensor([ 9676,  4109,  4403,  6420,  9246,   684,  7285,  2721, 13345,  2704])
-------Step 4-------
tensor([   64, 11007,  6159,  7125,  6289,  4455,    56,  9258,  8481,  1080]) tensor([ 622, 1316, 5402, 2114, 3272, 3322,  440, 9003, 7614, 2273])
-------Step 5-------
tensor([   64, 11007,  6159,  7125,  6289,  4455,    56,  9258,  8481,  1080]) tensor([6516, 6191, 8125, 1936, 4279,  831,  847, 1052, 6992, 8969])
-------Step 6-------
tensor([ 1285, 10325,    42,    75,  8739,  3750, 10161, 12525,  8654, 13024]) tensor([12097,  1967,  9484,  2659,  5343, 10896,  5132,  5231, 11500, 13012])
-------Step 7-------
tensor([ 1285, 10325,    42,    75,  8739,  3750, 10161, 12525,  8654, 13024]) tensor([13655,  7754,  4842,  4056,  1590,  5099,  9398,  3922,   156,  7581])
-------Step 8-------
tensor([ 4711,  4495,  6418, 13387,    60,    88, 10224,  7460,    84,  1499]) tensor([ 6837,  7356,  2907,  9613,  3277,  8456, 11048,  1659,  9522,  2212])
-------Step 9-------
tensor([ 4711,  4495,  6418, 13387,    60,    88, 10224,  7460,    84,  1499]) tensor([12354,  4968, 13499,  9893, 14946, 13767, 14465, 10519,   660, 13718])
before start barrier
start train
[proc 0] 100 steps, total: 9.710, sample: 0.424, forward: 1.225, backward: 0.730, update: 0.256
E20240204 10:40:44.068732 27272 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 10:40:44.174216 27272 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240204 10:40:45.068006 26670 parallel_pq_v2.h:79] insert failed, size(hashtable)=761
W20240204 10:40:45.193301 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=120, pq.top=120
W20240204 10:40:45.194908 27272 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 10:40:46.068007 26670 parallel_pq_v2.h:79] insert failed, size(hashtable)=774
W20240204 10:40:46.195613 27272 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240204 10:40:46.232787 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=135, pq.top=135
E20240204 10:40:47.068065 27271 parallel_pq_v2.h:79] insert failed, size(hashtable)=12556
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.614 ms                  | 27.187 ms                 |
| Forward                   | 5.192 ms                  | 18.270 ms                 |
| Backward                  | 4.618 ms                  | 15.112 ms                 |
| Optimize                  | 2.191 ms                  | 12.577 ms                 |
| BarrierTimeBeforeRank0    | 1.430 ms                  | 23.374 ms                 |
| AfterBackward             | 48.567 ms                 | 79.061 ms                 |
| BlockToStepN              | 590.498 us                | 1.944 ms                  |
| OneStep                   | 69.030 ms                 | 120.451 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:40:47.197768 27272 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240204 10:40:47.251226 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 379.951 us                | 6.945 ms                  |
| ProcessBack:Shuffle       | 8.600 ms                  | 13.318 ms                 |
| ProcessBack:UpdateCache   | 10.860 ms                 | 15.721 ms                 |
| ProcessBack:UpsertPq      | 27.544 ms                 | 51.163 ms                 |
| ProcessOneStep            | 48.422 ms                 | 78.549 ms                 |
| BlockToStepN              | 548.942 us                | 1.875 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:40:48.068032 27284 parallel_pq_v2.h:79] insert failed, size(hashtable)=11691
W20240204 10:40:48.229012 27272 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240204 10:40:48.551343 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=166, pq.top=166
E20240204 10:40:49.068014 27293 parallel_pq_v2.h:79] insert failed, size(hashtable)=10128
W20240204 10:40:49.248699 27272 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240204 10:40:49.967480 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=181, pq.top=181
E20240204 10:40:50.068064 27302 parallel_pq_v2.h:79] insert failed, size(hashtable)=6454
W20240204 10:40:50.250118 27272 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240204 10:40:51.010701 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=195, pq.top=195
E20240204 10:40:51.068006 25992 parallel_pq_v2.h:79] insert failed, size(hashtable)=221
W20240204 10:40:51.253829 27272 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
[proc 4] 200 steps, total: 7.866, sample: 0.351, forward: 0.444, backward: 0.439, update: 0.173
[proc 7] 200 steps, total: 7.867, sample: 0.445, forward: 0.526, backward: 0.462, update: 0.198
[proc 5] 200 steps, total: 7.866, sample: 0.365, forward: 0.451, backward: 0.436, update: 0.180
[proc 1] 200 steps, total: 7.866, sample: 0.332, forward: 0.437, backward: 0.469, update: 0.173
[proc 0] 200 steps, total: 7.866, sample: 0.489, forward: 0.563, backward: 0.465, update: 0.220
[proc 2] 200 steps, total: 7.866, sample: 0.420, forward: 0.516, backward: 0.480, update: 0.181
[proc 6] 200 steps, total: 7.866, sample: 0.369, forward: 0.478, backward: 0.509, update: 0.174
[proc 3] 200 steps, total: 7.866, sample: 0.378, forward: 0.479, backward: 0.535, update: 0.170
W20240204 10:40:52.036504 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=209, pq.top=209
E20240204 10:40:52.068029 27274 parallel_pq_v2.h:79] insert failed, size(hashtable)=9493
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.751 ms                  | 27.187 ms                 |
| Forward                   | 5.083 ms                  | 18.270 ms                 |
| Backward                  | 4.526 ms                  | 14.922 ms                 |
| Optimize                  | 2.193 ms                  | 8.277 ms                  |
| BarrierTimeBeforeRank0    | 2.494 ms                  | 26.995 ms                 |
| AfterBackward             | 48.400 ms                 | 79.061 ms                 |
| BlockToStepN              | 774.293 us                | 2.938 ms                  |
| OneStep                   | 73.885 ms                 | 120.451 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:40:52.256042 27272 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 388.463 us                | 6.936 ms                  |
| ProcessBack:Shuffle       | 8.549 ms                  | 13.318 ms                 |
| ProcessBack:UpdateCache   | 10.786 ms                 | 16.012 ms                 |
| ProcessBack:UpsertPq      | 27.288 ms                 | 51.163 ms                 |
| ProcessOneStep            | 47.966 ms                 | 79.014 ms                 |
| BlockToStepN              | 728.224 us                | 2.872 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:40:53.068017 26670 parallel_pq_v2.h:79] insert failed, size(hashtable)=32
W20240204 10:40:53.262310 27272 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 10:40:54.068020 27285 parallel_pq_v2.h:79] insert failed, size(hashtable)=3636
W20240204 10:40:54.278986 27272 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240204 10:40:54.449357 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=237, pq.top=237
E20240204 10:40:55.068037 27303 parallel_pq_v2.h:79] insert failed, size(hashtable)=9668
W20240204 10:40:55.281304 27272 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240204 10:40:55.478957 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=251, pq.top=251
E20240204 10:40:56.068120 27302 parallel_pq_v2.h:79] insert failed, size(hashtable)=10437
W20240204 10:40:56.286290 27272 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 10:40:57.068038 25992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1723
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.836 ms                  | 33.431 ms                 |
| Forward                   | 5.083 ms                  | 12.332 ms                 |
| Backward                  | 4.484 ms                  | 12.309 ms                 |
| Optimize                  | 2.201 ms                  | 7.452 ms                  |
| BarrierTimeBeforeRank0    | 2.749 ms                  | 27.187 ms                 |
| AfterBackward             | 48.468 ms                 | 78.593 ms                 |
| BlockToStepN              | 932.024 us                | 3.185 ms                  |
| OneStep                   | 76.562 ms                 | 116.912 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:40:57.289461 27272 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 344.714 us                | 6.418 ms                  |
| ProcessBack:Shuffle       | 8.627 ms                  | 13.167 ms                 |
| ProcessBack:UpdateCache   | 10.695 ms                 | 15.721 ms                 |
| ProcessBack:UpsertPq      | 27.483 ms                 | 50.356 ms                 |
| ProcessOneStep            | 48.469 ms                 | 78.549 ms                 |
| BlockToStepN              | 865.885 us                | 3.090 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:40:58.068007 25992 parallel_pq_v2.h:79] insert failed, size(hashtable)=612
W20240204 10:40:58.078534 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=280, pq.top=280
W20240204 10:40:58.292289 27272 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240204 10:40:59.068008 25992 parallel_pq_v2.h:79] insert failed, size(hashtable)=354
W20240204 10:40:59.088446 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240204 10:40:59.299798 27272 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
[proc 3] 300 steps, total: 8.399, sample: 0.410, forward: 0.509, backward: 0.497, update: 0.184
[proc 4] 300 steps, total: 8.400, sample: 0.317, forward: 0.439, backward: 0.408, update: 0.171
[proc 7] 300 steps, total: 8.400, sample: 0.413, forward: 0.516, backward: 0.460, update: 0.196
[proc 1] 300 steps, total: 8.400, sample: 0.393, forward: 0.493, backward: 0.439, update: 0.196
[proc 5] 300 steps, total: 8.400, sample: 0.349, forward: 0.486, backward: 0.521, update: 0.188
[proc 2] 300 steps, total: 8.400, sample: 0.408, forward: 0.542, backward: 0.474, update: 0.194
[proc 6] 300 steps, total: 8.399, sample: 0.381, forward: 0.480, backward: 0.490, update: 0.180
[proc 0] 300 steps, total: 8.400, sample: 0.501, forward: 0.532, backward: 0.441, update: 0.232
E20240204 10:41:00.068009 25992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1253
W20240204 10:41:00.158614 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240204 10:41:00.303536 27272 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240204 10:41:01.068037 27272 parallel_pq_v2.h:79] insert failed, size(hashtable)=33
W20240204 10:41:01.208976 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=318, pq.top=318
W20240204 10:41:01.304862 27272 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240204 10:41:02.068011 27303 parallel_pq_v2.h:79] insert failed, size(hashtable)=10449
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.936 ms                  | 33.431 ms                 |
| Forward                   | 5.013 ms                  | 14.141 ms                 |
| Backward                  | 4.492 ms                  | 12.309 ms                 |
| Optimize                  | 2.200 ms                  | 8.277 ms                  |
| BarrierTimeBeforeRank0    | 3.099 ms                  | 27.429 ms                 |
| AfterBackward             | 48.084 ms                 | 78.593 ms                 |
| BlockToStepN              | 1.064 ms                  | 4.332 ms                  |
| OneStep                   | 77.597 ms                 | 116.912 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:41:02.293401 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=332, pq.top=332
W20240204 10:41:02.311517 27272 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 442.182 us                | 8.138 ms                  |
| ProcessBack:Shuffle       | 8.525 ms                  | 13.190 ms                 |
| ProcessBack:UpdateCache   | 10.377 ms                 | 15.357 ms                 |
| ProcessBack:UpsertPq      | 27.317 ms                 | 50.318 ms                 |
| ProcessOneStep            | 47.827 ms                 | 78.549 ms                 |
| BlockToStepN              | 1.020 ms                  | 4.250 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:41:03.068096 27272 parallel_pq_v2.h:79] insert failed, size(hashtable)=673
W20240204 10:41:03.326373 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=346, pq.top=346
W20240204 10:41:03.327443 27272 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
E20240204 10:41:04.068044 27297 parallel_pq_v2.h:79] insert failed, size(hashtable)=7193
W20240204 10:41:04.347069 27272 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
W20240204 10:41:04.502905 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=361, pq.top=361
E20240204 10:41:05.068346 27285 parallel_pq_v2.h:79] insert failed, size(hashtable)=13734
W20240204 10:41:05.352702 27272 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240204 10:41:05.530915 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240204 10:41:06.068166 27272 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240204 10:41:06.353673 27272 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240204 10:41:06.649150 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=389, pq.top=389
E20240204 10:41:07.068070 27280 parallel_pq_v2.h:79] insert failed, size(hashtable)=3803
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.936 ms                  | 31.937 ms                 |
| Forward                   | 4.878 ms                  | 12.332 ms                 |
| Backward                  | 4.475 ms                  | 9.830 ms                  |
| Optimize                  | 2.181 ms                  | 7.452 ms                  |
| BarrierTimeBeforeRank0    | 3.457 ms                  | 27.825 ms                 |
| AfterBackward             | 47.515 ms                 | 78.445 ms                 |
| BlockToStepN              | 1.278 ms                  | 4.379 ms                  |
| OneStep                   | 77.150 ms                 | 113.766 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:41:07.362425 27272 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
[proc 5] 400 steps, total: 7.671, sample: 0.480, forward: 0.525, backward: 0.500, update: 0.209
[proc 1] 400 steps, total: 7.672, sample: 0.337, forward: 0.426, backward: 0.443, update: 0.172
[proc 0] 400 steps, total: 7.671, sample: 0.426, forward: 0.458, backward: 0.446, update: 0.230
[proc 3] 400 steps, total: 7.672, sample: 0.343, forward: 0.465, backward: 0.454, update: 0.169
[proc 4] 400 steps, total: 7.672, sample: 0.399, forward: 0.451, backward: 0.433, update: 0.175
[proc 7] 400 steps, total: 7.672, sample: 0.356, forward: 0.467, backward: 0.487, update: 0.183
[proc 2] 400 steps, total: 7.671, sample: 0.352, forward: 0.457, backward: 0.485, update: 0.166
[proc 6] 400 steps, total: 7.671, sample: 0.349, forward: 0.432, backward: 0.447, update: 0.172
W20240204 10:41:07.649528 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=403, pq.top=403
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 409.123 us                | 10.955 ms                 |
| ProcessBack:Shuffle       | 8.526 ms                  | 13.167 ms                 |
| ProcessBack:UpdateCache   | 10.147 ms                 | 14.754 ms                 |
| ProcessBack:UpsertPq      | 27.315 ms                 | 49.547 ms                 |
| ProcessOneStep            | 47.335 ms                 | 78.400 ms                 |
| BlockToStepN              | 1.229 ms                  | 4.579 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:41:08.068009 25992 parallel_pq_v2.h:79] insert failed, size(hashtable)=842
W20240204 10:41:08.374490 27272 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240204 10:41:08.735134 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=417, pq.top=417
E20240204 10:41:09.068022 27272 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
W20240204 10:41:09.382025 27272 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240204 10:41:09.801688 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=431, pq.top=431
E20240204 10:41:10.068008 25992 parallel_pq_v2.h:79] insert failed, size(hashtable)=211
W20240204 10:41:10.398834 27272 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240204 10:41:10.885767 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=446, pq.top=446
E20240204 10:41:11.068063 27292 parallel_pq_v2.h:79] insert failed, size(hashtable)=9894
W20240204 10:41:11.398281 27272 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240204 10:41:12.068442 27272 parallel_pq_v2.h:79] insert failed, size(hashtable)=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.966 ms                  | 27.390 ms                 |
| Forward                   | 4.795 ms                  | 11.173 ms                 |
| Backward                  | 4.452 ms                  | 9.439 ms                  |
| Optimize                  | 2.137 ms                  | 7.452 ms                  |
| BarrierTimeBeforeRank0    | 3.498 ms                  | 28.033 ms                 |
| AfterBackward             | 46.928 ms                 | 79.061 ms                 |
| BlockToStepN              | 1.694 ms                  | 4.987 ms                  |
| OneStep                   | 77.083 ms                 | 113.671 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:41:12.402963 27272 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 349.619 us                | 8.508 ms                  |
| ProcessBack:Shuffle       | 8.475 ms                  | 13.422 ms                 |
| ProcessBack:UpdateCache   | 9.816 ms                  | 14.685 ms                 |
| ProcessBack:UpsertPq      | 27.374 ms                 | 52.685 ms                 |
| ProcessOneStep            | 46.954 ms                 | 81.467 ms                 |
| BlockToStepN              | 1.623 ms                  | 4.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:41:13.068106 27272 parallel_pq_v2.h:79] insert failed, size(hashtable)=32
W20240204 10:41:13.404342 27272 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240204 10:41:14.068065 27291 parallel_pq_v2.h:79] insert failed, size(hashtable)=13531
W20240204 10:41:14.225430 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240204 10:41:14.406108 27272 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240204 10:41:15.068503 27272 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
W20240204 10:41:15.269027 25992 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240204 10:41:15.407050 27272 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
[proc 1] 500 steps, total: 8.281, sample: 0.462, forward: 0.524, backward: 0.503, update: 0.202
[proc 3] 500 steps, total: 8.281, sample: 0.367, forward: 0.464, backward: 0.443, update: 0.175
[proc 4] 500 steps, total: 8.281, sample: 0.395, forward: 0.504, backward: 0.417, update: 0.197
[proc 2] 500 steps, total: 8.281, sample: 0.342, forward: 0.468, backward: 0.469, update: 0.168
[proc 6] 500 steps, total: 8.281, sample: 0.288, forward: 0.423, backward: 0.476, update: 0.164
[proc 0] 500 steps, total: 8.281, sample: 0.490, forward: 0.487, backward: 0.438, update: 0.212
[proc 5] 500 steps, total: 8.281, sample: 0.297, forward: 0.428, backward: 0.495, update: 0.172
[proc 7] 500 steps, total: 8.281, sample: 0.353, forward: 0.448, backward: 0.449, update: 0.180
Successfully xmh. training takes 41.929795026779175 seconds
before call kg_cache_controller.StopThreads()
W20240204 10:41:15.723964 25992 grad_async_v2.h:84] call StopThreads. PID = 25179
W20240204 10:41:15.723994 25992 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 10:41:15.724478 25992 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 10:41:15.724488 25992 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240204 10:41:15.727931 25992 grad_async_v2.h:105] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7ffabbb29210>
