WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 13:21:43.258256 25692 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_93', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=6, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [25692 sampler.py:454] Start PreSampling
WARNING [25692 sampler.py:532] Before construct renumbering_dict
WARNING [25692 sampler.py:555] PreSampling done
W20240204 13:41:43.907752 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 13:41:43.907953 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 13:41:43.907992 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 13:41:43.908033 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 13:41:43.908087 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 13:41:43.908129 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 13:41:43.908172 25692 IPCTensor.h:369] NewIPCTensor: step_r0 [6]0x100002dd4000 48 B 
W20240204 13:41:43.908198 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100002dd6000 8 B 
W20240204 13:41:43.908223 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100002dd8000 8 B 
W20240204 13:41:43.908412 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100002dda000 7.629 MB
W20240204 13:41:43.908449 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x10000357d000 7.629 MB
W20240204 13:41:43.908478 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100003d20000 7.629 MB
W20240204 13:41:43.908505 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000044c3000 7.629 MB
W20240204 13:41:43.908536 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100004c66000 7.629 MB
W20240204 13:41:43.908571 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100005409000 7.629 MB
W20240204 13:41:43.908596 25692 IPCTensor.h:369] NewIPCTensor: step_r1 [6]0x100005bac000 48 B 
W20240204 13:41:43.908632 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100005bae000 8 B 
W20240204 13:41:43.908658 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100005bb0000 8 B 
W20240204 13:41:43.908708 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100005bb2000 7.629 MB
W20240204 13:41:43.908743 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100006355000 7.629 MB
W20240204 13:41:43.908773 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100006af8000 7.629 MB
W20240204 13:41:43.908807 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000729b000 7.629 MB
W20240204 13:41:43.908843 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x100007a3e000 7.629 MB
W20240204 13:41:43.908871 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000081e1000 7.629 MB
W20240204 13:41:43.908905 25692 IPCTensor.h:369] NewIPCTensor: step_r2 [6]0x100008984000 48 B 
W20240204 13:41:43.908927 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x100008986000 8 B 
W20240204 13:41:43.908948 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100008988000 8 B 
W20240204 13:41:43.909003 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000898a000 7.629 MB
W20240204 13:41:43.909035 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000912d000 7.629 MB
W20240204 13:41:43.909075 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000098d0000 7.629 MB
W20240204 13:41:43.909107 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000a073000 7.629 MB
W20240204 13:41:43.909138 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10000a816000 7.629 MB
W20240204 13:41:43.909165 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10000afb9000 7.629 MB
W20240204 13:41:43.909193 25692 IPCTensor.h:369] NewIPCTensor: step_r3 [6]0x10000b75c000 48 B 
W20240204 13:41:43.909214 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10000b75e000 8 B 
W20240204 13:41:43.909236 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10000b760000 8 B 
W20240204 13:41:43.909282 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10000b762000 7.629 MB
W20240204 13:41:43.909312 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x10000bf05000 7.629 MB
W20240204 13:41:43.909340 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x10000c6a8000 7.629 MB
W20240204 13:41:43.909368 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10000ce4b000 7.629 MB
W20240204 13:41:43.909401 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10000d5ee000 7.629 MB
W20240204 13:41:43.909427 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x10000dd91000 7.629 MB
W20240204 13:41:43.909456 25692 IPCTensor.h:369] NewIPCTensor: step_r4 [6]0x10000e534000 48 B 
W20240204 13:41:43.909477 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x10000e536000 8 B 
W20240204 13:41:43.909499 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x10000e538000 8 B 
W20240204 13:41:43.909548 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x10000e53a000 7.629 MB
W20240204 13:41:43.909576 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x10000ecdd000 7.629 MB
W20240204 13:41:43.909602 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x10000f480000 7.629 MB
W20240204 13:41:43.909633 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x10000fc23000 7.629 MB
W20240204 13:41:43.909663 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000103c6000 7.629 MB
W20240204 13:41:43.909691 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x100010b69000 7.629 MB
W20240204 13:41:43.909718 25692 IPCTensor.h:369] NewIPCTensor: step_r5 [6]0x10001130c000 48 B 
W20240204 13:41:43.909744 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001130e000 8 B 
W20240204 13:41:43.909765 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100011310000 8 B 
W20240204 13:41:43.909819 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x100011312000 7.629 MB
W20240204 13:41:43.909855 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x100011ab5000 7.629 MB
W20240204 13:41:43.909881 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x100012258000 7.629 MB
W20240204 13:41:43.909916 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000129fb000 7.629 MB
W20240204 13:41:43.909950 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001319e000 7.629 MB
W20240204 13:41:43.909981 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x100013941000 7.629 MB
W20240204 13:41:43.910008 25692 IPCTensor.h:369] NewIPCTensor: step_r6 [6]0x1000140e4000 48 B 
W20240204 13:41:43.910030 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000140e6000 8 B 
W20240204 13:41:43.910053 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000140e8000 8 B 
W20240204 13:41:43.910107 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000140ea000 7.629 MB
W20240204 13:41:43.910142 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10001488d000 7.629 MB
W20240204 13:41:43.910171 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100015030000 7.629 MB
W20240204 13:41:43.910198 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000157d3000 7.629 MB
W20240204 13:41:43.910231 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x100015f76000 7.629 MB
W20240204 13:41:43.910267 25692 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100016719000 7.629 MB
W20240204 13:41:43.910301 25692 IPCTensor.h:369] NewIPCTensor: step_r7 [6]0x100016ebc000 48 B 
W20240204 13:41:43.910323 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x100016ebe000 8 B 
W20240204 13:41:43.910346 25692 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100016ec0000 8 B 
W20240204 13:41:44.323431 25692 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100016ec2000 128.2 GB
W20240204 13:50:18.986805 25692 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102025afa000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302708,  4302741,    96111,  ..., 52587551, 66093273,  4901938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2226.659 seconds
[Rank1] pid = 54370
[Rank2] pid = 54529
[Rank3] pid = 54692
[Rank4] pid = 54907
[Rank5] pid = 55044
[Rank6] pid = 55257
INFO [25692 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [54370 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [54529 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [54692 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [54907 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [55044 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [55433 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [55257 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [55044 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55257 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55433 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 13:59:02.580869 55045 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
INFO [54907 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [54692 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [54529 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25692 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 13:59:02.585377 55497 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240204 13:59:02.585376 55258 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240204 13:59:02.585477 55434 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
INFO [54370 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 13:59:02.586128 54908 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240204 13:59:02.586288 54530 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240204 13:59:02.586311 54693 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240204 13:59:02.588007 54371 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240204 13:59:02.666939 55258 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10203a34f000 7.629 MB
W20240204 13:59:02.667187 55258 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10203aaf4000 7.629 MB
W20240204 13:59:02.667259 55258 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10203b297000 1.49 GB
W20240204 13:59:02.667312 55258 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10209a87a000 1.49 GB
W20240204 13:59:02.667325 55497 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1020f9e5d000 7.629 MB
W20240204 13:59:02.667351 54908 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1020fa600000 7.629 MB
W20240204 13:59:02.667366 54371 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1020fada3000 7.629 MB
W20240204 13:59:02.667394 55258 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 13:59:02.667402 54693 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1020fb546000 7.629 MB
W20240204 13:59:02.667441 55434 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1020fbce9000 7.629 MB
W20240204 13:59:02.667482 54530 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1020fc48c000 7.629 MB
W20240204 13:59:02.667490 55045 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1020fcc2f000 7.629 MB
W20240204 13:59:02.669176 55434 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020fd3d2000 7.629 MB
W20240204 13:59:02.669230 55045 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1020fdb75000 7.629 MB
W20240204 13:59:02.669294 55434 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1020fe31a000 1.49 GB
W20240204 13:59:02.669312 55045 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10215d8fd000 1.49 GB
W20240204 13:59:02.669319 54693 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1021bcee0000 7.629 MB
W20240204 13:59:02.669337 55434 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1021bd683000 1.49 GB
W20240204 13:59:02.669366 54530 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10221cc66000 7.629 MB
W20240204 13:59:02.669376 55258 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 13:59:02.669384 54908 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10221d409000 7.629 MB
W20240204 13:59:02.669389 55497 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10221dbac000 7.629 MB
W20240204 13:59:02.669417 54693 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10221e34f000 1.49 GB
W20240204 13:59:02.669428 54371 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10227d932000 7.629 MB
W20240204 13:59:02.669436 55045 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10227e0d5000 1.49 GB
W20240204 13:59:02.669456 55434 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 13:59:02.669458 54530 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1022dd6b8000 1.49 GB
W20240204 13:59:02.669476 54908 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10233cc9b000 1.49 GB
W20240204 13:59:02.669484 55497 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10239c27e000 1.49 GB
W20240204 13:59:02.669502 54693 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1023fb861000 1.49 GB
W20240204 13:59:02.669529 54530 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10245ae44000 1.49 GB
W20240204 13:59:02.669541 54908 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1024ba427000 1.49 GB
W20240204 13:59:02.669557 55045 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 13:59:02.669559 54693 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 13:59:02.669564 55497 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x102519a0a000 1.49 GB
W20240204 13:59:02.669582 54371 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x102578fed000 1.49 GB
W20240204 13:59:02.669588 54530 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 13:59:02.669595 54908 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 13:59:02.669612 55497 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 13:59:02.669651 54371 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1025d85d0000 1.49 GB
W20240204 13:59:02.669713 54371 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 13:59:02.684175 55434 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 13:59:02.684190 54530 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 13:59:02.684221 54908 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 13:59:02.684231 54371 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 13:59:02.684238 55497 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 13:59:02.684247 55045 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 13:59:02.700929 54693 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x100016ec2000
6: KnownLocalCachedEmbedding init done
WARNING [55257 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
5: KnownLocalCachedEmbedding init done
WARNING [55044 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
1: KnownLocalCachedEmbedding init done
WARNING [54370 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
2: KnownLocalCachedEmbedding init done
WARNING [54529 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
4: KnownLocalCachedEmbedding init done
WARNING [54907 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
3: KnownLocalCachedEmbedding init done
WARNING [54692 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 55433
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100016ec2000
0: KnownLocalCachedEmbedding init done
WARNING [25692 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
7: KnownLocalCachedEmbedding init done
WARNING [55433 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 13:59:53.537966 55497 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 13:59:53.538113 54908 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 13:59:53.538257 55258 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 13:59:53.538331 54530 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 13:59:53.538396 55045 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 13:59:53.538488 54371 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 13:59:53.538661 55434 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 13:59:53.538803 54693 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 13:59:53.540627 55434 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 6,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 13:59:53.540930 55434 grad_base.h:184] Init GradProcessingBase done
I20240204 14:00:06.047297 55434 grad_async_v2.h:42] Use main thread to update emb.
W20240204 14:00:06.047505 55434 kg_controller.h:78] after init GradAsyncProcessingV2
I20240204 14:00:06.047516 55434 kg_controller.h:84] Construct KGCacheController done
E20240204 14:00:06.849363 55497 recstore.cc:66] init folly done
E20240204 14:00:06.849622 55258 recstore.cc:66] init folly done
E20240204 14:00:06.849802 55045 recstore.cc:66] init folly done
E20240204 14:00:06.849903 54693 recstore.cc:66] init folly done
E20240204 14:00:06.849979 54530 recstore.cc:66] init folly done
E20240204 14:00:06.850031 54908 recstore.cc:66] init folly done
E20240204 14:00:06.850057 54371 recstore.cc:66] init folly done
E20240204 14:00:06.850067 55434 recstore.cc:66] init folly done
I20240204 14:00:06.851438 55434 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240204 14:00:25.535478 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 14:00:25.535897 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 14:00:26.742184 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 14:00:26.742345 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 127.877 us                | 264.973 us                |
+---------------------------+---------------------------+---------------------------+
W20240204 14:00:28.479225 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 14:00:28.501369 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 14:00:28.555094 55497 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 14:00:28.829236 55045 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 14:00:29.134697 54908 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 14:00:30.213783 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 14:00:30.233953 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 14:00:30.302174 54530 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 14:00:30.882980 54371 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 14:00:31.364516 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 14:00:31.385340 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 14:00:31.443470 54693 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 125.678 us                | 240.181 us                |
+---------------------------+---------------------------+---------------------------+
I20240204 14:00:32.007925 55434 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 14:00:32.750469 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 14:00:32.806177 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 14:00:32.836061 55258 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 51.960 ms                 | 51.960 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 14:00:33.806023 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
E20240204 14:00:35.295166 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 14:00:35.455870 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240204 14:00:35.467913 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240204 14:00:35.634816 55434 grad_async_v2.h:257] pq is empty
E20240204 14:00:36.295020 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=2013
W20240204 14:00:36.471531 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
W20240204 14:00:36.497272 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=7, pq.top=7
E20240204 14:00:36.744509 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=9, sample_step_cpp_seen_[rank]=8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 344.809 us                | 4.898 ms                  |
| ProcessBack:Shuffle       | 7.607 ms                  | 344.942 ms                |
| ProcessBack:UpdateCache   | 10.170 ms                 | 679.756 ms                |
| ProcessBack:UpsertPq      | 50.208 ms                 | 159.681 ms                |
| ProcessOneStep            | 131.016 ms                | 1.451 s                   |
| BlockToStepN              | 180.158 us                | 2.620 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 14:00:37.295017 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=14
W20240204 14:00:37.567395 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240204 14:00:37.752769 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=11, pq.top=11
E20240204 14:00:38.295011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=604
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.689 ms                  | 110.997 ms                |
| Forward                   | 5.488 ms                  | 907.812 ms                |
| Backward                  | 8.136 ms                  | 202.622 ms                |
| Optimize                  | 2.125 ms                  | 4.722 ms                  |
| BarrierTimeBeforeRank0    | 845.899 us                | 49.263 ms                 |
| AfterBackward             | 100.225 ms                | 1.452 s                   |
| BlockToStepN              | 665.595 us                | 4.262 ms                  |
| OneStep                   | 135.745 ms                | 2.622 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 14:00:38.733414 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240204 14:00:39.295008 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
W20240204 14:00:39.886498 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240204 14:00:40.295015 61751 parallel_pq_v2.h:79] insert failed, size(hashtable)=21267
W20240204 14:00:40.568423 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240204 14:00:41.035035 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240204 14:00:41.295012 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=329
E20240204 14:00:41.744009 55434 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=28, sample_step_cpp_seen_[rank]=27
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 334.542 us                | 1.787 ms                  |
| ProcessBack:Shuffle       | 8.081 ms                  | 312.492 ms                |
| ProcessBack:UpdateCache   | 10.365 ms                 | 678.014 ms                |
| ProcessBack:UpsertPq      | 50.208 ms                 | 159.681 ms                |
| ProcessOneStep            | 100.588 ms                | 1.451 s                   |
| BlockToStepN              | 191.741 us                | 4.199 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240204 14:00:41.856600 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240204 14:00:42.096417 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240204 14:00:42.295024 61744 parallel_pq_v2.h:79] insert failed, size(hashtable)=34606
W20240204 14:00:43.098536 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 14:00:43.295012 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=775
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.117 ms                  | 110.997 ms                |
| Forward                   | 5.793 ms                  | 907.812 ms                |
| Backward                  | 6.213 ms                  | 202.622 ms                |
| Optimize                  | 2.560 ms                  | 4.947 ms                  |
| BarrierTimeBeforeRank0    | 845.899 us                | 78.506 ms                 |
| AfterBackward             | 100.639 ms                | 1.452 s                   |
| BlockToStepN              | 386.245 us                | 4.262 ms                  |
| OneStep                   | 131.047 ms                | 2.622 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 14:00:43.551024 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=40, pq.top=39
W20240204 14:00:44.129125 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240204 14:00:44.295156 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=2666
W20240204 14:00:44.810679 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240204 14:00:45.215750 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240204 14:00:45.295009 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=32484
W20240204 14:00:46.229967 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240204 14:00:46.295010 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=2224
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 374.446 us                | 3.456 ms                  |
| ProcessBack:Shuffle       | 8.113 ms                  | 312.492 ms                |
| ProcessBack:UpdateCache   | 10.224 ms                 | 678.014 ms                |
| ProcessBack:UpsertPq      | 36.826 ms                 | 159.681 ms                |
| ProcessOneStep            | 100.176 ms                | 845.188 ms                |
| BlockToStepN              | 341.171 us                | 4.086 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240204 14:00:47.218397 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240204 14:00:47.292222 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 14:00:47.295526 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
E20240204 14:00:47.525166 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=61, sample_step_cpp_seen_[rank]=60
E20240204 14:00:48.295013 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1203
W20240204 14:00:48.321913 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240204 14:00:48.466356 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.894 ms                  | 105.440 ms                |
| Forward                   | 5.914 ms                  | 60.898 ms                 |
| Backward                  | 5.948 ms                  | 12.298 ms                 |
| Optimize                  | 2.656 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 845.899 us                | 52.229 ms                 |
| AfterBackward             | 100.225 ms                | 845.245 ms                |
| BlockToStepN              | 531.124 us                | 4.165 ms                  |
| OneStep                   | 131.047 ms                | 872.883 ms                |
+---------------------------+---------------------------+---------------------------+
E20240204 14:00:49.299085 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 14:00:49.373772 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
W20240204 14:00:50.202850 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=74, pq.top=74
E20240204 14:00:50.299011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=4586
W20240204 14:00:50.481721 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240204 14:00:51.299014 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=66
W20240204 14:00:51.528474 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 319.418 us                | 3.275 ms                  |
| ProcessBack:Shuffle       | 8.363 ms                  | 39.673 ms                 |
| ProcessBack:UpdateCache   | 10.047 ms                 | 15.309 ms                 |
| ProcessBack:UpsertPq      | 32.227 ms                 | 152.204 ms                |
| ProcessOneStep            | 100.588 ms                | 845.188 ms                |
| BlockToStepN              | 480.851 us                | 4.086 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240204 14:00:52.114679 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=84, pq.top=84
E20240204 14:00:52.299010 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=539
W20240204 14:00:52.664608 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240204 14:00:52.794816 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=89, sample_step_cpp_seen_[rank]=88
E20240204 14:00:53.299010 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.112 ms                  | 105.440 ms                |
| Forward                   | 5.900 ms                  | 60.898 ms                 |
| Backward                  | 5.639 ms                  | 17.240 ms                 |
| Optimize                  | 2.715 ms                  | 33.400 ms                 |
| BarrierTimeBeforeRank0    | 1.640 ms                  | 52.229 ms                 |
| AfterBackward             | 100.639 ms                | 845.245 ms                |
| BlockToStepN              | 589.639 us                | 4.262 ms                  |
| OneStep                   | 131.057 ms                | 872.883 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 14:00:53.699637 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 14:00:54.299011 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=14174
W20240204 14:00:54.343160 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240204 14:00:54.734391 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240204 14:00:55.299011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=56
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 26.822, sample: 1.370, forward: 1.424, backward: 0.811, update: 0.270
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 26.242, sample: 1.526, forward: 1.383, backward: 0.782, update: 0.244
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 25.074, sample: 1.259, forward: 1.372, backward: 0.831, update: 0.236
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 23.933, sample: 1.530, forward: 1.361, backward: 0.821, update: 0.222
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 26.548, sample: 1.524, forward: 1.374, backward: 0.816, update: 0.246
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 22.541, sample: 1.584, forward: 1.407, backward: 0.812, update: 0.274
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 24.494, sample: 1.510, forward: 1.252, backward: 0.777, update: 0.239
train_sampler.Prefill()
-------Step 0-------
tensor([   60712,    60737,    60786,    60827,  6049394,    88816, 64335174,
        20447357, 18193264,    60867]) tensor([ 5319860, 13634047, 50710392, 65070931, 21472179, 36045552, 32273446,
        69936725, 59677364, 33847043])
-------Step 1-------
tensor([   60712,    60737,    60786,    60827,  6049394,    88816, 64335174,
        20447357, 18193264,    60867]) tensor([75006841, 32169096, 10868702, 68774046, 81815504, 37385699, 65600953,
        41571542, 32163362, 14933243])
-------Step 2-------
tensor([  153608,   153635,   153671,    31513,   153732,   153768,   153807,
        29317559,   153838,   153881]) tensor([78488495, 26562821, 83090592, 41478915, 35328922, 24149043, 75180570,
        47312410, 13578510, 36673698])
-------Step 3-------
tensor([  153608,   153635,   153671,    31513,   153732,   153768,   153807,
        29317559,   153838,   153881]) tensor([42250172, 85873042, 29575133, 44009529, 74139204, 73837183, 42657473,
        18817073, 30696048,   689834])
-------Step 4-------
tensor([  246396, 51087631,   246437,   111852,   246473,   111875,   246510,
        46007720,   246550,   246601]) tensor([84660958, 10975038, 73623650, 19080729, 60487279, 37858236, 71372373,
        43137286, 85889283, 59508237])
-------Step 5-------
tensor([  246396, 51087631,   246437,   111852,   246473,   111875,   246510,
        46007720,   246550,   246601]) tensor([39681871, 77865471,   200387, 84023040, 49887812, 47444726, 14130520,
         8738978, 60106083, 35474294])
before start barrier
start train
[proc 0] 100 steps, total: 23.369, sample: 1.561, forward: 1.564, backward: 0.822, update: 0.383
W20240204 14:00:55.617172 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=102, pq.top=101
W20240204 14:00:55.823243 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240204 14:00:56.299021 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=12584
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 451.665 us                | 10.650 ms                 |
| ProcessBack:Shuffle       | 8.329 ms                  | 39.673 ms                 |
| ProcessBack:UpdateCache   | 9.895 ms                  | 15.309 ms                 |
| ProcessBack:UpsertPq      | 36.365 ms                 | 152.204 ms                |
| ProcessOneStep            | 100.176 ms                | 845.188 ms                |
| BlockToStepN              | 592.964 us                | 12.708 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 14:00:56.883793 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240204 14:00:57.299053 61730 parallel_pq_v2.h:79] insert failed, size(hashtable)=16871
W20240204 14:00:57.364012 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240204 14:00:57.937539 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 14:00:58.168298 55434 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=115, sample_step_cpp_seen_[rank]=114
E20240204 14:00:58.299008 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=2769
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.894 ms                  | 123.773 ms                |
| Forward                   | 5.793 ms                  | 60.898 ms                 |
| Backward                  | 5.509 ms                  | 17.240 ms                 |
| Optimize                  | 2.597 ms                  | 33.400 ms                 |
| BarrierTimeBeforeRank0    | 480.184 us                | 78.506 ms                 |
| AfterBackward             | 100.639 ms                | 845.245 ms                |
| BlockToStepN              | 691.902 us                | 27.159 ms                 |
| OneStep                   | 135.562 ms                | 872.883 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 14:00:58.941174 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240204 14:00:58.967989 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240204 14:00:59.299007 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=761
W20240204 14:01:00.016227 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240204 14:01:00.299008 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=276
W20240204 14:01:00.916616 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=124, pq.top=124
W20240204 14:01:01.052460 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 14:01:01.299011 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=472
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 446.836 us                | 6.482 ms                  |
| ProcessBack:Shuffle       | 8.358 ms                  | 21.553 ms                 |
| ProcessBack:UpdateCache   | 10.047 ms                 | 15.077 ms                 |
| ProcessBack:UpsertPq      | 32.728 ms                 | 150.862 ms                |
| ProcessOneStep            | 100.588 ms                | 1.071 s                   |
| BlockToStepN              | 693.375 us                | 27.019 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:02.102121 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240204 14:01:02.299019 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=74
W20240204 14:01:02.350526 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240204 14:01:03.127393 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240204 14:01:03.299015 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=14802
W20240204 14:01:03.506856 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.037 ms                  | 128.551 ms                |
| Forward                   | 5.815 ms                  | 60.898 ms                 |
| Backward                  | 5.529 ms                  | 17.240 ms                 |
| Optimize                  | 2.656 ms                  | 33.400 ms                 |
| BarrierTimeBeforeRank0    | 1.640 ms                  | 78.506 ms                 |
| AfterBackward             | 100.225 ms                | 1.071 s                   |
| BlockToStepN              | 850.120 us                | 50.061 ms                 |
| OneStep                   | 135.745 ms                | 1.171 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 14:01:03.589718 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=139, sample_step_cpp_seen_[rank]=138
W20240204 14:01:04.137069 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240204 14:01:04.299023 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=586
W20240204 14:01:04.608124 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240204 14:01:05.242266 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240204 14:01:05.299013 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=6323
W20240204 14:01:06.229851 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240204 14:01:06.276818 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 14:01:06.299005 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 369.396 us                | 2.448 ms                  |
| ProcessBack:Shuffle       | 8.408 ms                  | 21.553 ms                 |
| ProcessBack:UpdateCache   | 10.150 ms                 | 15.274 ms                 |
| ProcessBack:UpsertPq      | 33.916 ms                 | 150.862 ms                |
| ProcessOneStep            | 101.003 ms                | 1.071 s                   |
| BlockToStepN              | 770.757 us                | 49.889 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:07.237093 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240204 14:01:07.288367 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240204 14:01:07.299624 61734 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
E20240204 14:01:08.299968 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 14:01:08.364872 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.986 ms                  | 123.773 ms                |
| Forward                   | 5.736 ms                  | 20.567 ms                 |
| Backward                  | 5.509 ms                  | 12.298 ms                 |
| Optimize                  | 2.771 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.468 ms                  | 52.229 ms                 |
| AfterBackward             | 101.396 ms                | 1.042 s                   |
| BlockToStepN              | 935.257 us                | 27.159 ms                 |
| OneStep                   | 136.429 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:08.666713 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=159, pq.top=159
E20240204 14:01:09.299010 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=233
E20240204 14:01:09.458055 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=165, sample_step_cpp_seen_[rank]=164
W20240204 14:01:09.520799 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
W20240204 14:01:10.056710 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=166, pq.top=166
E20240204 14:01:10.299013 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=54904
W20240204 14:01:10.560204 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
W20240204 14:01:11.247397 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=173, pq.top=173
E20240204 14:01:11.299016 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1597
W20240204 14:01:11.689129 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 426.567 us                | 9.051 ms                  |
| ProcessBack:Shuffle       | 8.364 ms                  | 19.534 ms                 |
| ProcessBack:UpdateCache   | 10.153 ms                 | 15.077 ms                 |
| ProcessBack:UpsertPq      | 33.910 ms                 | 152.204 ms                |
| ProcessOneStep            | 101.352 ms                | 1.042 s                   |
| BlockToStepN              | 977.178 us                | 27.019 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 14:01:12.299011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=16966
W20240204 14:01:12.496306 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240204 14:01:12.735042 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240204 14:01:13.299010 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=57453
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.780 ms                  | 123.773 ms                |
| Forward                   | 5.697 ms                  | 20.567 ms                 |
| Backward                  | 5.553 ms                  | 12.298 ms                 |
| Optimize                  | 2.745 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.468 ms                  | 60.669 ms                 |
| AfterBackward             | 101.396 ms                | 1.042 s                   |
| BlockToStepN              | 1.119 ms                  | 27.159 ms                 |
| OneStep                   | 136.402 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:13.848317 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240204 14:01:14.299013 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=44028
W20240204 14:01:14.335348 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240204 14:01:14.949473 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240204 14:01:15.299013 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=49434
E20240204 14:01:15.341372 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=194, sample_step_cpp_seen_[rank]=193
W20240204 14:01:16.045174 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240204 14:01:16.048780 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 14:01:16.299013 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=15611
[proc 5] 200 steps, total: 21.337, sample: 1.170, forward: 0.579, backward: 0.595, update: 0.232
[proc 0] 200 steps, total: 21.337, sample: 1.600, forward: 0.583, backward: 0.617, update: 0.302
[proc 3] 200 steps, total: 21.338, sample: 1.253, forward: 0.607, backward: 0.567, update: 0.232
[proc 2] 200 steps, total: 21.338, sample: 1.163, forward: 0.575, backward: 0.567, update: 0.241
[proc 7] 200 steps, total: 21.338, sample: 1.052, forward: 0.568, backward: 0.657, update: 0.231
[proc 1] 200 steps, total: 21.337, sample: 1.317, forward: 0.550, backward: 0.578, update: 0.240
[proc 6] 200 steps, total: 21.337, sample: 1.277, forward: 0.585, backward: 0.622, update: 0.238
[proc 4] 200 steps, total: 21.338, sample: 1.113, forward: 0.579, backward: 0.649, update: 0.232
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 402.732 us                | 7.402 ms                  |
| ProcessBack:Shuffle       | 8.382 ms                  | 19.534 ms                 |
| ProcessBack:UpdateCache   | 10.145 ms                 | 15.077 ms                 |
| ProcessBack:UpsertPq      | 32.227 ms                 | 150.862 ms                |
| ProcessOneStep            | 101.662 ms                | 1.042 s                   |
| BlockToStepN              | 1.044 ms                  | 49.889 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:17.175549 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
W20240204 14:01:17.213689 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=203, pq.top=203
E20240204 14:01:17.299011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=2849
W20240204 14:01:18.180091 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
E20240204 14:01:18.299010 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=1525
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.682 ms                  | 123.773 ms                |
| Forward                   | 5.711 ms                  | 20.567 ms                 |
| Backward                  | 5.663 ms                  | 12.298 ms                 |
| Optimize                  | 2.696 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.426 ms                  | 78.506 ms                 |
| AfterBackward             | 101.040 ms                | 1.042 s                   |
| BlockToStepN              | 1.120 ms                  | 53.178 ms                 |
| OneStep                   | 136.600 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:18.562341 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240204 14:01:19.209718 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240204 14:01:19.299016 61727 parallel_pq_v2.h:79] insert failed, size(hashtable)=39066
W20240204 14:01:19.732499 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240204 14:01:20.282328 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240204 14:01:20.299005 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=813
E20240204 14:01:20.341002 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=219, sample_step_cpp_seen_[rank]=218
W20240204 14:01:20.857296 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=221, pq.top=221
E20240204 14:01:21.299011 61730 parallel_pq_v2.h:79] insert failed, size(hashtable)=44511
W20240204 14:01:21.313378 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 457.393 us                | 14.635 ms                 |
| ProcessBack:Shuffle       | 8.362 ms                  | 19.252 ms                 |
| ProcessBack:UpdateCache   | 10.095 ms                 | 15.061 ms                 |
| ProcessBack:UpsertPq      | 30.901 ms                 | 150.733 ms                |
| ProcessOneStep            | 100.588 ms                | 1.042 s                   |
| BlockToStepN              | 1.173 ms                  | 92.051 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 14:01:22.299016 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=40880
W20240204 14:01:22.409914 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240204 14:01:22.485073 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=230, pq.top=230
E20240204 14:01:23.299021 61726 parallel_pq_v2.h:79] insert failed, size(hashtable)=12107
W20240204 14:01:23.527344 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.558 ms                  | 123.773 ms                |
| Forward                   | 5.662 ms                  | 20.567 ms                 |
| Backward                  | 5.641 ms                  | 12.298 ms                 |
| Optimize                  | 2.650 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.468 ms                  | 78.506 ms                 |
| AfterBackward             | 99.941 ms                 | 1.042 s                   |
| BlockToStepN              | 1.324 ms                  | 92.205 ms                 |
| OneStep                   | 135.745 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 14:01:24.299011 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=2646
W20240204 14:01:24.343539 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240204 14:01:24.628397 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240204 14:01:25.299018 61732 parallel_pq_v2.h:79] insert failed, size(hashtable)=1392
E20240204 14:01:25.341002 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=244, sample_step_cpp_seen_[rank]=243
W20240204 14:01:25.582233 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240204 14:01:25.639521 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240204 14:01:26.310952 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 14:01:26.668557 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
W20240204 14:01:26.845144 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 464.356 us                | 8.292 ms                  |
| ProcessBack:Shuffle       | 8.380 ms                  | 19.252 ms                 |
| ProcessBack:UpdateCache   | 10.089 ms                 | 15.061 ms                 |
| ProcessBack:UpsertPq      | 30.467 ms                 | 150.733 ms                |
| ProcessOneStep            | 99.887 ms                 | 910.504 ms                |
| BlockToStepN              | 1.263 ms                  | 75.066 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 14:01:27.310011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=3919
W20240204 14:01:27.695411 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 14:01:28.310011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=57550
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.416 ms                  | 110.997 ms                |
| Forward                   | 5.694 ms                  | 15.072 ms                 |
| Backward                  | 5.699 ms                  | 10.938 ms                 |
| Optimize                  | 2.652 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.432 ms                  | 72.903 ms                 |
| AfterBackward             | 99.439 ms                 | 910.556 ms                |
| BlockToStepN              | 1.329 ms                  | 75.205 ms                 |
| OneStep                   | 136.402 ms                | 934.504 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:28.727936 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
W20240204 14:01:28.850049 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=263, pq.top=263
E20240204 14:01:29.310012 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=5234
W20240204 14:01:29.751578 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240204 14:01:29.905803 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=267, pq.top=267
E20240204 14:01:30.310014 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=10102
E20240204 14:01:30.681277 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=273, sample_step_cpp_seen_[rank]=272
W20240204 14:01:30.867606 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240204 14:01:31.310017 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=8400
W20240204 14:01:31.517583 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=275, pq.top=275
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 394.950 us                | 4.946 ms                  |
| ProcessBack:Shuffle       | 8.406 ms                  | 18.533 ms                 |
| ProcessBack:UpdateCache   | 10.089 ms                 | 14.985 ms                 |
| ProcessBack:UpsertPq      | 30.188 ms                 | 151.214 ms                |
| ProcessOneStep            | 100.176 ms                | 910.504 ms                |
| BlockToStepN              | 1.305 ms                  | 75.066 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:31.903581 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240204 14:01:32.310019 61748 parallel_pq_v2.h:79] insert failed, size(hashtable)=28085
W20240204 14:01:32.598732 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240204 14:01:32.980331 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240204 14:01:33.310014 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.173 ms                  | 110.997 ms                |
| Forward                   | 5.699 ms                  | 15.072 ms                 |
| Backward                  | 5.699 ms                  | 10.938 ms                 |
| Optimize                  | 2.626 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.393 ms                  | 72.903 ms                 |
| AfterBackward             | 100.225 ms                | 910.556 ms                |
| BlockToStepN              | 1.419 ms                  | 75.205 ms                 |
| OneStep                   | 136.493 ms                | 934.504 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:33.718868 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240204 14:01:34.056149 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240204 14:01:34.310092 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=2505
W20240204 14:01:35.029923 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240204 14:01:35.060458 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240204 14:01:35.310011 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=1533
W20240204 14:01:36.087013 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
[proc 0] 300 steps, total: 19.413, sample: 1.080, forward: 0.582, backward: 0.655, update: 0.285
[proc 6] 300 steps, total: 19.413, sample: 1.288, forward: 0.549, backward: 0.559, update: 0.231
[proc 7] 300 steps, total: 19.413, sample: 1.263, forward: 0.560, backward: 0.595, update: 0.307
[proc 5] 300 steps, total: 19.413, sample: 1.140, forward: 0.550, backward: 0.561, update: 0.272
[proc 1] 300 steps, total: 19.413, sample: 1.324, forward: 0.561, backward: 0.612, update: 0.238
[proc 2] 300 steps, total: 19.413, sample: 1.116, forward: 0.536, backward: 0.538, update: 0.239
[proc 3] 300 steps, total: 19.413, sample: 1.275, forward: 0.535, backward: 0.570, update: 0.227
[proc 4] 300 steps, total: 19.413, sample: 1.146, forward: 0.550, backward: 0.582, update: 0.242
W20240204 14:01:36.309521 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=301, pq.top=301
E20240204 14:01:36.310003 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=40562
E20240204 14:01:36.565884 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=303, sample_step_cpp_seen_[rank]=302
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 540.866 us                | 20.261 ms                 |
| ProcessBack:Shuffle       | 8.409 ms                  | 18.533 ms                 |
| ProcessBack:UpdateCache   | 10.052 ms                 | 14.985 ms                 |
| ProcessBack:UpsertPq      | 29.967 ms                 | 151.214 ms                |
| ProcessOneStep            | 99.887 ms                 | 910.504 ms                |
| BlockToStepN              | 1.419 ms                  | 75.066 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:37.114758 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 14:01:37.310009 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=3886
W20240204 14:01:37.332376 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240204 14:01:38.178424 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 14:01:38.310007 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1918
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.130 ms                  | 110.997 ms                |
| Forward                   | 5.691 ms                  | 15.072 ms                 |
| Backward                  | 5.655 ms                  | 10.938 ms                 |
| Optimize                  | 2.650 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.124 ms                  | 72.903 ms                 |
| AfterBackward             | 99.535 ms                 | 910.556 ms                |
| BlockToStepN              | 1.558 ms                  | 75.205 ms                 |
| OneStep                   | 136.597 ms                | 934.504 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:39.026839 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=314, pq.top=314
W20240204 14:01:39.192708 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240204 14:01:39.310014 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=2547
W20240204 14:01:40.067248 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240204 14:01:40.207178 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240204 14:01:40.310019 61744 parallel_pq_v2.h:79] insert failed, size(hashtable)=144202
W20240204 14:01:41.225992 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 14:01:41.310011 58228 parallel_pq_v2.h:79] insert failed, size(hashtable)=16364
W20240204 14:01:41.344923 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=327, pq.top=327
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 459.106 us                | 14.083 ms                 |
| ProcessBack:Shuffle       | 8.451 ms                  | 19.221 ms                 |
| ProcessBack:UpdateCache   | 10.030 ms                 | 14.985 ms                 |
| ProcessBack:UpsertPq      | 29.856 ms                 | 150.862 ms                |
| ProcessOneStep            | 99.164 ms                 | 910.504 ms                |
| BlockToStepN              | 1.522 ms                  | 75.066 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:42.308816 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240204 14:01:42.310001 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=35458
W20240204 14:01:42.380401 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=333, pq.top=333
E20240204 14:01:42.529680 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=334, sample_step_cpp_seen_[rank]=333
E20240204 14:01:43.310019 61718 parallel_pq_v2.h:79] insert failed, size(hashtable)=38865
W20240204 14:01:43.332751 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240204 14:01:43.409034 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=336, pq.top=336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.173 ms                  | 110.997 ms                |
| Forward                   | 5.684 ms                  | 15.072 ms                 |
| Backward                  | 5.597 ms                  | 10.938 ms                 |
| Optimize                  | 2.632 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.282 ms                  | 78.506 ms                 |
| AfterBackward             | 99.136 ms                 | 910.556 ms                |
| BlockToStepN              | 1.720 ms                  | 82.536 ms                 |
| OneStep                   | 136.600 ms                | 934.504 ms                |
+---------------------------+---------------------------+---------------------------+
E20240204 14:01:44.310011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=86715
W20240204 14:01:44.448930 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
W20240204 14:01:45.019785 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=345, pq.top=345
E20240204 14:01:45.310012 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=16835
W20240204 14:01:45.455329 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240204 14:01:46.310012 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=3855
W20240204 14:01:46.465764 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
W20240204 14:01:46.758352 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=355, pq.top=355
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 505.703 us                | 11.049 ms                 |
| ProcessBack:Shuffle       | 8.440 ms                  | 19.252 ms                 |
| ProcessBack:UpdateCache   | 9.946 ms                  | 14.985 ms                 |
| ProcessBack:UpsertPq      | 29.589 ms                 | 151.214 ms                |
| ProcessOneStep            | 98.560 ms                 | 845.188 ms                |
| BlockToStepN              | 1.749 ms                  | 75.066 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 14:01:47.310021 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=926
E20240204 14:01:47.544237 55434 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=361, sample_step_cpp_seen_[rank]=360
W20240204 14:01:47.551187 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240204 14:01:48.310009 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=274
W20240204 14:01:48.390177 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=363, pq.top=363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.119 ms                  | 105.440 ms                |
| Forward                   | 5.675 ms                  | 14.164 ms                 |
| Backward                  | 5.563 ms                  | 10.529 ms                 |
| Optimize                  | 2.589 ms                  | 9.112 ms                  |
| BarrierTimeBeforeRank0    | 1.440 ms                  | 80.829 ms                 |
| AfterBackward             | 98.588 ms                 | 845.245 ms                |
| BlockToStepN              | 1.889 ms                  | 75.205 ms                 |
| OneStep                   | 136.785 ms                | 872.883 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:48.555935 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 14:01:49.310011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=44268
W20240204 14:01:49.431017 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240204 14:01:49.581425 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 14:01:50.310010 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=46800
W20240204 14:01:50.512682 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=374, pq.top=374
W20240204 14:01:50.608310 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240204 14:01:51.311452 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=275
W20240204 14:01:51.613320 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 475.174 us                | 11.225 ms                 |
| ProcessBack:Shuffle       | 8.528 ms                  | 19.221 ms                 |
| ProcessBack:UpdateCache   | 9.976 ms                  | 14.958 ms                 |
| ProcessBack:UpsertPq      | 29.589 ms                 | 150.862 ms                |
| ProcessOneStep            | 98.286 ms                 | 845.188 ms                |
| BlockToStepN              | 1.879 ms                  | 75.066 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:52.270007 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=383, pq.top=383
E20240204 14:01:52.311010 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=63062
W20240204 14:01:52.681581 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240204 14:01:53.036619 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=389, sample_step_cpp_seen_[rank]=388
E20240204 14:01:53.311019 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=5110
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.939 ms                  | 105.440 ms                |
| Forward                   | 5.664 ms                  | 14.164 ms                 |
| Backward                  | 5.529 ms                  | 10.529 ms                 |
| Optimize                  | 2.582 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.633 ms                  | 80.829 ms                 |
| AfterBackward             | 97.799 ms                 | 845.245 ms                |
| BlockToStepN              | 2.026 ms                  | 75.205 ms                 |
| OneStep                   | 136.914 ms                | 872.883 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 14:01:53.688593 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240204 14:01:53.772421 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=391, pq.top=391
E20240204 14:01:54.311012 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=36361
W20240204 14:01:54.700235 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
W20240204 14:01:54.799479 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=399, pq.top=399
E20240204 14:01:55.311014 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=6234
[proc 0] 400 steps, total: 19.256, sample: 0.914, forward: 0.569, backward: 0.531, update: 0.278
[proc 4] 400 steps, total: 19.256, sample: 1.036, forward: 0.570, backward: 0.579, update: 0.255
[proc 5] 400 steps, total: 19.256, sample: 1.096, forward: 0.563, backward: 0.542, update: 0.240
[proc 7] 400 steps, total: 19.256, sample: 0.964, forward: 0.541, backward: 0.570, update: 0.235
[proc 6] 400 steps, total: 19.256, sample: 1.114, forward: 0.540, backward: 0.529, update: 0.235
[proc 1] 400 steps, total: 19.256, sample: 1.222, forward: 0.540, backward: 0.541, update: 0.243
[proc 2] 400 steps, total: 19.256, sample: 0.917, forward: 0.562, backward: 0.530, update: 0.233
[proc 3] 400 steps, total: 19.256, sample: 1.286, forward: 0.550, backward: 0.539, update: 0.228
W20240204 14:01:55.703557 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240204 14:01:56.100101 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=405, pq.top=404
E20240204 14:01:56.311012 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=18102
W20240204 14:01:56.710808 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 539.293 us                | 11.841 ms                 |
| ProcessBack:Shuffle       | 8.540 ms                  | 19.221 ms                 |
| ProcessBack:UpdateCache   | 9.890 ms                  | 14.958 ms                 |
| ProcessBack:UpsertPq      | 29.389 ms                 | 150.862 ms                |
| ProcessOneStep            | 97.565 ms                 | 845.188 ms                |
| BlockToStepN              | 2.058 ms                  | 75.066 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 14:01:57.311008 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=56
W20240204 14:01:57.579586 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=412, pq.top=411
W20240204 14:01:57.749958 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240204 14:01:58.311023 61739 parallel_pq_v2.h:79] insert failed, size(hashtable)=52454
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.931 ms                  | 105.440 ms                |
| Forward                   | 5.675 ms                  | 14.164 ms                 |
| Backward                  | 5.517 ms                  | 10.529 ms                 |
| Optimize                  | 2.580 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.683 ms                  | 80.829 ms                 |
| AfterBackward             | 97.799 ms                 | 845.245 ms                |
| BlockToStepN              | 2.190 ms                  | 75.205 ms                 |
| OneStep                   | 137.159 ms                | 872.883 ms                |
+---------------------------+---------------------------+---------------------------+
E20240204 14:01:58.574151 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=419, sample_step_cpp_seen_[rank]=418
W20240204 14:01:58.792110 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 14:01:59.311010 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=30042
W20240204 14:01:59.585451 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240204 14:01:59.912968 61430 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 14:02:00.317165 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 14:02:00.936620 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240204 14:02:01.003399 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=429, pq.top=429
E20240204 14:02:01.327404 58228 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 583.343 us                | 27.376 ms                 |
| ProcessBack:Shuffle       | 8.553 ms                  | 19.252 ms                 |
| ProcessBack:UpdateCache   | 9.790 ms                  | 14.958 ms                 |
| ProcessBack:UpsertPq      | 29.309 ms                 | 150.733 ms                |
| ProcessOneStep            | 98.286 ms                 | 845.188 ms                |
| BlockToStepN              | 2.135 ms                  | 82.038 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 14:02:02.030457 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240204 14:02:02.337036 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 14:02:02.652276 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240204 14:02:03.133486 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240204 14:02:03.337013 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1856
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.827 ms                  | 105.440 ms                |
| Forward                   | 5.664 ms                  | 14.164 ms                 |
| Backward                  | 5.522 ms                  | 10.938 ms                 |
| Optimize                  | 2.579 ms                  | 10.006 ms                 |
| BarrierTimeBeforeRank0    | 1.712 ms                  | 80.829 ms                 |
| AfterBackward             | 98.331 ms                 | 845.245 ms                |
| BlockToStepN              | 2.245 ms                  | 82.536 ms                 |
| OneStep                   | 137.533 ms                | 872.883 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 14:02:03.901742 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=445, pq.top=445
E20240204 14:02:03.944077 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=445, sample_step_cpp_seen_[rank]=444
W20240204 14:02:04.209605 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240204 14:02:04.337011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=1038
W20240204 14:02:05.072578 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240204 14:02:05.247190 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240204 14:02:05.337010 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=31590
W20240204 14:02:06.273545 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 14:02:06.337025 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=17127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 514.878 us                | 18.069 ms                 |
| ProcessBack:Shuffle       | 8.546 ms                  | 19.252 ms                 |
| ProcessBack:UpdateCache   | 9.741 ms                  | 14.958 ms                 |
| ProcessBack:UpsertPq      | 29.261 ms                 | 150.862 ms                |
| ProcessOneStep            | 98.286 ms                 | 818.246 ms                |
| BlockToStepN              | 2.219 ms                  | 82.038 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 14:02:07.123054 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240204 14:02:07.297694 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240204 14:02:07.337010 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=13972
W20240204 14:02:08.333658 61430 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240204 14:02:08.337117 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.786 ms                  | 102.150 ms                |
| Forward                   | 5.660 ms                  | 12.590 ms                 |
| Backward                  | 5.506 ms                  | 10.529 ms                 |
| Optimize                  | 2.582 ms                  | 9.112 ms                  |
| BarrierTimeBeforeRank0    | 1.746 ms                  | 78.506 ms                 |
| AfterBackward             | 98.331 ms                 | 818.302 ms                |
| BlockToStepN              | 2.372 ms                  | 82.192 ms                 |
| OneStep                   | 138.245 ms                | 842.875 ms                |
+---------------------------+---------------------------+---------------------------+
E20240204 14:02:09.337009 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=65
W20240204 14:02:09.406606 61430 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
W20240204 14:02:09.529512 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=475, pq.top=475
E20240204 14:02:09.994628 58228 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=477, sample_step_cpp_seen_[rank]=476
E20240204 14:02:10.337015 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=6459
W20240204 14:02:10.448010 61430 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 14:02:11.337168 55434 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
W20240204 14:02:11.523272 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 551.838 us                | 17.746 ms                 |
| ProcessBack:Shuffle       | 8.563 ms                  | 19.534 ms                 |
| ProcessBack:UpdateCache   | 9.741 ms                  | 14.985 ms                 |
| ProcessBack:UpsertPq      | 29.589 ms                 | 150.733 ms                |
| ProcessOneStep            | 98.544 ms                 | 818.246 ms                |
| BlockToStepN              | 2.345 ms                  | 82.381 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 14:02:12.337011 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=35056
W20240204 14:02:12.562074 61430 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
W20240204 14:02:12.659847 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=489, pq.top=488
E20240204 14:02:13.337105 61430 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.657 ms                  | 102.150 ms                |
| Forward                   | 5.660 ms                  | 12.590 ms                 |
| Backward                  | 5.459 ms                  | 10.529 ms                 |
| Optimize                  | 2.580 ms                  | 9.112 ms                  |
| BarrierTimeBeforeRank0    | 1.884 ms                  | 78.506 ms                 |
| AfterBackward             | 98.331 ms                 | 818.302 ms                |
| BlockToStepN              | 2.484 ms                  | 82.536 ms                 |
| OneStep                   | 138.872 ms                | 842.875 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 14:02:13.635488 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
W20240204 14:02:14.161527 55434 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=495, pq.top=495
E20240204 14:02:14.337014 58228 parallel_pq_v2.h:79] insert failed, size(hashtable)=8132
W20240204 14:02:14.665469 61430 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
[proc 2] 500 steps, total: 19.500, sample: 0.812, forward: 0.606, backward: 0.590, update: 0.227
[proc 0] 500 steps, total: 19.500, sample: 0.888, forward: 0.578, backward: 0.551, update: 0.286
[proc 5] 500 steps, total: 19.500, sample: 1.037, forward: 0.579, backward: 0.576, update: 0.262
[proc 7] 500 steps, total: 19.500, sample: 1.040, forward: 0.634, backward: 0.557, update: 0.244
[proc 1] 500 steps, total: 19.500, sample: 1.090, forward: 0.574, backward: 0.555, update: 0.234
[proc 6] 500 steps, total: 19.500, sample: 1.143, forward: 0.564, backward: 0.548, update: 0.235
[proc 4] 500 steps, total: 19.500, sample: 0.972, forward: 0.576, backward: 0.581, update: 0.246
[proc 3] 500 steps, total: 19.500, sample: 1.050, forward: 0.556, backward: 0.571, update: 0.238
Successfully xmh. training takes 102.87587594985962 seconds
before call kg_cache_controller.StopThreads()
W20240204 14:02:14.883908 55434 grad_async_v2.h:84] call StopThreads. PID = 25692
W20240204 14:02:14.883961 55434 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 14:02:14.884297 55434 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 14:02:14.884315 55434 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240204 14:02:15.284837 55434 grad_async_v2.h:105] StopThreads done.
