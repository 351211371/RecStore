WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 10:47:38.474290  6620 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_128', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=4, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [6620 sampler.py:454] Start PreSampling
WARNING [6620 sampler.py:532] Before construct renumbering_dict
WARNING [6620 sampler.py:555] PreSampling done
W20240204 10:47:44.079795  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 10:47:44.079988  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 10:47:44.080029  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 10:47:44.080070  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 10:47:44.080103  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 10:47:44.080137  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 10:47:44.080163  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 10:47:44.080226  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 10:47:44.080263  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 10:47:44.080288  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 10:47:44.080324  6620 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 10:47:44.080358  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 10:47:44.080389  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 10:47:44.080504  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 10:47:44.080555  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 10:47:44.080593  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 10:47:44.080632  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 10:47:44.080659  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 10:47:44.080693  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 10:47:44.080734  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 10:47:44.080766  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 10:47:44.080793  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 10:47:44.080817  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 10:47:44.080850  6620 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 10:47:44.080873  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 10:47:44.080895  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 10:47:44.080945  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 10:47:44.081000  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 10:47:44.081025  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 10:47:44.081049  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 10:47:44.081079  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 10:47:44.081112  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 10:47:44.081146  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 10:47:44.081177  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 10:47:44.081210  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 10:47:44.081235  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 10:47:44.081265  6620 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 10:47:44.081286  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 10:47:44.081312  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 10:47:44.081360  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 10:47:44.081398  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 10:47:44.081426  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 10:47:44.081457  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 10:47:44.081482  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 10:47:44.081521  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 10:47:44.081550  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 10:47:44.081575  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 10:47:44.081607  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 10:47:44.081635  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 10:47:44.081660  6620 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 10:47:44.081681  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 10:47:44.081701  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 10:47:44.081754  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 10:47:44.081794  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 10:47:44.081818  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 10:47:44.081842  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 10:47:44.081876  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 10:47:44.081908  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 10:47:44.081950  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 10:47:44.081976  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 10:47:44.082022  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 10:47:44.082056  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 10:47:44.082082  6620 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 10:47:44.082103  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 10:47:44.082129  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 10:47:44.082177  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 10:47:44.082219  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 10:47:44.082248  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 10:47:44.082273  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 10:47:44.082298  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 10:47:44.082337  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 10:47:44.082372  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 10:47:44.082413  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 10:47:44.082438  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 10:47:44.082464  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 10:47:44.082489  6620 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 10:47:44.082510  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 10:47:44.082531  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 10:47:44.082576  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 10:47:44.082612  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 10:47:44.082640  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 10:47:44.082677  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 10:47:44.082702  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 10:47:44.082743  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 10:47:44.082775  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 10:47:44.082813  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 10:47:44.082854  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 10:47:44.082881  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 10:47:44.082916  6620 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 10:47:44.082938  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 10:47:44.082966  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 10:47:44.083019  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 10:47:44.083056  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 10:47:44.083088  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 10:47:44.083138  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 10:47:44.083165  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 10:47:44.083196  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 10:47:44.083227  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 10:47:44.083259  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 10:47:44.083292  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 10:47:44.083317  6620 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 10:47:44.083343  6620 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 10:47:44.083364  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 10:47:44.083393  6620 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 10:47:44.306800  6620 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240204 10:47:44.339349  6620 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([  757,  1179,  1668,  ..., 10201,  7957,  6288]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.897 seconds
[Rank1] pid = 7043
[Rank2] pid = 7105
[Rank3] pid = 7171
[Rank4] pid = 7235
[Rank5] pid = 7299
[Rank6] pid = 7369
INFO [6620 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [7043 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [7105 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [7171 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [7235 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [7369 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [7369 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7171 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7235 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7299 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [7370 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [6620 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7105 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7043 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7299 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7370 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:47:46.920946  7403 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 10:47:46.921934  7372 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 10:47:46.922186  7172 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 10:47:46.922184  7236 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240204 10:47:46.922245  7044 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 10:47:46.922248  7108 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240204 10:47:46.923161  7302 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240204 10:47:46.923166  7417 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240204 10:47:46.952299  7302 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x100027a08000 7.629 MB
W20240204 10:47:46.952375  7372 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1000281ab000 7.629 MB
W20240204 10:47:46.952513  7302 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10002894e000 7.629 MB
W20240204 10:47:46.952574  7372 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000290f1000 7.629 MB
W20240204 10:47:46.952605  7302 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x100029894000 1.49 GB
W20240204 10:47:46.952656  7372 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x100088e77000 1.49 GB
W20240204 10:47:46.952665  7302 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1000e845a000 1.49 GB
W20240204 10:47:46.952718  7372 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x100147a3d000 1.49 GB
W20240204 10:47:46.952746  7302 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:47:46.952773  7372 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:47:46.956902  7302 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:47:46.956983  7372 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:47:46.957155  7417 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1001a7026000 7.629 MB
W20240204 10:47:46.957310  7417 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1001a77c9000 7.629 MB
W20240204 10:47:46.957365  7417 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1001a7f6c000 1.49 GB
W20240204 10:47:46.957404  7417 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10020754f000 1.49 GB
W20240204 10:47:46.957445  7417 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:47:46.962374  7417 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:47:46.962524  7172 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100266b3a000 7.629 MB
W20240204 10:47:46.962685  7172 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1002672dd000 7.629 MB
W20240204 10:47:46.962744  7172 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x100267a80000 1.49 GB
W20240204 10:47:46.962788  7172 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1002c7063000 1.49 GB
W20240204 10:47:46.962846  7172 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:47:46.966529  7172 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:47:46.980810  7236 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10032664e000 7.629 MB
W20240204 10:47:46.981036  7236 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x100326df1000 7.629 MB
W20240204 10:47:46.981098  7236 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x100327594000 1.49 GB
W20240204 10:47:46.981151  7236 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x100386b77000 1.49 GB
W20240204 10:47:46.981215  7236 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:47:46.983037  7236 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:47:46.988729  7044 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1003e6160000 7.629 MB
W20240204 10:47:46.988919  7044 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1003e6903000 7.629 MB
W20240204 10:47:46.989001  7044 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1003e70a6000 1.49 GB
W20240204 10:47:46.989063  7044 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100446689000 1.49 GB
W20240204 10:47:46.989148  7044 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:47:46.989259  7403 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1004a5c70000 7.629 MB
W20240204 10:47:46.989390  7403 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1004a6413000 7.629 MB
W20240204 10:47:46.989501  7403 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1004a6bb6000 1.49 GB
W20240204 10:47:46.989547  7108 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100506199000 7.629 MB
W20240204 10:47:46.989564  7403 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10050693c000 1.49 GB
W20240204 10:47:46.989645  7403 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:47:46.989728  7108 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100565f1f000 7.629 MB
W20240204 10:47:46.989826  7108 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1005666c2000 1.49 GB
W20240204 10:47:46.989902  7108 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1005c5ca5000 1.49 GB
W20240204 10:47:46.989967  7108 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:47:46.996944  7403 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:47:46.996978  7108 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:47:46.997004  7044 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [7105 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [7043 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [7171 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [7299 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [7370 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [7235 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [7369 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 7370
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [6620 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 10:47:49.268922  7403 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 10:47:49.269153  7044 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:47:49.270743  7172 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:47:49.270849  7302 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:47:49.270992  7372 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:47:49.271090  7417 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:47:49.271201  7108 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:47:49.271293  7236 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 10:47:49.274148  7403 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 4,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 10:47:49.274297  7403 grad_base.h:184] Init GradProcessingBase done
I20240204 10:47:49.276901  7403 grad_async_v1.h:203] Use main thread to update emb.
W20240204 10:47:49.276947  7403 kg_controller.h:75] after init GradAsyncProcessing
I20240204 10:47:49.276954  7403 kg_controller.h:84] Construct KGCacheController done
E20240204 10:47:50.042171  7372 recstore.cc:66] init folly done
E20240204 10:47:50.042620  7044 recstore.cc:66] init folly done
E20240204 10:47:50.042734  7302 recstore.cc:66] init folly done
E20240204 10:47:50.042770  7108 recstore.cc:66] init folly done
E20240204 10:47:50.042790  7403 recstore.cc:66] init folly done
E20240204 10:47:50.042912  7236 recstore.cc:66] init folly done
E20240204 10:47:50.042982  7417 recstore.cc:66] init folly done
E20240204 10:47:50.042986  7172 recstore.cc:66] init folly done
I20240204 10:47:50.044323  7403 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 10:47:50.873924  7403 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 10:47:50.878545  7372 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:47:50.879530  7236 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:47:50.879586  7044 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:47:50.883965  7302 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:47:50.885690  7172 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:47:50.885794  7417 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:47:50.885838  7108 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 10:47:53.321409  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=0
E20240204 10:47:53.402740  8093 grad_async_v1.h:533] Stalled in ProcessBackward: rank=1, step_no=1, sample_step_cpp_seen_[rank]=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.110 ms                  | 20.751 ms                 |
| Forward                   | 4.895 ms                  | 672.674 ms                |
| Backward                  | 4.242 ms                  | 260.070 ms                |
| Optimize                  | 2.355 ms                  | 6.174 ms                  |
| BarrierTimeBeforeRank0    | 5.093 ms                  | 22.155 ms                 |
| AfterBackward             | 27.095 ms                 | 1.471 s                   |
| BlockToStepN              | 99.075 us                 | 39.019 ms                 |
| OneStep                   | 47.093 ms                 | 2.474 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:47:54.750455  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.011 ms                  | 434.233 ms                |
| ProcessBack:UpdateCache   | 10.822 ms                 | 758.350 ms                |
| ProcessBack:UpsertPq      | 7.686 ms                  | 26.814 ms                 |
| ProcessOneStep            | 27.436 ms                 | 1.470 s                   |
| BlockToStepN              | 191.974 us                | 59.401 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 10:47:55.750020  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240204 10:47:56.770946  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=26, pq.top=26
W20240204 10:47:57.770020  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=32, pq.top=32
W20240204 10:47:58.790407  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.369 ms                  | 20.751 ms                 |
| Forward                   | 4.895 ms                  | 672.674 ms                |
| Backward                  | 4.276 ms                  | 260.070 ms                |
| Optimize                  | 1.681 ms                  | 6.174 ms                  |
| BarrierTimeBeforeRank0    | 5.130 ms                  | 22.155 ms                 |
| AfterBackward             | 28.403 ms                 | 1.471 s                   |
| BlockToStepN              | 99.557 ms                 | 338.943 ms                |
| OneStep                   | 151.837 ms                | 2.474 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:47:59.790007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.998 ms                  | 400.285 ms                |
| ProcessBack:UpdateCache   | 10.703 ms                 | 756.913 ms                |
| ProcessBack:UpsertPq      | 9.637 ms                  | 25.266 ms                 |
| ProcessOneStep            | 28.544 ms                 | 1.470 s                   |
| BlockToStepN              | 101.310 ms                | 338.809 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:00.790006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=50, pq.top=50
W20240204 10:48:01.841223  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240204 10:48:02.841010  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240204 10:48:03.844796  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=66, pq.top=66
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.302 ms                  | 20.666 ms                 |
| Forward                   | 4.805 ms                  | 7.502 ms                  |
| Backward                  | 4.221 ms                  | 12.802 ms                 |
| Optimize                  | 1.678 ms                  | 4.593 ms                  |
| BarrierTimeBeforeRank0    | 5.093 ms                  | 12.888 ms                 |
| AfterBackward             | 28.834 ms                 | 653.612 ms                |
| BlockToStepN              | 110.860 ms                | 179.003 ms                |
| OneStep                   | 163.449 ms                | 730.597 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:04.867133  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.890 ms                  | 400.285 ms                |
| ProcessBack:UpdateCache   | 10.510 ms                 | 756.913 ms                |
| ProcessBack:UpsertPq      | 9.973 ms                  | 25.266 ms                 |
| ProcessOneStep            | 28.856 ms                 | 653.446 ms                |
| BlockToStepN              | 113.448 ms                | 178.937 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:05.904693  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=76, pq.top=76
W20240204 10:48:06.950924  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240204 10:48:07.950023  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240204 10:48:08.950006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.358 ms                  | 20.666 ms                 |
| Forward                   | 4.785 ms                  | 7.502 ms                  |
| Backward                  | 4.249 ms                  | 12.802 ms                 |
| Optimize                  | 1.745 ms                  | 4.593 ms                  |
| BarrierTimeBeforeRank0    | 5.060 ms                  | 18.765 ms                 |
| AfterBackward             | 28.985 ms                 | 653.612 ms                |
| BlockToStepN              | 126.592 ms                | 216.103 ms                |
| OneStep                   | 183.299 ms                | 730.597 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:09.950008  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=94, pq.top=94
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.850 ms                  | 12.607 ms                 |
| ProcessBack:UpdateCache   | 10.310 ms                 | 11.592 ms                 |
| ProcessBack:UpsertPq      | 10.051 ms                 | 18.313 ms                 |
| ProcessOneStep            | 28.937 ms                 | 653.446 ms                |
| BlockToStepN              | 132.937 ms                | 215.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:10.950006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=98, pq.top=98
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 20.573, sample: 0.329, forward: 1.122, backward: 0.956, update: 0.178
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 20.566, sample: 0.314, forward: 1.129, backward: 0.759, update: 0.166
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 20.568, sample: 0.321, forward: 1.089, backward: 1.076, update: 0.164
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 20.574, sample: 0.331, forward: 1.118, backward: 1.164, update: 0.191
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 20.567, sample: 0.310, forward: 1.086, backward: 1.113, update: 0.186
train_sampler.Prefill()
-------Step 0-------
tensor([ 2198,    89,  2986,  3724, 13719, 11663,  1049,   442, 11653, 13501]) tensor([ 1668, 12033,  6614, 12799, 10554,  1080,   585,  4643,   500, 14874])
-------Step 1-------
tensor([ 2198,    89,  2986,  3724, 13719, 11663,  1049,   442, 11653, 13501]) tensor([ 3832,  9168, 13112,  1569,   974,  6635, 14692,  8878,  6118, 13351])
-------Step 2-------
tensor([ 7552, 12625,  5228,  3417, 11630,  7463,  9241,    75,  9667,   975]) tensor([ 3573,  4347,  3857,  8802,  5915,  7873, 14415,  8438, 14373,  8632])
-------Step 3-------
tensor([ 7552, 12625,  5228,  3417, 11630,  7463,  9241,    75,  9667,   975]) tensor([ 9775,  6783,  6536,  9907,  6178,   690,  4798,  1943, 11275,  1964])
-------Step 4-------
tensor([   89, 11813, 13654,  5592,  5740,  2950,    83,  6291,  8517,   976]) tensor([ 590, 1115, 4065, 3149, 3139, 2914,  442, 5771, 5056, 1692])
-------Step 5-------
tensor([   89, 11813, 13654,  5592,  5740,  2950,    83,  6291,  8517,   976]) tensor([14164,  5433,  5296,  1608,  2846,   847,   814,  1231,  7248,  7649])
-------Step 6-------
tensor([ 1532,  9428,    19,    11,  8022,  2671,  8156, 10325, 13113, 14207]) tensor([12625,  2643,  6511,  4598,  8085, 10740,  4503,  8658, 10282, 13526])
-------Step 7-------
tensor([ 1532,  9428,    19,    11,  8022,  2671,  8156, 10325, 13113, 14207]) tensor([11688, 13308,  4531,  6675,  1402,  7686,  6356,  3599,   126, 13311])
-------Step 8-------
tensor([ 3541,  7526,  5608, 11343,    49,    92, 10991, 13062,    25,  1831]) tensor([ 5303,  5049,  4525,  8820,  2724, 12559, 11008,  1440,  9347,  2916])
-------Step 9-------
tensor([ 3541,  7526,  5608, 11343,    49,    92, 10991, 13062,    25,  1831]) tensor([13789,  4009, 11850,  6999, 13605, 14580, 12812,  8878,   675, 11680])
before start barrier
start train
[proc 0] 100 steps, total: 20.578, sample: 0.365, forward: 1.142, backward: 0.764, update: 0.188
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 20.573, sample: 0.334, forward: 1.013, backward: 1.002, update: 0.184
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 20.566, sample: 0.332, forward: 1.119, backward: 1.136, update: 0.186
W20240204 10:48:12.005885  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240204 10:48:13.005007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240204 10:48:14.005007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.371 ms                  | 20.666 ms                 |
| Forward                   | 4.805 ms                  | 7.502 ms                  |
| Backward                  | 4.285 ms                  | 12.802 ms                 |
| Optimize                  | 1.762 ms                  | 4.593 ms                  |
| BarrierTimeBeforeRank0    | 4.779 ms                  | 18.765 ms                 |
| AfterBackward             | 28.968 ms                 | 653.612 ms                |
| BlockToStepN              | 144.257 ms                | 216.103 ms                |
| OneStep                   | 194.908 ms                | 730.597 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:15.005007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.865 ms                  | 12.607 ms                 |
| ProcessBack:UpdateCache   | 10.271 ms                 | 11.592 ms                 |
| ProcessBack:UpsertPq      | 10.051 ms                 | 18.313 ms                 |
| ProcessOneStep            | 28.937 ms                 | 653.446 ms                |
| BlockToStepN              | 145.590 ms                | 215.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:16.005017  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240204 10:48:17.005012  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240204 10:48:18.005007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240204 10:48:19.005007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.390 ms                  | 20.666 ms                 |
| Forward                   | 4.759 ms                  | 7.502 ms                  |
| Backward                  | 4.311 ms                  | 12.802 ms                 |
| Optimize                  | 1.794 ms                  | 5.177 ms                  |
| BarrierTimeBeforeRank0    | 4.527 ms                  | 18.765 ms                 |
| AfterBackward             | 28.968 ms                 | 653.612 ms                |
| BlockToStepN              | 153.417 ms                | 263.185 ms                |
| OneStep                   | 208.436 ms                | 730.597 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:20.045053  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.878 ms                  | 12.607 ms                 |
| ProcessBack:UpdateCache   | 10.218 ms                 | 11.545 ms                 |
| ProcessBack:UpsertPq      | 10.051 ms                 | 17.005 ms                 |
| ProcessOneStep            | 28.954 ms                 | 653.446 ms                |
| BlockToStepN              | 153.569 ms                | 263.084 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:21.045014  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=138, pq.top=138
W20240204 10:48:22.060459  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=142, pq.top=142
W20240204 10:48:23.060005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240204 10:48:24.060007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.390 ms                  | 23.419 ms                 |
| Forward                   | 4.818 ms                  | 7.502 ms                  |
| Backward                  | 4.305 ms                  | 12.802 ms                 |
| Optimize                  | 1.794 ms                  | 5.177 ms                  |
| BarrierTimeBeforeRank0    | 4.587 ms                  | 18.765 ms                 |
| AfterBackward             | 29.043 ms                 | 653.612 ms                |
| BlockToStepN              | 163.961 ms                | 263.185 ms                |
| OneStep                   | 216.743 ms                | 730.597 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.846 ms                  | 12.607 ms                 |
| ProcessBack:UpdateCache   | 10.203 ms                 | 11.592 ms                 |
| ProcessBack:UpsertPq      | 10.102 ms                 | 17.005 ms                 |
| ProcessOneStep            | 29.015 ms                 | 43.108 ms                 |
| BlockToStepN              | 165.598 ms                | 260.531 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:25.061605  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240204 10:48:26.061021  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
W20240204 10:48:27.061007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240204 10:48:28.097565  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=164, pq.top=164
W20240204 10:48:29.097007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.406 ms                  | 20.751 ms                 |
| Forward                   | 4.865 ms                  | 6.800 ms                  |
| Backward                  | 4.276 ms                  | 11.047 ms                 |
| Optimize                  | 1.771 ms                  | 4.593 ms                  |
| BarrierTimeBeforeRank0    | 4.705 ms                  | 22.155 ms                 |
| AfterBackward             | 29.043 ms                 | 43.146 ms                 |
| BlockToStepN              | 172.113 ms                | 263.185 ms                |
| OneStep                   | 222.635 ms                | 394.413 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.821 ms                  | 12.607 ms                 |
| ProcessBack:UpdateCache   | 10.224 ms                 | 11.592 ms                 |
| ProcessBack:UpsertPq      | 10.108 ms                 | 17.005 ms                 |
| ProcessOneStep            | 29.040 ms                 | 43.108 ms                 |
| BlockToStepN              | 172.802 ms                | 267.323 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:30.145056  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240204 10:48:31.145010  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=174, pq.top=174
W20240204 10:48:32.184590  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=178, pq.top=178
W20240204 10:48:33.184005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240204 10:48:34.184007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.394 ms                  | 20.751 ms                 |
| Forward                   | 4.867 ms                  | 7.502 ms                  |
| Backward                  | 4.276 ms                  | 11.047 ms                 |
| Optimize                  | 1.779 ms                  | 4.593 ms                  |
| BarrierTimeBeforeRank0    | 4.795 ms                  | 22.155 ms                 |
| AfterBackward             | 29.101 ms                 | 43.146 ms                 |
| BlockToStepN              | 177.006 ms                | 268.699 ms                |
| OneStep                   | 229.145 ms                | 394.413 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.795 ms                  | 11.341 ms                 |
| ProcessBack:UpdateCache   | 10.218 ms                 | 11.545 ms                 |
| ProcessBack:UpsertPq      | 10.110 ms                 | 16.647 ms                 |
| ProcessOneStep            | 29.073 ms                 | 43.108 ms                 |
| BlockToStepN              | 178.755 ms                | 285.769 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:35.184021  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240204 10:48:36.184011  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240204 10:48:37.206562  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240204 10:48:38.206007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=198
[proc 0] 200 steps, total: 27.493, sample: 0.409, forward: 0.484, backward: 0.591, update: 0.181
[proc 3] 200 steps, total: 27.493, sample: 0.364, forward: 0.436, backward: 0.799, update: 0.181
[proc 7] 200 steps, total: 27.493, sample: 0.344, forward: 0.431, backward: 0.871, update: 0.183
[proc 5] 200 steps, total: 27.493, sample: 0.347, forward: 0.450, backward: 0.747, update: 0.172
[proc 4] 200 steps, total: 27.493, sample: 0.420, forward: 0.469, backward: 0.760, update: 0.191
[proc 6] 200 steps, total: 27.493, sample: 0.351, forward: 0.438, backward: 0.851, update: 0.176
[proc 1] 200 steps, total: 27.493, sample: 0.328, forward: 0.427, backward: 0.720, update: 0.180
[proc 2] 200 steps, total: 27.493, sample: 0.333, forward: 0.433, backward: 0.659, update: 0.173
W20240204 10:48:39.240200  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=202, pq.top=202
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.390 ms                  | 20.751 ms                 |
| Forward                   | 4.882 ms                  | 7.502 ms                  |
| Backward                  | 4.276 ms                  | 11.047 ms                 |
| Optimize                  | 1.779 ms                  | 4.593 ms                  |
| BarrierTimeBeforeRank0    | 4.861 ms                  | 22.911 ms                 |
| AfterBackward             | 29.071 ms                 | 43.146 ms                 |
| BlockToStepN              | 184.842 ms                | 290.375 ms                |
| OneStep                   | 238.808 ms                | 394.413 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.772 ms                  | 11.341 ms                 |
| ProcessBack:UpdateCache   | 10.195 ms                 | 12.345 ms                 |
| ProcessBack:UpsertPq      | 10.112 ms                 | 16.647 ms                 |
| ProcessOneStep            | 29.015 ms                 | 43.108 ms                 |
| BlockToStepN              | 186.398 ms                | 290.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:40.240015  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240204 10:48:41.240010  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=208, pq.top=208
W20240204 10:48:42.240005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240204 10:48:43.240006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240204 10:48:44.240006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.402 ms                  | 23.419 ms                 |
| Forward                   | 4.867 ms                  | 7.502 ms                  |
| Backward                  | 4.267 ms                  | 11.047 ms                 |
| Optimize                  | 1.789 ms                  | 4.593 ms                  |
| BarrierTimeBeforeRank0    | 4.979 ms                  | 22.911 ms                 |
| AfterBackward             | 28.968 ms                 | 43.146 ms                 |
| BlockToStepN              | 191.456 ms                | 292.355 ms                |
| OneStep                   | 243.158 ms                | 394.413 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.745 ms                  | 11.341 ms                 |
| ProcessBack:UpdateCache   | 10.165 ms                 | 12.345 ms                 |
| ProcessBack:UpsertPq      | 10.110 ms                 | 16.647 ms                 |
| ProcessOneStep            | 28.937 ms                 | 43.108 ms                 |
| BlockToStepN              | 191.539 ms                | 292.270 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:45.243767  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240204 10:48:46.243014  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240204 10:48:47.243010  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240204 10:48:48.257519  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.414 ms                  | 23.419 ms                 |
| Forward                   | 4.859 ms                  | 7.502 ms                  |
| Backward                  | 4.263 ms                  | 11.047 ms                 |
| Optimize                  | 1.779 ms                  | 4.593 ms                  |
| BarrierTimeBeforeRank0    | 5.080 ms                  | 26.591 ms                 |
| AfterBackward             | 28.885 ms                 | 43.146 ms                 |
| BlockToStepN              | 195.038 ms                | 329.651 ms                |
| OneStep                   | 248.786 ms                | 394.893 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:49.312371  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.728 ms                  | 11.283 ms                 |
| ProcessBack:UpdateCache   | 10.158 ms                 | 11.655 ms                 |
| ProcessBack:UpsertPq      | 10.109 ms                 | 15.488 ms                 |
| ProcessOneStep            | 28.856 ms                 | 43.108 ms                 |
| BlockToStepN              | 195.133 ms                | 329.488 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:50.368211  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240204 10:48:51.368014  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
W20240204 10:48:52.368005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240204 10:48:53.368008  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.419 ms                  | 23.419 ms                 |
| Forward                   | 4.854 ms                  | 7.502 ms                  |
| Backward                  | 4.249 ms                  | 11.047 ms                 |
| Optimize                  | 1.776 ms                  | 4.593 ms                  |
| BarrierTimeBeforeRank0    | 5.093 ms                  | 26.591 ms                 |
| AfterBackward             | 28.968 ms                 | 43.146 ms                 |
| BlockToStepN              | 198.063 ms                | 331.255 ms                |
| OneStep                   | 251.171 ms                | 419.532 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:54.368005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.714 ms                  | 11.283 ms                 |
| ProcessBack:UpdateCache   | 10.158 ms                 | 12.895 ms                 |
| ProcessBack:UpsertPq      | 10.128 ms                 | 15.488 ms                 |
| ProcessOneStep            | 28.954 ms                 | 41.123 ms                 |
| BlockToStepN              | 197.992 ms                | 334.848 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:55.419236  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240204 10:48:56.419008  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240204 10:48:57.419018  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240204 10:48:58.419010  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.431 ms                  | 21.134 ms                 |
| Forward                   | 4.838 ms                  | 6.800 ms                  |
| Backward                  | 4.245 ms                  | 10.827 ms                 |
| Optimize                  | 1.776 ms                  | 3.249 ms                  |
| BarrierTimeBeforeRank0    | 5.123 ms                  | 26.591 ms                 |
| AfterBackward             | 28.923 ms                 | 41.174 ms                 |
| BlockToStepN              | 204.285 ms                | 334.919 ms                |
| OneStep                   | 254.580 ms                | 419.532 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:48:59.419006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=264, pq.top=264
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.709 ms                  | 11.283 ms                 |
| ProcessBack:UpdateCache   | 10.158 ms                 | 12.895 ms                 |
| ProcessBack:UpsertPq      | 10.129 ms                 | 16.647 ms                 |
| ProcessOneStep            | 28.937 ms                 | 41.123 ms                 |
| BlockToStepN              | 204.453 ms                | 334.848 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:00.419005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240204 10:49:01.419005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240204 10:49:02.419008  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240204 10:49:03.419015  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.445 ms                  | 23.419 ms                 |
| Forward                   | 4.818 ms                  | 6.800 ms                  |
| Backward                  | 4.262 ms                  | 10.827 ms                 |
| Optimize                  | 1.775 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.130 ms                  | 26.591 ms                 |
| AfterBackward             | 28.968 ms                 | 41.174 ms                 |
| BlockToStepN              | 206.906 ms                | 334.919 ms                |
| OneStep                   | 257.536 ms                | 419.532 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:04.419004  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=280, pq.top=280
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.726 ms                  | 10.797 ms                 |
| ProcessBack:UpdateCache   | 10.145 ms                 | 12.345 ms                 |
| ProcessBack:UpsertPq      | 10.128 ms                 | 16.647 ms                 |
| ProcessOneStep            | 28.937 ms                 | 41.123 ms                 |
| BlockToStepN              | 207.378 ms                | 334.848 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:05.419005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240204 10:49:06.419006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240204 10:49:07.419011  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240204 10:49:08.419015  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=292, pq.top=292
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.448 ms                  | 23.419 ms                 |
| Forward                   | 4.803 ms                  | 6.800 ms                  |
| Backward                  | 4.278 ms                  | 12.802 ms                 |
| Optimize                  | 1.779 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.222 ms                  | 26.591 ms                 |
| AfterBackward             | 28.968 ms                 | 41.174 ms                 |
| BlockToStepN              | 208.581 ms                | 334.919 ms                |
| OneStep                   | 260.241 ms                | 419.532 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:09.461241  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=296, pq.top=296
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.735 ms                  | 10.797 ms                 |
| ProcessBack:UpdateCache   | 10.137 ms                 | 12.345 ms                 |
| ProcessBack:UpsertPq      | 10.177 ms                 | 16.923 ms                 |
| ProcessOneStep            | 28.951 ms                 | 41.123 ms                 |
| BlockToStepN              | 208.864 ms                | 334.848 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:10.461005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 7] 300 steps, total: 32.064, sample: 0.333, forward: 0.427, backward: 0.890, update: 0.182
[proc 6] 300 steps, total: 32.064, sample: 0.314, forward: 0.432, backward: 0.888, update: 0.173
[proc 3] 300 steps, total: 32.064, sample: 0.329, forward: 0.441, backward: 0.754, update: 0.173
[proc 0] 300 steps, total: 32.064, sample: 0.388, forward: 0.453, backward: 0.607, update: 0.178
[proc 5] 300 steps, total: 32.064, sample: 0.313, forward: 0.437, backward: 0.740, update: 0.169
[proc 1] 300 steps, total: 32.064, sample: 0.330, forward: 0.430, backward: 0.848, update: 0.180
[proc 2] 300 steps, total: 32.064, sample: 0.320, forward: 0.436, backward: 0.599, update: 0.177
[proc 4] 300 steps, total: 32.064, sample: 0.334, forward: 0.451, backward: 0.666, update: 0.183
W20240204 10:49:11.461007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
W20240204 10:49:12.461022  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240204 10:49:13.461015  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=308, pq.top=308
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.456 ms                  | 23.419 ms                 |
| Forward                   | 4.785 ms                  | 6.800 ms                  |
| Backward                  | 4.296 ms                  | 12.802 ms                 |
| Optimize                  | 1.786 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.308 ms                  | 26.591 ms                 |
| AfterBackward             | 29.007 ms                 | 41.174 ms                 |
| BlockToStepN              | 213.534 ms                | 334.919 ms                |
| OneStep                   | 266.030 ms                | 419.532 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:14.461006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.742 ms                  | 10.797 ms                 |
| ProcessBack:UpdateCache   | 10.134 ms                 | 13.182 ms                 |
| ProcessBack:UpsertPq      | 10.205 ms                 | 18.313 ms                 |
| ProcessOneStep            | 28.993 ms                 | 41.123 ms                 |
| BlockToStepN              | 213.990 ms                | 338.809 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:15.461007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240204 10:49:16.461005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240204 10:49:17.462164  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240204 10:49:18.462007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=322, pq.top=322
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.461 ms                  | 23.419 ms                 |
| Forward                   | 4.785 ms                  | 6.800 ms                  |
| Backward                  | 4.311 ms                  | 13.442 ms                 |
| Optimize                  | 1.794 ms                  | 3.356 ms                  |
| BarrierTimeBeforeRank0    | 5.435 ms                  | 26.591 ms                 |
| AfterBackward             | 29.071 ms                 | 41.174 ms                 |
| BlockToStepN              | 215.457 ms                | 361.767 ms                |
| OneStep                   | 271.725 ms                | 439.689 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:19.462011  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.756 ms                  | 10.797 ms                 |
| ProcessBack:UpdateCache   | 10.133 ms                 | 12.960 ms                 |
| ProcessBack:UpsertPq      | 10.212 ms                 | 18.949 ms                 |
| ProcessOneStep            | 29.015 ms                 | 41.123 ms                 |
| BlockToStepN              | 215.913 ms                | 365.186 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:20.462011  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=328, pq.top=328
W20240204 10:49:21.462007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240204 10:49:22.462005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240204 10:49:23.462007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.464 ms                  | 23.419 ms                 |
| Forward                   | 4.785 ms                  | 6.800 ms                  |
| Backward                  | 4.296 ms                  | 13.442 ms                 |
| Optimize                  | 1.789 ms                  | 3.356 ms                  |
| BarrierTimeBeforeRank0    | 5.449 ms                  | 26.591 ms                 |
| AfterBackward             | 29.109 ms                 | 43.005 ms                 |
| BlockToStepN              | 219.498 ms                | 366.498 ms                |
| OneStep                   | 276.627 ms                | 458.254 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:24.462013  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=338, pq.top=338
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.745 ms                  | 10.797 ms                 |
| ProcessBack:UpdateCache   | 10.136 ms                 | 13.182 ms                 |
| ProcessBack:UpsertPq      | 10.212 ms                 | 19.630 ms                 |
| ProcessOneStep            | 29.073 ms                 | 42.953 ms                 |
| BlockToStepN              | 219.440 ms                | 366.386 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:25.462011  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=340, pq.top=340
W20240204 10:49:26.462006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240204 10:49:27.462007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=346, pq.top=346
W20240204 10:49:28.462006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=348, pq.top=348
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.471 ms                  | 23.419 ms                 |
| Forward                   | 4.786 ms                  | 6.800 ms                  |
| Backward                  | 4.306 ms                  | 13.442 ms                 |
| Optimize                  | 1.789 ms                  | 3.356 ms                  |
| BarrierTimeBeforeRank0    | 5.435 ms                  | 26.591 ms                 |
| AfterBackward             | 29.101 ms                 | 43.005 ms                 |
| BlockToStepN              | 222.744 ms                | 391.592 ms                |
| OneStep                   | 282.136 ms                | 504.134 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:29.462005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=351, pq.top=351
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.758 ms                  | 10.797 ms                 |
| ProcessBack:UpdateCache   | 10.126 ms                 | 13.182 ms                 |
| ProcessBack:UpsertPq      | 10.238 ms                 | 19.630 ms                 |
| ProcessOneStep            | 29.073 ms                 | 41.123 ms                 |
| BlockToStepN              | 223.746 ms                | 366.386 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:30.463878  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=354, pq.top=354
W20240204 10:49:31.463017  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=356, pq.top=356
W20240204 10:49:32.481431  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240204 10:49:33.481007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=362, pq.top=362
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.477 ms                  | 22.834 ms                 |
| Forward                   | 4.786 ms                  | 6.764 ms                  |
| Backward                  | 4.340 ms                  | 12.802 ms                 |
| Optimize                  | 1.789 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.442 ms                  | 26.213 ms                 |
| AfterBackward             | 29.139 ms                 | 42.755 ms                 |
| BlockToStepN              | 226.924 ms                | 391.592 ms                |
| OneStep                   | 286.232 ms                | 460.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:34.483676  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.771 ms                  | 10.797 ms                 |
| ProcessBack:UpdateCache   | 10.136 ms                 | 13.182 ms                 |
| ProcessBack:UpsertPq      | 10.250 ms                 | 20.012 ms                 |
| ProcessOneStep            | 29.097 ms                 | 42.709 ms                 |
| BlockToStepN              | 227.257 ms                | 391.515 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:35.483007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240204 10:49:36.483006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=370, pq.top=370
W20240204 10:49:37.483011  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=373, pq.top=373
W20240204 10:49:38.483016  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=376, pq.top=376
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.481 ms                  | 22.834 ms                 |
| Forward                   | 4.787 ms                  | 6.764 ms                  |
| Backward                  | 4.354 ms                  | 12.802 ms                 |
| Optimize                  | 1.794 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.449 ms                  | 26.726 ms                 |
| AfterBackward             | 29.174 ms                 | 42.755 ms                 |
| BlockToStepN              | 229.005 ms                | 391.592 ms                |
| OneStep                   | 291.100 ms                | 460.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:39.533282  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=379, pq.top=379
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.778 ms                  | 10.730 ms                 |
| ProcessBack:UpdateCache   | 10.136 ms                 | 12.960 ms                 |
| ProcessBack:UpsertPq      | 10.281 ms                 | 19.711 ms                 |
| ProcessOneStep            | 29.137 ms                 | 42.709 ms                 |
| BlockToStepN              | 229.176 ms                | 391.515 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:40.550740  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240204 10:49:41.550009  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240204 10:49:42.550056  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=387, pq.top=387
W20240204 10:49:43.550014  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=390, pq.top=390
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.490 ms                  | 22.834 ms                 |
| Forward                   | 4.787 ms                  | 6.764 ms                  |
| Backward                  | 4.376 ms                  | 12.802 ms                 |
| Optimize                  | 1.792 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.453 ms                  | 26.726 ms                 |
| AfterBackward             | 29.196 ms                 | 42.755 ms                 |
| BlockToStepN              | 233.101 ms                | 391.592 ms                |
| OneStep                   | 294.486 ms                | 460.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:44.550006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.801 ms                  | 10.903 ms                 |
| ProcessBack:UpdateCache   | 10.130 ms                 | 12.960 ms                 |
| ProcessBack:UpsertPq      | 10.278 ms                 | 19.711 ms                 |
| ProcessOneStep            | 29.162 ms                 | 42.709 ms                 |
| BlockToStepN              | 233.290 ms                | 391.515 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:45.550007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=396, pq.top=396
W20240204 10:49:46.550005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 6] 400 steps, total: 36.113, sample: 0.359, forward: 0.440, backward: 0.852, update: 0.177
[proc 1] 400 steps, total: 36.113, sample: 0.357, forward: 0.438, backward: 0.858, update: 0.190
[proc 0] 400 steps, total: 36.113, sample: 0.377, forward: 0.459, backward: 0.701, update: 0.182
[proc 7] 400 steps, total: 36.113, sample: 0.312, forward: 0.432, backward: 0.899, update: 0.183
[proc 3] 400 steps, total: 36.113, sample: 0.309, forward: 0.432, backward: 0.621, update: 0.165
[proc 4] 400 steps, total: 36.113, sample: 0.370, forward: 0.442, backward: 0.783, update: 0.186
[proc 2] 400 steps, total: 36.113, sample: 0.329, forward: 0.431, backward: 0.770, update: 0.175
[proc 5] 400 steps, total: 36.114, sample: 0.328, forward: 0.433, backward: 0.778, update: 0.172
W20240204 10:49:47.550006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=402, pq.top=402
W20240204 10:49:48.550006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=405, pq.top=405
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.493 ms                  | 22.834 ms                 |
| Forward                   | 4.769 ms                  | 6.764 ms                  |
| Backward                  | 4.419 ms                  | 12.802 ms                 |
| Optimize                  | 1.786 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.486 ms                  | 27.005 ms                 |
| AfterBackward             | 29.232 ms                 | 42.755 ms                 |
| BlockToStepN              | 236.397 ms                | 391.592 ms                |
| OneStep                   | 297.593 ms                | 460.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:49.550009  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=408, pq.top=408
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.795 ms                  | 10.903 ms                 |
| ProcessBack:UpdateCache   | 10.126 ms                 | 12.960 ms                 |
| ProcessBack:UpsertPq      | 10.296 ms                 | 20.389 ms                 |
| ProcessOneStep            | 29.206 ms                 | 42.953 ms                 |
| BlockToStepN              | 236.820 ms                | 391.515 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:50.583386  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240204 10:49:51.627187  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240204 10:49:52.627007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=416, pq.top=416
W20240204 10:49:53.689114  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.509 ms                  | 22.834 ms                 |
| Forward                   | 4.768 ms                  | 6.764 ms                  |
| Backward                  | 4.464 ms                  | 13.442 ms                 |
| Optimize                  | 1.789 ms                  | 3.356 ms                  |
| BarrierTimeBeforeRank0    | 5.467 ms                  | 27.005 ms                 |
| AfterBackward             | 29.293 ms                 | 43.005 ms                 |
| BlockToStepN              | 239.677 ms                | 391.723 ms                |
| OneStep                   | 299.465 ms                | 460.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:54.689007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=422, pq.top=422
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.811 ms                  | 10.903 ms                 |
| ProcessBack:UpdateCache   | 10.124 ms                 | 12.960 ms                 |
| ProcessBack:UpsertPq      | 10.308 ms                 | 20.918 ms                 |
| ProcessOneStep            | 29.259 ms                 | 42.953 ms                 |
| BlockToStepN              | 240.160 ms                | 391.639 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:55.689009  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=424, pq.top=424
W20240204 10:49:56.689018  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240204 10:49:57.689007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=430, pq.top=430
W20240204 10:49:58.715345  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=433, pq.top=433
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.509 ms                  | 23.419 ms                 |
| Forward                   | 4.760 ms                  | 6.764 ms                  |
| Backward                  | 4.477 ms                  | 13.442 ms                 |
| Optimize                  | 1.790 ms                  | 3.356 ms                  |
| BarrierTimeBeforeRank0    | 5.442 ms                  | 27.005 ms                 |
| AfterBackward             | 29.319 ms                 | 43.005 ms                 |
| BlockToStepN              | 243.047 ms                | 391.723 ms                |
| OneStep                   | 302.834 ms                | 460.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:49:59.715009  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=435, pq.top=435
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.812 ms                  | 10.903 ms                 |
| ProcessBack:UpdateCache   | 10.120 ms                 | 12.895 ms                 |
| ProcessBack:UpsertPq      | 10.329 ms                 | 20.918 ms                 |
| ProcessOneStep            | 29.280 ms                 | 42.953 ms                 |
| BlockToStepN              | 243.727 ms                | 394.501 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:50:00.758083  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240204 10:50:01.758018  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=440, pq.top=440
W20240204 10:50:02.758013  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=442, pq.top=442
W20240204 10:50:03.758008  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=445, pq.top=445
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.514 ms                  | 23.419 ms                 |
| Forward                   | 4.760 ms                  | 6.764 ms                  |
| Backward                  | 4.488 ms                  | 13.442 ms                 |
| Optimize                  | 1.792 ms                  | 3.356 ms                  |
| BarrierTimeBeforeRank0    | 5.435 ms                  | 27.360 ms                 |
| AfterBackward             | 29.302 ms                 | 43.146 ms                 |
| BlockToStepN              | 245.664 ms                | 401.609 ms                |
| OneStep                   | 304.672 ms                | 478.906 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:50:04.758008  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=447, pq.top=447
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.813 ms                  | 10.903 ms                 |
| ProcessBack:UpdateCache   | 10.113 ms                 | 12.895 ms                 |
| ProcessBack:UpsertPq      | 10.330 ms                 | 21.386 ms                 |
| ProcessOneStep            | 29.273 ms                 | 43.108 ms                 |
| BlockToStepN              | 245.680 ms                | 401.536 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:50:05.758008  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=450, pq.top=450
W20240204 10:50:06.758011  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=453, pq.top=453
W20240204 10:50:07.758018  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240204 10:50:08.758008  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=458, pq.top=458
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.514 ms                  | 23.263 ms                 |
| Forward                   | 4.767 ms                  | 6.397 ms                  |
| Backward                  | 4.477 ms                  | 12.802 ms                 |
| Optimize                  | 1.790 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.435 ms                  | 27.186 ms                 |
| AfterBackward             | 29.319 ms                 | 43.005 ms                 |
| BlockToStepN              | 247.560 ms                | 394.610 ms                |
| OneStep                   | 307.249 ms                | 460.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:50:09.758008  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=461, pq.top=461
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.810 ms                  | 10.903 ms                 |
| ProcessBack:UpdateCache   | 10.124 ms                 | 12.895 ms                 |
| ProcessBack:UpsertPq      | 10.345 ms                 | 22.562 ms                 |
| ProcessOneStep            | 29.280 ms                 | 42.953 ms                 |
| BlockToStepN              | 248.048 ms                | 394.501 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:50:10.758008  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=463, pq.top=463
W20240204 10:50:11.758015  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=466, pq.top=466
W20240204 10:50:12.758016  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240204 10:50:13.808748  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=472, pq.top=472
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.514 ms                  | 23.263 ms                 |
| Forward                   | 4.765 ms                  | 6.397 ms                  |
| Backward                  | 4.443 ms                  | 12.802 ms                 |
| Optimize                  | 1.779 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.435 ms                  | 27.186 ms                 |
| AfterBackward             | 29.319 ms                 | 43.005 ms                 |
| BlockToStepN              | 251.059 ms                | 394.610 ms                |
| OneStep                   | 309.751 ms                | 460.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:50:14.808004  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=475, pq.top=475
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.795 ms                  | 10.903 ms                 |
| ProcessBack:UpdateCache   | 10.133 ms                 | 12.895 ms                 |
| ProcessBack:UpsertPq      | 10.354 ms                 | 22.562 ms                 |
| ProcessOneStep            | 29.280 ms                 | 42.953 ms                 |
| BlockToStepN              | 251.471 ms                | 394.501 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:50:15.808007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=478, pq.top=478
W20240204 10:50:16.808007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240204 10:50:17.808012  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240204 10:50:18.843640  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=486, pq.top=486
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.515 ms                  | 23.263 ms                 |
| Forward                   | 4.765 ms                  | 6.397 ms                  |
| Backward                  | 4.419 ms                  | 12.802 ms                 |
| Optimize                  | 1.773 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.453 ms                  | 27.186 ms                 |
| AfterBackward             | 29.324 ms                 | 43.005 ms                 |
| BlockToStepN              | 253.837 ms                | 400.415 ms                |
| OneStep                   | 309.998 ms                | 462.639 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:50:19.866762  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=489, pq.top=489
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.791 ms                  | 10.797 ms                 |
| ProcessBack:UpdateCache   | 10.135 ms                 | 12.345 ms                 |
| ProcessBack:UpsertPq      | 10.359 ms                 | 22.562 ms                 |
| ProcessOneStep            | 29.283 ms                 | 43.108 ms                 |
| BlockToStepN              | 254.290 ms                | 400.310 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:50:20.866005  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=492, pq.top=492
W20240204 10:50:21.866007  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240204 10:50:22.866006  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=497, pq.top=497
W20240204 10:50:23.866021  7403 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=500, pq.top=500
[proc 3] 500 steps, total: 36.990, sample: 0.316, forward: 0.426, backward: 0.415, update: 0.157
[proc 5] 500 steps, total: 36.990, sample: 0.300, forward: 0.440, backward: 0.678, update: 0.161
[proc 7] 500 steps, total: 36.990, sample: 0.338, forward: 0.428, backward: 0.900, update: 0.180
[proc 1] 500 steps, total: 36.990, sample: 0.320, forward: 0.427, backward: 0.865, update: 0.177
[proc 2] 500 steps, total: 36.990, sample: 0.339, forward: 0.430, backward: 0.617, update: 0.168
[proc 6] 500 steps, total: 36.990, sample: 0.315, forward: 0.444, backward: 0.906, update: 0.176
[proc 0] 500 steps, total: 36.990, sample: 0.396, forward: 0.457, backward: 0.603, update: 0.180
[proc 4] 500 steps, total: 36.990, sample: 0.370, forward: 0.488, backward: 0.546, update: 0.181
Successfully xmh. training takes 153.2387797832489 seconds
before call kg_cache_controller.StopThreads()
W20240204 10:50:24.112761  7403 grad_async_v1.h:243] call StopThreads. PID = 6620
W20240204 10:50:24.112794  7403 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 10:50:24.119248  7403 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 10:50:24.119269  7403 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 10:50:24.147354  7403 grad_async_v1.h:264] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.517 ms                  | 23.263 ms                 |
| Forward                   | 4.760 ms                  | 6.397 ms                  |
| Backward                  | 4.417 ms                  | 12.802 ms                 |
| Optimize                  | 1.773 ms                  | 3.307 ms                  |
| BarrierTimeBeforeRank0    | 5.449 ms                  | 27.186 ms                 |
| AfterBackward             | 29.353 ms                 | 45.614 ms                 |
| BlockToStepN              | 255.647 ms                | 400.415 ms                |
| OneStep                   | 311.548 ms                | 462.639 ms                |
+---------------------------+---------------------------+---------------------------+
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7fac66f5e0d0>
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.787 ms                  | 10.797 ms                 |
| ProcessBack:UpdateCache   | 10.133 ms                 | 12.345 ms                 |
| ProcessBack:UpsertPq      | 10.364 ms                 | 22.993 ms                 |
| ProcessOneStep            | 29.321 ms                 | 45.533 ms                 |
| BlockToStepN              | 255.593 ms                | 400.310 ms                |
+---------------------------+---------------------------+---------------------------+
