WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 11:03:35.223727 42631 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_133', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=24, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [42631 sampler.py:454] Start PreSampling
WARNING [42631 sampler.py:532] Before construct renumbering_dict
WARNING [42631 sampler.py:555] PreSampling done
W20240204 11:03:40.931046 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 11:03:40.931367 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 11:03:40.931440 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 11:03:40.931504 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 11:03:40.931563 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 11:03:40.931613 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 11:03:40.931660 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 11:03:40.931712 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 11:03:40.931766 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 11:03:40.931810 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 11:03:40.931864 42631 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 11:03:40.931900 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 11:03:40.931936 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 11:03:40.932112 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 11:03:40.932169 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 11:03:40.932206 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 11:03:40.932269 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 11:03:40.932309 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 11:03:40.932350 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 11:03:40.932396 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 11:03:40.932446 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 11:03:40.932503 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 11:03:40.932554 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 11:03:40.932591 42631 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 11:03:40.932624 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 11:03:40.932658 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 11:03:40.932734 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 11:03:40.932773 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 11:03:40.932809 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 11:03:40.932854 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 11:03:40.932894 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 11:03:40.932960 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 11:03:40.933009 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 11:03:40.933056 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 11:03:40.933111 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 11:03:40.933156 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 11:03:40.933197 42631 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 11:03:40.933228 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 11:03:40.933261 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 11:03:40.933347 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 11:03:40.933398 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 11:03:40.933436 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 11:03:40.933476 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 11:03:40.933522 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 11:03:40.933562 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 11:03:40.933600 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 11:03:40.933655 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 11:03:40.933704 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 11:03:40.933745 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 11:03:40.933781 42631 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 11:03:40.933815 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 11:03:40.933845 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 11:03:40.933933 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 11:03:40.933972 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 11:03:40.934010 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 11:03:40.934049 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 11:03:40.934087 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 11:03:40.934130 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 11:03:40.934175 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 11:03:40.934219 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 11:03:40.934260 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 11:03:40.934317 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 11:03:40.934363 42631 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 11:03:40.934397 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 11:03:40.934437 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 11:03:40.934510 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 11:03:40.934567 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 11:03:40.934640 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 11:03:40.934680 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 11:03:40.934721 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 11:03:40.934762 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 11:03:40.934814 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 11:03:40.934860 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 11:03:40.934902 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 11:03:40.934948 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 11:03:40.934985 42631 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 11:03:40.935016 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 11:03:40.935058 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 11:03:40.935128 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 11:03:40.935175 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 11:03:40.935212 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 11:03:40.935249 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 11:03:40.935312 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 11:03:40.935367 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 11:03:40.935408 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 11:03:40.935462 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 11:03:40.935511 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 11:03:40.935550 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 11:03:40.935609 42631 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 11:03:40.935642 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 11:03:40.935674 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 11:03:40.935753 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 11:03:40.935798 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 11:03:40.935837 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 11:03:40.935874 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 11:03:40.935911 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 11:03:40.935956 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 11:03:40.935998 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 11:03:40.936043 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 11:03:40.936105 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 11:03:40.936142 42631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 11:03:40.936192 42631 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 11:03:40.936225 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 11:03:40.936256 42631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 11:03:41.194314 42631 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240204 11:03:41.286836 42631 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 747, 1151, 1680,  ..., 9021, 9289, 7205]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 6.163 seconds
[Rank1] pid = 43055
[Rank2] pid = 43087
[Rank3] pid = 43183
[Rank4] pid = 43226
[Rank5] pid = 43248
[Rank6] pid = 43313
INFO [42631 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [43055 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [43226 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [43087 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [43183 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [43248 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [43377 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [43313 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [43313 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43248 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43377 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43183 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43055 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43226 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42631 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43087 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 11:03:43.899127 43376 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 11:03:43.899252 43390 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240204 11:03:43.899302 43184 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 11:03:43.900224 43378 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 11:03:43.900264 43056 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 11:03:43.900264 43312 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240204 11:03:43.900918 43249 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240204 11:03:43.901846 43120 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240204 11:03:43.925859 43390 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100027a08000 7.629 MB
W20240204 11:03:43.925864 43376 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1000281ab000 7.629 MB
W20240204 11:03:43.926075 43376 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10002894e000 7.629 MB
W20240204 11:03:43.926095 43390 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000290f1000 7.629 MB
W20240204 11:03:43.926159 43376 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x100029894000 1.49 GB
W20240204 11:03:43.926175 43390 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x100088e77000 1.49 GB
W20240204 11:03:43.926223 43376 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1000e845a000 1.49 GB
W20240204 11:03:43.926229 43390 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x100147a3d000 1.49 GB
W20240204 11:03:43.926280 43390 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 11:03:43.926280 43376 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 11:03:43.930124 43376 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 11:03:43.930218 43390 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 11:03:43.930465 43249 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1001a7026000 7.629 MB
W20240204 11:03:43.930687 43249 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1001a77c9000 7.629 MB
W20240204 11:03:43.930774 43249 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1001a7f6c000 1.49 GB
W20240204 11:03:43.930841 43249 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10020754f000 1.49 GB
W20240204 11:03:43.930893 43249 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 11:03:43.932046 43184 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100266b34000 7.629 MB
W20240204 11:03:43.932305 43184 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1002672d7000 7.629 MB
W20240204 11:03:43.932394 43184 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x100267a7a000 1.49 GB
W20240204 11:03:43.932467 43184 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1002c705d000 1.49 GB
W20240204 11:03:43.932519 43184 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 11:03:43.933491 43378 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100326642000 7.629 MB
W20240204 11:03:43.933662 43378 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100326de5000 7.629 MB
W20240204 11:03:43.933727 43378 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x100327588000 1.49 GB
W20240204 11:03:43.933786 43378 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x100386b6b000 1.49 GB
W20240204 11:03:43.933840 43378 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 11:03:43.938501 43120 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1003e6154000 7.629 MB
W20240204 11:03:43.938521 43378 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 11:03:43.938656 43120 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1003e68f7000 7.629 MB
W20240204 11:03:43.938737 43120 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1003e709a000 1.49 GB
W20240204 11:03:43.938787 43120 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10044667d000 1.49 GB
W20240204 11:03:43.938831 43120 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 11:03:43.940410 43312 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1004a5c62000 7.629 MB
W20240204 11:03:43.940590 43312 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1004a6405000 7.629 MB
W20240204 11:03:43.940665 43312 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1004a6ba8000 1.49 GB
W20240204 11:03:43.940728 43312 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10050618b000 1.49 GB
W20240204 11:03:43.940778 43312 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 11:03:43.942083 43056 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100565770000 7.629 MB
W20240204 11:03:43.942229 43056 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100565f13000 7.629 MB
W20240204 11:03:43.942306 43056 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1005666b6000 1.49 GB
W20240204 11:03:43.942369 43056 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1005c5c99000 1.49 GB
W20240204 11:03:43.942435 43056 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 11:03:43.946686 43120 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 11:03:43.946723 43249 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 11:03:43.946781 43056 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 11:03:43.946775 43312 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 11:03:43.953965 43184 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [43183 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [43055 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [43226 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [43087 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 43377
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [42631 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [43313 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [43377 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [43248 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 11:03:46.450641 43312 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 11:03:46.450922 43184 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 11:03:46.451081 43249 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 11:03:46.451205 43378 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 11:03:46.451387 43120 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 11:03:46.451584 43390 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 11:03:46.451738 43376 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 11:03:46.451870 43056 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 11:03:46.455670 43378 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 24,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 11:03:46.455989 43378 grad_base.h:184] Init GradProcessingBase done
I20240204 11:03:46.466140 43378 grad_async_v1.h:203] Use main thread to update emb.
W20240204 11:03:46.466308 43378 kg_controller.h:75] after init GradAsyncProcessing
I20240204 11:03:46.466326 43378 kg_controller.h:84] Construct KGCacheController done
E20240204 11:03:48.261322 43376 recstore.cc:66] init folly done
E20240204 11:03:48.261929 43390 recstore.cc:66] init folly done
E20240204 11:03:48.261992 43249 recstore.cc:66] init folly done
E20240204 11:03:48.261958 43184 recstore.cc:66] init folly done
E20240204 11:03:48.262145 43120 recstore.cc:66] init folly done
E20240204 11:03:48.262207 43056 recstore.cc:66] init folly done
E20240204 11:03:48.262331 43312 recstore.cc:66] init folly done
E20240204 11:03:48.262415 43378 recstore.cc:66] init folly done
I20240204 11:03:48.263484 43378 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 11:03:49.053380 43056 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 11:03:49.054423 43120 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 11:03:49.057978 43378 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 11:03:49.067530 43184 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 11:03:49.067763 43376 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 11:03:49.069464 43249 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 11:03:49.069525 43312 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 11:03:49.069665 43390 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 11:03:51.324000 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.145 ms                  | 3.960 ms                  |
| Forward                   | 12.446 ms                 | 635.804 ms                |
| Backward                  | 10.690 ms                 | 193.985 ms                |
| Optimize                  | 2.668 ms                  | 4.048 ms                  |
| BarrierTimeBeforeRank0    | 9.830 ms                  | 18.146 ms                 |
| AfterBackward             | 26.684 ms                 | 1.400 s                   |
| BlockToStepN              | 5.314 ms                  | 30.874 ms                 |
| OneStep                   | 65.832 ms                 | 2.287 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 11:03:52.171990 43990 grad_async_v1.h:533] Stalled in ProcessBackward: rank=7, step_no=14, sample_step_cpp_seen_[rank]=13
W20240204 11:03:52.657778 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.928 ms                  | 366.314 ms                |
| ProcessBack:UpdateCache   | 9.754 ms                  | 751.101 ms                |
| ProcessBack:UpsertPq      | 7.529 ms                  | 20.546 ms                 |
| ProcessOneStep            | 26.863 ms                 | 1.400 s                   |
| BlockToStepN              | 346.099 us                | 225.117 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:03:53.657016 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=20, pq.top=20
W20240204 11:03:54.657018 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240204 11:03:55.668553 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=34, pq.top=34
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.338 ms                  | 20.540 ms                 |
| Forward                   | 4.902 ms                  | 635.804 ms                |
| Backward                  | 8.893 ms                  | 193.985 ms                |
| Optimize                  | 1.932 ms                  | 9.530 ms                  |
| BarrierTimeBeforeRank0    | 1.224 ms                  | 19.503 ms                 |
| AfterBackward             | 27.926 ms                 | 1.400 s                   |
| BlockToStepN              | 91.230 ms                 | 225.206 ms                |
| OneStep                   | 143.761 ms                | 2.287 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 11:03:56.668007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=40, pq.top=40
W20240204 11:03:57.668022 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=46, pq.top=46
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.883 ms                  | 325.536 ms                |
| ProcessBack:UpdateCache   | 9.591 ms                  | 750.326 ms                |
| ProcessBack:UpsertPq      | 9.283 ms                  | 19.741 ms                 |
| ProcessOneStep            | 27.819 ms                 | 1.400 s                   |
| BlockToStepN              | 98.562 ms                 | 225.117 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:03:58.668006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=52, pq.top=52
W20240204 11:03:59.668020 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=58, pq.top=58
W20240204 11:04:00.668006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.346 ms                  | 19.677 ms                 |
| Forward                   | 4.861 ms                  | 20.662 ms                 |
| Backward                  | 8.900 ms                  | 16.939 ms                 |
| Optimize                  | 1.932 ms                  | 4.048 ms                  |
| BarrierTimeBeforeRank0    | 786.985 us                | 18.146 ms                 |
| AfterBackward             | 28.044 ms                 | 501.951 ms                |
| BlockToStepN              | 106.749 ms                | 147.431 ms                |
| OneStep                   | 158.304 ms                | 628.144 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:01.683300 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240204 11:04:02.683017 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=74, pq.top=74
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.970 ms                  | 10.842 ms                 |
| ProcessBack:UpdateCache   | 9.194 ms                  | 12.812 ms                 |
| ProcessBack:UpsertPq      | 9.462 ms                  | 18.840 ms                 |
| ProcessOneStep            | 28.005 ms                 | 501.834 ms                |
| BlockToStepN              | 111.188 ms                | 178.046 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:03.683007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240204 11:04:04.683019 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=84, pq.top=84
W20240204 11:04:05.683007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=88, pq.top=88
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.399 ms                  | 20.540 ms                 |
| Forward                   | 4.762 ms                  | 20.662 ms                 |
| Backward                  | 8.958 ms                  | 16.939 ms                 |
| Optimize                  | 1.904 ms                  | 4.048 ms                  |
| BarrierTimeBeforeRank0    | 420.878 us                | 18.146 ms                 |
| AfterBackward             | 28.180 ms                 | 501.951 ms                |
| BlockToStepN              | 116.727 ms                | 212.267 ms                |
| OneStep                   | 173.695 ms                | 628.144 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:06.683014 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240204 11:04:07.683007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=98, pq.top=98
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 19.186, sample: 0.341, forward: 1.085, backward: 1.088, update: 0.190
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 19.186, sample: 0.316, forward: 1.055, backward: 0.867, update: 0.184
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 19.186, sample: 0.353, forward: 1.056, backward: 1.119, update: 0.192
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 19.201, sample: 0.331, forward: 1.075, backward: 1.080, update: 0.202
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 19.202, sample: 0.307, forward: 1.049, backward: 1.126, update: 0.190
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 19.188, sample: 0.332, forward: 1.075, backward: 1.114, update: 0.189
train_sampler.Prefill()
-------Step 0-------
tensor([ 2024,    92,  3330,  3227, 12493, 13108,   990,   436, 13004, 12017]) tensor([ 1680,  9688,  5775,  8606, 11819,  1045,   587,  5062,   521, 12895])
-------Step 1-------
tensor([ 2024,    92,  3330,  3227, 12493, 13108,   990,   436, 13004, 12017]) tensor([ 3891, 10379, 14328,  1508,  1049,  7439, 14577, 10089,  5460, 13030])
-------Step 2-------
tensor([ 7303, 11262,  5420,  3791, 10488,  8441, 10442,    80, 11068,   932]) tensor([ 3535,  5085,  3780,  8513,  6042,  8861, 13455,  9552, 13743,  9798])
-------Step 3-------
tensor([ 7303, 11262,  5420,  3791, 10488,  8441, 10442,    80, 11068,   932]) tensor([ 8803,  6919,  7498, 11331,  5580,   713,  5386,  2075, 12610,  2144])
-------Step 4-------
tensor([   92, 10924, 10840,  5490,  5504,  3279,    66,  7071,  7629,  1023]) tensor([ 601, 1182, 3986, 3101, 3053, 2647,  436, 6565, 5697, 1846])
-------Step 5-------
tensor([   92, 10924, 10840,  5490,  5504,  3279,    66,  7071,  7629,  1023]) tensor([11526,  3726,  4765,  1785,  3150,   811,   828,  1327,  6078,  6460])
-------Step 6-------
tensor([ 1698,  8309,    34,    27,  7613,  3028,  8520, 11677, 14229, 13282]) tensor([11262,  2939,  7314,  4319,  9354,  9544,  3158,  8593, 10258, 11973])
-------Step 7-------
tensor([ 1698,  8309,    34,    27,  7613,  3028,  8520, 11677, 14229, 13282]) tensor([12984, 13022,  4453,  6812,  1344,  8867,  5743,  3560,   135, 13327])
-------Step 8-------
tensor([ 3477,  7677,  3849, 12666,    79,    89,  9765, 13139,    35,  2095]) tensor([ 6064,  5859,  4531,  7767,  2706, 14174,  9768,  1463,  8755,  3411])
-------Step 9-------
tensor([ 3477,  7677,  3849, 12666,    79,    89,  9765, 13139,    35,  2095]) tensor([12628,  3942, 13162,  7841, 14834, 13984, 14130, 10089,   680, 10709])
before start barrier
start train
[proc 0] 100 steps, total: 19.197, sample: 0.388, forward: 1.155, backward: 1.022, update: 0.208
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 19.187, sample: 0.318, forward: 1.047, backward: 0.976, update: 0.178
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.020 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 9.119 ms                  | 12.812 ms                 |
| ProcessBack:UpsertPq      | 9.473 ms                  | 19.064 ms                 |
| ProcessOneStep            | 28.064 ms                 | 501.834 ms                |
| BlockToStepN              | 122.161 ms                | 212.171 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:08.683007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=102, pq.top=102
W20240204 11:04:09.690515 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240204 11:04:10.690018 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.399 ms                  | 20.540 ms                 |
| Forward                   | 4.740 ms                  | 20.662 ms                 |
| Backward                  | 8.922 ms                  | 16.939 ms                 |
| Optimize                  | 1.919 ms                  | 4.048 ms                  |
| BarrierTimeBeforeRank0    | 567.365 us                | 18.146 ms                 |
| AfterBackward             | 28.197 ms                 | 501.951 ms                |
| BlockToStepN              | 128.265 ms                | 212.267 ms                |
| OneStep                   | 181.592 ms                | 628.144 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:11.694238 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240204 11:04:12.694006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=120, pq.top=120
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.966 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 9.227 ms                  | 12.812 ms                 |
| ProcessBack:UpsertPq      | 9.562 ms                  | 19.064 ms                 |
| ProcessOneStep            | 28.169 ms                 | 501.834 ms                |
| BlockToStepN              | 130.723 ms                | 212.171 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:13.694006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=124, pq.top=124
W20240204 11:04:14.694016 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=128, pq.top=128
W20240204 11:04:15.694011 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=132, pq.top=132
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.436 ms                  | 22.395 ms                 |
| Forward                   | 4.740 ms                  | 20.662 ms                 |
| Backward                  | 8.922 ms                  | 16.939 ms                 |
| Optimize                  | 1.936 ms                  | 4.048 ms                  |
| BarrierTimeBeforeRank0    | 591.529 us                | 18.146 ms                 |
| AfterBackward             | 28.249 ms                 | 501.951 ms                |
| BlockToStepN              | 136.314 ms                | 225.206 ms                |
| OneStep                   | 188.931 ms                | 628.144 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:16.694008 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=136, pq.top=136
W20240204 11:04:17.694006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.966 ms                  | 12.138 ms                 |
| ProcessBack:UpdateCache   | 9.219 ms                  | 12.121 ms                 |
| ProcessBack:UpsertPq      | 9.554 ms                  | 18.840 ms                 |
| ProcessOneStep            | 28.223 ms                 | 501.834 ms                |
| BlockToStepN              | 142.783 ms                | 235.330 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:18.694010 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=144, pq.top=144
W20240204 11:04:19.694013 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=148, pq.top=148
W20240204 11:04:20.694010 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=152, pq.top=152
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.442 ms                  | 22.213 ms                 |
| Forward                   | 4.615 ms                  | 12.540 ms                 |
| Backward                  | 8.893 ms                  | 15.613 ms                 |
| Optimize                  | 1.919 ms                  | 3.949 ms                  |
| BarrierTimeBeforeRank0    | 875.110 us                | 19.503 ms                 |
| AfterBackward             | 28.315 ms                 | 42.492 ms                 |
| BlockToStepN              | 147.969 ms                | 235.392 ms                |
| OneStep                   | 197.373 ms                | 294.100 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:21.694006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
W20240204 11:04:22.694008 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.901 ms                  | 12.138 ms                 |
| ProcessBack:UpdateCache   | 9.422 ms                  | 12.121 ms                 |
| ProcessBack:UpsertPq      | 9.647 ms                  | 18.840 ms                 |
| ProcessOneStep            | 28.289 ms                 | 42.448 ms                 |
| BlockToStepN              | 151.410 ms                | 240.512 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:23.719115 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=164, pq.top=164
W20240204 11:04:24.768149 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=168, pq.top=168
W20240204 11:04:25.784089 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=172, pq.top=172
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.440 ms                  | 22.213 ms                 |
| Forward                   | 4.620 ms                  | 12.540 ms                 |
| Backward                  | 8.842 ms                  | 15.613 ms                 |
| Optimize                  | 1.888 ms                  | 3.949 ms                  |
| BarrierTimeBeforeRank0    | 1.328 ms                  | 23.114 ms                 |
| AfterBackward             | 28.329 ms                 | 42.492 ms                 |
| BlockToStepN              | 155.896 ms                | 242.211 ms                |
| OneStep                   | 207.292 ms                | 307.703 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:26.784005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240204 11:04:27.832643 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.816 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 9.735 ms                  | 11.915 ms                 |
| ProcessBack:UpsertPq      | 9.682 ms                  | 18.026 ms                 |
| ProcessOneStep            | 28.357 ms                 | 42.448 ms                 |
| BlockToStepN              | 159.734 ms                | 246.829 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:28.867724 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240204 11:04:29.867012 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=186, pq.top=186
W20240204 11:04:30.867007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=190, pq.top=190
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.415 ms                  | 22.213 ms                 |
| Forward                   | 4.673 ms                  | 12.540 ms                 |
| Backward                  | 8.795 ms                  | 15.613 ms                 |
| Optimize                  | 1.872 ms                  | 3.949 ms                  |
| BarrierTimeBeforeRank0    | 2.019 ms                  | 23.122 ms                 |
| AfterBackward             | 28.329 ms                 | 45.637 ms                 |
| BlockToStepN              | 163.828 ms                | 256.324 ms                |
| OneStep                   | 215.713 ms                | 353.242 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:31.867005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240204 11:04:32.867007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.786 ms                  | 12.138 ms                 |
| ProcessBack:UpdateCache   | 9.832 ms                  | 12.121 ms                 |
| ProcessBack:UpsertPq      | 9.756 ms                  | 18.026 ms                 |
| ProcessOneStep            | 28.408 ms                 | 45.589 ms                 |
| BlockToStepN              | 166.339 ms                | 256.191 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 200 steps, total: 25.452, sample: 0.342, forward: 0.434, backward: 0.893, update: 0.186
[proc 1] 200 steps, total: 25.452, sample: 0.330, forward: 0.429, backward: 0.889, update: 0.188
[proc 6] 200 steps, total: 25.451, sample: 0.334, forward: 0.423, backward: 0.866, update: 0.177
[proc 4] 200 steps, total: 25.452, sample: 0.340, forward: 0.422, backward: 0.640, update: 0.176
[proc 2] 200 steps, total: 25.452, sample: 0.342, forward: 0.437, backward: 0.883, update: 0.195
[proc 5] 200 steps, total: 25.452, sample: 0.331, forward: 0.421, backward: 0.911, update: 0.185
[proc 3] 200 steps, total: 25.451, sample: 0.362, forward: 0.443, backward: 0.676, update: 0.177
[proc 0] 200 steps, total: 25.451, sample: 0.404, forward: 0.449, backward: 0.551, update: 0.186
W20240204 11:04:33.867012 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240204 11:04:34.867009 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240204 11:04:35.867005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=208, pq.top=208
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.399 ms                  | 22.213 ms                 |
| Forward                   | 4.688 ms                  | 12.540 ms                 |
| Backward                  | 7.377 ms                  | 15.613 ms                 |
| Optimize                  | 1.866 ms                  | 3.949 ms                  |
| BarrierTimeBeforeRank0    | 2.678 ms                  | 24.798 ms                 |
| AfterBackward             | 28.437 ms                 | 45.637 ms                 |
| BlockToStepN              | 169.469 ms                | 274.561 ms                |
| OneStep                   | 222.226 ms                | 361.566 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:36.903630 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240204 11:04:37.903007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.743 ms                  | 12.138 ms                 |
| ProcessBack:UpdateCache   | 9.907 ms                  | 12.121 ms                 |
| ProcessBack:UpsertPq      | 9.804 ms                  | 18.615 ms                 |
| ProcessOneStep            | 28.439 ms                 | 45.589 ms                 |
| BlockToStepN              | 170.620 ms                | 274.436 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:38.922070 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240204 11:04:39.922010 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240204 11:04:40.952529 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=226, pq.top=226
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.399 ms                  | 22.213 ms                 |
| Forward                   | 4.710 ms                  | 12.540 ms                 |
| Backward                  | 5.128 ms                  | 15.613 ms                 |
| Optimize                  | 1.860 ms                  | 3.949 ms                  |
| BarrierTimeBeforeRank0    | 3.133 ms                  | 24.798 ms                 |
| AfterBackward             | 28.466 ms                 | 45.637 ms                 |
| BlockToStepN              | 175.056 ms                | 282.303 ms                |
| OneStep                   | 227.261 ms                | 361.566 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:41.952008 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240204 11:04:42.952005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.700 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 9.929 ms                  | 11.915 ms                 |
| ProcessBack:UpsertPq      | 9.860 ms                  | 18.519 ms                 |
| ProcessOneStep            | 28.408 ms                 | 45.589 ms                 |
| BlockToStepN              | 175.391 ms                | 282.203 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:43.952013 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240204 11:04:44.984988 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
W20240204 11:04:45.984006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.410 ms                  | 22.213 ms                 |
| Forward                   | 4.739 ms                  | 12.540 ms                 |
| Backward                  | 4.612 ms                  | 15.613 ms                 |
| Optimize                  | 1.847 ms                  | 3.949 ms                  |
| BarrierTimeBeforeRank0    | 3.444 ms                  | 24.798 ms                 |
| AfterBackward             | 28.466 ms                 | 45.637 ms                 |
| BlockToStepN              | 180.658 ms                | 282.303 ms                |
| OneStep                   | 232.674 ms                | 361.566 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:47.027614 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240204 11:04:48.027005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.680 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 9.940 ms                  | 11.915 ms                 |
| ProcessBack:UpsertPq      | 9.883 ms                  | 18.519 ms                 |
| ProcessOneStep            | 28.434 ms                 | 45.589 ms                 |
| BlockToStepN              | 184.371 ms                | 291.661 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:49.027012 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240204 11:04:50.027010 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=256, pq.top=256
W20240204 11:04:51.027006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.429 ms                  | 20.540 ms                 |
| Forward                   | 4.741 ms                  | 12.446 ms                 |
| Backward                  | 4.510 ms                  | 12.028 ms                 |
| Optimize                  | 1.835 ms                  | 3.511 ms                  |
| BarrierTimeBeforeRank0    | 3.774 ms                  | 24.798 ms                 |
| AfterBackward             | 28.544 ms                 | 42.492 ms                 |
| BlockToStepN              | 186.738 ms                | 291.809 ms                |
| OneStep                   | 239.143 ms                | 363.828 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:52.027005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240204 11:04:53.027006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=266, pq.top=266
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.668 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 9.968 ms                  | 11.915 ms                 |
| ProcessBack:UpsertPq      | 9.919 ms                  | 18.840 ms                 |
| ProcessOneStep            | 28.563 ms                 | 42.448 ms                 |
| BlockToStepN              | 188.488 ms                | 291.661 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:54.027015 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240204 11:04:55.027011 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240204 11:04:56.027006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=276, pq.top=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.436 ms                  | 20.540 ms                 |
| Forward                   | 4.740 ms                  | 12.446 ms                 |
| Backward                  | 4.480 ms                  | 14.939 ms                 |
| Optimize                  | 1.835 ms                  | 3.592 ms                  |
| BarrierTimeBeforeRank0    | 4.076 ms                  | 24.798 ms                 |
| AfterBackward             | 28.648 ms                 | 42.492 ms                 |
| BlockToStepN              | 189.503 ms                | 296.142 ms                |
| OneStep                   | 245.734 ms                | 369.660 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:57.027006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240204 11:04:58.035398 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.672 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 9.981 ms                  | 11.885 ms                 |
| ProcessBack:UpsertPq      | 9.919 ms                  | 18.615 ms                 |
| ProcessOneStep            | 28.615 ms                 | 42.448 ms                 |
| BlockToStepN              | 191.401 ms                | 295.973 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:04:59.035015 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240204 11:05:00.035012 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240204 11:05:01.035005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.436 ms                  | 22.395 ms                 |
| Forward                   | 4.728 ms                  | 12.446 ms                 |
| Backward                  | 4.622 ms                  | 14.939 ms                 |
| Optimize                  | 1.836 ms                  | 3.603 ms                  |
| BarrierTimeBeforeRank0    | 4.138 ms                  | 24.798 ms                 |
| AfterBackward             | 28.648 ms                 | 42.492 ms                 |
| BlockToStepN              | 195.293 ms                | 296.142 ms                |
| OneStep                   | 249.965 ms                | 369.660 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:02.035005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240204 11:05:03.035006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.669 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 9.984 ms                  | 11.885 ms                 |
| ProcessBack:UpsertPq      | 9.930 ms                  | 19.064 ms                 |
| ProcessOneStep            | 28.622 ms                 | 42.448 ms                 |
| BlockToStepN              | 196.724 ms                | 295.973 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 300 steps, total: 29.691, sample: 0.315, forward: 0.436, backward: 0.891, update: 0.177
[proc 4] 300 steps, total: 29.691, sample: 0.310, forward: 0.424, backward: 0.935, update: 0.185
[proc 5] 300 steps, total: 29.691, sample: 0.324, forward: 0.421, backward: 0.920, update: 0.182
[proc 2] 300 steps, total: 29.691, sample: 0.316, forward: 0.436, backward: 0.848, update: 0.193
[proc 3] 300 steps, total: 29.691, sample: 0.335, forward: 0.476, backward: 0.537, update: 0.173
[proc 0] 300 steps, total: 29.691, sample: 0.396, forward: 0.478, backward: 0.548, update: 0.186
[proc 1] 300 steps, total: 29.691, sample: 0.333, forward: 0.435, backward: 0.873, update: 0.182
[proc 7] 300 steps, total: 29.691, sample: 0.340, forward: 0.432, backward: 0.892, update: 0.185
W20240204 11:05:04.087078 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240204 11:05:05.088063 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=306, pq.top=306
W20240204 11:05:06.088009 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.440 ms                  | 22.395 ms                 |
| Forward                   | 4.710 ms                  | 12.446 ms                 |
| Backward                  | 5.128 ms                  | 14.939 ms                 |
| Optimize                  | 1.836 ms                  | 3.603 ms                  |
| BarrierTimeBeforeRank0    | 4.216 ms                  | 24.798 ms                 |
| AfterBackward             | 28.663 ms                 | 42.492 ms                 |
| BlockToStepN              | 200.135 ms                | 296.751 ms                |
| OneStep                   | 254.227 ms                | 385.033 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:07.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=312, pq.top=312
W20240204 11:05:08.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.669 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 9.983 ms                  | 11.885 ms                 |
| ProcessBack:UpsertPq      | 9.938 ms                  | 19.168 ms                 |
| ProcessOneStep            | 28.637 ms                 | 42.448 ms                 |
| BlockToStepN              | 201.359 ms                | 296.596 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:09.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=318, pq.top=318
W20240204 11:05:10.088021 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240204 11:05:11.088007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=324, pq.top=324
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.451 ms                  | 22.395 ms                 |
| Forward                   | 4.686 ms                  | 12.446 ms                 |
| Backward                  | 6.407 ms                  | 14.939 ms                 |
| Optimize                  | 1.848 ms                  | 3.603 ms                  |
| BarrierTimeBeforeRank0    | 4.299 ms                  | 24.798 ms                 |
| AfterBackward             | 28.692 ms                 | 42.492 ms                 |
| BlockToStepN              | 203.275 ms                | 303.678 ms                |
| OneStep                   | 260.567 ms                | 385.033 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:12.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=328, pq.top=328
W20240204 11:05:13.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=331, pq.top=331
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.659 ms                  | 10.842 ms                 |
| ProcessBack:UpdateCache   | 9.981 ms                  | 11.840 ms                 |
| ProcessBack:UpsertPq      | 9.965 ms                  | 19.064 ms                 |
| ProcessOneStep            | 28.710 ms                 | 42.448 ms                 |
| BlockToStepN              | 204.306 ms                | 310.610 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:14.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=334, pq.top=334
W20240204 11:05:15.088014 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240204 11:05:16.088011 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=340, pq.top=340
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.458 ms                  | 22.395 ms                 |
| Forward                   | 4.688 ms                  | 12.446 ms                 |
| Backward                  | 6.947 ms                  | 14.939 ms                 |
| Optimize                  | 1.850 ms                  | 3.603 ms                  |
| BarrierTimeBeforeRank0    | 4.305 ms                  | 24.798 ms                 |
| AfterBackward             | 28.748 ms                 | 42.492 ms                 |
| BlockToStepN              | 206.436 ms                | 319.009 ms                |
| OneStep                   | 265.099 ms                | 385.033 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:17.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=344, pq.top=344
W20240204 11:05:18.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=347, pq.top=347
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.669 ms                  | 11.016 ms                 |
| ProcessBack:UpdateCache   | 9.993 ms                  | 11.915 ms                 |
| ProcessBack:UpsertPq      | 9.980 ms                  | 19.064 ms                 |
| ProcessOneStep            | 28.745 ms                 | 42.448 ms                 |
| BlockToStepN              | 206.540 ms                | 319.140 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:19.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=350, pq.top=350
W20240204 11:05:20.088013 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240204 11:05:21.088011 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=356, pq.top=356
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.470 ms                  | 22.213 ms                 |
| Forward                   | 4.685 ms                  | 11.795 ms                 |
| Backward                  | 6.002 ms                  | 13.952 ms                 |
| Optimize                  | 1.846 ms                  | 3.592 ms                  |
| BarrierTimeBeforeRank0    | 4.485 ms                  | 24.404 ms                 |
| AfterBackward             | 28.775 ms                 | 42.392 ms                 |
| BlockToStepN              | 208.609 ms                | 319.009 ms                |
| OneStep                   | 266.846 ms                | 385.033 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:22.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240204 11:05:23.088007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=362, pq.top=362
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.671 ms                  | 12.138 ms                 |
| ProcessBack:UpdateCache   | 9.996 ms                  | 11.915 ms                 |
| ProcessBack:UpsertPq      | 9.984 ms                  | 19.064 ms                 |
| ProcessOneStep            | 28.762 ms                 | 42.357 ms                 |
| BlockToStepN              | 210.364 ms                | 318.954 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:24.088007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240204 11:05:25.088014 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=368, pq.top=368
W20240204 11:05:26.088011 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=371, pq.top=371
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.489 ms                  | 22.213 ms                 |
| Forward                   | 4.669 ms                  | 11.795 ms                 |
| Backward                  | 6.057 ms                  | 13.952 ms                 |
| Optimize                  | 1.839 ms                  | 3.592 ms                  |
| BarrierTimeBeforeRank0    | 4.485 ms                  | 24.404 ms                 |
| AfterBackward             | 28.808 ms                 | 42.392 ms                 |
| BlockToStepN              | 213.662 ms                | 320.984 ms                |
| OneStep                   | 269.641 ms                | 391.421 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:27.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=374, pq.top=374
W20240204 11:05:28.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=377, pq.top=377
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.686 ms                  | 12.074 ms                 |
| ProcessBack:UpdateCache   | 9.997 ms                  | 11.885 ms                 |
| ProcessBack:UpsertPq      | 10.009 ms                 | 18.840 ms                 |
| ProcessOneStep            | 28.783 ms                 | 42.357 ms                 |
| BlockToStepN              | 213.952 ms                | 320.908 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:29.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=380, pq.top=380
W20240204 11:05:30.088012 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=383, pq.top=383
W20240204 11:05:31.088011 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=386, pq.top=386
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.497 ms                  | 22.213 ms                 |
| Forward                   | 4.664 ms                  | 11.795 ms                 |
| Backward                  | 6.189 ms                  | 13.952 ms                 |
| Optimize                  | 1.839 ms                  | 3.592 ms                  |
| BarrierTimeBeforeRank0    | 4.520 ms                  | 24.404 ms                 |
| AfterBackward             | 28.854 ms                 | 42.392 ms                 |
| BlockToStepN              | 215.680 ms                | 321.991 ms                |
| OneStep                   | 273.226 ms                | 391.421 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:32.088011 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=389, pq.top=389
W20240204 11:05:33.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=392, pq.top=392
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.685 ms                  | 12.074 ms                 |
| ProcessBack:UpdateCache   | 9.998 ms                  | 11.885 ms                 |
| ProcessBack:UpsertPq      | 10.028 ms                 | 20.546 ms                 |
| ProcessOneStep            | 28.825 ms                 | 42.357 ms                 |
| BlockToStepN              | 216.439 ms                | 321.804 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:34.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=395, pq.top=395
W20240204 11:05:35.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=398, pq.top=398
[proc 1] 400 steps, total: 32.411, sample: 0.341, forward: 0.424, backward: 0.867, update: 0.185
[proc 2] 400 steps, total: 32.412, sample: 0.334, forward: 0.424, backward: 0.876, update: 0.189
[proc 3] 400 steps, total: 32.412, sample: 0.315, forward: 0.441, backward: 0.868, update: 0.183
[proc 7] 400 steps, total: 32.411, sample: 0.307, forward: 0.444, backward: 0.881, update: 0.188
[proc 4] 400 steps, total: 32.412, sample: 0.346, forward: 0.421, backward: 0.855, update: 0.179
[proc 6] 400 steps, total: 32.412, sample: 0.334, forward: 0.418, backward: 0.881, update: 0.180
[proc 5] 400 steps, total: 32.412, sample: 0.337, forward: 0.410, backward: 0.798, update: 0.183
[proc 0] 400 steps, total: 32.411, sample: 0.393, forward: 0.445, backward: 0.747, update: 0.191
W20240204 11:05:36.088016 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=402, pq.top=402
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.508 ms                  | 22.213 ms                 |
| Forward                   | 4.660 ms                  | 11.795 ms                 |
| Backward                  | 6.684 ms                  | 13.952 ms                 |
| Optimize                  | 1.846 ms                  | 3.592 ms                  |
| BarrierTimeBeforeRank0    | 4.498 ms                  | 24.404 ms                 |
| AfterBackward             | 28.854 ms                 | 42.392 ms                 |
| BlockToStepN              | 217.695 ms                | 321.991 ms                |
| OneStep                   | 277.021 ms                | 391.421 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:37.088006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240204 11:05:38.114214 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=408, pq.top=408
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.686 ms                  | 12.074 ms                 |
| ProcessBack:UpdateCache   | 10.003 ms                 | 11.915 ms                 |
| ProcessBack:UpsertPq      | 10.053 ms                 | 20.649 ms                 |
| ProcessOneStep            | 28.829 ms                 | 42.357 ms                 |
| BlockToStepN              | 218.238 ms                | 321.804 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:39.137568 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240204 11:05:40.137005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240204 11:05:41.167426 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.519 ms                  | 22.213 ms                 |
| Forward                   | 4.658 ms                  | 11.795 ms                 |
| Backward                  | 5.918 ms                  | 13.952 ms                 |
| Optimize                  | 1.836 ms                  | 3.592 ms                  |
| BarrierTimeBeforeRank0    | 4.520 ms                  | 24.404 ms                 |
| AfterBackward             | 28.867 ms                 | 42.392 ms                 |
| BlockToStepN              | 219.764 ms                | 324.360 ms                |
| OneStep                   | 278.927 ms                | 391.421 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:42.167011 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
W20240204 11:05:43.213169 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=423, pq.top=423
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.682 ms                  | 12.074 ms                 |
| ProcessBack:UpdateCache   | 10.009 ms                 | 11.915 ms                 |
| ProcessBack:UpsertPq      | 10.065 ms                 | 21.296 ms                 |
| ProcessOneStep            | 28.864 ms                 | 42.357 ms                 |
| BlockToStepN              | 219.957 ms                | 329.515 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:44.215891 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=426, pq.top=426
W20240204 11:05:45.215005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240204 11:05:46.215006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=431, pq.top=431
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.528 ms                  | 23.108 ms                 |
| Forward                   | 4.655 ms                  | 11.795 ms                 |
| Backward                  | 5.069 ms                  | 13.952 ms                 |
| Optimize                  | 1.836 ms                  | 3.592 ms                  |
| BarrierTimeBeforeRank0    | 4.520 ms                  | 24.404 ms                 |
| AfterBackward             | 28.896 ms                 | 42.392 ms                 |
| BlockToStepN              | 221.445 ms                | 330.390 ms                |
| OneStep                   | 279.883 ms                | 407.030 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:47.215018 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=434, pq.top=434
W20240204 11:05:48.215011 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=437, pq.top=437
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.671 ms                  | 12.074 ms                 |
| ProcessBack:UpdateCache   | 10.016 ms                 | 11.885 ms                 |
| ProcessBack:UpsertPq      | 10.066 ms                 | 20.649 ms                 |
| ProcessOneStep            | 28.864 ms                 | 42.357 ms                 |
| BlockToStepN              | 221.777 ms                | 340.414 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:49.215006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=440, pq.top=440
W20240204 11:05:50.215006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=443, pq.top=443
W20240204 11:05:51.276315 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=447, pq.top=447
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.535 ms                  | 23.108 ms                 |
| Forward                   | 4.649 ms                  | 11.795 ms                 |
| Backward                  | 4.923 ms                  | 13.952 ms                 |
| Optimize                  | 1.835 ms                  | 3.592 ms                  |
| BarrierTimeBeforeRank0    | 4.528 ms                  | 24.798 ms                 |
| AfterBackward             | 28.867 ms                 | 42.392 ms                 |
| BlockToStepN              | 223.929 ms                | 340.488 ms                |
| OneStep                   | 281.485 ms                | 416.390 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:52.321054 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=450, pq.top=450
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.664 ms                  | 12.074 ms                 |
| ProcessBack:UpdateCache   | 10.025 ms                 | 12.035 ms                 |
| ProcessBack:UpsertPq      | 10.073 ms                 | 21.296 ms                 |
| ProcessOneStep            | 28.864 ms                 | 42.357 ms                 |
| BlockToStepN              | 225.117 ms                | 339.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:53.321009 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=452, pq.top=452
W20240204 11:05:54.321005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240204 11:05:55.321007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240204 11:05:56.321007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=460, pq.top=460
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.553 ms                  | 23.108 ms                 |
| Forward                   | 4.658 ms                  | 11.371 ms                 |
| Backward                  | 4.852 ms                  | 12.028 ms                 |
| Optimize                  | 1.836 ms                  | 3.575 ms                  |
| BarrierTimeBeforeRank0    | 4.560 ms                  | 24.798 ms                 |
| AfterBackward             | 28.910 ms                 | 42.392 ms                 |
| BlockToStepN              | 226.373 ms                | 354.744 ms                |
| OneStep                   | 282.912 ms                | 427.133 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:57.321005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=463, pq.top=463
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.668 ms                  | 12.074 ms                 |
| ProcessBack:UpdateCache   | 10.030 ms                 | 12.035 ms                 |
| ProcessBack:UpsertPq      | 10.099 ms                 | 21.324 ms                 |
| ProcessOneStep            | 28.865 ms                 | 42.357 ms                 |
| BlockToStepN              | 227.237 ms                | 356.619 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:05:58.321009 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=466, pq.top=466
W20240204 11:05:59.321017 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240204 11:06:00.321007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240204 11:06:01.338965 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=475, pq.top=475
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.559 ms                  | 23.108 ms                 |
| Forward                   | 4.651 ms                  | 11.371 ms                 |
| Backward                  | 4.761 ms                  | 12.028 ms                 |
| Optimize                  | 1.835 ms                  | 3.575 ms                  |
| BarrierTimeBeforeRank0    | 4.637 ms                  | 25.263 ms                 |
| AfterBackward             | 28.956 ms                 | 42.392 ms                 |
| BlockToStepN              | 227.748 ms                | 360.413 ms                |
| OneStep                   | 284.946 ms                | 438.950 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:06:02.338006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=478, pq.top=478
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.665 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 10.035 ms                 | 11.915 ms                 |
| ProcessBack:UpsertPq      | 10.114 ms                 | 21.324 ms                 |
| ProcessOneStep            | 28.927 ms                 | 42.357 ms                 |
| BlockToStepN              | 229.125 ms                | 360.324 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:06:03.338008 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240204 11:06:04.338016 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240204 11:06:05.338006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=486, pq.top=486
W20240204 11:06:06.338006 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=489, pq.top=489
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.568 ms                  | 23.108 ms                 |
| Forward                   | 4.649 ms                  | 11.371 ms                 |
| Backward                  | 4.717 ms                  | 12.028 ms                 |
| Optimize                  | 1.829 ms                  | 3.575 ms                  |
| BarrierTimeBeforeRank0    | 4.650 ms                  | 25.263 ms                 |
| AfterBackward             | 28.972 ms                 | 42.392 ms                 |
| BlockToStepN              | 229.916 ms                | 373.554 ms                |
| OneStep                   | 286.559 ms                | 445.216 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:06:07.390058 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=492, pq.top=492
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.654 ms                  | 11.723 ms                 |
| ProcessBack:UpdateCache   | 10.039 ms                 | 11.915 ms                 |
| ProcessBack:UpsertPq      | 10.119 ms                 | 21.324 ms                 |
| ProcessOneStep            | 28.927 ms                 | 42.357 ms                 |
| BlockToStepN              | 231.024 ms                | 378.906 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 11:06:08.390005 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240204 11:06:09.390020 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=497, pq.top=497
W20240204 11:06:10.390007 43378 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=500, pq.top=500
[proc 7] 500 steps, total: 34.706, sample: 0.339, forward: 0.458, backward: 0.848, update: 0.181
[proc 3] 500 steps, total: 34.706, sample: 0.315, forward: 0.435, backward: 0.734, update: 0.174
[proc 5] 500 steps, total: 34.706, sample: 0.275, forward: 0.419, backward: 0.668, update: 0.171
[proc 1] 500 steps, total: 34.706, sample: 0.315, forward: 0.422, backward: 0.645, update: 0.171
[proc 6] 500 steps, total: 34.706, sample: 0.296, forward: 0.427, backward: 0.856, update: 0.177
[proc 4] 500 steps, total: 34.706, sample: 0.306, forward: 0.426, backward: 0.871, update: 0.176
[proc 0] 500 steps, total: 34.706, sample: 0.410, forward: 0.444, backward: 0.415, update: 0.179
[proc 2] 500 steps, total: 34.706, sample: 0.344, forward: 0.434, backward: 0.856, update: 0.186
Successfully xmh. training takes 141.45886135101318 seconds
before call kg_cache_controller.StopThreads()
W20240204 11:06:10.516884 43378 grad_async_v1.h:243] call StopThreads. PID = 42631
W20240204 11:06:10.516901 43378 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 11:06:10.524441 43378 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 11:06:10.524464 43378 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 11:06:10.547600 43378 grad_async_v1.h:264] StopThreads done.
