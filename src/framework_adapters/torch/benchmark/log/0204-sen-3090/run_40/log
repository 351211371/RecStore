WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 18:55:08.459895 38263 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_98', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=4, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [38263 sampler.py:454] Start PreSampling
WARNING [38263 sampler.py:532] Before construct renumbering_dict
WARNING [38263 sampler.py:555] PreSampling done
W20240204 19:15:03.823554 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 19:15:03.823763 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 19:15:03.823807 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 19:15:03.823849 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 19:15:03.823895 38263 IPCTensor.h:369] NewIPCTensor: step_r0 [4]0x100001e8e000 32 B 
W20240204 19:15:03.823923 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100001e90000 8 B 
W20240204 19:15:03.823956 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100001e92000 8 B 
W20240204 19:15:03.824122 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100001e94000 7.629 MB
W20240204 19:15:03.824180 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100002637000 7.629 MB
W20240204 19:15:03.824219 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100002dda000 7.629 MB
W20240204 19:15:03.824262 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000357d000 7.629 MB
W20240204 19:15:03.824294 38263 IPCTensor.h:369] NewIPCTensor: step_r1 [4]0x100003d20000 32 B 
W20240204 19:15:03.824321 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100003d22000 8 B 
W20240204 19:15:03.824353 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100003d24000 8 B 
W20240204 19:15:03.824412 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100003d26000 7.629 MB
W20240204 19:15:03.824445 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000044c9000 7.629 MB
W20240204 19:15:03.824488 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100004c6c000 7.629 MB
W20240204 19:15:03.824523 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000540f000 7.629 MB
W20240204 19:15:03.824560 38263 IPCTensor.h:369] NewIPCTensor: step_r2 [4]0x100005bb2000 32 B 
W20240204 19:15:03.824584 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x100005bb4000 8 B 
W20240204 19:15:03.824610 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100005bb6000 8 B 
W20240204 19:15:03.824680 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100005bb8000 7.629 MB
W20240204 19:15:03.824728 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000635b000 7.629 MB
W20240204 19:15:03.824765 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100006afe000 7.629 MB
W20240204 19:15:03.824795 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000072a1000 7.629 MB
W20240204 19:15:03.824826 38263 IPCTensor.h:369] NewIPCTensor: step_r3 [4]0x100007a44000 32 B 
W20240204 19:15:03.824851 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x100007a46000 8 B 
W20240204 19:15:03.824877 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100007a48000 8 B 
W20240204 19:15:03.824934 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100007a4a000 7.629 MB
W20240204 19:15:03.824971 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000081ed000 7.629 MB
W20240204 19:15:03.825004 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x100008990000 7.629 MB
W20240204 19:15:03.825042 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x100009133000 7.629 MB
W20240204 19:15:03.825073 38263 IPCTensor.h:369] NewIPCTensor: step_r4 [4]0x1000098d6000 32 B 
W20240204 19:15:03.825098 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000098d8000 8 B 
W20240204 19:15:03.825129 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000098da000 8 B 
W20240204 19:15:03.825186 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000098dc000 7.629 MB
W20240204 19:15:03.825222 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x10000a07f000 7.629 MB
W20240204 19:15:03.825254 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x10000a822000 7.629 MB
W20240204 19:15:03.825284 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x10000afc5000 7.629 MB
W20240204 19:15:03.825315 38263 IPCTensor.h:369] NewIPCTensor: step_r5 [4]0x10000b768000 32 B 
W20240204 19:15:03.825340 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10000b76a000 8 B 
W20240204 19:15:03.825367 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10000b76c000 8 B 
W20240204 19:15:03.825423 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10000b76e000 7.629 MB
W20240204 19:15:03.825461 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10000bf11000 7.629 MB
W20240204 19:15:03.825492 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10000c6b4000 7.629 MB
W20240204 19:15:03.825527 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10000ce57000 7.629 MB
W20240204 19:15:03.825556 38263 IPCTensor.h:369] NewIPCTensor: step_r6 [4]0x10000d5fa000 32 B 
W20240204 19:15:03.825582 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x10000d5fc000 8 B 
W20240204 19:15:03.825615 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10000d5fe000 8 B 
W20240204 19:15:03.825675 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10000d600000 7.629 MB
W20240204 19:15:03.825711 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10000dda3000 7.629 MB
W20240204 19:15:03.825743 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10000e546000 7.629 MB
W20240204 19:15:03.825779 38263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x10000ece9000 7.629 MB
W20240204 19:15:03.825816 38263 IPCTensor.h:369] NewIPCTensor: step_r7 [4]0x10000f48c000 32 B 
W20240204 19:15:03.825841 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10000f48e000 8 B 
W20240204 19:15:03.825868 38263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10000f490000 8 B 
W20240204 19:15:04.266227 38263 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x10000f492000 128.2 GB
W20240204 19:23:47.448765 38263 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10201e0ca000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302760,  4302809,    92945,  ..., 67857942, 61420456,  4911976]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2116.823 seconds
[Rank1] pid = 64952
[Rank2] pid = 65049
[Rank3] pid = 65116
[Rank4] pid = 65246
[Rank5] pid = 65434
[Rank6] pid = 465
INFO [38263 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [64952 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [65049 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [65116 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [65246 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [65434 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [688 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [65116 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [465 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [65246 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65434 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [688 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [465 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 19:30:35.604601 65117 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240204 19:30:35.605226   468 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240204 19:30:35.605279 65247 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240204 19:30:35.605957   775 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240204 19:30:35.605948 65449 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
INFO [38263 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65049 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64952 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 19:30:35.622246   689 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240204 19:30:35.622488 65050 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240204 19:30:35.622833 64953 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240204 19:30:35.659328   775 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x102032915000 7.629 MB
W20240204 19:30:35.659343   468 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1020330b8000 7.629 MB
W20240204 19:30:35.659488   775 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10203385b000 7.629 MB
W20240204 19:30:35.659499   468 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x102033ffe000 7.629 MB
W20240204 19:30:35.659549   775 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1020347a1000 1.49 GB
W20240204 19:30:35.659565   468 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x102093d84000 1.49 GB
W20240204 19:30:35.659633   468 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1020f3369000 1.49 GB
W20240204 19:30:35.659651   775 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10215294c000 1.49 GB
W20240204 19:30:35.659680   468 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 19:30:35.659701   775 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 19:30:35.659921 65117 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1021b1f2f000 7.629 MB
W20240204 19:30:35.660151 65117 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1021b26d2000 7.629 MB
W20240204 19:30:35.660239 65117 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1021b2e75000 1.49 GB
W20240204 19:30:35.660331 65117 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102212458000 1.49 GB
W20240204 19:30:35.660403 65117 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 19:30:35.666491   468 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 19:30:35.666500   775 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 19:30:35.666639 65117 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 19:30:35.717239 65247 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102272997000 7.629 MB
W20240204 19:30:35.717227   689 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102271a51000 7.629 MB
W20240204 19:30:35.717235 65449 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1022721f4000 7.629 MB
W20240204 19:30:35.717286 65050 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10227313a000 7.629 MB
W20240204 19:30:35.717315 64953 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1022738dd000 7.629 MB
W20240204 19:30:35.717872 65050 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102274080000 7.629 MB
W20240204 19:30:35.717883 65247 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x102274823000 7.629 MB
W20240204 19:30:35.717888 65449 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102274fc6000 7.629 MB
W20240204 19:30:35.717892   689 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102275769000 7.629 MB
W20240204 19:30:35.717911 64953 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102275f0c000 7.629 MB
W20240204 19:30:35.717962 65449 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1022766af000 1.49 GB
W20240204 19:30:35.718010 64953 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1022d5c92000 1.49 GB
W20240204 19:30:35.718019   689 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102335275000 1.49 GB
W20240204 19:30:35.718047 65050 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102394858000 1.49 GB
W20240204 19:30:35.718055 65247 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1023f3e3b000 1.49 GB
W20240204 19:30:35.718127 65247 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10245341e000 1.49 GB
W20240204 19:30:35.718132 65050 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1024b2a01000 1.49 GB
W20240204 19:30:35.718227   689 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102511fe4000 1.49 GB
W20240204 19:30:35.718276 65449 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1025715c7000 1.49 GB
W20240204 19:30:35.718295 64953 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1025d0baa000 1.49 GB
W20240204 19:30:35.718508 64953 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 19:30:35.718508   689 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 19:30:35.718510 65449 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 19:30:35.718515 65050 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 19:30:35.718528 65247 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 19:30:35.727835 64953 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 19:30:35.727932   689 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 19:30:35.727941 65247 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 19:30:35.727942 65449 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 19:30:35.727954 65050 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x10000f492000
6: KnownLocalCachedEmbedding init done
WARNING [465 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
2: KnownLocalCachedEmbedding init done
WARNING [65049 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
7: KnownLocalCachedEmbedding init done
WARNING [688 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
3: KnownLocalCachedEmbedding init done
WARNING [65116 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
1: KnownLocalCachedEmbedding init done
WARNING [64952 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
5: KnownLocalCachedEmbedding init done
WARNING [65434 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 688
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x10000f492000
0: KnownLocalCachedEmbedding init done
WARNING [38263 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000f492000
4: KnownLocalCachedEmbedding init done
WARNING [65246 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 19:31:27.210947 65247 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 19:31:27.211146 65117 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 19:31:27.211222 65449 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 19:31:27.211292   775 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 19:31:27.211360 64953 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 19:31:27.211427 65050 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 19:31:27.211488   689 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 19:31:27.211522   468 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 19:31:27.213115   689 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 4,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 19:31:27.213281   689 grad_base.h:184] Init GradProcessingBase done
I20240204 19:31:40.562148   689 grad_async_v1.h:203] Use main thread to update emb.
W20240204 19:31:40.562569   689 kg_controller.h:75] after init GradAsyncProcessing
I20240204 19:31:40.562589   689 kg_controller.h:84] Construct KGCacheController done
E20240204 19:31:42.341528 64953 recstore.cc:66] init folly done
E20240204 19:31:42.341549   468 recstore.cc:66] init folly done
E20240204 19:31:42.341549 65449 recstore.cc:66] init folly done
E20240204 19:31:42.341569 65050 recstore.cc:66] init folly done
E20240204 19:31:42.341622   775 recstore.cc:66] init folly done
E20240204 19:31:42.341622 65247 recstore.cc:66] init folly done
E20240204 19:31:42.341750 65117 recstore.cc:66] init folly done
E20240204 19:31:42.342357   689 recstore.cc:66] init folly done
I20240204 19:31:42.343331   689 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 19:32:05.275104 65050 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 19:32:06.354158   775 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 19:32:06.451001 65449 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 19:32:06.527884 65247 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 19:32:09.049451 64953 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 19:32:09.318085 65117 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 19:32:09.660625   689 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 19:32:10.794520   468 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.421 ms                 | 12.421 ms                 |
| Forward                   | 731.110 ms                | 731.110 ms                |
| Backward                  | 211.523 ms                | 211.523 ms                |
| Optimize                  | 2.575 ms                  | 2.575 ms                  |
| BarrierTimeBeforeRank0    | 30.708 ms                 | 30.708 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:13.091367   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240204 19:32:14.175022   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240204 19:32:15.175007   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240204 19:32:16.179462   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240204 19:32:17.179008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.110 ms                 | 14.343 ms                 |
| Forward                   | 5.464 ms                  | 731.110 ms                |
| Backward                  | 10.831 ms                 | 211.523 ms                |
| Optimize                  | 3.002 ms                  | 5.226 ms                  |
| BarrierTimeBeforeRank0    | 59.167 us                 | 32.659 ms                 |
| AfterBackward             | 67.815 ms                 | 1.308 s                   |
| BlockToStepN              | 5.281 ms                  | 840.246 ms                |
| OneStep                   | 153.738 ms                | 3.152 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.454 ms                  | 290.348 ms                |
| ProcessBack:UpdateCache   | 9.579 ms                  | 664.448 ms                |
| ProcessBack:UpsertPq      | 40.286 ms                 | 89.078 ms                 |
| ProcessOneStep            | 67.783 ms                 | 1.307 s                   |
| BlockToStepN              | 5.243 ms                  | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:18.179008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240204 19:32:19.179005   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240204 19:32:20.184607   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240204 19:32:21.184006   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240204 19:32:22.184006   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.982 ms                  | 105.061 ms                |
| Forward                   | 5.100 ms                  | 731.110 ms                |
| Backward                  | 9.601 ms                  | 211.523 ms                |
| Optimize                  | 2.739 ms                  | 5.267 ms                  |
| BarrierTimeBeforeRank0    | 59.167 us                 | 47.512 ms                 |
| AfterBackward             | 64.265 ms                 | 1.308 s                   |
| BlockToStepN              | 5.934 ms                  | 840.246 ms                |
| OneStep                   | 154.038 ms                | 3.152 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.507 ms                  | 290.348 ms                |
| ProcessBack:UpdateCache   | 9.849 ms                  | 664.448 ms                |
| ProcessBack:UpsertPq      | 40.286 ms                 | 89.078 ms                 |
| ProcessOneStep            | 64.234 ms                 | 1.307 s                   |
| BlockToStepN              | 5.895 ms                  | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:23.184007   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240204 19:32:24.184006   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240204 19:32:25.184010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240204 19:32:26.184007   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240204 19:32:27.184006   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.442 ms                  | 105.061 ms                |
| Forward                   | 5.053 ms                  | 731.110 ms                |
| Backward                  | 9.693 ms                  | 211.523 ms                |
| Optimize                  | 3.309 ms                  | 5.267 ms                  |
| BarrierTimeBeforeRank0    | 96.079 us                 | 47.512 ms                 |
| AfterBackward             | 65.211 ms                 | 1.308 s                   |
| BlockToStepN              | 15.451 ms                 | 840.246 ms                |
| OneStep                   | 154.038 ms                | 3.152 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.523 ms                  | 251.734 ms                |
| ProcessBack:UpdateCache   | 9.849 ms                  | 663.128 ms                |
| ProcessBack:UpsertPq      | 39.745 ms                 | 66.349 ms                 |
| ProcessOneStep            | 65.178 ms                 | 1.307 s                   |
| BlockToStepN              | 15.409 ms                 | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:28.184008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240204 19:32:29.184008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240204 19:32:30.184007   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240204 19:32:31.184007   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.387 ms                  | 105.061 ms                |
| Forward                   | 5.365 ms                  | 731.110 ms                |
| Backward                  | 9.540 ms                  | 211.523 ms                |
| Optimize                  | 3.002 ms                  | 5.267 ms                  |
| BarrierTimeBeforeRank0    | 264.911 us                | 47.512 ms                 |
| AfterBackward             | 65.474 ms                 | 1.308 s                   |
| BlockToStepN              | 15.451 ms                 | 840.246 ms                |
| OneStep                   | 178.322 ms                | 3.152 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:32.314152   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.619 ms                  | 251.734 ms                |
| ProcessBack:UpdateCache   | 10.240 ms                 | 663.128 ms                |
| ProcessBack:UpsertPq      | 40.271 ms                 | 117.326 ms                |
| ProcessOneStep            | 66.457 ms                 | 1.307 s                   |
| BlockToStepN              | 15.409 ms                 | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:33.314009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240204 19:32:34.314008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240204 19:32:35.314018   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240204 19:32:36.314010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=46, pq.top=46
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.955 ms                  | 123.284 ms                |
| Forward                   | 5.526 ms                  | 731.110 ms                |
| Backward                  | 9.636 ms                  | 211.523 ms                |
| Optimize                  | 2.856 ms                  | 6.461 ms                  |
| BarrierTimeBeforeRank0    | 252.870 us                | 47.512 ms                 |
| AfterBackward             | 66.786 ms                 | 1.308 s                   |
| BlockToStepN              | 685.408 ms                | 840.246 ms                |
| OneStep                   | 833.850 ms                | 3.152 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:37.337294   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.921 ms                  | 251.734 ms                |
| ProcessBack:UpdateCache   | 10.377 ms                 | 663.128 ms                |
| ProcessBack:UpsertPq      | 39.684 ms                 | 117.326 ms                |
| ProcessOneStep            | 66.457 ms                 | 1.307 s                   |
| BlockToStepN              | 15.409 ms                 | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:38.337010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240204 19:32:39.337011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240204 19:32:40.337010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240204 19:32:41.337013   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.211 ms                  | 105.061 ms                |
| Forward                   | 5.508 ms                  | 29.952 ms                 |
| Backward                  | 9.785 ms                  | 17.217 ms                 |
| Optimize                  | 3.002 ms                  | 6.461 ms                  |
| BarrierTimeBeforeRank0    | 59.167 us                 | 33.793 ms                 |
| AfterBackward             | 64.114 ms                 | 148.997 ms                |
| BlockToStepN              | 18.623 ms                 | 834.464 ms                |
| OneStep                   | 205.496 ms                | 1.058 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:42.337011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.892 ms                  | 251.734 ms                |
| ProcessBack:UpdateCache   | 9.997 ms                  | 663.128 ms                |
| ProcessBack:UpsertPq      | 38.982 ms                 | 117.326 ms                |
| ProcessOneStep            | 64.071 ms                 | 148.946 ms                |
| BlockToStepN              | 18.575 ms                 | 834.324 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:43.339339   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240204 19:32:44.342171   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=62, pq.top=62
W20240204 19:32:45.415599   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=64, pq.top=64
W20240204 19:32:46.463111   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.211 ms                  | 105.061 ms                |
| Forward                   | 5.508 ms                  | 29.952 ms                 |
| Backward                  | 9.981 ms                  | 17.217 ms                 |
| Optimize                  | 3.000 ms                  | 6.461 ms                  |
| BarrierTimeBeforeRank0    | 59.167 us                 | 45.995 ms                 |
| AfterBackward             | 61.764 ms                 | 148.997 ms                |
| BlockToStepN              | 18.623 ms                 | 840.246 ms                |
| OneStep                   | 205.496 ms                | 1.058 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.882 ms                  | 251.734 ms                |
| ProcessBack:UpdateCache   | 9.997 ms                  | 663.128 ms                |
| ProcessBack:UpsertPq      | 35.583 ms                 | 117.326 ms                |
| ProcessOneStep            | 61.257 ms                 | 148.946 ms                |
| BlockToStepN              | 685.305 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:47.463009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240204 19:32:48.463007   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240204 19:32:49.463009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240204 19:32:50.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240204 19:32:51.463008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.961 ms                  | 105.061 ms                |
| Forward                   | 5.464 ms                  | 29.952 ms                 |
| Backward                  | 10.446 ms                 | 17.217 ms                 |
| Optimize                  | 2.798 ms                  | 6.461 ms                  |
| BarrierTimeBeforeRank0    | 156.837 us                | 45.995 ms                 |
| AfterBackward             | 60.212 ms                 | 148.997 ms                |
| BlockToStepN              | 685.408 ms                | 840.246 ms                |
| OneStep                   | 833.850 ms                | 1.058 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.711 ms                  | 23.297 ms                 |
| ProcessBack:UpdateCache   | 10.039 ms                 | 21.170 ms                 |
| ProcessBack:UpsertPq      | 34.014 ms                 | 89.078 ms                 |
| ProcessOneStep            | 59.955 ms                 | 148.946 ms                |
| BlockToStepN              | 18.575 ms                 | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:52.463006   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240204 19:32:53.463009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240204 19:32:54.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240204 19:32:55.463009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240204 19:32:56.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.833 ms                  | 105.061 ms                |
| Forward                   | 5.454 ms                  | 29.952 ms                 |
| Backward                  | 10.453 ms                 | 17.217 ms                 |
| Optimize                  | 2.798 ms                  | 6.461 ms                  |
| BarrierTimeBeforeRank0    | 252.870 us                | 45.995 ms                 |
| AfterBackward             | 59.003 ms                 | 148.997 ms                |
| BlockToStepN              | 18.623 ms                 | 840.246 ms                |
| OneStep                   | 205.496 ms                | 1.058 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.644 ms                  | 23.297 ms                 |
| ProcessBack:UpdateCache   | 10.224 ms                 | 21.170 ms                 |
| ProcessBack:UpsertPq      | 32.927 ms                 | 89.078 ms                 |
| ProcessOneStep            | 58.974 ms                 | 148.946 ms                |
| BlockToStepN              | 18.575 ms                 | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:32:57.463006   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240204 19:32:58.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240204 19:32:59.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240204 19:33:00.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240204 19:33:01.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.481 ms                  | 105.061 ms                |
| Forward                   | 5.464 ms                  | 29.952 ms                 |
| Backward                  | 10.541 ms                 | 17.217 ms                 |
| Optimize                  | 2.837 ms                  | 6.461 ms                  |
| BarrierTimeBeforeRank0    | 249.907 us                | 45.995 ms                 |
| AfterBackward             | 57.889 ms                 | 148.997 ms                |
| BlockToStepN              | 61.999 ms                 | 840.246 ms                |
| OneStep                   | 205.496 ms                | 1.058 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.631 ms                  | 31.837 ms                 |
| ProcessBack:UpdateCache   | 10.114 ms                 | 21.170 ms                 |
| ProcessBack:UpsertPq      | 32.190 ms                 | 89.078 ms                 |
| ProcessOneStep            | 57.840 ms                 | 148.946 ms                |
| BlockToStepN              | 61.947 ms                 | 839.177 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:02.463006   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 56.482, sample: 1.467, forward: 1.225, backward: 1.147, update: 0.295
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 53.692, sample: 1.404, forward: 1.286, backward: 0.870, update: 0.257
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 52.215, sample: 1.175, forward: 1.241, backward: 0.870, update: 0.247
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 56.559, sample: 1.464, forward: 1.300, backward: 1.055, update: 0.251
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 57.735, sample: 1.623, forward: 1.222, backward: 1.239, update: 0.247
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 53.961, sample: 1.227, forward: 1.216, backward: 1.149, update: 0.261
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 56.656, sample: 1.127, forward: 1.261, backward: 0.821, update: 0.235
train_sampler.Prefill()
-------Step 0-------
tensor([   64132,    64161,    64198,    64244,  5918447,   149216, 50016423,
        16613885, 21178867,    64287]) tensor([ 5208362, 14125564, 56237903, 69738184, 20755317, 30612386, 31998852,
        71575676, 78186354, 29172694])
-------Step 1-------
tensor([   64132,    64161,    64198,    64244,  5918447,   149216, 50016423,
        16613885, 21178867,    64287]) tensor([76587459, 28594474, 12101555, 84857154, 81360971, 40496260, 64984849,
        45694066, 39843651, 11646782])
-------Step 2-------
tensor([  160808,   160848,   160897,    24576,   160944,   160986,   161032,
        25367581,   161063,   161098]) tensor([64380466, 24969808, 83869273, 46079358, 43938760, 27464520, 76961264,
        43169742, 15233657, 39729277])
-------Step 3-------
tensor([  160808,   160848,   160897,    24576,   160944,   160986,   161032,
        25367581,   161063,   161098]) tensor([53415597, 77271429, 33360055, 35993051, 68625673, 59990898, 38560997,
        15138349, 25767133,   779651])
before start barrier
start train
[proc 0] 100 steps, total: 53.349, sample: 1.563, forward: 1.296, backward: 1.175, update: 0.342
W20240204 19:33:03.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240204 19:33:04.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240204 19:33:05.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240204 19:33:06.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.285 ms                  | 105.061 ms                |
| Forward                   | 5.426 ms                  | 29.952 ms                 |
| Backward                  | 10.549 ms                 | 17.217 ms                 |
| Optimize                  | 2.798 ms                  | 6.461 ms                  |
| BarrierTimeBeforeRank0    | 248.673 us                | 47.512 ms                 |
| AfterBackward             | 56.948 ms                 | 148.997 ms                |
| BlockToStepN              | 74.338 ms                 | 840.246 ms                |
| OneStep                   | 205.496 ms                | 1.058 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.641 ms                  | 31.837 ms                 |
| ProcessBack:UpdateCache   | 9.934 ms                  | 21.170 ms                 |
| ProcessBack:UpsertPq      | 31.931 ms                 | 89.078 ms                 |
| ProcessOneStep            | 56.908 ms                 | 148.946 ms                |
| BlockToStepN              | 74.289 ms                 | 839.177 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:07.463008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240204 19:33:08.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240204 19:33:09.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240204 19:33:10.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240204 19:33:11.463009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.285 ms                  | 105.061 ms                |
| Forward                   | 5.406 ms                  | 29.952 ms                 |
| Backward                  | 10.626 ms                 | 17.217 ms                 |
| Optimize                  | 2.798 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 96.079 us                 | 47.512 ms                 |
| AfterBackward             | 57.363 ms                 | 148.997 ms                |
| BlockToStepN              | 74.338 ms                 | 840.246 ms                |
| OneStep                   | 205.496 ms                | 1.058 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.680 ms                  | 31.837 ms                 |
| ProcessBack:UpdateCache   | 9.819 ms                  | 21.170 ms                 |
| ProcessBack:UpsertPq      | 32.607 ms                 | 89.078 ms                 |
| ProcessOneStep            | 57.710 ms                 | 148.946 ms                |
| BlockToStepN              | 74.289 ms                 | 839.177 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:12.463008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240204 19:33:13.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240204 19:33:14.463011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240204 19:33:15.650038   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240204 19:33:16.660183   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=126, pq.top=126
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.285 ms                  | 139.342 ms                |
| Forward                   | 5.371 ms                  | 29.952 ms                 |
| Backward                  | 10.641 ms                 | 17.217 ms                 |
| Optimize                  | 2.800 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 218.633 us                | 47.512 ms                 |
| AfterBackward             | 57.363 ms                 | 148.997 ms                |
| BlockToStepN              | 80.483 ms                 | 840.246 ms                |
| OneStep                   | 223.095 ms                | 1.077 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.703 ms                  | 23.297 ms                 |
| ProcessBack:UpdateCache   | 9.819 ms                  | 16.112 ms                 |
| ProcessBack:UpsertPq      | 32.465 ms                 | 66.349 ms                 |
| ProcessOneStep            | 57.319 ms                 | 148.946 ms                |
| BlockToStepN              | 80.422 ms                 | 839.177 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:17.668782   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=128, pq.top=128
W20240204 19:33:18.668007   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240204 19:33:19.741489   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240204 19:33:20.839772   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240204 19:33:21.839007   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.495 ms                  | 139.342 ms                |
| Forward                   | 5.371 ms                  | 29.952 ms                 |
| Backward                  | 10.634 ms                 | 17.217 ms                 |
| Optimize                  | 2.836 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 61.696 us                 | 47.512 ms                 |
| AfterBackward             | 57.392 ms                 | 148.997 ms                |
| BlockToStepN              | 80.483 ms                 | 840.246 ms                |
| OneStep                   | 223.095 ms                | 1.077 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.703 ms                  | 23.297 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 16.112 ms                 |
| ProcessBack:UpsertPq      | 32.612 ms                 | 77.046 ms                 |
| ProcessOneStep            | 57.359 ms                 | 148.946 ms                |
| BlockToStepN              | 80.422 ms                 | 839.177 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:22.839010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240204 19:33:24.225728   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240204 19:33:25.312548   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240204 19:33:26.312009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.839 ms                  | 199.698 ms                |
| Forward                   | 5.406 ms                  | 29.952 ms                 |
| Backward                  | 10.667 ms                 | 17.217 ms                 |
| Optimize                  | 2.800 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 56.571 us                 | 47.512 ms                 |
| AfterBackward             | 57.392 ms                 | 148.997 ms                |
| BlockToStepN              | 80.483 ms                 | 840.246 ms                |
| OneStep                   | 223.095 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:27.312009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.703 ms                  | 23.297 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 16.112 ms                 |
| ProcessBack:UpsertPq      | 32.927 ms                 | 77.046 ms                 |
| ProcessOneStep            | 57.359 ms                 | 148.946 ms                |
| BlockToStepN              | 80.422 ms                 | 839.177 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:28.312009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240204 19:33:29.312009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240204 19:33:30.359705   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240204 19:33:31.407418   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.961 ms                  | 139.342 ms                |
| Forward                   | 5.406 ms                  | 14.432 ms                 |
| Backward                  | 10.696 ms                 | 16.120 ms                 |
| Optimize                  | 2.798 ms                  | 6.461 ms                  |
| BarrierTimeBeforeRank0    | 51.962 us                 | 45.995 ms                 |
| AfterBackward             | 56.939 ms                 | 141.273 ms                |
| BlockToStepN              | 672.047 ms                | 839.278 ms                |
| OneStep                   | 794.742 ms                | 1.077 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.711 ms                  | 23.297 ms                 |
| ProcessBack:UpdateCache   | 9.781 ms                  | 16.112 ms                 |
| ProcessBack:UpsertPq      | 32.796 ms                 | 77.046 ms                 |
| ProcessOneStep            | 56.792 ms                 | 141.207 ms                |
| BlockToStepN              | 671.928 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:32.750633   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240204 19:33:33.786231   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240204 19:33:34.786010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240204 19:33:35.786008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240204 19:33:36.786011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.211 ms                  | 199.698 ms                |
| Forward                   | 5.410 ms                  | 14.432 ms                 |
| Backward                  | 10.711 ms                 | 16.120 ms                 |
| Optimize                  | 2.785 ms                  | 6.461 ms                  |
| BarrierTimeBeforeRank0    | 45.730 us                 | 45.995 ms                 |
| AfterBackward             | 56.511 ms                 | 141.273 ms                |
| BlockToStepN              | 100.653 ms                | 839.278 ms                |
| OneStep                   | 223.095 ms                | 1.153 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.730 ms                  | 23.297 ms                 |
| ProcessBack:UpdateCache   | 9.781 ms                  | 16.112 ms                 |
| ProcessBack:UpsertPq      | 32.689 ms                 | 77.046 ms                 |
| ProcessOneStep            | 56.461 ms                 | 141.207 ms                |
| BlockToStepN              | 100.516 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:37.810550   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240204 19:33:38.810009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=168, pq.top=168
W20240204 19:33:39.812247   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=170, pq.top=170
W20240204 19:33:40.859838   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=172, pq.top=172
W20240204 19:33:41.859011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.481 ms                  | 278.808 ms                |
| Forward                   | 5.426 ms                  | 14.432 ms                 |
| Backward                  | 10.733 ms                 | 16.120 ms                 |
| Optimize                  | 2.776 ms                  | 6.461 ms                  |
| BarrierTimeBeforeRank0    | 43.023 us                 | 45.995 ms                 |
| AfterBackward             | 56.052 ms                 | 141.273 ms                |
| BlockToStepN              | 672.047 ms                | 839.278 ms                |
| OneStep                   | 794.742 ms                | 1.153 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.711 ms                  | 23.297 ms                 |
| ProcessBack:UpdateCache   | 9.776 ms                  | 16.112 ms                 |
| ProcessBack:UpsertPq      | 32.689 ms                 | 77.046 ms                 |
| ProcessOneStep            | 55.945 ms                 | 141.207 ms                |
| BlockToStepN              | 103.038 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:42.859010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240204 19:33:43.859010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240204 19:33:44.859011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240204 19:33:45.859010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240204 19:33:46.859012   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.680 ms                  | 278.808 ms                |
| Forward                   | 5.436 ms                  | 14.432 ms                 |
| Backward                  | 10.738 ms                 | 16.120 ms                 |
| Optimize                  | 2.774 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 42.437 us                 | 45.995 ms                 |
| AfterBackward             | 56.546 ms                 | 141.273 ms                |
| BlockToStepN              | 103.163 ms                | 839.278 ms                |
| OneStep                   | 235.566 ms                | 1.153 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.730 ms                  | 17.379 ms                 |
| ProcessBack:UpdateCache   | 9.768 ms                  | 14.931 ms                 |
| ProcessBack:UpsertPq      | 32.823 ms                 | 82.106 ms                 |
| ProcessOneStep            | 56.501 ms                 | 141.207 ms                |
| BlockToStepN              | 671.928 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:47.859009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240204 19:33:48.859009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240204 19:33:50.092223   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240204 19:33:51.165867   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240204 19:33:52.165009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.915 ms                  | 300.270 ms                |
| Forward                   | 5.454 ms                  | 14.432 ms                 |
| Backward                  | 10.768 ms                 | 16.120 ms                 |
| Optimize                  | 2.734 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 38.518 us                 | 45.995 ms                 |
| AfterBackward             | 56.632 ms                 | 141.273 ms                |
| BlockToStepN              | 119.114 ms                | 839.278 ms                |
| OneStep                   | 235.566 ms                | 1.190 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.784 ms                  | 17.379 ms                 |
| ProcessBack:UpdateCache   | 9.752 ms                  | 14.931 ms                 |
| ProcessBack:UpsertPq      | 32.829 ms                 | 82.106 ms                 |
| ProcessOneStep            | 56.590 ms                 | 141.207 ms                |
| BlockToStepN              | 119.027 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:53.165009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240204 19:33:54.165009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240204 19:33:55.228224   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 6] 200 steps, total: 53.167, sample: 1.169, forward: 0.532, backward: 0.933, update: 0.251
[proc 2] 200 steps, total: 53.167, sample: 1.246, forward: 0.510, backward: 1.079, update: 0.263
[proc 3] 200 steps, total: 53.167, sample: 1.175, forward: 0.516, backward: 0.970, update: 0.254
[proc 7] 200 steps, total: 53.167, sample: 1.090, forward: 0.528, backward: 0.525, update: 0.229
[proc 5] 200 steps, total: 53.167, sample: 1.217, forward: 0.536, backward: 0.913, update: 0.241
[proc 4] 200 steps, total: 53.167, sample: 1.322, forward: 0.503, backward: 0.944, update: 0.250
[proc 1] 200 steps, total: 53.167, sample: 1.170, forward: 0.556, backward: 0.906, update: 0.257
[proc 0] 200 steps, total: 53.167, sample: 3.446, forward: 0.577, backward: 1.080, update: 0.327
W20240204 19:33:56.274928   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.266 ms                  | 300.270 ms                |
| Forward                   | 5.452 ms                  | 14.432 ms                 |
| Backward                  | 10.775 ms                 | 16.120 ms                 |
| Optimize                  | 2.726 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 37.456 us                 | 45.995 ms                 |
| AfterBackward             | 56.858 ms                 | 141.273 ms                |
| BlockToStepN              | 129.127 ms                | 839.278 ms                |
| OneStep                   | 794.742 ms                | 1.190 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:57.328037   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.812 ms                  | 17.379 ms                 |
| ProcessBack:UpdateCache   | 9.736 ms                  | 14.931 ms                 |
| ProcessBack:UpsertPq      | 32.937 ms                 | 82.106 ms                 |
| ProcessOneStep            | 56.903 ms                 | 141.207 ms                |
| BlockToStepN              | 129.048 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:33:58.681257   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240204 19:33:59.686825   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240204 19:34:00.686008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240204 19:34:01.688670   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.441 ms                  | 300.270 ms                |
| Forward                   | 5.436 ms                  | 14.432 ms                 |
| Backward                  | 10.787 ms                 | 16.120 ms                 |
| Optimize                  | 2.732 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 36.432 us                 | 45.995 ms                 |
| AfterBackward             | 56.858 ms                 | 141.273 ms                |
| BlockToStepN              | 129.127 ms                | 839.278 ms                |
| OneStep                   | 235.566 ms                | 1.190 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.812 ms                  | 17.379 ms                 |
| ProcessBack:UpdateCache   | 9.719 ms                  | 14.931 ms                 |
| ProcessBack:UpsertPq      | 32.927 ms                 | 82.106 ms                 |
| ProcessOneStep            | 56.792 ms                 | 141.207 ms                |
| BlockToStepN              | 129.048 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:34:02.747087   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240204 19:34:03.822767   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240204 19:34:04.887527   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240204 19:34:05.887009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
W20240204 19:34:06.900856   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.441 ms                  | 300.270 ms                |
| Forward                   | 5.454 ms                  | 14.432 ms                 |
| Backward                  | 10.775 ms                 | 16.120 ms                 |
| Optimize                  | 2.711 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 35.601 us                 | 45.995 ms                 |
| AfterBackward             | 56.546 ms                 | 141.273 ms                |
| BlockToStepN              | 166.627 ms                | 839.278 ms                |
| OneStep                   | 255.013 ms                | 1.190 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.812 ms                  | 17.379 ms                 |
| ProcessBack:UpdateCache   | 9.658 ms                  | 14.931 ms                 |
| ProcessBack:UpsertPq      | 32.937 ms                 | 82.106 ms                 |
| ProcessOneStep            | 56.501 ms                 | 141.207 ms                |
| BlockToStepN              | 166.526 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:34:07.900009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240204 19:34:08.900009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240204 19:34:09.900012   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240204 19:34:10.900009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240204 19:34:11.900012   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.659 ms                  | 300.270 ms                |
| Forward                   | 5.464 ms                  | 29.952 ms                 |
| Backward                  | 10.787 ms                 | 16.120 ms                 |
| Optimize                  | 2.726 ms                  | 8.584 ms                  |
| BarrierTimeBeforeRank0    | 35.601 us                 | 45.995 ms                 |
| AfterBackward             | 56.632 ms                 | 141.273 ms                |
| BlockToStepN              | 166.627 ms                | 839.278 ms                |
| OneStep                   | 255.013 ms                | 1.190 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.824 ms                  | 16.616 ms                 |
| ProcessBack:UpdateCache   | 9.652 ms                  | 14.921 ms                 |
| ProcessBack:UpsertPq      | 32.937 ms                 | 77.046 ms                 |
| ProcessOneStep            | 56.590 ms                 | 141.207 ms                |
| BlockToStepN              | 166.526 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:34:12.900009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240204 19:34:13.971727   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240204 19:34:15.053218   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240204 19:34:16.053010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240204 19:34:17.053012   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.659 ms                  | 300.270 ms                |
| Forward                   | 5.464 ms                  | 29.952 ms                 |
| Backward                  | 10.815 ms                 | 16.675 ms                 |
| Optimize                  | 2.719 ms                  | 8.584 ms                  |
| BarrierTimeBeforeRank0    | 35.601 us                 | 45.995 ms                 |
| AfterBackward             | 56.948 ms                 | 141.273 ms                |
| BlockToStepN              | 672.047 ms                | 839.278 ms                |
| OneStep                   | 794.742 ms                | 1.190 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.863 ms                  | 16.616 ms                 |
| ProcessBack:UpdateCache   | 9.652 ms                  | 14.921 ms                 |
| ProcessBack:UpsertPq      | 33.036 ms                 | 77.046 ms                 |
| ProcessOneStep            | 56.908 ms                 | 141.207 ms                |
| BlockToStepN              | 671.928 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:34:18.053009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240204 19:34:19.053025   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240204 19:34:20.053011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240204 19:34:21.053010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240204 19:34:22.053010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.877 ms                  | 300.270 ms                |
| Forward                   | 5.464 ms                  | 29.952 ms                 |
| Backward                  | 10.815 ms                 | 16.675 ms                 |
| Optimize                  | 2.708 ms                  | 8.584 ms                  |
| BarrierTimeBeforeRank0    | 34.866 us                 | 45.995 ms                 |
| AfterBackward             | 57.319 ms                 | 141.273 ms                |
| BlockToStepN              | 166.627 ms                | 839.278 ms                |
| OneStep                   | 255.013 ms                | 1.190 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.863 ms                  | 16.616 ms                 |
| ProcessBack:UpdateCache   | 9.619 ms                  | 14.921 ms                 |
| ProcessBack:UpsertPq      | 33.036 ms                 | 77.046 ms                 |
| ProcessOneStep            | 57.280 ms                 | 141.207 ms                |
| BlockToStepN              | 166.526 ms                | 838.522 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:34:23.053009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240204 19:34:24.118507   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240204 19:34:25.118009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=252, pq.top=252
W20240204 19:34:26.118010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240204 19:34:27.118011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.919 ms                  | 295.792 ms                |
| Forward                   | 5.464 ms                  | 14.432 ms                 |
| Backward                  | 10.787 ms                 | 16.120 ms                 |
| Optimize                  | 2.693 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 34.502 us                 | 40.087 ms                 |
| AfterBackward             | 57.552 ms                 | 117.408 ms                |
| BlockToStepN              | 672.047 ms                | 834.464 ms                |
| OneStep                   | 794.742 ms                | 1.153 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.882 ms                  | 16.616 ms                 |
| ProcessBack:UpdateCache   | 9.613 ms                  | 14.921 ms                 |
| ProcessBack:UpsertPq      | 33.063 ms                 | 77.046 ms                 |
| ProcessOneStep            | 57.501 ms                 | 117.345 ms                |
| BlockToStepN              | 166.526 ms                | 834.324 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:34:28.118011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240204 19:34:29.118011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240204 19:34:30.118010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240204 19:34:31.118011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240204 19:34:32.118009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.982 ms                  | 295.792 ms                |
| Forward                   | 5.464 ms                  | 14.432 ms                 |
| Backward                  | 10.778 ms                 | 16.120 ms                 |
| Optimize                  | 2.693 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 34.043 us                 | 40.087 ms                 |
| AfterBackward             | 57.569 ms                 | 117.408 ms                |
| BlockToStepN              | 171.711 ms                | 834.464 ms                |
| OneStep                   | 263.370 ms                | 1.153 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.882 ms                  | 16.616 ms                 |
| ProcessBack:UpdateCache   | 9.598 ms                  | 14.921 ms                 |
| ProcessBack:UpsertPq      | 33.063 ms                 | 77.046 ms                 |
| ProcessOneStep            | 57.522 ms                 | 117.345 ms                |
| BlockToStepN              | 171.614 ms                | 834.324 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:34:33.118008   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240204 19:34:34.404630   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240204 19:34:35.404007   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240204 19:34:36.404012   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.982 ms                  | 295.792 ms                |
| Forward                   | 5.468 ms                  | 14.432 ms                 |
| Backward                  | 10.785 ms                 | 16.120 ms                 |
| Optimize                  | 2.693 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 34.043 us                 | 40.087 ms                 |
| AfterBackward             | 57.807 ms                 | 117.408 ms                |
| BlockToStepN              | 672.047 ms                | 834.464 ms                |
| OneStep                   | 794.742 ms                | 1.153 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.892 ms                  | 16.616 ms                 |
| ProcessBack:UpdateCache   | 9.574 ms                  | 14.921 ms                 |
| ProcessBack:UpsertPq      | 33.063 ms                 | 77.046 ms                 |
| ProcessOneStep            | 57.767 ms                 | 117.345 ms                |
| BlockToStepN              | 174.169 ms                | 834.324 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:34:37.434716   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240204 19:34:38.507709   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240204 19:34:39.507009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=278, pq.top=278
W20240204 19:34:40.507009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=280, pq.top=280
W20240204 19:34:41.507011   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.159 ms                  | 295.792 ms                |
| Forward                   | 5.481 ms                  | 14.432 ms                 |
| Backward                  | 10.778 ms                 | 16.120 ms                 |
| Optimize                  | 2.711 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 33.838 us                 | 40.087 ms                 |
| AfterBackward             | 57.889 ms                 | 117.408 ms                |
| BlockToStepN              | 182.574 ms                | 834.464 ms                |
| OneStep                   | 294.662 ms                | 1.153 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.892 ms                  | 16.555 ms                 |
| ProcessBack:UpdateCache   | 9.533 ms                  | 14.605 ms                 |
| ProcessBack:UpsertPq      | 33.148 ms                 | 66.349 ms                 |
| ProcessOneStep            | 57.849 ms                 | 117.345 ms                |
| BlockToStepN              | 182.513 ms                | 834.324 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 19:34:42.507009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240204 19:34:43.507010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240204 19:34:44.507010   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240204 19:34:45.507009   689 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
Successfully xmh. training takes 156.82398056983948 seconds
before call kg_cache_controller.StopThreads()
W20240204 19:34:46.484795   689 grad_async_v1.h:243] call StopThreads. PID = 38263
W20240204 19:34:46.484824   689 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 19:34:46.488564   689 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 19:34:46.488575   689 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 19:34:46.702066   689 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.297 ms                  | 295.792 ms                |
| Forward                   | 5.473 ms                  | 14.432 ms                 |
| Backward                  | 10.774 ms                 | 16.120 ms                 |
| Optimize                  | 2.682 ms                  | 6.831 ms                  |
| BarrierTimeBeforeRank0    | 33.487 us                 | 40.087 ms                 |
| AfterBackward             | 57.990 ms                 | 117.408 ms                |
| BlockToStepN              | 209.140 ms                | 834.464 ms                |
| OneStep                   | 302.959 ms                | 1.153 s                   |
+---------------------------+---------------------------+---------------------------+
