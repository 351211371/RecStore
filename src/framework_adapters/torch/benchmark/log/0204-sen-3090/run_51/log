WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 11:21:08.715494 53919 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_111', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=24, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [53919 sampler.py:454] Start PreSampling
WARNING [53919 sampler.py:532] Before construct renumbering_dict
WARNING [53919 sampler.py:555] PreSampling done
W20240205 11:41:17.996809 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 11:41:17.996996 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 11:41:17.997033 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 11:41:17.997059 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 11:41:17.997087 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 11:41:17.997121 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 11:41:17.997152 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 11:41:17.997189 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 11:41:17.997222 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 11:41:17.997256 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 11:41:17.997293 53919 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 11:41:17.997321 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 11:41:17.997351 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 11:41:17.997509 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 11:41:17.997548 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 11:41:17.997575 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 11:41:17.997618 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 11:41:17.997649 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 11:41:17.997681 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 11:41:17.997713 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 11:41:17.997748 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 11:41:17.997779 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 11:41:17.997807 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 11:41:17.997833 53919 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 11:41:17.997854 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 11:41:17.997876 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 11:41:17.997932 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 11:41:17.997965 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 11:41:17.997992 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 11:41:17.998016 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 11:41:17.998051 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 11:41:17.998077 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 11:41:17.998108 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 11:41:17.998140 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 11:41:17.998167 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 11:41:17.998191 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 11:41:17.998217 53919 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 11:41:17.998239 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 11:41:17.998265 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 11:41:17.998319 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 11:41:17.998353 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 11:41:17.998382 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 11:41:17.998411 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 11:41:17.998441 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 11:41:17.998483 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 11:41:17.998519 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 11:41:17.998548 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 11:41:17.998574 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 11:41:17.998603 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 11:41:17.998629 53919 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 11:41:17.998651 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 11:41:17.998672 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 11:41:17.998731 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 11:41:17.998761 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 11:41:17.998787 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 11:41:17.998813 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 11:41:17.998839 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 11:41:17.998870 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 11:41:17.998904 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 11:41:17.998930 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 11:41:17.998960 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 11:41:17.998987 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 11:41:17.999019 53919 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 11:41:17.999042 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 11:41:17.999063 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 11:41:17.999112 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 11:41:17.999142 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 11:41:17.999171 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 11:41:17.999197 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 11:41:17.999229 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 11:41:17.999264 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 11:41:17.999289 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 11:41:17.999320 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 11:41:17.999352 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 11:41:17.999379 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 11:41:17.999409 53919 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 11:41:17.999431 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 11:41:17.999454 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 11:41:17.999503 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 11:41:17.999531 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 11:41:17.999560 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 11:41:17.999588 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 11:41:17.999615 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 11:41:17.999650 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 11:41:17.999676 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 11:41:17.999706 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 11:41:17.999742 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 11:41:17.999783 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 11:41:17.999816 53919 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 11:41:17.999840 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 11:41:17.999861 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 11:41:17.999909 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 11:41:17.999943 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 11:41:17.999975 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 11:41:18.000002 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 11:41:18.000031 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 11:41:18.000073 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 11:41:18.000101 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 11:41:18.000129 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 11:41:18.000160 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 11:41:18.000195 53919 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 11:41:18.000224 53919 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 11:41:18.000247 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 11:41:18.000269 53919 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 11:41:18.421648 53919 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 11:49:51.979559 53919 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302714,  4302727,    82266,  ..., 54426832, 63331442,  4874516]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2229.310 seconds
[Rank1] pid = 14964
[Rank2] pid = 15063
[Rank3] pid = 15132
[Rank4] pid = 15202
[Rank5] pid = 15281
[Rank6] pid = 15453
INFO [53919 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [14964 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [15063 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [15132 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [15202 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [15453 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [15132 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15618 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [15281 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [15453 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15063 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15618 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15202 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15281 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 11:58:29.776432 15133 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 11:58:29.776540 15475 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 11:58:29.776600 15690 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 11:58:29.776715 15203 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 11:58:29.777653 15283 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 11:58:29.777653 15064 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
INFO [53919 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14964 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 11:58:29.780696 15619 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 11:58:29.782759 14965 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 11:58:29.856515 15690 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1020497ad000 7.629 MB
W20240205 11:58:29.856577 15475 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x102049f50000 7.629 MB
W20240205 11:58:29.856595 15133 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204a6f3000 7.629 MB
W20240205 11:58:29.856606 15203 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204ae96000 7.629 MB
W20240205 11:58:29.856619 15283 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204bddc000 7.629 MB
W20240205 11:58:29.856618 15064 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204b639000 7.629 MB
W20240205 11:58:29.856696 15690 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204c57f000 7.629 MB
W20240205 11:58:29.856739 15133 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10204cd26000 7.629 MB
W20240205 11:58:29.856743 15475 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204d4c9000 7.629 MB
W20240205 11:58:29.856748 15203 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204dc6c000 7.629 MB
W20240205 11:58:29.856767 15690 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10204e40f000 1.49 GB
W20240205 11:58:29.856822 15064 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1020ad9f2000 7.629 MB
W20240205 11:58:29.856829 15283 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1020ae195000 7.629 MB
W20240205 11:58:29.856838 15690 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1020af0db000 1.49 GB
W20240205 11:58:29.856834 15619 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1020ae938000 7.629 MB
W20240205 11:58:29.856844 15475 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10210e6be000 1.49 GB
W20240205 11:58:29.856851 15133 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10216dca1000 1.49 GB
W20240205 11:58:29.856858 15203 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1021cd284000 1.49 GB
W20240205 11:58:29.856925 14965 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10222c867000 7.629 MB
W20240205 11:58:29.856940 15690 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 11:58:29.856940 15133 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10222d00a000 1.49 GB
W20240205 11:58:29.856947 15203 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10228c5ed000 1.49 GB
W20240205 11:58:29.856953 15475 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1022ebbd0000 1.49 GB
W20240205 11:58:29.856956 15619 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10234b1b3000 7.629 MB
W20240205 11:58:29.856983 15064 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10234b956000 1.49 GB
W20240205 11:58:29.856989 15283 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1023aaf39000 1.49 GB
W20240205 11:58:29.857017 15619 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10240a51c000 1.49 GB
W20240205 11:58:29.857038 15203 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 11:58:29.857048 15475 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 11:58:29.857048 15133 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 11:58:29.857051 15619 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102469aff000 1.49 GB
W20240205 11:58:29.857072 15283 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1024c90e2000 1.49 GB
W20240205 11:58:29.857079 15064 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1025286c5000 1.49 GB
W20240205 11:58:29.857093 14965 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102587ca8000 7.629 MB
W20240205 11:58:29.857118 15619 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 11:58:29.857156 14965 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10258844b000 1.49 GB
W20240205 11:58:29.857175 15283 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 11:58:29.857173 15064 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 11:58:29.857203 14965 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240205 11:58:29.857244 14965 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 11:58:29.870702 15619 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 11:58:29.870725 15133 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 11:58:29.870741 14965 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 11:58:29.870748 15203 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 11:58:29.870752 15690 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 11:58:29.870752 15064 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 11:58:29.870752 15283 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 11:58:29.870792 15475 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [15281 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [15618 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [15063 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 15618
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [53919 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [14964 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [15202 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [15132 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [15453 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 11:59:19.839234 15475 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 11:59:19.839428 15203 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 11:59:19.839507 15064 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 11:59:19.839638 15283 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 11:59:19.840286 15690 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 11:59:19.840353 15133 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 11:59:19.840417 14965 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 11:59:19.840481 15619 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 11:59:19.842660 15619 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 24,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 11:59:19.842957 15619 grad_base.h:184] Init GradProcessingBase done
I20240205 11:59:32.213182 15619 grad_async_v2.h:42] Use main thread to update emb.
W20240205 11:59:32.213425 15619 kg_controller.h:78] after init GradAsyncProcessingV2
I20240205 11:59:32.213436 15619 kg_controller.h:84] Construct KGCacheController done
E20240205 11:59:33.944937 15690 recstore.cc:66] init folly done
E20240205 11:59:33.944989 15283 recstore.cc:66] init folly done
E20240205 11:59:33.945017 15203 recstore.cc:66] init folly done
E20240205 11:59:33.945847 15475 recstore.cc:66] init folly done
E20240205 11:59:33.945873 15064 recstore.cc:66] init folly done
E20240205 11:59:33.946049 14965 recstore.cc:66] init folly done
E20240205 11:59:33.946067 15133 recstore.cc:66] init folly done
E20240205 11:59:33.946103 15619 recstore.cc:66] init folly done
I20240205 11:59:33.947481 15619 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240205 11:59:52.339917 17304 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 11:59:52.340332 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 11:59:53.615744 17304 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 11:59:53.615948 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 140.732 us                | 278.462 us                |
+---------------------------+---------------------------+---------------------------+
W20240205 11:59:55.412825 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 11:59:55.430323 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 11:59:55.671717 15283 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 11:59:55.763553 15690 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 11:59:55.994714 15203 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 11:59:56.430014 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240205 11:59:56.503288 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
I20240205 11:59:57.360055 15064 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 11:59:57.436617 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 11:59:57.751452 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
I20240205 11:59:57.834913 14965 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 11:59:57.928375 15133 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 11:59:58.441045 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 142.248 us                | 270.410 us                |
+---------------------------+---------------------------+---------------------------+
W20240205 11:59:59.637562 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 11:59:59.659021 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 12:00:00.008726 15619 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 12:00:00.107797 15475 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 12:00:00.659025 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 12:00:00.698810 17304 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 12:00:02.521356 16563 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 12:00:02.694659 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240205 12:00:02.813902 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=2, pq.top=2
E20240205 12:00:03.521009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=3020
W20240205 12:00:03.727903 17304 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 262.217 us                | 1.140 ms                  |
| ProcessBack:Shuffle       | 12.846 ms                 | 349.693 ms                |
| ProcessBack:UpdateCache   | 13.194 ms                 | 688.797 ms                |
| ProcessBack:UpsertPq      | 38.276 ms                 | 213.509 ms                |
| ProcessOneStep            | 68.864 ms                 | 1.421 s                   |
| BlockToStepN              | 130.678 us                | 525.512 us                |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:04.040277 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=7, pq.top=7
E20240205 12:00:04.521009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=2037
W20240205 12:00:04.728200 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 18.396 ms                 | 225.896 ms                |
| Forward                   | 8.130 ms                  | 780.488 ms                |
| Backward                  | 4.788 ms                  | 212.440 ms                |
| Optimize                  | 2.905 ms                  | 6.790 ms                  |
| BarrierTimeBeforeRank0    | 5.507 ms                  | 92.098 ms                 |
| AfterBackward             | 69.309 ms                 | 1.422 s                   |
| BlockToStepN              | 546.899 us                | 1.409 ms                  |
| OneStep                   | 171.006 ms                | 2.581 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:05.185321 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=15, pq.top=15
E20240205 12:00:05.521018 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=227
E20240205 12:00:05.746068 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=19, sample_step_cpp_seen_[rank]=18
W20240205 12:00:05.866565 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 12:00:06.526743 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:00:06.759280 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=20, pq.top=20
W20240205 12:00:06.874047 17304 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 12:00:07.620978 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 12:00:07.883172 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=24, pq.top=24
W20240205 12:00:07.896770 17304 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240205 12:00:08.620008 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=163
W20240205 12:00:08.934311 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=33, pq.top=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 484.374 us                | 6.814 ms                  |
| ProcessBack:Shuffle       | 9.196 ms                  | 316.128 ms                |
| ProcessBack:UpdateCache   | 10.049 ms                 | 687.591 ms                |
| ProcessBack:UpsertPq      | 35.009 ms                 | 201.823 ms                |
| ProcessOneStep            | 112.818 ms                | 1.421 s                   |
| BlockToStepN              | 664.710 us                | 5.053 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:09.098955 17304 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 12:00:09.620011 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1900
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.669 ms                 | 517.335 ms                |
| Forward                   | 5.958 ms                  | 780.488 ms                |
| Backward                  | 5.117 ms                  | 212.440 ms                |
| Optimize                  | 2.949 ms                  | 6.790 ms                  |
| BarrierTimeBeforeRank0    | 1.918 ms                  | 92.098 ms                 |
| AfterBackward             | 112.861 ms                | 1.422 s                   |
| BlockToStepN              | 796.900 us                | 5.137 ms                  |
| OneStep                   | 146.898 ms                | 2.581 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:10.177767 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
W20240205 12:00:10.419706 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=36, pq.top=36
E20240205 12:00:10.620011 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=4622
W20240205 12:00:11.246882 17304 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240205 12:00:11.508105 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=41, pq.top=40
E20240205 12:00:11.634002 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=8691
W20240205 12:00:12.442126 17304 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240205 12:00:12.633018 17307 parallel_pq_v2.h:79] insert failed, size(hashtable)=22163
W20240205 12:00:12.676879 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=49, pq.top=49
E20240205 12:00:12.992271 15619 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=51, sample_step_cpp_seen_[rank]=50
W20240205 12:00:13.550529 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240205 12:00:13.633008 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=3364
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 336.294 us                | 3.235 ms                  |
| ProcessBack:Shuffle       | 8.524 ms                  | 316.128 ms                |
| ProcessBack:UpdateCache   | 10.604 ms                 | 687.591 ms                |
| ProcessBack:UpsertPq      | 31.746 ms                 | 201.823 ms                |
| ProcessOneStep            | 112.818 ms                | 1.234 s                   |
| BlockToStepN              | 854.012 us                | 39.788 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:14.418910 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240205 12:00:14.562731 17304 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240205 12:00:14.633010 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=389
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.071 ms                 | 378.118 ms                |
| Forward                   | 5.775 ms                  | 20.375 ms                 |
| Backward                  | 5.253 ms                  | 10.619 ms                 |
| Optimize                  | 2.902 ms                  | 17.147 ms                 |
| BarrierTimeBeforeRank0    | 1.884 ms                  | 71.674 ms                 |
| AfterBackward             | 112.861 ms                | 1.300 s                   |
| BlockToStepN              | 934.883 us                | 39.894 ms                 |
| OneStep                   | 146.898 ms                | 1.370 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:15.448220 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=58, pq.top=58
W20240205 12:00:15.575613 17304 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240205 12:00:15.633013 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=149
W20240205 12:00:16.495121 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=63, pq.top=63
E20240205 12:00:16.633009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=4168
W20240205 12:00:16.653343 17304 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240205 12:00:17.633013 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=225
W20240205 12:00:17.683205 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 12:00:17.992008 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=69, sample_step_cpp_seen_[rank]=68
E20240205 12:00:18.633011 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=724
W20240205 12:00:18.778657 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 325.552 us                | 2.285 ms                  |
| ProcessBack:Shuffle       | 8.508 ms                  | 316.128 ms                |
| ProcessBack:UpdateCache   | 11.931 ms                 | 687.591 ms                |
| ProcessBack:UpsertPq      | 35.279 ms                 | 217.698 ms                |
| ProcessOneStep            | 115.488 ms                | 1.300 s                   |
| BlockToStepN              | 854.012 us                | 39.788 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:00:19.633028 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 12:00:19.799751 17304 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.764 ms                  | 378.118 ms                |
| Forward                   | 5.811 ms                  | 20.375 ms                 |
| Backward                  | 5.438 ms                  | 10.619 ms                 |
| Optimize                  | 2.735 ms                  | 17.147 ms                 |
| BarrierTimeBeforeRank0    | 1.405 ms                  | 71.674 ms                 |
| AfterBackward             | 115.542 ms                | 1.422 s                   |
| BlockToStepN              | 922.215 us                | 39.894 ms                 |
| OneStep                   | 155.565 ms                | 1.610 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:00:20.635578 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=61
W20240205 12:00:20.936506 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240205 12:00:21.322772 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=81, pq.top=81
E20240205 12:00:21.635008 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=584
W20240205 12:00:22.125952 17304 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
W20240205 12:00:22.416033 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=87, pq.top=87
E20240205 12:00:22.636170 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240205 12:00:23.196233 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=91, sample_step_cpp_seen_[rank]=90
W20240205 12:00:23.303851 17304 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240205 12:00:23.636009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1414
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 307.699 us                | 2.544 ms                  |
| ProcessBack:Shuffle       | 8.628 ms                  | 33.341 ms                 |
| ProcessBack:UpdateCache   | 11.059 ms                 | 18.875 ms                 |
| ProcessBack:UpsertPq      | 34.088 ms                 | 213.509 ms                |
| ProcessOneStep            | 115.488 ms                | 1.421 s                   |
| BlockToStepN              | 799.756 us                | 39.788 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:24.134559 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=92, pq.top=92
W20240205 12:00:24.336607 17304 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 12:00:24.636011 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=180
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.534 ms                 | 378.118 ms                |
| Forward                   | 5.811 ms                  | 20.375 ms                 |
| Backward                  | 5.361 ms                  | 10.619 ms                 |
| Optimize                  | 2.902 ms                  | 17.147 ms                 |
| BarrierTimeBeforeRank0    | 692.914 us                | 92.098 ms                 |
| AfterBackward             | 115.542 ms                | 1.422 s                   |
| BlockToStepN              | 837.617 us                | 39.894 ms                 |
| OneStep                   | 161.198 ms                | 1.610 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:25.149559 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=98, pq.top=98
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 29.650, sample: 1.293, forward: 1.235, backward: 0.784, update: 0.245
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 29.418, sample: 1.694, forward: 1.304, backward: 0.791, update: 0.233
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 28.053, sample: 1.657, forward: 1.340, backward: 0.866, update: 0.254
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 29.742, sample: 1.420, forward: 1.304, backward: 1.032, update: 0.246
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.485, sample: 1.606, forward: 1.196, backward: 0.859, update: 0.234
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 25.305, sample: 1.505, forward: 1.330, backward: 0.773, update: 0.255
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 27.578, sample: 1.882, forward: 1.328, backward: 0.890, update: 0.278
train_sampler.Prefill()
-------Step 0-------
tensor([   47008,    47041,    47067,    47092,  6013485,   125895, 62432669,
        18824546, 23813045,    47115]) tensor([ 5317628, 17545470, 68097007, 77405648, 16720242, 36607996, 41449959,
        83700855, 78000528, 33035161])
-------Step 1-------
tensor([   47008,    47041,    47067,    47092,  6013485,   125895, 62432669,
        18824546, 23813045,    47115]) tensor([65728790, 24913283,  9650452, 84526917, 81196439, 36199784, 64747211,
        41900995, 32912299, 14408241])
-------Step 2-------
tensor([  116108,   116142,   116178,    27825,   116207,   116236,   116261,
        29141656,   116280,   116303]) tensor([78961029, 20950436, 79179889, 55833779, 46505313, 32151320, 66046266,
        36285942, 15354603, 35412298])
-------Step 3-------
tensor([  116108,   116142,   116178,    27825,   116207,   116236,   116261,
        29141656,   116280,   116303]) tensor([43509807, 82464497, 39908778, 43894072, 70990219, 55216228, 41445205,
        17609094, 30066683,   775520])
-------Step 4-------
tensor([  184824, 39500037,   184848,   158153,   184872,   158189,   184896,
        45725393,   184926,   184957]) tensor([79884996, 10601823, 84517787, 15087034, 62874630, 35987960, 74041557,
        43095971, 74894893, 46128203])
-------Step 5-------
tensor([  184824, 39500037,   184848,   158153,   184872,   158189,   184896,
        45725393,   184926,   184957]) tensor([29877006, 68404788,   226045, 85615105, 50688735, 61378549, 16158787,
         8734325, 79061747, 45497229])
-------Step 6-------
tensor([  251794,    60801,   251819,   251853,    60852, 80293399,   251882,
          251904,   174824, 41905922]) tensor([11491330, 43568043, 30387552, 71101835, 28424783, 41500880, 28258024,
         7058847, 76060820, 73045073])
-------Step 7-------
tensor([  251794,    60801,   251819,   251853,    60852, 80293399,   251882,
          251904,   174824, 41905922]) tensor([21836823, 44522702, 63398712, 64662673, 84615043, 43864094, 45588563,
        49921558, 40788867, 27610429])
-------Step 8-------
tensor([  319116, 29047621,   319141,   190432,   319170,    76726,   319200,
          319218,   319245,   319270]) tensor([42741554, 21311431, 29942076,  1909332, 42090761, 58512536, 17369376,
        63748790,  1469843, 55018808])
-------Step 9-------
tensor([  319116, 29047621,   319141,   190432,   319170,    76726,   319200,
          319218,   319245,   319270]) tensor([59953318, 31486976, 15729514, 57002667,  8575781, 35227381, 30745880,
        42602459, 73488261, 74266215])
before start barrier
start train
[proc 0] 100 steps, total: 25.404, sample: 3.663, forward: 1.414, backward: 0.780, update: 0.353
W20240205 12:00:25.519666 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
E20240205 12:00:25.636005 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1547
W20240205 12:00:26.212922 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=103, pq.top=103
E20240205 12:00:26.640338 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:00:26.680657 17304 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240205 12:00:27.643756 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:00:27.725934 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
W20240205 12:00:28.149209 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=109, pq.top=109
E20240205 12:00:28.643007 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=12355
W20240205 12:00:28.841022 17304 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 435.330 us                | 6.386 ms                  |
| ProcessBack:Shuffle       | 8.719 ms                  | 33.341 ms                 |
| ProcessBack:UpdateCache   | 10.661 ms                 | 21.772 ms                 |
| ProcessBack:UpsertPq      | 33.855 ms                 | 213.509 ms                |
| ProcessOneStep            | 116.143 ms                | 1.421 s                   |
| BlockToStepN              | 885.402 us                | 39.788 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:29.228473 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=117, pq.top=117
E20240205 12:00:29.643008 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=259
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.430 ms                 | 378.118 ms                |
| Forward                   | 5.764 ms                  | 20.375 ms                 |
| Backward                  | 5.447 ms                  | 10.619 ms                 |
| Optimize                  | 2.728 ms                  | 17.147 ms                 |
| BarrierTimeBeforeRank0    | 1.666 ms                  | 105.984 ms                |
| AfterBackward             | 115.191 ms                | 1.422 s                   |
| BlockToStepN              | 1.008 ms                  | 39.894 ms                 |
| OneStep                   | 161.198 ms                | 1.610 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:00:29.879770 15619 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=120, sample_step_cpp_seen_[rank]=119
W20240205 12:00:30.043048 17304 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 12:00:30.645651 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:00:31.206259 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
W20240205 12:00:31.626519 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=122, pq.top=122
E20240205 12:00:31.645012 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=8986
W20240205 12:00:32.215452 17304 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240205 12:00:32.645011 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=284
W20240205 12:00:32.712723 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240205 12:00:33.301894 17304 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 12:00:33.645009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=2059
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 324.652 us                | 3.693 ms                  |
| ProcessBack:Shuffle       | 8.770 ms                  | 23.983 ms                 |
| ProcessBack:UpdateCache   | 11.212 ms                 | 18.875 ms                 |
| ProcessBack:UpsertPq      | 33.025 ms                 | 201.823 ms                |
| ProcessOneStep            | 115.148 ms                | 1.431 s                   |
| BlockToStepN              | 971.034 us                | 40.179 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:34.124255 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240205 12:00:34.340773 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240205 12:00:34.645009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=37167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.293 ms                 | 378.118 ms                |
| Forward                   | 5.652 ms                  | 20.375 ms                 |
| Backward                  | 5.552 ms                  | 10.619 ms                 |
| Optimize                  | 2.735 ms                  | 17.147 ms                 |
| BarrierTimeBeforeRank0    | 1.666 ms                  | 123.164 ms                |
| AfterBackward             | 115.191 ms                | 1.431 s                   |
| BlockToStepN              | 1.092 ms                  | 40.308 ms                 |
| OneStep                   | 155.403 ms                | 1.610 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:35.315928 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240205 12:00:35.516216 17304 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240205 12:00:35.645009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=3275
E20240205 12:00:35.913038 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=149, sample_step_cpp_seen_[rank]=148
W20240205 12:00:36.607157 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240205 12:00:36.645020 17313 parallel_pq_v2.h:79] insert failed, size(hashtable)=5640
W20240205 12:00:36.880268 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=150, pq.top=150
E20240205 12:00:37.645009 16563 parallel_pq_v2.h:79] insert failed, size(hashtable)=1282
W20240205 12:00:37.723768 17304 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
W20240205 12:00:37.969892 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=157, pq.top=157
E20240205 12:00:38.645009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240205 12:00:38.827519 17304 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 458.556 us                | 16.814 ms                 |
| ProcessBack:Shuffle       | 8.787 ms                  | 23.983 ms                 |
| ProcessBack:UpdateCache   | 10.676 ms                 | 18.875 ms                 |
| ProcessBack:UpsertPq      | 31.746 ms                 | 201.823 ms                |
| ProcessOneStep            | 108.812 ms                | 1.421 s                   |
| BlockToStepN              | 1.163 ms                  | 50.846 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:00:39.645015 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=10070
W20240205 12:00:39.843199 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=164, pq.top=164
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.492 ms                  | 355.330 ms                |
| Forward                   | 5.681 ms                  | 16.442 ms                 |
| Backward                  | 5.509 ms                  | 10.355 ms                 |
| Optimize                  | 2.715 ms                  | 7.923 ms                  |
| BarrierTimeBeforeRank0    | 1.465 ms                  | 105.984 ms                |
| AfterBackward             | 108.864 ms                | 1.422 s                   |
| BlockToStepN              | 1.238 ms                  | 50.975 ms                 |
| OneStep                   | 155.091 ms                | 1.453 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:39.852763 17304 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240205 12:00:40.645009 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1610
W20240205 12:00:40.875547 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
W20240205 12:00:41.004607 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=171, pq.top=171
E20240205 12:00:41.645009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
E20240205 12:00:41.809692 15619 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=177, sample_step_cpp_seen_[rank]=176
W20240205 12:00:42.123837 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240205 12:00:42.645015 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=5798
W20240205 12:00:43.000986 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240205 12:00:43.162494 17304 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
E20240205 12:00:43.645473 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=18
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 429.003 us                | 19.058 ms                 |
| ProcessBack:Shuffle       | 8.788 ms                  | 21.984 ms                 |
| ProcessBack:UpdateCache   | 10.972 ms                 | 18.875 ms                 |
| ProcessBack:UpsertPq      | 30.731 ms                 | 193.443 ms                |
| ProcessOneStep            | 108.812 ms                | 1.421 s                   |
| BlockToStepN              | 1.087 ms                  | 50.846 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:44.044734 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240205 12:00:44.351743 17304 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240205 12:00:44.645009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=46258
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.916 ms                  | 355.330 ms                |
| Forward                   | 5.576 ms                  | 16.442 ms                 |
| Backward                  | 5.601 ms                  | 10.355 ms                 |
| Optimize                  | 2.701 ms                  | 7.923 ms                  |
| BarrierTimeBeforeRank0    | 1.695 ms                  | 105.984 ms                |
| AfterBackward             | 108.864 ms                | 1.422 s                   |
| BlockToStepN              | 1.250 ms                  | 50.975 ms                 |
| OneStep                   | 150.476 ms                | 1.453 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:45.463505 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240205 12:00:45.645015 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=561
W20240205 12:00:46.226049 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240205 12:00:46.491333 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240205 12:00:46.645013 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=2684
[proc 3] 200 steps, total: 21.849, sample: 1.337, forward: 0.555, backward: 0.704, update: 0.255
[proc 0] 200 steps, total: 21.849, sample: 2.127, forward: 0.542, backward: 0.671, update: 0.303
[proc 5] 200 steps, total: 21.849, sample: 1.073, forward: 0.535, backward: 0.607, update: 0.239
[proc 2] 200 steps, total: 21.850, sample: 2.342, forward: 0.572, backward: 0.721, update: 0.282
[proc 4] 200 steps, total: 21.850, sample: 1.189, forward: 0.572, backward: 0.533, update: 0.259
[proc 6] 200 steps, total: 21.850, sample: 1.224, forward: 0.555, backward: 0.533, update: 0.264
[proc 1] 200 steps, total: 21.850, sample: 2.271, forward: 0.542, backward: 0.661, update: 0.228
[proc 7] 200 steps, total: 21.850, sample: 1.021, forward: 0.587, backward: 0.596, update: 0.226
W20240205 12:00:47.403981 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240205 12:00:47.522069 17304 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240205 12:00:47.645025 17303 parallel_pq_v2.h:79] insert failed, size(hashtable)=17181
W20240205 12:00:48.602066 17304 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240205 12:00:48.645007 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=3373
W20240205 12:00:48.695420 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=211, pq.top=211
E20240205 12:00:48.839068 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=212, sample_step_cpp_seen_[rank]=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 502.727 us                | 29.132 ms                 |
| ProcessBack:Shuffle       | 8.770 ms                  | 21.984 ms                 |
| ProcessBack:UpdateCache   | 10.670 ms                 | 18.875 ms                 |
| ProcessBack:UpsertPq      | 30.036 ms                 | 201.823 ms                |
| ProcessOneStep            | 104.920 ms                | 1.421 s                   |
| BlockToStepN              | 1.199 ms                  | 50.846 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:49.606144 17304 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
E20240205 12:00:49.649892 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.462 ms                  | 355.330 ms                |
| Forward                   | 5.570 ms                  | 16.442 ms                 |
| Backward                  | 5.666 ms                  | 10.355 ms                 |
| Optimize                  | 2.672 ms                  | 7.923 ms                  |
| BarrierTimeBeforeRank0    | 2.274 ms                  | 123.164 ms                |
| AfterBackward             | 108.089 ms                | 1.422 s                   |
| BlockToStepN              | 1.321 ms                  | 50.975 ms                 |
| OneStep                   | 152.122 ms                | 1.453 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:50.137744 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240205 12:00:50.610704 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240205 12:00:50.649010 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=4041
W20240205 12:00:51.261122 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=221, pq.top=221
E20240205 12:00:51.651940 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:00:51.790019 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
W20240205 12:00:52.356118 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=229, pq.top=229
E20240205 12:00:52.651010 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=42
W20240205 12:00:52.803257 17304 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
W20240205 12:00:53.554523 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=230, pq.top=230
E20240205 12:00:53.651010 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=5253
W20240205 12:00:53.828737 17304 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 382.350 us                | 5.645 ms                  |
| ProcessBack:Shuffle       | 8.840 ms                  | 23.983 ms                 |
| ProcessBack:UpdateCache   | 10.655 ms                 | 18.318 ms                 |
| ProcessBack:UpsertPq      | 29.739 ms                 | 193.443 ms                |
| ProcessOneStep            | 108.610 ms                | 1.421 s                   |
| BlockToStepN              | 1.292 ms                  | 50.846 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:00:54.651010 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=11720
W20240205 12:00:54.681228 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240205 12:00:54.842060 17304 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.595 ms                  | 355.330 ms                |
| Forward                   | 5.637 ms                  | 16.442 ms                 |
| Backward                  | 5.656 ms                  | 10.619 ms                 |
| Optimize                  | 2.698 ms                  | 7.923 ms                  |
| BarrierTimeBeforeRank0    | 2.432 ms                  | 123.164 ms                |
| AfterBackward             | 108.658 ms                | 1.422 s                   |
| BlockToStepN              | 1.384 ms                  | 50.975 ms                 |
| OneStep                   | 153.332 ms                | 1.453 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:00:55.651016 17335 parallel_pq_v2.h:79] insert failed, size(hashtable)=22627
W20240205 12:00:55.695091 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240205 12:00:55.918675 17304 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 12:00:55.958431 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=245, sample_step_cpp_seen_[rank]=244
E20240205 12:00:56.653383 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:00:56.954401 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240205 12:00:57.045500 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=246, pq.top=246
E20240205 12:00:57.653014 17312 parallel_pq_v2.h:79] insert failed, size(hashtable)=20213
W20240205 12:00:58.017041 17304 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
W20240205 12:00:58.154430 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=253, pq.top=253
E20240205 12:00:58.653208 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 487.589 us                | 12.246 ms                 |
| ProcessBack:Shuffle       | 8.790 ms                  | 23.983 ms                 |
| ProcessBack:UpdateCache   | 10.479 ms                 | 18.318 ms                 |
| ProcessBack:UpsertPq      | 29.051 ms                 | 193.443 ms                |
| ProcessOneStep            | 103.630 ms                | 1.300 s                   |
| BlockToStepN              | 1.429 ms                  | 55.587 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:00:59.024230 17304 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240205 12:00:59.653012 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=5864
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.941 ms                  | 354.089 ms                |
| Forward                   | 5.646 ms                  | 12.661 ms                 |
| Backward                  | 5.706 ms                  | 10.355 ms                 |
| Optimize                  | 2.678 ms                  | 7.495 ms                  |
| BarrierTimeBeforeRank0    | 2.404 ms                  | 105.984 ms                |
| AfterBackward             | 103.672 ms                | 1.300 s                   |
| BlockToStepN              | 1.524 ms                  | 62.534 ms                 |
| OneStep                   | 148.780 ms                | 1.370 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:00.088155 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 12:01:00.653012 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=17015
W20240205 12:01:00.980190 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=268, pq.top=267
W20240205 12:01:01.158226 17304 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
E20240205 12:01:01.653018 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=61
E20240205 12:01:01.839653 15619 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=275, sample_step_cpp_seen_[rank]=274
W20240205 12:01:02.250677 17304 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240205 12:01:02.653023 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=3592
W20240205 12:01:03.180759 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240205 12:01:03.266474 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240205 12:01:03.653008 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=11675
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 451.098 us                | 5.626 ms                  |
| ProcessBack:Shuffle       | 8.671 ms                  | 21.984 ms                 |
| ProcessBack:UpdateCache   | 10.348 ms                 | 18.245 ms                 |
| ProcessBack:UpsertPq      | 28.736 ms                 | 186.344 ms                |
| ProcessOneStep            | 103.156 ms                | 1.300 s                   |
| BlockToStepN              | 1.461 ms                  | 62.430 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:04.253036 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240205 12:01:04.388630 17304 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
E20240205 12:01:04.653009 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=445
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.937 ms                  | 354.089 ms                |
| Forward                   | 5.617 ms                  | 12.661 ms                 |
| Backward                  | 5.601 ms                  | 10.355 ms                 |
| Optimize                  | 2.672 ms                  | 7.495 ms                  |
| BarrierTimeBeforeRank0    | 2.404 ms                  | 105.984 ms                |
| AfterBackward             | 102.317 ms                | 1.300 s                   |
| BlockToStepN              | 1.601 ms                  | 62.534 ms                 |
| OneStep                   | 144.532 ms                | 1.370 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:05.533831 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240205 12:01:05.653012 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=3472
W20240205 12:01:06.118186 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240205 12:01:06.582211 17304 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
E20240205 12:01:06.653009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=16477
[proc 0] 300 steps, total: 19.844, sample: 1.602, forward: 0.560, backward: 0.626, update: 0.293
[proc 2] 300 steps, total: 19.844, sample: 1.574, forward: 0.538, backward: 0.711, update: 0.233
[proc 3] 300 steps, total: 19.844, sample: 1.116, forward: 0.504, backward: 0.543, update: 0.241
[proc 4] 300 steps, total: 19.844, sample: 1.112, forward: 0.565, backward: 0.556, update: 0.233
[proc 7] 300 steps, total: 19.844, sample: 0.918, forward: 0.577, backward: 0.628, update: 0.236
[proc 5] 300 steps, total: 19.844, sample: 0.979, forward: 0.589, backward: 0.594, update: 0.242
[proc 1] 300 steps, total: 19.844, sample: 1.338, forward: 0.569, backward: 0.603, update: 0.233
[proc 6] 300 steps, total: 19.844, sample: 1.130, forward: 0.590, backward: 0.585, update: 0.244
W20240205 12:01:07.321069 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=301, pq.top=301
E20240205 12:01:07.653014 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1466
W20240205 12:01:07.708439 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240205 12:01:08.096755 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=307, sample_step_cpp_seen_[rank]=306
E20240205 12:01:08.653014 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=2764
W20240205 12:01:08.783905 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 460.032 us                | 29.341 ms                 |
| ProcessBack:Shuffle       | 8.628 ms                  | 22.722 ms                 |
| ProcessBack:UpdateCache   | 10.240 ms                 | 18.245 ms                 |
| ProcessBack:UpsertPq      | 28.510 ms                 | 186.344 ms                |
| ProcessOneStep            | 101.320 ms                | 1.300 s                   |
| BlockToStepN              | 1.585 ms                  | 62.430 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:09.253001 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=308, pq.top=308
E20240205 12:01:09.653012 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=4394
W20240205 12:01:09.800944 17304 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.286 ms                  | 354.089 ms                |
| Forward                   | 5.619 ms                  | 12.661 ms                 |
| Backward                  | 5.567 ms                  | 10.355 ms                 |
| Optimize                  | 2.672 ms                  | 7.923 ms                  |
| BarrierTimeBeforeRank0    | 2.173 ms                  | 105.984 ms                |
| AfterBackward             | 101.368 ms                | 1.300 s                   |
| BlockToStepN              | 1.665 ms                  | 62.534 ms                 |
| OneStep                   | 144.568 ms                | 1.370 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:10.502319 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=315, pq.top=315
E20240205 12:01:10.653008 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=4193
W20240205 12:01:10.970269 17304 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
W20240205 12:01:11.502403 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=323, pq.top=323
E20240205 12:01:11.653013 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=2501
W20240205 12:01:12.047504 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240205 12:01:12.653008 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=11232
W20240205 12:01:12.967658 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=326, pq.top=326
W20240205 12:01:13.062418 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240205 12:01:13.653010 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1222
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 464.675 us                | 7.062 ms                  |
| ProcessBack:Shuffle       | 8.628 ms                  | 21.984 ms                 |
| ProcessBack:UpdateCache   | 10.112 ms                 | 16.843 ms                 |
| ProcessBack:UpsertPq      | 28.422 ms                 | 179.207 ms                |
| ProcessOneStep            | 101.229 ms                | 1.300 s                   |
| BlockToStepN              | 1.688 ms                  | 71.955 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:14.154455 17304 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
W20240205 12:01:14.189642 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=333, pq.top=333
E20240205 12:01:14.653010 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.506 ms                  | 354.089 ms                |
| Forward                   | 5.605 ms                  | 12.661 ms                 |
| Backward                  | 5.552 ms                  | 10.355 ms                 |
| Optimize                  | 2.647 ms                  | 7.923 ms                  |
| BarrierTimeBeforeRank0    | 2.525 ms                  | 123.164 ms                |
| AfterBackward             | 101.163 ms                | 1.300 s                   |
| BlockToStepN              | 1.895 ms                  | 72.036 ms                 |
| OneStep                   | 145.403 ms                | 1.370 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:15.192731 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=341, pq.top=341
W20240205 12:01:15.321395 17304 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 12:01:15.472927 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=342, sample_step_cpp_seen_[rank]=341
E20240205 12:01:15.653010 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
W20240205 12:01:16.367733 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240205 12:01:16.431144 17304 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240205 12:01:16.653010 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=336
W20240205 12:01:17.367076 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=351, pq.top=351
W20240205 12:01:17.598851 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240205 12:01:17.653018 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
E20240205 12:01:18.653012 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=22
W20240205 12:01:18.738102 17304 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 513.604 us                | 33.206 ms                 |
| ProcessBack:Shuffle       | 8.601 ms                  | 21.984 ms                 |
| ProcessBack:UpdateCache   | 10.036 ms                 | 16.843 ms                 |
| ProcessBack:UpsertPq      | 28.189 ms                 | 179.207 ms                |
| ProcessOneStep            | 98.984 ms                 | 1.234 s                   |
| BlockToStepN              | 1.896 ms                  | 71.955 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:19.418217 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=359, pq.top=359
E20240205 12:01:19.653009 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=661
W20240205 12:01:19.809701 17304 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.198 ms                  | 296.730 ms                |
| Forward                   | 5.567 ms                  | 11.106 ms                 |
| Backward                  | 5.527 ms                  | 10.266 ms                 |
| Optimize                  | 2.622 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 2.432 ms                  | 114.204 ms                |
| AfterBackward             | 99.049 ms                 | 1.235 s                   |
| BlockToStepN              | 1.997 ms                  | 72.036 ms                 |
| OneStep                   | 145.377 ms                | 1.254 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:20.589828 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=369, pq.top=369
E20240205 12:01:20.653049 17310 parallel_pq_v2.h:79] insert failed, size(hashtable)=42581
E20240205 12:01:20.902482 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=371, sample_step_cpp_seen_[rank]=370
W20240205 12:01:21.038357 17304 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 12:01:21.653019 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=4208
W20240205 12:01:22.046129 17304 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240205 12:01:22.214730 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=373, pq.top=373
E20240205 12:01:22.657960 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:01:23.119791 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240205 12:01:23.326049 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=381, pq.top=381
E20240205 12:01:23.657022 17313 parallel_pq_v2.h:79] insert failed, size(hashtable)=6107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 530.975 us                | 16.180 ms                 |
| ProcessBack:Shuffle       | 8.546 ms                  | 21.305 ms                 |
| ProcessBack:UpdateCache   | 9.963 ms                  | 16.821 ms                 |
| ProcessBack:UpsertPq      | 28.164 ms                 | 176.810 ms                |
| ProcessOneStep            | 99.205 ms                 | 1.234 s                   |
| BlockToStepN              | 1.960 ms                  | 71.955 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:24.341073 17304 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240205 12:01:24.663573 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.235 ms                  | 296.730 ms                |
| Forward                   | 5.513 ms                  | 11.106 ms                 |
| Backward                  | 5.482 ms                  | 10.266 ms                 |
| Optimize                  | 2.607 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 2.228 ms                  | 114.204 ms                |
| AfterBackward             | 99.252 ms                 | 1.235 s                   |
| BlockToStepN              | 2.058 ms                  | 72.036 ms                 |
| OneStep                   | 144.532 ms                | 1.254 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:25.189365 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=387, pq.top=387
W20240205 12:01:25.361348 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240205 12:01:25.663007 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=362
W20240205 12:01:26.266973 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=395, pq.top=395
W20240205 12:01:26.508695 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240205 12:01:26.663017 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=3536
[proc 6] 400 steps, total: 19.929, sample: 1.069, forward: 0.538, backward: 0.546, update: 0.242
[proc 5] 400 steps, total: 19.930, sample: 1.071, forward: 0.558, backward: 0.633, update: 0.236
[proc 7] 400 steps, total: 19.930, sample: 0.902, forward: 0.546, backward: 0.578, update: 0.240
[proc 4] 400 steps, total: 19.930, sample: 1.026, forward: 0.528, backward: 0.674, update: 0.230
[proc 2] 400 steps, total: 19.930, sample: 1.714, forward: 0.536, backward: 0.588, update: 0.246
[proc 3] 400 steps, total: 19.930, sample: 1.351, forward: 0.514, backward: 0.557, update: 0.228
[proc 1] 400 steps, total: 19.930, sample: 1.932, forward: 0.564, backward: 0.633, update: 0.252
[proc 0] 400 steps, total: 19.930, sample: 1.748, forward: 0.541, backward: 0.539, update: 0.281
W20240205 12:01:27.303800 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=402, pq.top=402
E20240205 12:01:27.497284 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=403, sample_step_cpp_seen_[rank]=402
W20240205 12:01:27.650609 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 12:01:27.663003 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=367
W20240205 12:01:28.650727 17304 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 12:01:28.663010 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1234
W20240205 12:01:28.774506 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=405, pq.top=405
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 525.008 us                | 7.685 ms                  |
| ProcessBack:Shuffle       | 8.545 ms                  | 21.984 ms                 |
| ProcessBack:UpdateCache   | 9.948 ms                  | 16.821 ms                 |
| ProcessBack:UpsertPq      | 28.099 ms                 | 176.810 ms                |
| ProcessOneStep            | 99.205 ms                 | 1.234 s                   |
| BlockToStepN              | 2.011 ms                  | 71.955 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:01:29.663012 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=58696
W20240205 12:01:29.666754 17304 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
W20240205 12:01:29.774951 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=411, pq.top=411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.944 ms                  | 296.730 ms                |
| Forward                   | 5.517 ms                  | 11.106 ms                 |
| Backward                  | 5.438 ms                  | 10.355 ms                 |
| Optimize                  | 2.613 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 2.228 ms                  | 114.204 ms                |
| AfterBackward             | 99.252 ms                 | 1.235 s                   |
| BlockToStepN              | 2.127 ms                  | 72.036 ms                 |
| OneStep                   | 144.261 ms                | 1.261 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:01:30.663015 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=18983
W20240205 12:01:30.804347 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=419, pq.top=419
W20240205 12:01:30.839429 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 12:01:31.663010 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
W20240205 12:01:31.923504 17304 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
E20240205 12:01:32.663293 16563 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 12:01:32.700913 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=426, pq.top=426
W20240205 12:01:32.926728 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240205 12:01:33.663015 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=53501
W20240205 12:01:33.736116 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=434, pq.top=433
W20240205 12:01:33.942341 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 575.134 us                | 18.446 ms                 |
| ProcessBack:Shuffle       | 8.581 ms                  | 21.305 ms                 |
| ProcessBack:UpdateCache   | 9.953 ms                  | 16.534 ms                 |
| ProcessBack:UpsertPq      | 28.148 ms                 | 167.228 ms                |
| ProcessOneStep            | 99.205 ms                 | 1.234 s                   |
| BlockToStepN              | 2.058 ms                  | 72.719 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:01:34.446938 15619 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=438, sample_step_cpp_seen_[rank]=437
E20240205 12:01:34.663007 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=2054
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.865 ms                  | 296.730 ms                |
| Forward                   | 5.511 ms                  | 11.106 ms                 |
| Backward                  | 5.447 ms                  | 10.355 ms                 |
| Optimize                  | 2.607 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 2.226 ms                  | 114.204 ms                |
| AfterBackward             | 99.049 ms                 | 1.235 s                   |
| BlockToStepN              | 2.156 ms                  | 72.850 ms                 |
| OneStep                   | 144.261 ms                | 1.261 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:34.972437 17304 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240205 12:01:35.663012 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=64522
W20240205 12:01:36.094491 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
W20240205 12:01:36.387912 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=448, pq.top=448
E20240205 12:01:36.663012 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=66
W20240205 12:01:37.271368 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 12:01:37.663012 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1393
W20240205 12:01:38.291205 17304 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 12:01:38.663019 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=22
W20240205 12:01:38.850126 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=457, pq.top=457
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 532.754 us                | 8.288 ms                  |
| ProcessBack:Shuffle       | 8.666 ms                  | 21.305 ms                 |
| ProcessBack:UpdateCache   | 10.007 ms                 | 16.821 ms                 |
| ProcessBack:UpsertPq      | 28.167 ms                 | 167.228 ms                |
| ProcessOneStep            | 99.205 ms                 | 1.223 s                   |
| BlockToStepN              | 2.058 ms                  | 71.955 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:39.385087 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
E20240205 12:01:39.663014 17322 parallel_pq_v2.h:79] insert failed, size(hashtable)=3865
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.571 ms                  | 259.452 ms                |
| Forward                   | 5.520 ms                  | 10.881 ms                 |
| Backward                  | 5.423 ms                  | 10.266 ms                 |
| Optimize                  | 2.596 ms                  | 7.495 ms                  |
| BarrierTimeBeforeRank0    | 2.393 ms                  | 114.204 ms                |
| AfterBackward             | 99.779 ms                 | 1.223 s                   |
| BlockToStepN              | 2.198 ms                  | 72.036 ms                 |
| OneStep                   | 144.532 ms                | 1.254 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:01:40.052091 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=467, pq.top=467
E20240205 12:01:40.384930 16563 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=469, sample_step_cpp_seen_[rank]=468
W20240205 12:01:40.568054 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 12:01:40.667476 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:01:41.403558 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=470, pq.top=469
W20240205 12:01:41.584969 17304 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 12:01:41.667009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=32145
W20240205 12:01:42.545565 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=477, pq.top=477
E20240205 12:01:42.667011 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=53891
W20240205 12:01:42.675804 17304 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
W20240205 12:01:43.545279 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=485, pq.top=485
E20240205 12:01:43.667009 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=32
W20240205 12:01:43.835239 17304 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 620.585 us                | 21.269 ms                 |
| ProcessBack:Shuffle       | 8.677 ms                  | 20.427 ms                 |
| ProcessBack:UpdateCache   | 10.011 ms                 | 16.534 ms                 |
| ProcessBack:UpsertPq      | 28.099 ms                 | 161.677 ms                |
| ProcessOneStep            | 99.732 ms                 | 1.223 s                   |
| BlockToStepN              | 2.170 ms                  | 72.719 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:01:44.667016 17328 parallel_pq_v2.h:79] insert failed, size(hashtable)=36079
W20240205 12:01:44.694304 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240205 12:01:44.838598 17304 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.461 ms                  | 259.452 ms                |
| Forward                   | 5.517 ms                  | 10.881 ms                 |
| Backward                  | 5.406 ms                  | 10.266 ms                 |
| Optimize                  | 2.607 ms                  | 7.495 ms                  |
| BarrierTimeBeforeRank0    | 2.295 ms                  | 114.204 ms                |
| AfterBackward             | 100.622 ms                | 1.223 s                   |
| BlockToStepN              | 2.268 ms                  | 72.850 ms                 |
| OneStep                   | 144.532 ms                | 1.254 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:01:45.667009 17304 parallel_pq_v2.h:79] insert failed, size(hashtable)=186510
W20240205 12:01:45.853201 17304 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
W20240205 12:01:45.986003 15619 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=495, pq.top=495
E20240205 12:01:46.667008 15619 parallel_pq_v2.h:79] insert failed, size(hashtable)=4111
[proc 5] 500 steps, total: 19.806, sample: 1.014, forward: 0.543, backward: 0.615, update: 0.240
[proc 6] 500 steps, total: 19.806, sample: 1.110, forward: 0.524, backward: 0.535, update: 0.241
[proc 4] 500 steps, total: 19.806, sample: 1.100, forward: 0.569, backward: 0.561, update: 0.238
[proc 3] 500 steps, total: 19.805, sample: 1.293, forward: 0.499, backward: 0.588, update: 0.248
[proc 2] 500 steps, total: 19.806, sample: 1.603, forward: 0.564, backward: 0.627, update: 0.258
[proc 0] 500 steps, total: 19.804, sample: 1.310, forward: 0.570, backward: 0.562, update: 0.281
[proc 1] 500 steps, total: 19.805, sample: 1.544, forward: 0.560, backward: 0.598, update: 0.241
[proc 7] 500 steps, total: 19.806, sample: 0.969, forward: 0.576, backward: 0.586, update: 0.240
Successfully xmh. training takes 106.83468508720398 seconds
before call kg_cache_controller.StopThreads()
W20240205 12:01:46.843477 15619 grad_async_v2.h:84] call StopThreads. PID = 53919
W20240205 12:01:46.843523 15619 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 12:01:46.843931 15619 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 12:01:46.843940 15619 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240205 12:01:46.951356 17304 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240205 12:01:47.466498 15619 grad_async_v2.h:105] StopThreads done.
