perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fed90f79ee0>==========
Worker 0 pid=5161
Worker 1 pid=5162
Worker 2 pid=5163
Worker 3 pid=5164
Worker 4 pid=5165
Worker 5 pid=5172
Worker 6 pid=5173
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [distributed_c10d.py:466] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([10000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([10000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([10000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([10000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([10000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([10000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([10000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([10000000, 32])
Step99:rank5, time: 27.641, per_step: 0.276413
Step99:rank3, time: 27.607, per_step: 0.276072
Step99:rank2, time: 27.642, per_step: 0.276422
Step99:rank4, time: 27.761, per_step: 0.277609
Step99:rank1, time: 27.546, per_step: 0.275460
Step99:rank6, time: 27.710, per_step: 0.277099
Step99:rank7, time: 27.541, per_step: 0.275407
Step99:rank0, time: 27.595, per_step: 0.275954
Step199:rank4, time: 25.654, per_step: 0.254002
Step199:rank2, time: 25.658, per_step: 0.254040
Step199:rank1, time: 25.640, per_step: 0.253859
Step199:rank3, time: 25.668, per_step: 0.254134
Step199:rank7, time: 25.638, per_step: 0.253841
Step199:rank5, time: 25.686, per_step: 0.254318
Step199:rank6, time: 25.641, per_step: 0.253869
Step199:rank0, time: 25.641, per_step: 0.253871
Step299:rank3, time: 25.596, per_step: 0.253430
Step299:rank6, time: 25.590, per_step: 0.253371
Step299:rank7, time: 25.594, per_step: 0.253410
Step299:rank5, time: 25.595, per_step: 0.253412
Step299:rank1, time: 25.606, per_step: 0.253522
Step299:rank4, time: 25.609, per_step: 0.253550
Step299:rank2, time: 25.622, per_step: 0.253680
Step299:rank0, time: 25.617, per_step: 0.253631
Step399:rank4, time: 26.022, per_step: 0.257643
Step399:rank3, time: 26.025, per_step: 0.257671
Step399:rank2, time: 26.009, per_step: 0.257514
Step399:rank5, time: 26.023, per_step: 0.257653
Step399:rank1, time: 26.026, per_step: 0.257687
Step399:rank6, time: 26.030, per_step: 0.257721
Step399:rank7, time: 26.039, per_step: 0.257812
Step399:rank0, time: 26.014, per_step: 0.257567
Step499:rank5, time: 25.482, per_step: 0.252293
Step499:rank2, time: 25.494, per_step: 0.252413
Step499:rank1, time: 25.493, per_step: 0.252405
Step499:rank4, time: 25.497, per_step: 0.252448
Step499:rank7, time: 25.483, per_step: 0.252306
Step499:rank6, time: 25.495, per_step: 0.252430
Step499:rank3, time: 25.511, per_step: 0.252584
Step499:rank0, time: 25.506, per_step: 0.252534
Worker 7 pid=5174
Successfully xmh
