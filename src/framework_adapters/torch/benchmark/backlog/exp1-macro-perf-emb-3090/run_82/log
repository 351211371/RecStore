perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fab2d84cee0>==========
Worker 0 pid=20430
Worker 1 pid=20431
Worker 2 pid=20432
Worker 3 pid=20433
Worker 4 pid=20434
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
Step99:rank5, time: 46.085, per_step: 0.460855
Step99:rank3, time: 45.932, per_step: 0.459315
Step99:rank4, time: 45.892, per_step: 0.458921
Step99:rank1, time: 46.143, per_step: 0.461428
Step99:rank2, time: 45.818, per_step: 0.458182
Step99:rank0, time: 45.922, per_step: 0.459216
Step199:rank1, time: 44.220, per_step: 0.437822
Step199:rank4, time: 44.220, per_step: 0.437824
Step199:rank3, time: 44.221, per_step: 0.437827
Step199:rank2, time: 44.220, per_step: 0.437825
Step199:rank5, time: 44.221, per_step: 0.437834
Step199:rank0, time: 44.298, per_step: 0.438598
Step299:rank1, time: 43.698, per_step: 0.432653
Step299:rank5, time: 43.697, per_step: 0.432645
Step299:rank3, time: 43.698, per_step: 0.432653
Step299:rank2, time: 43.698, per_step: 0.432655
Step299:rank4, time: 43.699, per_step: 0.432659
Step299:rank0, time: 43.639, per_step: 0.432073
Step399:rank1, time: 43.568, per_step: 0.431363
Step399:rank3, time: 43.568, per_step: 0.431363
Step399:rank5, time: 43.568, per_step: 0.431369
Step399:rank2, time: 43.568, per_step: 0.431366
Step399:rank4, time: 43.568, per_step: 0.431365
Step399:rank0, time: 43.615, per_step: 0.431828
Step499:rank3, time: 44.017, per_step: 0.435814
Step499:rank1, time: 44.018, per_step: 0.435821
Step499:rank4, time: 44.017, per_step: 0.435812
Step499:rank2, time: 44.017, per_step: 0.435814
Step499:rank5, time: 44.018, per_step: 0.435822
Step499:rank0, time: 44.016, per_step: 0.435800
Worker 5 pid=20435
Successfully xmh
