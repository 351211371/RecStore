perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f0b300e1ee0>==========
Worker 0 pid=34720
Worker 1 pid=34721
Worker 2 pid=34722
Worker 3 pid=34723
Worker 4 pid=34724
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
Step99:rank4, time: 23.916, per_step: 0.239162
Step99:rank5, time: 24.005, per_step: 0.240048
Step99:rank2, time: 23.995, per_step: 0.239947
Step99:rank3, time: 24.037, per_step: 0.240375
Step99:rank1, time: 23.923, per_step: 0.239229
Step99:rank0, time: 23.975, per_step: 0.239754
Step199:rank2, time: 22.919, per_step: 0.226923
Step199:rank4, time: 22.920, per_step: 0.226927
Step199:rank3, time: 22.918, per_step: 0.226914
Step199:rank5, time: 22.920, per_step: 0.226927
Step199:rank1, time: 22.914, per_step: 0.226869
Step199:rank0, time: 22.916, per_step: 0.226895
Step299:rank1, time: 22.407, per_step: 0.221847
Step299:rank4, time: 22.408, per_step: 0.221858
Step299:rank2, time: 22.408, per_step: 0.221858
Step299:rank5, time: 22.407, per_step: 0.221855
Step299:rank3, time: 22.407, per_step: 0.221856
Step299:rank0, time: 22.416, per_step: 0.221937
Step399:rank1, time: 22.808, per_step: 0.225819
Step399:rank5, time: 22.807, per_step: 0.225814
Step399:rank4, time: 22.808, per_step: 0.225826
Step399:rank3, time: 22.808, per_step: 0.225825
Step399:rank2, time: 22.809, per_step: 0.225829
Step399:rank0, time: 22.801, per_step: 0.225756
Step499:rank1, time: 22.571, per_step: 0.223473
Step499:rank2, time: 22.569, per_step: 0.223460
Step499:rank4, time: 22.571, per_step: 0.223476
Step499:rank5, time: 22.573, per_step: 0.223496
Step499:rank3, time: 22.573, per_step: 0.223497
Step499:rank0, time: 22.587, per_step: 0.223629
Worker 5 pid=34731
Successfully xmh
