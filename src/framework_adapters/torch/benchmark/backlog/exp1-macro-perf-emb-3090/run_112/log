perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7ff54433aee0>==========
Worker 0 pid=53248
Worker 1 pid=53249
Worker 2 pid=53250
Worker 3 pid=53251
Worker 4 pid=53252
Worker 5 pid=53255
Worker 6 pid=53260
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
Step99:rank7, time: 28.521, per_step: 0.285208
Step99:rank2, time: 28.697, per_step: 0.286967
Step99:rank4, time: 28.620, per_step: 0.286197
Step99:rank6, time: 28.423, per_step: 0.284231
Step99:rank3, time: 28.771, per_step: 0.287707
Step99:rank5, time: 28.373, per_step: 0.283733
Step99:rank1, time: 28.697, per_step: 0.286965
Step99:rank0, time: 28.529, per_step: 0.285293
Step199:rank2, time: 25.943, per_step: 0.256858
Step199:rank3, time: 25.943, per_step: 0.256858
Step199:rank6, time: 25.943, per_step: 0.256859
Step199:rank7, time: 25.943, per_step: 0.256865
Step199:rank4, time: 25.943, per_step: 0.256863
Step199:rank1, time: 25.943, per_step: 0.256861
Step199:rank5, time: 25.944, per_step: 0.256874
Step199:rank0, time: 25.962, per_step: 0.257049
Step299:rank2, time: 26.080, per_step: 0.258216
Step299:rank4, time: 26.079, per_step: 0.258211
Step299:rank3, time: 26.080, per_step: 0.258214
Step299:rank6, time: 26.080, per_step: 0.258215
Step299:rank7, time: 26.080, per_step: 0.258215
Step299:rank1, time: 26.079, per_step: 0.258212
Step299:rank5, time: 26.079, per_step: 0.258204
Step299:rank0, time: 26.054, per_step: 0.257964
Step399:rank5, time: 25.911, per_step: 0.256547
Step399:rank6, time: 25.912, per_step: 0.256557
Step399:rank3, time: 25.912, per_step: 0.256558
Step399:rank4, time: 25.913, per_step: 0.256560
Step399:rank7, time: 25.912, per_step: 0.256555
Step399:rank1, time: 25.912, per_step: 0.256555
Step399:rank2, time: 25.913, per_step: 0.256564
Step399:rank0, time: 25.917, per_step: 0.256606
Step499:rank6, time: 26.284, per_step: 0.260242
Step499:rank2, time: 26.284, per_step: 0.260242
Step499:rank4, time: 26.285, per_step: 0.260246
Step499:rank3, time: 26.285, per_step: 0.260246
Step499:rank1, time: 26.285, per_step: 0.260245
Step499:rank7, time: 26.285, per_step: 0.260246
Step499:rank5, time: 26.288, per_step: 0.260278
Step499:rank0, time: 26.288, per_step: 0.260273
Worker 7 pid=53261
Successfully xmh
