perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f945d6b4ee0>==========
Worker 0 pid=3519
Worker 1 pid=3520
Worker 2 pid=3521
Worker 3 pid=3522
Worker 4 pid=3532
Worker 5 pid=3533
Worker 6 pid=3534
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
Step99:rank5, time: 52.540, per_step: 0.525398
Step99:rank4, time: 52.326, per_step: 0.523256
Step99:rank7, time: 52.486, per_step: 0.524861
Step99:rank1, time: 52.160, per_step: 0.521597
Step99:rank2, time: 52.186, per_step: 0.521858
Step99:rank6, time: 52.360, per_step: 0.523596
Step99:rank3, time: 52.414, per_step: 0.524137
Step99:rank0, time: 52.615, per_step: 0.526146
Step199:rank2, time: 50.453, per_step: 0.499539
Step199:rank5, time: 50.456, per_step: 0.499561
Step199:rank1, time: 50.454, per_step: 0.499545
Step199:rank7, time: 50.455, per_step: 0.499559
Step199:rank3, time: 50.443, per_step: 0.499432
Step199:rank6, time: 50.454, per_step: 0.499544
Step199:rank4, time: 50.456, per_step: 0.499563
Step199:rank0, time: 50.458, per_step: 0.499585
Step299:rank5, time: 50.136, per_step: 0.496393
Step299:rank1, time: 50.136, per_step: 0.496393
Step299:rank4, time: 50.135, per_step: 0.496391
Step299:rank2, time: 50.136, per_step: 0.496399
Step299:rank7, time: 50.136, per_step: 0.496394
Step299:rank3, time: 50.136, per_step: 0.496394
Step299:rank6, time: 50.148, per_step: 0.496511
Step299:rank0, time: 50.195, per_step: 0.496977
Step399:rank7, time: 50.111, per_step: 0.496147
Step399:rank3, time: 50.111, per_step: 0.496151
Step399:rank6, time: 50.100, per_step: 0.496040
Step399:rank1, time: 50.112, per_step: 0.496159
Step399:rank4, time: 50.112, per_step: 0.496159
Step399:rank5, time: 50.112, per_step: 0.496161
Step399:rank2, time: 50.112, per_step: 0.496158
Step399:rank0, time: 50.124, per_step: 0.496272
Step499:rank2, time: 50.117, per_step: 0.496206
Step499:rank3, time: 50.117, per_step: 0.496213
Step499:rank6, time: 50.117, per_step: 0.496212
Step499:rank5, time: 50.117, per_step: 0.496211
Step499:rank1, time: 50.118, per_step: 0.496215
Step499:rank4, time: 50.119, per_step: 0.496231
Step499:rank7, time: 50.120, per_step: 0.496240
Step499:rank0, time: 50.081, per_step: 0.495853
Worker 7 pid=3535
Successfully xmh
