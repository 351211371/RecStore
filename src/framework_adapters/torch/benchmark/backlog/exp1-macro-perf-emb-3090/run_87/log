perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f54c03faee0>==========
Worker 0 pid=47346
Worker 1 pid=47347
Worker 2 pid=47348
Worker 3 pid=47349
Worker 4 pid=47350
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
Step99:rank3, time: 76.603, per_step: 0.766028
Step99:rank4, time: 77.219, per_step: 0.772185
Step99:rank0, time: 77.243, per_step: 0.772432
Step99:rank2, time: 77.580, per_step: 0.775802
Step99:rank5, time: 78.645, per_step: 0.786452
Step99:rank1, time: 79.245, per_step: 0.792448
Step199:rank5, time: 72.171, per_step: 0.714569
Step199:rank4, time: 74.852, per_step: 0.741107
Step199:rank0, time: 74.895, per_step: 0.741531
Step199:rank2, time: 76.354, per_step: 0.755984
Step199:rank3, time: 78.887, per_step: 0.781061
Step199:rank1, time: 77.475, per_step: 0.767080
Step299:rank5, time: 72.970, per_step: 0.722475
Step299:rank2, time: 72.193, per_step: 0.714780
Step299:rank4, time: 74.814, per_step: 0.740736
Step299:rank0, time: 76.095, per_step: 0.753416
Step299:rank3, time: 79.588, per_step: 0.787996
Step299:rank1, time: 81.430, per_step: 0.806238
Step399:rank5, time: 74.765, per_step: 0.740243
Step399:rank2, time: 75.047, per_step: 0.743043
Step399:rank4, time: 74.423, per_step: 0.736865
Step399:rank0, time: 76.886, per_step: 0.761244
Step399:rank3, time: 73.282, per_step: 0.725564
Step399:rank1, time: 77.003, per_step: 0.762406
Step499:rank5, time: 73.642, per_step: 0.729128
Step499:rank2, time: 72.587, per_step: 0.718686
Step499:rank4, time: 76.503, per_step: 0.757460
Step499:rank0, time: 74.512, per_step: 0.737742
Step499:rank3, time: 73.534, per_step: 0.728064
Step499:rank1, time: 68.911, per_step: 0.682282
Worker 5 pid=47351
Successfully xmh
