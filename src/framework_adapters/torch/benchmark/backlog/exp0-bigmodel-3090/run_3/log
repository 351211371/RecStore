Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
|Train|: 304727650
random partition 304727650 edges into 4 parts
part 0 has 76181913 edges
part 1 has 76181913 edges
part 2 has 76181913 edges
part 3 has 76181911 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=None, batch_size=1000, batch_size_eval=16, data_files=None, data_path='/home/xieminhui/dgl-data', dataset='Freebase', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3], has_edge_importance=False, hidden_dim=100, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=86054151, no_eval_filter=False, no_save_emb=True, nr_gpus=4, num_proc=4, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='/tmp/ckpts/TransE_l1_Freebase_13', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 16929318
|test|: 16929308
Total initialize time 537.183 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 3][Train](1000/10000) average pos_loss: 0.7094562748074531
[proc 3][Train](1000/10000) average neg_loss: 0.780858816742897
[proc 3][Train](1000/10000) average loss: 0.7451575453877449
[proc 3][Train](1000/10000) average regularization: 9.02192026405828e-05
[proc 3] 1000 steps, total: 31.250, sample: 17.303, forward: 6.882, backward: 2.791, update: 3.094
[proc 2][Train](1000/10000) average pos_loss: 0.7080628189444542
[proc 2][Train](1000/10000) average neg_loss: 0.7770863011479378
[proc 2][Train](1000/10000) average loss: 0.7425745606422425
[proc 2][Train](1000/10000) average regularization: 9.170697035006014e-05
[proc 2] 1000 steps, total: 31.755, sample: 18.754, forward: 7.007, backward: 2.870, update: 3.116
[proc 0][Train](1000/10000) average pos_loss: 0.710994213193655
[proc 0][Train](1000/10000) average neg_loss: 0.7896738991737365
[proc 0][Train](1000/10000) average loss: 0.7503340563774109
[proc 0][Train](1000/10000) average regularization: 8.799691154490575e-05
[proc 0] 1000 steps, total: 32.723, sample: 17.206, forward: 7.157, backward: 2.776, update: 3.134
[proc 1][Train](1000/10000) average pos_loss: 0.7107550295889378
[proc 1][Train](1000/10000) average neg_loss: 0.7845128256082535
[proc 1][Train](1000/10000) average loss: 0.7476339285373688
[proc 1][Train](1000/10000) average regularization: 8.884216339356498e-05
[proc 1] 1000 steps, total: 32.247, sample: 17.524, forward: 6.934, backward: 2.695, update: 3.054
[proc 2][Train](2000/10000) average pos_loss: 0.6930570202469826
[proc 2][Train](2000/10000) average neg_loss: 0.7565004077553749
[proc 2][Train](2000/10000) average loss: 0.7247787142395973
[proc 2][Train](2000/10000) average regularization: 0.00010657746698416304
[proc 2] 2000 steps, total: 11.370, sample: 2.169, forward: 3.585, backward: 2.751, update: 2.859
[proc 1][Train](2000/10000) average pos_loss: 0.6951574748754501
[proc 1][Train](2000/10000) average neg_loss: 0.7565401931405067
[proc 1][Train](2000/10000) average loss: 0.7258488343954086
[proc 1][Train](2000/10000) average regularization: 0.00010633361356303794
[proc 1] 2000 steps, total: 11.370, sample: 2.110, forward: 3.368, backward: 2.811, update: 2.875
[proc 3][Train](2000/10000) average pos_loss: 0.6944362919330597
[proc 3][Train](2000/10000) average neg_loss: 0.7568310189247132
[proc 3][Train](2000/10000) average loss: 0.7256336560249329
[proc 3][Train](2000/10000) average regularization: 0.00010652372062031645
[proc 3] 2000 steps, total: 11.371, sample: 2.207, forward: 3.416, backward: 2.768, update: 2.908
[proc 0][Train](2000/10000) average pos_loss: 0.693945726454258
[proc 0][Train](2000/10000) average neg_loss: 0.756551762342453
[proc 0][Train](2000/10000) average loss: 0.7252487444877624
[proc 0][Train](2000/10000) average regularization: 0.00010652659230981953
[proc 0] 2000 steps, total: 11.370, sample: 2.180, forward: 3.375, backward: 2.836, update: 2.889
[proc 0][Train](3000/10000) average pos_loss: 0.6860469371080399
[proc 0][Train](3000/10000) average neg_loss: 0.7452675664424896
[proc 0][Train](3000/10000) average loss: 0.7156572521924972
[proc 0][Train](3000/10000) average regularization: 0.00011715368692239281
[proc 0] 3000 steps, total: 11.430, sample: 2.138, forward: 3.323, backward: 3.160, update: 2.802
[proc 1][Train](3000/10000) average pos_loss: 0.686344029724598
[proc 1][Train](3000/10000) average neg_loss: 0.7451778519153595
[proc 1][Train](3000/10000) average loss: 0.71576094019413
[proc 1][Train](3000/10000) average regularization: 0.00011710106102691498
[proc 1] 3000 steps, total: 11.431, sample: 2.111, forward: 3.278, backward: 3.130, update: 2.805
[proc 2][Train](3000/10000) average pos_loss: 0.6857722125649452
[proc 2][Train](3000/10000) average neg_loss: 0.7443836990594864
[proc 2][Train](3000/10000) average loss: 0.7150779552459717
[proc 2][Train](3000/10000) average regularization: 0.00011705996116506867
[proc 2] 3000 steps, total: 11.432, sample: 2.129, forward: 3.531, backward: 2.762, update: 2.756
[proc 3][Train](3000/10000) average pos_loss: 0.6865516074895859
[proc 3][Train](3000/10000) average neg_loss: 0.7449488711357116
[proc 3][Train](3000/10000) average loss: 0.7157502399086952
[proc 3][Train](3000/10000) average regularization: 0.00011714395592571237
[proc 3] 3000 steps, total: 11.431, sample: 2.170, forward: 3.403, backward: 2.903, update: 2.786
[proc 1][Train](4000/10000) average pos_loss: 0.6806381674408912
[proc 1][Train](4000/10000) average neg_loss: 0.736610032081604
[proc 1][Train](4000/10000) average loss: 0.7086240994930267
[proc 1][Train](4000/10000) average regularization: 0.00012470861813926602
[proc 1] 4000 steps, total: 11.241, sample: 2.170, forward: 3.279, backward: 3.084, update: 2.701
[proc 0][Train](4000/10000) average pos_loss: 0.6802808644771576
[proc 0][Train](4000/10000) average neg_loss: 0.7361676852703094
[proc 0][Train](4000/10000) average loss: 0.7082242743372917
[proc 0][Train](4000/10000) average regularization: 0.0001245744293264579
[proc 0] 4000 steps, total: 11.242, sample: 2.107, forward: 3.276, backward: 2.774, update: 2.698
[proc 2][Train](4000/10000) average pos_loss: 0.6803371669650078
[proc 2][Train](4000/10000) average neg_loss: 0.73708417314291
[proc 2][Train](4000/10000) average loss: 0.7087106699347496
[proc 2][Train](4000/10000) average regularization: 0.0001246434150962159
[proc 2] 4000 steps, total: 11.241, sample: 2.101, forward: 3.506, backward: 2.888, update: 2.688
[proc 3][Train](4000/10000) average pos_loss: 0.6804383468627929
[proc 3][Train](4000/10000) average neg_loss: 0.7366493142843247
[proc 3][Train](4000/10000) average loss: 0.7085438314676284
[proc 3][Train](4000/10000) average regularization: 0.00012461279371927958
[proc 3] 4000 steps, total: 11.241, sample: 2.223, forward: 3.347, backward: 2.758, update: 2.731
[proc 0][Train](5000/10000) average pos_loss: 0.6751435291171074
[proc 0][Train](5000/10000) average neg_loss: 0.7295787979364395
[proc 0][Train](5000/10000) average loss: 0.7023611639738083
[proc 0][Train](5000/10000) average regularization: 0.0001301464420685079
[proc 0] 5000 steps, total: 11.049, sample: 2.252, forward: 3.279, backward: 2.744, update: 2.751
[proc 3][Train](5000/10000) average pos_loss: 0.6754429790377617
[proc 3][Train](5000/10000) average neg_loss: 0.7295956246852875
[proc 3][Train](5000/10000) average loss: 0.7025193015933037
[proc 3][Train](5000/10000) average regularization: 0.00013009609760774766
[proc 3] 5000 steps, total: 11.049, sample: 2.274, forward: 3.268, backward: 2.775, update: 2.615
[proc 2][Train](5000/10000) average pos_loss: 0.6755128582715988
[proc 2][Train](5000/10000) average neg_loss: 0.7294933382868767
[proc 2][Train](5000/10000) average loss: 0.7025030983686447
[proc 2][Train](5000/10000) average regularization: 0.00013012793293455617
[proc 2] 5000 steps, total: 11.049, sample: 2.253, forward: 3.478, backward: 2.725, update: 2.586
[proc 1][Train](5000/10000) average pos_loss: 0.6757809308171272
[proc 1][Train](5000/10000) average neg_loss: 0.7298809370994568
[proc 1][Train](5000/10000) average loss: 0.7028309335112571
[proc 1][Train](5000/10000) average regularization: 0.00013008232225547546
[proc 1] 5000 steps, total: 11.050, sample: 2.283, forward: 3.228, backward: 2.777, update: 2.593
[proc 2][Train](6000/10000) average pos_loss: 0.671322478055954
[proc 2][Train](6000/10000) average neg_loss: 0.7241335183382034
[proc 2][Train](6000/10000) average loss: 0.697727997481823
[proc 2][Train](6000/10000) average regularization: 0.00013419756809889805
[proc 2] 6000 steps, total: 10.881, sample: 2.032, forward: 3.500, backward: 2.758, update: 2.584
[proc 0][Train](6000/10000) average pos_loss: 0.6720824482440948
[proc 0][Train](6000/10000) average neg_loss: 0.7243186379075051
[proc 0][Train](6000/10000) average loss: 0.6982005439400673
[proc 0][Train](6000/10000) average regularization: 0.0001341835949133383
[proc 0] 6000 steps, total: 10.882, sample: 2.041, forward: 3.240, backward: 2.714, update: 2.621
[proc 3][Train](6000/10000) average pos_loss: 0.6706664840579033
[proc 3][Train](6000/10000) average neg_loss: 0.7237303288578987
[proc 3][Train](6000/10000) average loss: 0.6971984060406685
[proc 3][Train](6000/10000) average regularization: 0.00013425814497168177
[proc 3] 6000 steps, total: 10.882, sample: 2.103, forward: 3.189, backward: 2.750, update: 2.537
[proc 1][Train](6000/10000) average pos_loss: 0.6711141240000725
[proc 1][Train](6000/10000) average neg_loss: 0.7237203606367111
[proc 1][Train](6000/10000) average loss: 0.6974172415137291
[proc 1][Train](6000/10000) average regularization: 0.00013424881355604158
[proc 1] 6000 steps, total: 10.882, sample: 2.077, forward: 3.246, backward: 2.693, update: 2.569
[proc 1][Train](7000/10000) average pos_loss: 0.6670080442428589
[proc 1][Train](7000/10000) average neg_loss: 0.7189075863957405
[proc 1][Train](7000/10000) average loss: 0.6929578152894974
[proc 1][Train](7000/10000) average regularization: 0.00013755964212759864
[proc 1] 7000 steps, total: 10.790, sample: 2.111, forward: 3.285, backward: 2.746, update: 2.641
[proc 2][Train](7000/10000) average pos_loss: 0.6665190698504448
[proc 2][Train](7000/10000) average neg_loss: 0.7182096527218819
[proc 2][Train](7000/10000) average loss: 0.692364361345768
[proc 2][Train](7000/10000) average regularization: 0.00013754386450455058
[proc 2] 7000 steps, total: 10.791, sample: 2.078, forward: 3.445, backward: 2.707, update: 2.517
[proc 3][Train](7000/10000) average pos_loss: 0.6667664141654969
[proc 3][Train](7000/10000) average neg_loss: 0.7180349686145783
[proc 3][Train](7000/10000) average loss: 0.6924006913304329
[proc 3][Train](7000/10000) average regularization: 0.00013753095421998297
[proc 3] 7000 steps, total: 10.791, sample: 2.076, forward: 3.294, backward: 2.764, update: 2.574
[proc 0][Train](7000/10000) average pos_loss: 0.6669046503305435
[proc 0][Train](7000/10000) average neg_loss: 0.7183148461580277
[proc 0][Train](7000/10000) average loss: 0.6926097485423088
[proc 0][Train](7000/10000) average regularization: 0.00013750726911530365
[proc 0] 7000 steps, total: 10.791, sample: 2.056, forward: 3.294, backward: 2.691, update: 2.666
[proc 2][Train](8000/10000) average pos_loss: 0.6624389285445214
[proc 2][Train](8000/10000) average neg_loss: 0.7137996279001236
[proc 2][Train](8000/10000) average loss: 0.688119278728962
[proc 2][Train](8000/10000) average regularization: 0.000140307410954847
[proc 2] 8000 steps, total: 10.956, sample: 2.257, forward: 3.671, backward: 2.294, update: 2.727
[proc 0][Train](8000/10000) average pos_loss: 0.6630999442338944
[proc 0][Train](8000/10000) average neg_loss: 0.7139015004038811
[proc 0][Train](8000/10000) average loss: 0.6885007221102715
[proc 0][Train](8000/10000) average regularization: 0.00014023319621628616
[proc 0] 8000 steps, total: 10.957, sample: 2.249, forward: 3.473, backward: 2.247, update: 2.782
[proc 3][Train](8000/10000) average pos_loss: 0.6627079685926437
[proc 3][Train](8000/10000) average neg_loss: 0.7140336437821388
[proc 3][Train](8000/10000) average loss: 0.688370805978775
[proc 3][Train](8000/10000) average regularization: 0.00014030429819831625
[proc 3] 8000 steps, total: 10.957, sample: 2.205, forward: 3.452, backward: 2.288, update: 2.753
[proc 1][Train](8000/10000) average pos_loss: 0.6632017182707787
[proc 1][Train](8000/10000) average neg_loss: 0.7134576241970062
[proc 1][Train](8000/10000) average loss: 0.6883296704292298
[proc 1][Train](8000/10000) average regularization: 0.00014026586183172186
[proc 1] 8000 steps, total: 10.957, sample: 2.236, forward: 3.446, backward: 2.354, update: 2.736
[proc 0][Train](9000/10000) average pos_loss: 0.6602745669484138
[proc 0][Train](9000/10000) average neg_loss: 0.7094469293355942
[proc 0][Train](9000/10000) average loss: 0.6848607479333878
[proc 0][Train](9000/10000) average regularization: 0.0001427649432589533
[proc 0] 9000 steps, total: 12.232, sample: 2.210, forward: 3.761, backward: 2.736, update: 3.520
[proc 3][Train](9000/10000) average pos_loss: 0.6597585822343827
[proc 3][Train](9000/10000) average neg_loss: 0.7095314909219742
[proc 3][Train](9000/10000) average loss: 0.6846450358629227
[proc 3][Train](9000/10000) average regularization: 0.00014249114377889782
[proc 3] 9000 steps, total: 12.233, sample: 2.155, forward: 3.261, backward: 0.929, update: 2.766
[proc 2][Train](9000/10000) average pos_loss: 0.6594638366699219
[proc 2][Train](9000/10000) average neg_loss: 0.7094982804059983
[proc 2][Train](9000/10000) average loss: 0.6844810590147972
[proc 2][Train](9000/10000) average regularization: 0.00014264734381868037
[proc 2] 9000 steps, total: 12.234, sample: 2.203, forward: 3.445, backward: 2.738, update: 2.478
[proc 1][Train](9000/10000) average pos_loss: 0.6580980795621872
[proc 1][Train](9000/10000) average neg_loss: 0.7088251751661301
[proc 1][Train](9000/10000) average loss: 0.6834616271853446
[proc 1][Train](9000/10000) average regularization: 0.00014264606755750719
[proc 1] 9000 steps, total: 12.233, sample: 2.205, forward: 3.437, backward: 2.757, update: 2.788
[proc 0][Train](10000/10000) average pos_loss: 0.6553168395757675
[proc 0][Train](10000/10000) average neg_loss: 0.7054236682057381
[proc 0][Train](10000/10000) average loss: 0.6803702536225319
[proc 0][Train](10000/10000) average regularization: 0.00014499733243428635
[proc 0] 10000 steps, total: 12.355, sample: 2.017, forward: 3.853, backward: 2.772, update: 3.706
proc 0 takes 135.032 seconds
[proc 3][Train](10000/10000) average pos_loss: 0.6567995079755783
[proc 3][Train](10000/10000) average neg_loss: 0.7059667288661003
[proc 3][Train](10000/10000) average loss: 0.6813831184506416
[proc 3][Train](10000/10000) average regularization: 0.00014455683161213528
[proc 3] 10000 steps, total: 12.355, sample: 1.986, forward: 3.179, backward: 0.951, update: 2.746
[proc 1][Train](10000/10000) average pos_loss: 0.656380344748497
[proc 1][Train](10000/10000) average neg_loss: 0.7054596493840217
[proc 1][Train](10000/10000) average loss: 0.6809199972748756
[proc 1][Train](10000/10000) average regularization: 0.00014471269758359995
[proc 1] 10000 steps, total: 12.354, sample: 2.050, forward: 3.261, backward: 2.944, update: 2.505
proc 3 takes 133.560 seconds
proc 1 takes 134.556 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.6567265871763229
[proc 2][Train](10000/10000) average neg_loss: 0.7053241364359856
[proc 2][Train](10000/10000) average loss: 0.6810253622531891
[proc 2][Train](10000/10000) average regularization: 0.00014465755270794034
[proc 2] 10000 steps, total: 12.355, sample: 2.019, forward: 3.472, backward: 2.763, update: 2.542
proc 2 takes 134.065 seconds
Successfully xmh. training takes 138.57468700408936 seconds
