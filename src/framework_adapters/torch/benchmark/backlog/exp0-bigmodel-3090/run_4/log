Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
|Train|: 304727650
random partition 304727650 edges into 5 parts
part 0 has 60945530 edges
part 1 has 60945530 edges
part 2 has 60945530 edges
part 3 has 60945530 edges
part 4 has 60945530 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=None, batch_size=1000, batch_size_eval=16, data_files=None, data_path='/home/xieminhui/dgl-data', dataset='Freebase', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3, 4], has_edge_importance=False, hidden_dim=100, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=86054151, no_eval_filter=False, no_save_emb=True, nr_gpus=5, num_proc=5, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='/tmp/ckpts/TransE_l1_Freebase_14', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 16929318
|test|: 16929308
Total initialize time 535.526 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 3][Train](1000/10000) average pos_loss: 0.705978495657444
[proc 3][Train](1000/10000) average neg_loss: 0.7755411958098412
[proc 3][Train](1000/10000) average loss: 0.7407598448991776
[proc 3][Train](1000/10000) average regularization: 9.3898519888171e-05
[proc 3] 1000 steps, total: 27.288, sample: 14.280, forward: 7.172, backward: 2.717, update: 3.111
[proc 1][Train](1000/10000) average pos_loss: 0.7086609916090966
[proc 1][Train](1000/10000) average neg_loss: 0.780506618976593
[proc 1][Train](1000/10000) average loss: 0.7445838053822518
[proc 1][Train](1000/10000) average regularization: 9.139770782348932e-05
[proc 1] 1000 steps, total: 28.312, sample: 13.811, forward: 7.100, backward: 2.813, update: 3.114
[proc 0][Train](1000/10000) average pos_loss: 0.7092047556936741
[proc 0][Train](1000/10000) average neg_loss: 0.7880112526416778
[proc 0][Train](1000/10000) average loss: 0.748608004450798
[proc 0][Train](1000/10000) average regularization: 8.943406415710342e-05
[proc 0] 1000 steps, total: 28.824, sample: 13.274, forward: 7.248, backward: 2.874, update: 2.996
[proc 2][Train](1000/10000) average pos_loss: 0.707107307612896
[proc 2][Train](1000/10000) average neg_loss: 0.7786655387282372
[proc 2][Train](1000/10000) average loss: 0.7428864235877991
[proc 2][Train](1000/10000) average regularization: 9.199138309486443e-05
[proc 2] 1000 steps, total: 27.805, sample: 13.537, forward: 7.247, backward: 2.745, update: 3.181
[proc 4][Train](1000/10000) average pos_loss: 0.7054889674186706
[proc 4][Train](1000/10000) average neg_loss: 0.7743821539282799
[proc 4][Train](1000/10000) average loss: 0.739935560464859
[proc 4][Train](1000/10000) average regularization: 9.392046467837645e-05
[proc 4] 1000 steps, total: 26.733, sample: 13.547, forward: 7.119, backward: 2.719, update: 3.128
[proc 3][Train](2000/10000) average pos_loss: 0.6904045773148537
[proc 3][Train](2000/10000) average neg_loss: 0.7523347871899605
[proc 3][Train](2000/10000) average loss: 0.7213696817755699
[proc 3][Train](2000/10000) average regularization: 0.00011165121005615219
[proc 3] 2000 steps, total: 11.750, sample: 2.332, forward: 3.649, backward: 2.725, update: 3.037
[proc 0][Train](2000/10000) average pos_loss: 0.6903216679692268
[proc 0][Train](2000/10000) average neg_loss: 0.7530125513672828
[proc 0][Train](2000/10000) average loss: 0.7216671100258827
[proc 0][Train](2000/10000) average regularization: 0.00011141196359676542
[proc 0] 2000 steps, total: 11.750, sample: 2.291, forward: 3.583, backward: 2.703, update: 2.802
[proc 4][Train](2000/10000) average pos_loss: 0.6909829635620117
[proc 4][Train](2000/10000) average neg_loss: 0.7531754286885262
[proc 4][Train](2000/10000) average loss: 0.7220791954398155
[proc 4][Train](2000/10000) average regularization: 0.00011147213574440684
[proc 4] 2000 steps, total: 11.750, sample: 2.315, forward: 3.580, backward: 2.783, update: 2.970
[proc 1][Train](2000/10000) average pos_loss: 0.6912862385511398
[proc 1][Train](2000/10000) average neg_loss: 0.751927850306034
[proc 1][Train](2000/10000) average loss: 0.7216070435047149
[proc 1][Train](2000/10000) average regularization: 0.00011147794430144131
[proc 1] 2000 steps, total: 11.751, sample: 2.195, forward: 3.591, backward: 2.681, update: 2.894
[proc 2][Train](2000/10000) average pos_loss: 0.6907914646863937
[proc 2][Train](2000/10000) average neg_loss: 0.7518996648788452
[proc 2][Train](2000/10000) average loss: 0.7213455646038055
[proc 2][Train](2000/10000) average regularization: 0.00011157979250856443
[proc 2] 2000 steps, total: 11.751, sample: 2.217, forward: 3.606, backward: 2.798, update: 2.991
[proc 1][Train](3000/10000) average pos_loss: 0.6825094677209854
[proc 1][Train](3000/10000) average neg_loss: 0.7396835389733315
[proc 1][Train](3000/10000) average loss: 0.7110965022444725
[proc 1][Train](3000/10000) average regularization: 0.00012340937019325794
[proc 1] 3000 steps, total: 11.634, sample: 2.250, forward: 3.606, backward: 2.741, update: 2.796
[proc 4][Train](3000/10000) average pos_loss: 0.6818707846403121
[proc 4][Train](3000/10000) average neg_loss: 0.7394326881766319
[proc 4][Train](3000/10000) average loss: 0.7106517362594604
[proc 4][Train](3000/10000) average regularization: 0.00012341938386816763
[proc 4] 3000 steps, total: 11.635, sample: 2.287, forward: 3.394, backward: 2.759, update: 2.834
[proc 3][Train](3000/10000) average pos_loss: 0.6826363713741302
[proc 3][Train](3000/10000) average neg_loss: 0.7396510438323021
[proc 3][Train](3000/10000) average loss: 0.7111437088251114
[proc 3][Train](3000/10000) average regularization: 0.0001234953687962843
[proc 3] 3000 steps, total: 11.635, sample: 2.386, forward: 3.579, backward: 2.750, update: 2.912
[proc 2][Train](3000/10000) average pos_loss: 0.6821291829347611
[proc 2][Train](3000/10000) average neg_loss: 0.740246297776699
[proc 2][Train](3000/10000) average loss: 0.7111877403259277
[proc 2][Train](3000/10000) average regularization: 0.00012350963677454274
[proc 2] 3000 steps, total: 11.635, sample: 2.246, forward: 3.568, backward: 2.755, update: 2.934
[proc 0][Train](3000/10000) average pos_loss: 0.6815502035021782
[proc 0][Train](3000/10000) average neg_loss: 0.740169895529747
[proc 0][Train](3000/10000) average loss: 0.7108600499033928
[proc 0][Train](3000/10000) average regularization: 0.00012344526233209764
[proc 0] 3000 steps, total: 11.635, sample: 2.349, forward: 3.473, backward: 2.815, update: 2.769
[proc 2][Train](4000/10000) average pos_loss: 0.6749290629029274
[proc 2][Train](4000/10000) average neg_loss: 0.7311605587601662
[proc 2][Train](4000/10000) average loss: 0.7030448105335235
[proc 2][Train](4000/10000) average regularization: 0.00013128528236120473
[proc 2] 4000 steps, total: 11.388, sample: 2.253, forward: 3.596, backward: 2.733, update: 2.800
[proc 4][Train](4000/10000) average pos_loss: 0.6769289775490761
[proc 4][Train](4000/10000) average neg_loss: 0.730978522837162
[proc 4][Train](4000/10000) average loss: 0.7039537495970726
[proc 4][Train](4000/10000) average regularization: 0.00013120497988711576
[proc 4] 4000 steps, total: 11.389, sample: 2.235, forward: 3.423, backward: 2.840, update: 2.822
[proc 0][Train](4000/10000) average pos_loss: 0.676236909866333
[proc 0][Train](4000/10000) average neg_loss: 0.7312543649077415
[proc 0][Train](4000/10000) average loss: 0.7037456375956536
[proc 0][Train](4000/10000) average regularization: 0.00013116479918244295
[proc 0] 4000 steps, total: 11.389, sample: 2.170, forward: 3.480, backward: 2.710, update: 2.686
[proc 1][Train](4000/10000) average pos_loss: 0.6765551505088806
[proc 1][Train](4000/10000) average neg_loss: 0.7305446580648423
[proc 1][Train](4000/10000) average loss: 0.7035499038100242
[proc 1][Train](4000/10000) average regularization: 0.00013123616881784982
[proc 1] 4000 steps, total: 11.390, sample: 2.164, forward: 3.533, backward: 2.737, update: 2.720
[proc 3][Train](4000/10000) average pos_loss: 0.675355904519558
[proc 3][Train](4000/10000) average neg_loss: 0.7311021624803543
[proc 3][Train](4000/10000) average loss: 0.7032290344238281
[proc 3][Train](4000/10000) average regularization: 0.0001312910500273574
[proc 3] 4000 steps, total: 11.390, sample: 2.160, forward: 3.516, backward: 2.718, update: 2.824
[proc 2][Train](5000/10000) average pos_loss: 0.6714553305506706
[proc 2][Train](5000/10000) average neg_loss: 0.7231971881389618
[proc 2][Train](5000/10000) average loss: 0.697326258957386
[proc 2][Train](5000/10000) average regularization: 0.00013663851874298416
[proc 2] 5000 steps, total: 11.755, sample: 2.641, forward: 3.552, backward: 2.745, update: 2.811
[proc 1][Train](5000/10000) average pos_loss: 0.6706873172521591
[proc 1][Train](5000/10000) average neg_loss: 0.7240112095475196
[proc 1][Train](5000/10000) average loss: 0.6973492639660835
[proc 1][Train](5000/10000) average regularization: 0.00013668128942663315
[proc 1] 5000 steps, total: 11.755, sample: 2.504, forward: 3.570, backward: 2.906, update: 2.645
[proc 0][Train](5000/10000) average pos_loss: 0.6705265641212463
[proc 0][Train](5000/10000) average neg_loss: 0.7239843190908432
[proc 0][Train](5000/10000) average loss: 0.6972554413080215
[proc 0][Train](5000/10000) average regularization: 0.00013659630186157301
[proc 0] 5000 steps, total: 11.755, sample: 2.557, forward: 3.406, backward: 2.883, update: 2.537
[proc 4][Train](5000/10000) average pos_loss: 0.6706891130805016
[proc 4][Train](5000/10000) average neg_loss: 0.7237169541716576
[proc 4][Train](5000/10000) average loss: 0.6972030336260796
[proc 4][Train](5000/10000) average regularization: 0.000136528160146554
[proc 4] 5000 steps, total: 11.756, sample: 2.392, forward: 3.425, backward: 2.708, update: 2.838
[proc 3][Train](5000/10000) average pos_loss: 0.6707037243247033
[proc 3][Train](5000/10000) average neg_loss: 0.723122983455658
[proc 3][Train](5000/10000) average loss: 0.6969133532643318
[proc 3][Train](5000/10000) average regularization: 0.0001366306807321962
[proc 3] 5000 steps, total: 11.755, sample: 2.322, forward: 3.523, backward: 2.739, update: 2.811
[proc 1][Train](6000/10000) average pos_loss: 0.6657509236335755
[proc 1][Train](6000/10000) average neg_loss: 0.7161755747795105
[proc 1][Train](6000/10000) average loss: 0.6909632496833801
[proc 1][Train](6000/10000) average regularization: 0.00014079546507855413
[proc 1] 6000 steps, total: 11.131, sample: 2.087, forward: 3.588, backward: 2.830, update: 2.619
[proc 3][Train](6000/10000) average pos_loss: 0.6656338824629784
[proc 3][Train](6000/10000) average neg_loss: 0.7172401743531227
[proc 3][Train](6000/10000) average loss: 0.6914370265603066
[proc 3][Train](6000/10000) average regularization: 0.00014073103888949845
[proc 3] 6000 steps, total: 11.131, sample: 2.153, forward: 3.486, backward: 2.723, update: 2.733
[proc 2][Train](6000/10000) average pos_loss: 0.6652932152152061
[proc 2][Train](6000/10000) average neg_loss: 0.7185670857429505
[proc 2][Train](6000/10000) average loss: 0.6919301507472992
[proc 2][Train](6000/10000) average regularization: 0.00014071107220661361
[proc 2] 6000 steps, total: 11.132, sample: 2.158, forward: 3.512, backward: 2.686, update: 2.747
[proc 4][Train](6000/10000) average pos_loss: 0.6655692520141602
[proc 4][Train](6000/10000) average neg_loss: 0.7176125561594963
[proc 4][Train](6000/10000) average loss: 0.6915909037590027
[proc 4][Train](6000/10000) average regularization: 0.0001406632477446692
[proc 4] 6000 steps, total: 11.131, sample: 2.162, forward: 3.452, backward: 2.736, update: 2.706
[proc 0][Train](6000/10000) average pos_loss: 0.6657333738207817
[proc 0][Train](6000/10000) average neg_loss: 0.7173098050951958
[proc 0][Train](6000/10000) average loss: 0.6915215895175933
[proc 0][Train](6000/10000) average regularization: 0.0001407657640229445
[proc 0] 6000 steps, total: 11.132, sample: 2.175, forward: 3.553, backward: 2.791, update: 2.603
[proc 2][Train](7000/10000) average pos_loss: 0.6617661551833153
[proc 2][Train](7000/10000) average neg_loss: 0.7109336212873459
[proc 2][Train](7000/10000) average loss: 0.6863498880863189
[proc 2][Train](7000/10000) average regularization: 0.00014412682963302358
[proc 2] 7000 steps, total: 11.183, sample: 2.234, forward: 3.494, backward: 2.680, update: 2.769
[proc 1][Train](7000/10000) average pos_loss: 0.6610333956480027
[proc 1][Train](7000/10000) average neg_loss: 0.7109899553060531
[proc 1][Train](7000/10000) average loss: 0.6860116745829582
[proc 1][Train](7000/10000) average regularization: 0.00014414113918610383
[proc 1] 7000 steps, total: 11.183, sample: 2.172, forward: 3.599, backward: 2.739, update: 2.633
[proc 3][Train](7000/10000) average pos_loss: 0.6605342321395874
[proc 3][Train](7000/10000) average neg_loss: 0.7116123900413514
[proc 3][Train](7000/10000) average loss: 0.6860733112096786
[proc 3][Train](7000/10000) average regularization: 0.0001440837484988151
[proc 3] 7000 steps, total: 11.183, sample: 2.181, forward: 3.528, backward: 2.720, update: 2.714
[proc 4][Train](7000/10000) average pos_loss: 0.6617937754392624
[proc 4][Train](7000/10000) average neg_loss: 0.7112807213664055
[proc 4][Train](7000/10000) average loss: 0.686537248492241
[proc 4][Train](7000/10000) average regularization: 0.00014406754275842105
[proc 4] 7000 steps, total: 11.183, sample: 2.171, forward: 3.398, backward: 2.738, update: 2.637
[proc 0][Train](7000/10000) average pos_loss: 0.6600938408970832
[proc 0][Train](7000/10000) average neg_loss: 0.7117840766310691
[proc 0][Train](7000/10000) average loss: 0.685938958644867
[proc 0][Train](7000/10000) average regularization: 0.0001440347943571396
[proc 0] 7000 steps, total: 11.183, sample: 2.191, forward: 3.426, backward: 2.724, update: 2.582
[proc 4][Train](8000/10000) average pos_loss: 0.6575864441394806
[proc 4][Train](8000/10000) average neg_loss: 0.7063807738423348
[proc 4][Train](8000/10000) average loss: 0.6819836102128028
[proc 4][Train](8000/10000) average regularization: 0.00014685659666429274
[proc 4] 8000 steps, total: 11.351, sample: 2.211, forward: 3.469, backward: 3.006, update: 2.659
[proc 2][Train](8000/10000) average pos_loss: 0.6565894668698311
[proc 2][Train](8000/10000) average neg_loss: 0.7064718891382218
[proc 2][Train](8000/10000) average loss: 0.6815306770205498
[proc 2][Train](8000/10000) average regularization: 0.00014677155847311952
[proc 2] 8000 steps, total: 11.353, sample: 2.266, forward: 3.502, backward: 2.716, update: 2.762
[proc 0][Train](8000/10000) average pos_loss: 0.6573501539230346
[proc 0][Train](8000/10000) average neg_loss: 0.7065956729054451
[proc 0][Train](8000/10000) average loss: 0.6819729129076004
[proc 0][Train](8000/10000) average regularization: 0.00014681451716751326
[proc 0] 8000 steps, total: 11.352, sample: 2.092, forward: 3.416, backward: 2.842, update: 2.490
[proc 1][Train](8000/10000) average pos_loss: 0.6574800215363502
[proc 1][Train](8000/10000) average neg_loss: 0.7068825842142105
[proc 1][Train](8000/10000) average loss: 0.6821813025474548
[proc 1][Train](8000/10000) average regularization: 0.00014685398363508285
[proc 1] 8000 steps, total: 11.353, sample: 2.216, forward: 3.682, backward: 2.732, update: 2.571
[proc 3][Train](8000/10000) average pos_loss: 0.6567173951864242
[proc 3][Train](8000/10000) average neg_loss: 0.707207729101181
[proc 3][Train](8000/10000) average loss: 0.6819625620245934
[proc 3][Train](8000/10000) average regularization: 0.0001467861309502041
[proc 3] 8000 steps, total: 11.352, sample: 2.156, forward: 3.435, backward: 2.739, update: 2.687
[proc 3][Train](9000/10000) average pos_loss: 0.6528125344514847
[proc 3][Train](9000/10000) average neg_loss: 0.7016956058144569
[proc 3][Train](9000/10000) average loss: 0.6772540706396103
[proc 3][Train](9000/10000) average regularization: 0.00014914610324194655
[proc 3] 9000 steps, total: 11.459, sample: 2.357, forward: 3.454, backward: 2.918, update: 2.723
[proc 2][Train](9000/10000) average pos_loss: 0.6519820473194122
[proc 2][Train](9000/10000) average neg_loss: 0.7016051715612411
[proc 2][Train](9000/10000) average loss: 0.6767936099171639
[proc 2][Train](9000/10000) average regularization: 0.000149226320834714
[proc 2] 9000 steps, total: 11.461, sample: 2.293, forward: 3.552, backward: 2.514, update: 2.767
[proc 0][Train](9000/10000) average pos_loss: 0.652736557006836
[proc 0][Train](9000/10000) average neg_loss: 0.7011017382740975
[proc 0][Train](9000/10000) average loss: 0.6769191483855248
[proc 0][Train](9000/10000) average regularization: 0.0001491819723887602
[proc 0] 9000 steps, total: 11.460, sample: 2.221, forward: 3.440, backward: 2.747, update: 2.475
[proc 1][Train](9000/10000) average pos_loss: 0.6538719735741615
[proc 1][Train](9000/10000) average neg_loss: 0.7019583745598793
[proc 1][Train](9000/10000) average loss: 0.6779151746630668
[proc 1][Train](9000/10000) average regularization: 0.00014919859985820948
[proc 1] 9000 steps, total: 11.460, sample: 2.316, forward: 3.565, backward: 2.749, update: 2.601
[proc 4][Train](9000/10000) average pos_loss: 0.6523993327617645
[proc 4][Train](9000/10000) average neg_loss: 0.7021185494065285
[proc 4][Train](9000/10000) average loss: 0.6772589403390884
[proc 4][Train](9000/10000) average regularization: 0.00014922480250243098
[proc 4] 9000 steps, total: 11.461, sample: 2.338, forward: 3.439, backward: 2.702, update: 2.666
[proc 3][Train](10000/10000) average pos_loss: 0.6498597400188446
[proc 3][Train](10000/10000) average neg_loss: 0.6962959215641021
[proc 3][Train](10000/10000) average loss: 0.6730778306722641
[proc 3][Train](10000/10000) average regularization: 0.0001512855897162808
[proc 3] 10000 steps, total: 11.427, sample: 2.209, forward: 3.521, backward: 2.943, update: 2.747
proc 3 takes 130.372 seconds
[proc 4][Train](10000/10000) average pos_loss: 0.6488786215186119
[proc 4][Train](10000/10000) average neg_loss: 0.69724876588583
[proc 4][Train](10000/10000) average loss: 0.6730636936426163
[proc 4][Train](10000/10000) average regularization: 0.0001512935525533976
[proc 4] 10000 steps, total: 11.427, sample: 2.099, forward: 3.371, backward: 2.721, update: 2.677
[proc 0][Train](10000/10000) average pos_loss: 0.6494098751544952
[proc 0][Train](10000/10000) average neg_loss: 0.6970108062028885
[proc 0][Train](10000/10000) average loss: 0.673210341334343
[proc 0][Train](10000/10000) average regularization: 0.00015122780507954302
[proc 0] 10000 steps, total: 11.427, sample: 2.023, forward: 3.429, backward: 2.724, update: 2.435
proc 4 takes 129.817 seconds
proc 0 takes 131.908 seconds
[proc 1][Train](10000/10000) average pos_loss: 0.6482277364134789
[proc 1][Train](10000/10000) average neg_loss: 0.6981148060560226
[proc 1][Train](10000/10000) average loss: 0.6731712709665298
[proc 1][Train](10000/10000) average regularization: 0.00015132211324817035
[proc 1] 10000 steps, total: 11.427, sample: 2.209, forward: 3.582, backward: 2.688, update: 2.514
proc 1 takes 131.397 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.6491711736321449
[proc 2][Train](10000/10000) average neg_loss: 0.6974475085139274
[proc 2][Train](10000/10000) average loss: 0.6733093420267106
[proc 2][Train](10000/10000) average regularization: 0.00015134045205195435
[proc 2] 10000 steps, total: 11.427, sample: 2.169, forward: 3.537, backward: 2.753, update: 2.694
proc 2 takes 130.889 seconds
Successfully xmh. training takes 136.78072333335876 seconds
