Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
|Train|: 304727650
random partition 304727650 edges into 4 parts
part 0 has 76181913 edges
part 1 has 76181913 edges
part 2 has 76181913 edges
part 3 has 76181911 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=None, batch_size=1000, batch_size_eval=16, data_files=None, data_path='/home/xieminhui/dgl-data', dataset='Freebase', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3], has_edge_importance=False, hidden_dim=100, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=86054151, no_eval_filter=False, no_save_emb=True, nr_gpus=4, num_proc=4, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='/tmp/ckpts/TransE_l1_Freebase_15', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 16929318
|test|: 16929308
Total initialize time 434.752 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 2][Train](1000/10000) average pos_loss: 0.7090977405309677
[proc 2][Train](1000/10000) average neg_loss: 0.7813542678952217
[proc 2][Train](1000/10000) average loss: 0.7452260037660599
[proc 2][Train](1000/10000) average regularization: 9.177264645404648e-05
[proc 2] 1000 steps, total: 19.789, sample: 7.896, forward: 6.581, backward: 2.669, update: 2.637
[proc 0][Train](1000/10000) average pos_loss: 0.709025948792696
[proc 0][Train](1000/10000) average neg_loss: 0.7815900062322616
[proc 0][Train](1000/10000) average loss: 0.7453079774379731
[proc 0][Train](1000/10000) average regularization: 9.140647628737498e-05
[proc 0] 1000 steps, total: 20.299, sample: 8.306, forward: 6.557, backward: 2.396, update: 2.573
[proc 1][Train](1000/10000) average pos_loss: 0.7090492427349091
[proc 1][Train](1000/10000) average neg_loss: 0.7806304521560669
[proc 1][Train](1000/10000) average loss: 0.7448398481607437
[proc 1][Train](1000/10000) average regularization: 9.173369572818047e-05
[proc 1] 1000 steps, total: 20.058, sample: 8.387, forward: 6.325, backward: 2.671, update: 2.550
[proc 3][Train](1000/10000) average pos_loss: 0.7127047645449638
[proc 3][Train](1000/10000) average neg_loss: 0.785652751505375
[proc 3][Train](1000/10000) average loss: 0.7491787574291229
[proc 3][Train](1000/10000) average regularization: 8.990939825889655e-05
[proc 3] 1000 steps, total: 19.546, sample: 7.499, forward: 6.326, backward: 1.556, update: 2.802
[proc 1][Train](2000/10000) average pos_loss: 0.6934686751961708
[proc 1][Train](2000/10000) average neg_loss: 0.7546946188807487
[proc 1][Train](2000/10000) average loss: 0.7240816475749016
[proc 1][Train](2000/10000) average regularization: 0.000109445797301305
[proc 1] 2000 steps, total: 9.643, sample: 1.449, forward: 3.192, backward: 2.628, update: 2.368
[proc 3][Train](2000/10000) average pos_loss: 0.6932100127339363
[proc 3][Train](2000/10000) average neg_loss: 0.7561327841281891
[proc 3][Train](2000/10000) average loss: 0.7246713982224464
[proc 3][Train](2000/10000) average regularization: 0.0001089534560815082
[proc 3] 2000 steps, total: 9.643, sample: 1.392, forward: 3.219, backward: 1.523, update: 2.619
[proc 2][Train](2000/10000) average pos_loss: 0.6948272304534913
[proc 2][Train](2000/10000) average neg_loss: 0.7555919821858406
[proc 2][Train](2000/10000) average loss: 0.7252096067667008
[proc 2][Train](2000/10000) average regularization: 0.00010946172038529767
[proc 2] 2000 steps, total: 9.644, sample: 1.398, forward: 3.232, backward: 2.370, update: 2.516
[proc 0][Train](2000/10000) average pos_loss: 0.6931767992377281
[proc 0][Train](2000/10000) average neg_loss: 0.7553486809134483
[proc 0][Train](2000/10000) average loss: 0.7242627396583557
[proc 0][Train](2000/10000) average regularization: 0.00010919490775995654
[proc 0] 2000 steps, total: 9.643, sample: 1.398, forward: 3.136, backward: 2.203, update: 2.432
[proc 2][Train](3000/10000) average pos_loss: 0.6861946132779121
[proc 2][Train](3000/10000) average neg_loss: 0.744590315937996
[proc 2][Train](3000/10000) average loss: 0.7153924648165703
[proc 2][Train](3000/10000) average regularization: 0.0001196114124613814
[proc 2] 3000 steps, total: 9.509, sample: 1.480, forward: 3.253, backward: 2.328, update: 2.442
[proc 1][Train](3000/10000) average pos_loss: 0.6862645286917687
[proc 1][Train](3000/10000) average neg_loss: 0.744455423116684
[proc 1][Train](3000/10000) average loss: 0.7153599752187729
[proc 1][Train](3000/10000) average regularization: 0.00011954856352531352
[proc 1] 3000 steps, total: 9.509, sample: 1.430, forward: 3.124, backward: 2.561, update: 2.258
[proc 3][Train](3000/10000) average pos_loss: 0.6866842950582505
[proc 3][Train](3000/10000) average neg_loss: 0.743527224957943
[proc 3][Train](3000/10000) average loss: 0.7151057597398758
[proc 3][Train](3000/10000) average regularization: 0.00011949227413424524
[proc 3] 3000 steps, total: 9.509, sample: 1.495, forward: 3.196, backward: 1.556, update: 2.563
[proc 0][Train](3000/10000) average pos_loss: 0.685955200791359
[proc 0][Train](3000/10000) average neg_loss: 0.7434665936231614
[proc 0][Train](3000/10000) average loss: 0.7147108972668648
[proc 0][Train](3000/10000) average regularization: 0.00011952871827816124
[proc 0] 3000 steps, total: 9.509, sample: 1.414, forward: 3.087, backward: 2.305, update: 2.295
[proc 2][Train](4000/10000) average pos_loss: 0.6803985760807991
[proc 2][Train](4000/10000) average neg_loss: 0.7356153292059898
[proc 2][Train](4000/10000) average loss: 0.7080069525837899
[proc 2][Train](4000/10000) average regularization: 0.00012614956495235675
[proc 2] 4000 steps, total: 9.285, sample: 1.439, forward: 3.215, backward: 2.295, update: 2.331
[proc 0][Train](4000/10000) average pos_loss: 0.6809495235681534
[proc 0][Train](4000/10000) average neg_loss: 0.7359385657310485
[proc 0][Train](4000/10000) average loss: 0.708444045484066
[proc 0][Train](4000/10000) average regularization: 0.00012610875826067058
[proc 0] 4000 steps, total: 9.285, sample: 1.450, forward: 3.150, backward: 2.367, update: 2.312
[proc 1][Train](4000/10000) average pos_loss: 0.6800597602128983
[proc 1][Train](4000/10000) average neg_loss: 0.7353656759858131
[proc 1][Train](4000/10000) average loss: 0.707712717115879
[proc 1][Train](4000/10000) average regularization: 0.00012615767084935215
[proc 1] 4000 steps, total: 9.285, sample: 1.397, forward: 3.084, backward: 2.438, update: 2.175
[proc 3][Train](4000/10000) average pos_loss: 0.6806212499737739
[proc 3][Train](4000/10000) average neg_loss: 0.7356341952681541
[proc 3][Train](4000/10000) average loss: 0.7081277225613594
[proc 3][Train](4000/10000) average regularization: 0.00012580620127846488
[proc 3] 4000 steps, total: 9.285, sample: 1.343, forward: 3.000, backward: 1.399, update: 2.385
[proc 0][Train](5000/10000) average pos_loss: 0.6751450523734093
[proc 0][Train](5000/10000) average neg_loss: 0.7291243003606797
[proc 0][Train](5000/10000) average loss: 0.7021346760392189
[proc 0][Train](5000/10000) average regularization: 0.0001307795932807494
[proc 0] 5000 steps, total: 10.174, sample: 1.763, forward: 3.373, backward: 2.492, update: 2.540
[proc 1][Train](5000/10000) average pos_loss: 0.6759482837319374
[proc 1][Train](5000/10000) average neg_loss: 0.7289991750717163
[proc 1][Train](5000/10000) average loss: 0.7024737288951873
[proc 1][Train](5000/10000) average regularization: 0.00013054707259288988
[proc 1] 5000 steps, total: 10.174, sample: 1.510, forward: 3.084, backward: 2.503, update: 2.114
[proc 2][Train](5000/10000) average pos_loss: 0.6754641771316529
[proc 2][Train](5000/10000) average neg_loss: 0.7285407675504685
[proc 2][Train](5000/10000) average loss: 0.7020024734139443
[proc 2][Train](5000/10000) average regularization: 0.00013067280725226736
[proc 2] 5000 steps, total: 10.174, sample: 1.564, forward: 3.226, backward: 2.384, update: 2.344
[proc 3][Train](5000/10000) average pos_loss: 0.6751910167336463
[proc 3][Train](5000/10000) average neg_loss: 0.7292383703589439
[proc 3][Train](5000/10000) average loss: 0.7022146935462952
[proc 3][Train](5000/10000) average regularization: 0.00013050012721214444
[proc 3] 5000 steps, total: 10.174, sample: 1.681, forward: 3.233, backward: 2.082, update: 2.381
[proc 3][Train](6000/10000) average pos_loss: 0.67104629945755
[proc 3][Train](6000/10000) average neg_loss: 0.7237212721705437
[proc 3][Train](6000/10000) average loss: 0.6973837854266167
[proc 3][Train](6000/10000) average regularization: 0.00013428203467628918
[proc 3] 6000 steps, total: 10.300, sample: 1.558, forward: 3.392, backward: 2.743, update: 2.491
[proc 1][Train](6000/10000) average pos_loss: 0.6715362852215767
[proc 1][Train](6000/10000) average neg_loss: 0.7234643996357918
[proc 1][Train](6000/10000) average loss: 0.6975003424882888
[proc 1][Train](6000/10000) average regularization: 0.00013432198374357541
[proc 1] 6000 steps, total: 10.300, sample: 1.729, forward: 3.456, backward: 2.641, update: 2.468
[proc 0][Train](6000/10000) average pos_loss: 0.6714591808915138
[proc 0][Train](6000/10000) average neg_loss: 0.7235823202729225
[proc 0][Train](6000/10000) average loss: 0.6975207508802413
[proc 0][Train](6000/10000) average regularization: 0.00013427977132960222
[proc 0] 6000 steps, total: 10.301, sample: 1.492, forward: 3.225, backward: 2.577, update: 2.343
[proc 2][Train](6000/10000) average pos_loss: 0.6705496691465378
[proc 2][Train](6000/10000) average neg_loss: 0.7239182730913162
[proc 2][Train](6000/10000) average loss: 0.6972339715957642
[proc 2][Train](6000/10000) average regularization: 0.0001341882532578893
[proc 2] 6000 steps, total: 10.300, sample: 1.535, forward: 3.357, backward: 2.732, update: 2.384
[proc 2][Train](7000/10000) average pos_loss: 0.6665269219875336
[proc 2][Train](7000/10000) average neg_loss: 0.718265131354332
[proc 2][Train](7000/10000) average loss: 0.6923960258960724
[proc 2][Train](7000/10000) average regularization: 0.00013720280880806968
[proc 2] 7000 steps, total: 10.205, sample: 1.575, forward: 3.366, backward: 2.890, update: 2.339
[proc 3][Train](7000/10000) average pos_loss: 0.667194360613823
[proc 3][Train](7000/10000) average neg_loss: 0.7182391877770424
[proc 3][Train](7000/10000) average loss: 0.6927167747020722
[proc 3][Train](7000/10000) average regularization: 0.0001372264754900243
[proc 3] 7000 steps, total: 10.205, sample: 1.573, forward: 3.385, backward: 2.850, update: 2.392
[proc 0][Train](7000/10000) average pos_loss: 0.6672168611288071
[proc 0][Train](7000/10000) average neg_loss: 0.7182132672071457
[proc 0][Train](7000/10000) average loss: 0.6927150636315346
[proc 0][Train](7000/10000) average regularization: 0.00013731581956380977
[proc 0] 7000 steps, total: 10.205, sample: 1.551, forward: 3.275, backward: 2.399, update: 2.385
[proc 1][Train](7000/10000) average pos_loss: 0.6678709887266159
[proc 1][Train](7000/10000) average neg_loss: 0.7182580088376999
[proc 1][Train](7000/10000) average loss: 0.693064499616623
[proc 1][Train](7000/10000) average regularization: 0.0001371220219589304
[proc 1] 7000 steps, total: 10.205, sample: 1.509, forward: 3.279, backward: 2.334, update: 2.406
[proc 3][Train](8000/10000) average pos_loss: 0.6618294079303741
[proc 3][Train](8000/10000) average neg_loss: 0.7138864541053772
[proc 3][Train](8000/10000) average loss: 0.6878579312562942
[proc 3][Train](8000/10000) average regularization: 0.00013975305821804795
[proc 3] 8000 steps, total: 9.854, sample: 1.523, forward: 3.347, backward: 2.620, update: 2.359
[proc 2][Train](8000/10000) average pos_loss: 0.6641249016523362
[proc 2][Train](8000/10000) average neg_loss: 0.7137739978432656
[proc 2][Train](8000/10000) average loss: 0.6889494491815567
[proc 2][Train](8000/10000) average regularization: 0.00013981273605895693
[proc 2] 8000 steps, total: 9.854, sample: 1.519, forward: 3.319, backward: 2.629, update: 2.351
[proc 0][Train](8000/10000) average pos_loss: 0.6635806589722634
[proc 0][Train](8000/10000) average neg_loss: 0.7140736500620842
[proc 0][Train](8000/10000) average loss: 0.6888271543979645
[proc 0][Train](8000/10000) average regularization: 0.00013974609134311322
[proc 0] 8000 steps, total: 9.854, sample: 1.501, forward: 3.219, backward: 2.312, update: 2.342
[proc 1][Train](8000/10000) average pos_loss: 0.6636136900782585
[proc 1][Train](8000/10000) average neg_loss: 0.7132603265047074
[proc 1][Train](8000/10000) average loss: 0.6884370085597038
[proc 1][Train](8000/10000) average regularization: 0.0001397600102063734
[proc 1] 8000 steps, total: 9.854, sample: 1.493, forward: 3.262, backward: 2.283, update: 2.381
[proc 3][Train](9000/10000) average pos_loss: 0.6593248521089554
[proc 3][Train](9000/10000) average neg_loss: 0.7086037634015083
[proc 3][Train](9000/10000) average loss: 0.683964307487011
[proc 3][Train](9000/10000) average regularization: 0.00014201948353729677
[proc 3] 9000 steps, total: 9.940, sample: 1.631, forward: 3.334, backward: 2.626, update: 2.346
[proc 2][Train](9000/10000) average pos_loss: 0.6591412541866303
[proc 2][Train](9000/10000) average neg_loss: 0.7094251381158829
[proc 2][Train](9000/10000) average loss: 0.6842831955552101
[proc 2][Train](9000/10000) average regularization: 0.00014193871451425365
[proc 2] 9000 steps, total: 9.940, sample: 1.616, forward: 3.339, backward: 2.616, update: 2.361
[proc 1][Train](9000/10000) average pos_loss: 0.6601111045479775
[proc 1][Train](9000/10000) average neg_loss: 0.7092186450958252
[proc 1][Train](9000/10000) average loss: 0.6846648752093315
[proc 1][Train](9000/10000) average regularization: 0.00014187519351253287
[proc 1] 9000 steps, total: 9.940, sample: 1.615, forward: 3.277, backward: 2.276, update: 2.364
[proc 0][Train](9000/10000) average pos_loss: 0.6595670261383056
[proc 0][Train](9000/10000) average neg_loss: 0.7095076643228531
[proc 0][Train](9000/10000) average loss: 0.6845373452901841
[proc 0][Train](9000/10000) average regularization: 0.00014189255288511049
[proc 0] 9000 steps, total: 9.941, sample: 1.571, forward: 3.215, backward: 2.166, update: 2.334
[proc 3][Train](10000/10000) average pos_loss: 0.6568760393857956
[proc 3][Train](10000/10000) average neg_loss: 0.7056326038241386
[proc 3][Train](10000/10000) average loss: 0.6812543217539787
[proc 3][Train](10000/10000) average regularization: 0.00014392937373486347
[proc 3] 10000 steps, total: 9.829, sample: 1.510, forward: 3.342, backward: 2.622, update: 2.351
proc 3 takes 108.285 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.6560309440493584
[proc 2][Train](10000/10000) average neg_loss: 0.7055955660343171
[proc 2][Train](10000/10000) average loss: 0.6808132538795472
[proc 2][Train](10000/10000) average regularization: 0.0001439071260392666
[proc 2] 10000 steps, total: 9.829, sample: 1.523, forward: 3.309, backward: 2.595, update: 2.326
proc 2 takes 108.528 seconds
[proc 0][Train](10000/10000) average pos_loss: 0.655667363524437
[proc 0][Train](10000/10000) average neg_loss: 0.705440037727356
[proc 0][Train](10000/10000) average loss: 0.6805537009835243
[proc 0][Train](10000/10000) average regularization: 0.00014379023769288323
[proc 0] 10000 steps, total: 9.829, sample: 1.494, forward: 3.219, backward: 1.931, update: 2.340
proc 0 takes 109.038 seconds
[proc 1][Train](10000/10000) average pos_loss: 0.6566889404058457
[proc 1][Train](10000/10000) average neg_loss: 0.7061005347371101
[proc 1][Train](10000/10000) average loss: 0.6813947383761406
[proc 1][Train](10000/10000) average regularization: 0.0001439017660013633
[proc 1] 10000 steps, total: 9.829, sample: 1.496, forward: 3.256, backward: 2.276, update: 2.348
proc 1 takes 108.797 seconds
Successfully xmh. training takes 112.63379907608032 seconds
