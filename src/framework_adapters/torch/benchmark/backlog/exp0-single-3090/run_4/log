Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
random partition 483142 edges into 5 parts
part 0 has 96629 edges
part 1 has 96629 edges
part 2 has 96629 edges
part 3 has 96629 edges
part 4 has 96626 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=None, batch_size=1000, batch_size_eval=16, data_files=None, data_path='/home/xieminhui/dgl-data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3, 4], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=5, num_proc=5, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='/tmp/ckpts/TransE_l1_FB15k_10', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 1.586 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 2][Train](1000/10000) average pos_loss: 0.14482416064664722
[proc 2][Train](1000/10000) average neg_loss: 0.16194377113878727
[proc 2][Train](1000/10000) average loss: 0.15338396574556828
[proc 2][Train](1000/10000) average regularization: 1.3437261387480249e-05
[proc 2] 1000 steps, total: 17.417, sample: 1.833, forward: 7.660, backward: 2.871, update: 5.045
[proc 0][Train](1000/10000) average pos_loss: 0.1449394637681544
[proc 0][Train](1000/10000) average neg_loss: 0.16123212541639806
[proc 0][Train](1000/10000) average loss: 0.15308579409122466
[proc 0][Train](1000/10000) average regularization: 1.3380082328012577e-05
[proc 0] 1000 steps, total: 17.458, sample: 1.808, forward: 7.603, backward: 2.737, update: 5.074
[proc 4][Train](1000/10000) average pos_loss: 0.1404914253242314
[proc 4][Train](1000/10000) average neg_loss: 0.15781419308483602
[proc 4][Train](1000/10000) average loss: 0.14915280941873788
[proc 4][Train](1000/10000) average regularization: 1.3445837692870554e-05
[proc 4] 1000 steps, total: 17.417, sample: 1.802, forward: 7.604, backward: 2.933, update: 4.820
[proc 1][Train](1000/10000) average pos_loss: 0.15097640065848827
[proc 1][Train](1000/10000) average neg_loss: 0.16116660702228547
[proc 1][Train](1000/10000) average loss: 0.1560715037211776
[proc 1][Train](1000/10000) average regularization: 1.3405712449639396e-05
[proc 1] 1000 steps, total: 17.418, sample: 1.867, forward: 7.541, backward: 2.821, update: 4.925
[proc 3][Train](1000/10000) average pos_loss: 0.1351703313998878
[proc 3][Train](1000/10000) average neg_loss: 0.16123268323391676
[proc 3][Train](1000/10000) average loss: 0.14820150781422853
[proc 3][Train](1000/10000) average regularization: 1.3345705973961231e-05
[proc 3] 1000 steps, total: 17.418, sample: 1.802, forward: 7.355, backward: 2.810, update: 5.019
[proc 2][Train](2000/10000) average pos_loss: 0.05736482720449567
[proc 2][Train](2000/10000) average neg_loss: 0.08497314605861903
[proc 2][Train](2000/10000) average loss: 0.07116898662224412
[proc 2][Train](2000/10000) average regularization: 1.8167882415582425e-05
[proc 2] 2000 steps, total: 14.861, sample: 1.777, forward: 5.051, backward: 3.071, update: 4.953
[proc 1][Train](2000/10000) average pos_loss: 0.05733696956932545
[proc 1][Train](2000/10000) average neg_loss: 0.08557712235301733
[proc 1][Train](2000/10000) average loss: 0.0714570460356772
[proc 1][Train](2000/10000) average regularization: 1.8119739443136496e-05
[proc 1] 2000 steps, total: 14.860, sample: 1.738, forward: 4.872, backward: 2.905, update: 4.830
[proc 4][Train](2000/10000) average pos_loss: 0.05741556765884161
[proc 4][Train](2000/10000) average neg_loss: 0.0855365538932383
[proc 4][Train](2000/10000) average loss: 0.07147606081888079
[proc 4][Train](2000/10000) average regularization: 1.8124977674233378e-05
[proc 4] 2000 steps, total: 14.861, sample: 1.749, forward: 4.971, backward: 2.842, update: 4.848
[proc 0][Train](2000/10000) average pos_loss: 0.05708616517484188
[proc 0][Train](2000/10000) average neg_loss: 0.0852048423551023
[proc 0][Train](2000/10000) average loss: 0.07114550368115306
[proc 0][Train](2000/10000) average regularization: 1.812576554948464e-05
[proc 0] 2000 steps, total: 14.861, sample: 1.750, forward: 5.072, backward: 2.750, update: 5.087
[proc 3][Train](2000/10000) average pos_loss: 0.05732000289857388
[proc 3][Train](2000/10000) average neg_loss: 0.08547978131100535
[proc 3][Train](2000/10000) average loss: 0.07139989205449819
[proc 3][Train](2000/10000) average regularization: 1.8107414072801476e-05
[proc 3] 2000 steps, total: 14.861, sample: 1.798, forward: 4.658, backward: 2.731, update: 5.130
[proc 0][Train](3000/10000) average pos_loss: 0.050041017644107344
[proc 0][Train](3000/10000) average neg_loss: 0.07629520399868488
[proc 0][Train](3000/10000) average loss: 0.06316811077669263
[proc 0][Train](3000/10000) average regularization: 1.9976136107288766e-05
[proc 0] 3000 steps, total: 14.873, sample: 1.797, forward: 5.130, backward: 2.741, update: 5.197
[proc 2][Train](3000/10000) average pos_loss: 0.049938217233866454
[proc 2][Train](3000/10000) average neg_loss: 0.07620423944294452
[proc 2][Train](3000/10000) average loss: 0.06307122825086117
[proc 2][Train](3000/10000) average regularization: 1.9979239677923033e-05
[proc 2] 3000 steps, total: 14.875, sample: 1.847, forward: 5.018, backward: 2.801, update: 5.092
[proc 4][Train](3000/10000) average pos_loss: 0.05018575210124254
[proc 4][Train](3000/10000) average neg_loss: 0.0765482062883675
[proc 4][Train](3000/10000) average loss: 0.06336697920039296
[proc 4][Train](3000/10000) average regularization: 1.9953724020524534e-05
[proc 4] 3000 steps, total: 14.874, sample: 1.811, forward: 5.042, backward: 2.716, update: 4.997
[proc 1][Train](3000/10000) average pos_loss: 0.05039683105051517
[proc 1][Train](3000/10000) average neg_loss: 0.07646287353336811
[proc 1][Train](3000/10000) average loss: 0.0634298523850739
[proc 1][Train](3000/10000) average regularization: 1.998253863530408e-05
[proc 1] 3000 steps, total: 14.874, sample: 1.853, forward: 4.962, backward: 2.852, update: 4.948
[proc 3][Train](3000/10000) average pos_loss: 0.05000935346633196
[proc 3][Train](3000/10000) average neg_loss: 0.07655326110124588
[proc 3][Train](3000/10000) average loss: 0.06328130726516247
[proc 3][Train](3000/10000) average regularization: 1.99301291431766e-05
[proc 3] 3000 steps, total: 14.874, sample: 1.777, forward: 4.622, backward: 2.756, update: 5.130
[proc 2][Train](4000/10000) average pos_loss: 0.046689101479947565
[proc 2][Train](4000/10000) average neg_loss: 0.07184434603899717
[proc 2][Train](4000/10000) average loss: 0.05926672375574708
[proc 2][Train](4000/10000) average regularization: 2.1158138562896057e-05
[proc 2] 4000 steps, total: 14.558, sample: 1.739, forward: 5.011, backward: 2.737, update: 5.064
[proc 4][Train](4000/10000) average pos_loss: 0.046891969203948974
[proc 4][Train](4000/10000) average neg_loss: 0.07221331197768449
[proc 4][Train](4000/10000) average loss: 0.059552640542387965
[proc 4][Train](4000/10000) average regularization: 2.115354385205137e-05
[proc 4] 4000 steps, total: 14.558, sample: 1.752, forward: 4.953, backward: 3.091, update: 4.743
[proc 3][Train](4000/10000) average pos_loss: 0.046836138531565666
[proc 3][Train](4000/10000) average neg_loss: 0.07212715874239803
[proc 3][Train](4000/10000) average loss: 0.05948164864629507
[proc 3][Train](4000/10000) average regularization: 2.113172988356382e-05
[proc 3] 4000 steps, total: 14.558, sample: 1.798, forward: 4.776, backward: 2.732, update: 5.153
[proc 1][Train](4000/10000) average pos_loss: 0.04662203132733703
[proc 1][Train](4000/10000) average neg_loss: 0.07238870095089078
[proc 1][Train](4000/10000) average loss: 0.05950536616146564
[proc 1][Train](4000/10000) average regularization: 2.113728920448921e-05
[proc 1] 4000 steps, total: 14.559, sample: 1.650, forward: 4.790, backward: 2.742, update: 4.799
[proc 0][Train](4000/10000) average pos_loss: 0.04641474825888872
[proc 0][Train](4000/10000) average neg_loss: 0.07214139590784907
[proc 0][Train](4000/10000) average loss: 0.05927807212993503
[proc 0][Train](4000/10000) average regularization: 2.113450810247741e-05
[proc 0] 4000 steps, total: 14.560, sample: 1.713, forward: 4.979, backward: 2.737, update: 5.036
[proc 2][Train](5000/10000) average pos_loss: 0.04462680177390575
[proc 2][Train](5000/10000) average neg_loss: 0.06929314981028438
[proc 2][Train](5000/10000) average loss: 0.05695997580885887
[proc 2][Train](5000/10000) average regularization: 2.203664138323802e-05
[proc 2] 5000 steps, total: 14.852, sample: 1.915, forward: 5.010, backward: 2.998, update: 4.920
[proc 1][Train](5000/10000) average pos_loss: 0.04482618812099099
[proc 1][Train](5000/10000) average neg_loss: 0.06952151538431645
[proc 1][Train](5000/10000) average loss: 0.05717385185882449
[proc 1][Train](5000/10000) average regularization: 2.2025207052138286e-05
[proc 1] 5000 steps, total: 14.851, sample: 1.937, forward: 4.886, backward: 3.052, update: 4.766
[proc 3][Train](5000/10000) average pos_loss: 0.04443327582255006
[proc 3][Train](5000/10000) average neg_loss: 0.06942940087988973
[proc 3][Train](5000/10000) average loss: 0.0569313383847475
[proc 3][Train](5000/10000) average regularization: 2.1994258817358058e-05
[proc 3] 5000 steps, total: 14.852, sample: 1.943, forward: 4.553, backward: 2.767, update: 5.065
[proc 0][Train](5000/10000) average pos_loss: 0.04420507541671395
[proc 0][Train](5000/10000) average neg_loss: 0.06934824636206031
[proc 0][Train](5000/10000) average loss: 0.05677666091173887
[proc 0][Train](5000/10000) average regularization: 2.199277578802139e-05
[proc 0] 5000 steps, total: 14.852, sample: 1.935, forward: 4.982, backward: 2.043, update: 5.330
[proc 4][Train](5000/10000) average pos_loss: 0.04467413486912847
[proc 4][Train](5000/10000) average neg_loss: 0.06960821667313576
[proc 4][Train](5000/10000) average loss: 0.05714117573201656
[proc 4][Train](5000/10000) average regularization: 2.2012953702869707e-05
[proc 4] 5000 steps, total: 14.853, sample: 1.915, forward: 4.949, backward: 2.869, update: 4.805
[proc 0][Train](6000/10000) average pos_loss: 0.043178860332816836
[proc 0][Train](6000/10000) average neg_loss: 0.06747967837750912
[proc 0][Train](6000/10000) average loss: 0.05532926937192678
[proc 0][Train](6000/10000) average regularization: 2.2703223365169835e-05
[proc 0] 6000 steps, total: 14.856, sample: 1.731, forward: 4.975, backward: 3.469, update: 4.674
[proc 3][Train](6000/10000) average pos_loss: 0.04301333906501532
[proc 3][Train](6000/10000) average neg_loss: 0.06761524207517505
[proc 3][Train](6000/10000) average loss: 0.05531429056078196
[proc 3][Train](6000/10000) average regularization: 2.2683048466205946e-05
[proc 3] 6000 steps, total: 14.857, sample: 1.759, forward: 4.745, backward: 2.761, update: 4.981
[proc 4][Train](6000/10000) average pos_loss: 0.043066322360187766
[proc 4][Train](6000/10000) average neg_loss: 0.0680190425477922
[proc 4][Train](6000/10000) average loss: 0.05554268235713244
[proc 4][Train](6000/10000) average regularization: 2.2694241233693902e-05
[proc 4] 6000 steps, total: 14.857, sample: 1.736, forward: 4.960, backward: 2.708, update: 4.846
[proc 2][Train](6000/10000) average pos_loss: 0.0430287409350276
[proc 2][Train](6000/10000) average neg_loss: 0.06745520895346999
[proc 2][Train](6000/10000) average loss: 0.05524197493493557
[proc 2][Train](6000/10000) average regularization: 2.2714416634698865e-05
[proc 2] 6000 steps, total: 14.858, sample: 1.779, forward: 5.023, backward: 2.755, update: 5.073
[proc 1][Train](6000/10000) average pos_loss: 0.04315404671058059
[proc 1][Train](6000/10000) average neg_loss: 0.06778375927358865
[proc 1][Train](6000/10000) average loss: 0.05546890301257372
[proc 1][Train](6000/10000) average regularization: 2.2705349651005235e-05
[proc 1] 6000 steps, total: 14.858, sample: 1.709, forward: 4.868, backward: 2.705, update: 4.888
[proc 1][Train](7000/10000) average pos_loss: 0.042487250685691834
[proc 1][Train](7000/10000) average neg_loss: 0.06633963590860367
[proc 1][Train](7000/10000) average loss: 0.05441344332695007
[proc 1][Train](7000/10000) average regularization: 2.3287786756554852e-05
[proc 1] 7000 steps, total: 14.822, sample: 1.963, forward: 4.947, backward: 2.886, update: 5.017
[proc 2][Train](7000/10000) average pos_loss: 0.04202353734523058
[proc 2][Train](7000/10000) average neg_loss: 0.06617463137581944
[proc 2][Train](7000/10000) average loss: 0.05409908439964056
[proc 2][Train](7000/10000) average regularization: 2.3275644562090747e-05
[proc 2] 7000 steps, total: 14.823, sample: 1.816, forward: 5.013, backward: 2.787, update: 4.955
[proc 0][Train](7000/10000) average pos_loss: 0.04181497737020254
[proc 0][Train](7000/10000) average neg_loss: 0.06625495824217796
[proc 0][Train](7000/10000) average loss: 0.05403496780246496
[proc 0][Train](7000/10000) average regularization: 2.3250257301697275e-05
[proc 0] 7000 steps, total: 14.824, sample: 1.785, forward: 5.008, backward: 2.831, update: 4.891
[proc 4][Train](7000/10000) average pos_loss: 0.04214323713630438
[proc 4][Train](7000/10000) average neg_loss: 0.06655417424812914
[proc 4][Train](7000/10000) average loss: 0.054348705697804686
[proc 4][Train](7000/10000) average regularization: 2.325892597400525e-05
[proc 4] 7000 steps, total: 14.823, sample: 1.801, forward: 4.985, backward: 2.745, update: 4.867
[proc 3][Train](7000/10000) average pos_loss: 0.04192536510154605
[proc 3][Train](7000/10000) average neg_loss: 0.06648816019669175
[proc 3][Train](7000/10000) average loss: 0.05420676267892122
[proc 3][Train](7000/10000) average regularization: 2.3243241079399012e-05
[proc 3] 7000 steps, total: 14.823, sample: 1.815, forward: 4.652, backward: 2.696, update: 4.993
[proc 2][Train](8000/10000) average pos_loss: 0.04124503751844168
[proc 2][Train](8000/10000) average neg_loss: 0.0651056873574853
[proc 2][Train](8000/10000) average loss: 0.05317536246776581
[proc 2][Train](8000/10000) average regularization: 2.3755856558636877e-05
[proc 2] 8000 steps, total: 14.661, sample: 1.802, forward: 5.113, backward: 2.752, update: 4.986
[proc 1][Train](8000/10000) average pos_loss: 0.041360844243317846
[proc 1][Train](8000/10000) average neg_loss: 0.06538350524008274
[proc 1][Train](8000/10000) average loss: 0.05337217469885945
[proc 1][Train](8000/10000) average regularization: 2.3759639600029912e-05
[proc 1] 8000 steps, total: 14.662, sample: 1.807, forward: 4.807, backward: 3.333, update: 4.681
[proc 4][Train](8000/10000) average pos_loss: 0.041330092512071134
[proc 4][Train](8000/10000) average neg_loss: 0.06548159147799015
[proc 4][Train](8000/10000) average loss: 0.053405841931700705
[proc 4][Train](8000/10000) average regularization: 2.3746066151943524e-05
[proc 4] 8000 steps, total: 14.661, sample: 1.800, forward: 4.992, backward: 2.764, update: 4.792
[proc 0][Train](8000/10000) average pos_loss: 0.041076628152281046
[proc 0][Train](8000/10000) average neg_loss: 0.06520172552764415
[proc 0][Train](8000/10000) average loss: 0.05313917689397931
[proc 0][Train](8000/10000) average regularization: 2.3730172411887906e-05
[proc 0] 8000 steps, total: 14.661, sample: 1.771, forward: 5.020, backward: 2.800, update: 4.878
[proc 3][Train](8000/10000) average pos_loss: 0.041205071680247785
[proc 3][Train](8000/10000) average neg_loss: 0.06533651083707809
[proc 3][Train](8000/10000) average loss: 0.05327079124003649
[proc 3][Train](8000/10000) average regularization: 2.3725352857582038e-05
[proc 3] 8000 steps, total: 14.661, sample: 1.830, forward: 4.692, backward: 2.751, update: 4.972
[proc 2][Train](9000/10000) average pos_loss: 0.040629077892750505
[proc 2][Train](9000/10000) average neg_loss: 0.06429866570606828
[proc 2][Train](9000/10000) average loss: 0.052463871791958806
[proc 2][Train](9000/10000) average regularization: 2.4175237169401954e-05
[proc 2] 9000 steps, total: 14.877, sample: 1.974, forward: 5.128, backward: 2.773, update: 4.994
[proc 3][Train](9000/10000) average pos_loss: 0.04047529570758343
[proc 3][Train](9000/10000) average neg_loss: 0.06453436337038874
[proc 3][Train](9000/10000) average loss: 0.05250482948496938
[proc 3][Train](9000/10000) average regularization: 2.414063020114554e-05
[proc 3] 9000 steps, total: 14.877, sample: 1.951, forward: 4.675, backward: 2.470, update: 5.064
[proc 0][Train](9000/10000) average pos_loss: 0.04042176781967282
[proc 0][Train](9000/10000) average neg_loss: 0.0643982543349266
[proc 0][Train](9000/10000) average loss: 0.05241001110523939
[proc 0][Train](9000/10000) average regularization: 2.4153881649908727e-05
[proc 0] 9000 steps, total: 14.877, sample: 1.912, forward: 5.019, backward: 2.766, update: 4.905
[proc 1][Train](9000/10000) average pos_loss: 0.04066214382275939
[proc 1][Train](9000/10000) average neg_loss: 0.0645755314156413
[proc 1][Train](9000/10000) average loss: 0.052618837621062994
[proc 1][Train](9000/10000) average regularization: 2.417491766573221e-05
[proc 1] 9000 steps, total: 14.878, sample: 1.955, forward: 4.746, backward: 2.725, update: 4.939
[proc 4][Train](9000/10000) average pos_loss: 0.040704984784126284
[proc 4][Train](9000/10000) average neg_loss: 0.06463463454321026
[proc 4][Train](9000/10000) average loss: 0.05266980972513557
[proc 4][Train](9000/10000) average regularization: 2.4157130455932928e-05
[proc 4] 9000 steps, total: 14.878, sample: 1.960, forward: 4.985, backward: 2.791, update: 4.872
[proc 4][Train](10000/10000) average pos_loss: 0.04010686914622784
[proc 4][Train](10000/10000) average neg_loss: 0.0639771632887423
[proc 4][Train](10000/10000) average loss: 0.05204201625287533
[proc 4][Train](10000/10000) average regularization: 2.452935961991898e-05
[proc 4] 10000 steps, total: 14.525, sample: 1.795, forward: 4.921, backward: 2.803, update: 4.955
[proc 0][Train](10000/10000) average pos_loss: 0.039867194920778275
[proc 0][Train](10000/10000) average neg_loss: 0.06379006347805262
[proc 0][Train](10000/10000) average loss: 0.05182862918451429
[proc 0][Train](10000/10000) average regularization: 2.4511784895366874e-05
[proc 0] 10000 steps, total: 14.526, sample: 1.766, forward: 4.983, backward: 2.750, update: 4.924
proc 4 takes 150.308 seconds
proc 0 takes 150.349 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.03990617667138577
[proc 2][Train](10000/10000) average neg_loss: 0.06366628039255738
[proc 2][Train](10000/10000) average loss: 0.05178622850775719
[proc 2][Train](10000/10000) average regularization: 2.453779744064377e-05
[proc 2] 10000 steps, total: 14.527, sample: 1.781, forward: 5.047, backward: 2.725, update: 4.966
proc 2 takes 150.309 seconds
[proc 3][Train](10000/10000) average pos_loss: 0.04005222734808922
[proc 3][Train](10000/10000) average neg_loss: 0.06387246653437614
[proc 3][Train](10000/10000) average loss: 0.05196234691143036
[proc 3][Train](10000/10000) average regularization: 2.4509056136594154e-05
[proc 3] 10000 steps, total: 14.526, sample: 1.807, forward: 4.713, backward: 2.798, update: 5.010
proc 3 takes 150.308 seconds
[proc 1][Train](10000/10000) average pos_loss: 0.040206915963441135
[proc 1][Train](10000/10000) average neg_loss: 0.06384251611307264
[proc 1][Train](10000/10000) average loss: 0.0520247160308063
[proc 1][Train](10000/10000) average regularization: 2.4537600909752654e-05
[proc 1] 10000 steps, total: 14.526, sample: 1.802, forward: 4.830, backward: 2.773, update: 4.949
proc 1 takes 150.309 seconds
Successfully xmh. training takes 151.04371619224548 seconds
