Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
random partition 483142 edges into 4 parts
part 0 has 120786 edges
part 1 has 120786 edges
part 2 has 120786 edges
part 3 has 120784 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=None, batch_size=1000, batch_size_eval=16, data_files=None, data_path='/home/xieminhui/dgl-data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=4, num_proc=4, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='/tmp/ckpts/TransE_l1_FB15k_9', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 0.951 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 3][Train](1000/10000) average pos_loss: 0.15428401620686055
[proc 3][Train](1000/10000) average neg_loss: 0.17197811533510685
[proc 3][Train](1000/10000) average loss: 0.16313106572628022
[proc 3][Train](1000/10000) average regularization: 1.2795474278846086e-05
[proc 3] 1000 steps, total: 17.014, sample: 1.783, forward: 7.392, backward: 2.768, update: 5.063
[proc 0][Train](1000/10000) average pos_loss: 0.15815120324119925
[proc 0][Train](1000/10000) average neg_loss: 0.17998114609718321
[proc 0][Train](1000/10000) average loss: 0.16906617464870213
[proc 0][Train](1000/10000) average regularization: 1.2546907304340494e-05
[proc 0] 1000 steps, total: 17.040, sample: 1.628, forward: 6.941, backward: 2.681, update: 4.714
[proc 2][Train](1000/10000) average pos_loss: 0.14604883648455144
[proc 2][Train](1000/10000) average neg_loss: 0.1706231321617961
[proc 2][Train](1000/10000) average loss: 0.15833598428964615
[proc 2][Train](1000/10000) average regularization: 1.277260610322628e-05
[proc 2] 1000 steps, total: 17.015, sample: 1.696, forward: 7.324, backward: 2.702, update: 5.031
[proc 1][Train](1000/10000) average pos_loss: 0.15843214418366552
[proc 1][Train](1000/10000) average neg_loss: 0.17631606411933898
[proc 1][Train](1000/10000) average loss: 0.16737410408258438
[proc 1][Train](1000/10000) average regularization: 1.2697342895990004e-05
[proc 1] 1000 steps, total: 17.032, sample: 1.715, forward: 7.201, backward: 2.746, update: 5.025
[proc 3][Train](2000/10000) average pos_loss: 0.06064476279914379
[proc 3][Train](2000/10000) average neg_loss: 0.08938911829516291
[proc 3][Train](2000/10000) average loss: 0.07501694062352181
[proc 3][Train](2000/10000) average regularization: 1.7464541548179114e-05
[proc 3] 2000 steps, total: 14.831, sample: 1.782, forward: 5.132, backward: 2.907, update: 5.002
[proc 1][Train](2000/10000) average pos_loss: 0.0606830338165164
[proc 1][Train](2000/10000) average neg_loss: 0.08935332822799683
[proc 1][Train](2000/10000) average loss: 0.07501818089187146
[proc 1][Train](2000/10000) average regularization: 1.744210067590757e-05
[proc 1] 2000 steps, total: 14.829, sample: 1.684, forward: 4.964, backward: 2.736, update: 5.011
[proc 2][Train](2000/10000) average pos_loss: 0.06113579909130931
[proc 2][Train](2000/10000) average neg_loss: 0.08974668981134891
[proc 2][Train](2000/10000) average loss: 0.07544124448671936
[proc 2][Train](2000/10000) average regularization: 1.743539504423097e-05
[proc 2] 2000 steps, total: 14.830, sample: 1.650, forward: 5.008, backward: 2.808, update: 5.014
[proc 0][Train](2000/10000) average pos_loss: 0.06101397752761841
[proc 0][Train](2000/10000) average neg_loss: 0.09005796597152949
[proc 0][Train](2000/10000) average loss: 0.07553597185015679
[proc 0][Train](2000/10000) average regularization: 1.7362178965413477e-05
[proc 0] 2000 steps, total: 14.830, sample: 1.574, forward: 4.644, backward: 2.686, update: 4.692
[proc 1][Train](3000/10000) average pos_loss: 0.05264437520503998
[proc 1][Train](3000/10000) average neg_loss: 0.07925414356589318
[proc 1][Train](3000/10000) average loss: 0.06594925937056541
[proc 1][Train](3000/10000) average regularization: 1.9314960514748235e-05
[proc 1] 3000 steps, total: 14.773, sample: 1.757, forward: 5.127, backward: 2.787, update: 5.095
[proc 3][Train](3000/10000) average pos_loss: 0.05227280597016215
[proc 3][Train](3000/10000) average neg_loss: 0.079329903639853
[proc 3][Train](3000/10000) average loss: 0.06580135484412312
[proc 3][Train](3000/10000) average regularization: 1.928755471089971e-05
[proc 3] 3000 steps, total: 14.775, sample: 1.707, forward: 4.921, backward: 2.712, update: 4.949
[proc 2][Train](3000/10000) average pos_loss: 0.05263340688869357
[proc 2][Train](3000/10000) average neg_loss: 0.07965372103080154
[proc 2][Train](3000/10000) average loss: 0.0661435639820993
[proc 2][Train](3000/10000) average regularization: 1.9261486229879667e-05
[proc 2] 3000 steps, total: 14.775, sample: 1.695, forward: 4.985, backward: 2.190, update: 5.297
[proc 0][Train](3000/10000) average pos_loss: 0.05280267958343029
[proc 0][Train](3000/10000) average neg_loss: 0.07970322029292584
[proc 0][Train](3000/10000) average loss: 0.06625294986739755
[proc 0][Train](3000/10000) average regularization: 1.925520209078968e-05
[proc 0] 3000 steps, total: 14.778, sample: 1.618, forward: 4.706, backward: 2.765, update: 4.716
[proc 1][Train](4000/10000) average pos_loss: 0.04847896477207542
[proc 1][Train](4000/10000) average neg_loss: 0.07447227446362376
[proc 1][Train](4000/10000) average loss: 0.061475619558244946
[proc 1][Train](4000/10000) average regularization: 2.0488579126322294e-05
[proc 1] 4000 steps, total: 14.661, sample: 1.708, forward: 5.125, backward: 2.669, update: 5.151
[proc 2][Train](4000/10000) average pos_loss: 0.04899609091505408
[proc 2][Train](4000/10000) average neg_loss: 0.07485997134447098
[proc 2][Train](4000/10000) average loss: 0.06192803103104234
[proc 2][Train](4000/10000) average regularization: 2.0465788706133025e-05
[proc 2] 4000 steps, total: 14.660, sample: 1.675, forward: 4.970, backward: 2.684, update: 5.048
[proc 0][Train](4000/10000) average pos_loss: 0.048700456500053405
[proc 0][Train](4000/10000) average neg_loss: 0.07465624545514583
[proc 0][Train](4000/10000) average loss: 0.06167835111543536
[proc 0][Train](4000/10000) average regularization: 2.0440976426471023e-05
[proc 0] 4000 steps, total: 14.657, sample: 1.571, forward: 4.709, backward: 2.719, update: 4.697
[proc 3][Train](4000/10000) average pos_loss: 0.04853105417639017
[proc 3][Train](4000/10000) average neg_loss: 0.07447404458746314
[proc 3][Train](4000/10000) average loss: 0.06150254940241575
[proc 3][Train](4000/10000) average regularization: 2.0471653338972828e-05
[proc 3] 4000 steps, total: 14.661, sample: 1.709, forward: 4.977, backward: 2.731, update: 5.005
[proc 1][Train](5000/10000) average pos_loss: 0.046127222783863546
[proc 1][Train](5000/10000) average neg_loss: 0.07131242763623595
[proc 1][Train](5000/10000) average loss: 0.05871982515975833
[proc 1][Train](5000/10000) average regularization: 2.1362204608522006e-05
[proc 1] 5000 steps, total: 14.655, sample: 1.842, forward: 5.009, backward: 2.738, update: 5.058
[proc 2][Train](5000/10000) average pos_loss: 0.04649277107045054
[proc 2][Train](5000/10000) average neg_loss: 0.07179139857366681
[proc 2][Train](5000/10000) average loss: 0.059142084855586294
[proc 2][Train](5000/10000) average regularization: 2.1346187681047012e-05
[proc 2] 5000 steps, total: 14.655, sample: 1.821, forward: 4.905, backward: 2.751, update: 4.940
[proc 0][Train](5000/10000) average pos_loss: 0.04639308799430728
[proc 0][Train](5000/10000) average neg_loss: 0.07166763181239366
[proc 0][Train](5000/10000) average loss: 0.05903035994246602
[proc 0][Train](5000/10000) average regularization: 2.1317789038221235e-05
[proc 0] 5000 steps, total: 14.655, sample: 1.778, forward: 4.634, backward: 2.673, update: 4.671
[proc 3][Train](5000/10000) average pos_loss: 0.04615255418792367
[proc 3][Train](5000/10000) average neg_loss: 0.0715111935287714
[proc 3][Train](5000/10000) average loss: 0.05883187386393547
[proc 3][Train](5000/10000) average regularization: 2.134288303022913e-05
[proc 3] 5000 steps, total: 14.655, sample: 1.838, forward: 4.893, backward: 2.707, update: 4.948
[proc 3][Train](6000/10000) average pos_loss: 0.044653831515461206
[proc 3][Train](6000/10000) average neg_loss: 0.06929356141388417
[proc 3][Train](6000/10000) average loss: 0.05697369644418359
[proc 3][Train](6000/10000) average regularization: 2.2040238047338788e-05
[proc 3] 6000 steps, total: 14.473, sample: 1.709, forward: 5.010, backward: 2.743, update: 5.004
[proc 2][Train](6000/10000) average pos_loss: 0.044810477327555415
[proc 2][Train](6000/10000) average neg_loss: 0.06958406091853976
[proc 2][Train](6000/10000) average loss: 0.057197269156575206
[proc 2][Train](6000/10000) average regularization: 2.2028521738320705e-05
[proc 2] 6000 steps, total: 14.474, sample: 1.647, forward: 4.950, backward: 2.717, update: 5.012
[proc 1][Train](6000/10000) average pos_loss: 0.04432575446739793
[proc 1][Train](6000/10000) average neg_loss: 0.06934330034255981
[proc 1][Train](6000/10000) average loss: 0.05683452739194036
[proc 1][Train](6000/10000) average regularization: 2.204060705662414e-05
[proc 1] 6000 steps, total: 14.475, sample: 1.651, forward: 4.903, backward: 2.734, update: 4.942
[proc 0][Train](6000/10000) average pos_loss: 0.04466307192668319
[proc 0][Train](6000/10000) average neg_loss: 0.06955271889269352
[proc 0][Train](6000/10000) average loss: 0.05710789542645216
[proc 0][Train](6000/10000) average regularization: 2.2003833126291282e-05
[proc 0] 6000 steps, total: 14.474, sample: 1.549, forward: 4.639, backward: 2.664, update: 4.687
[proc 2][Train](7000/10000) average pos_loss: 0.0436131805293262
[proc 2][Train](7000/10000) average neg_loss: 0.06825897070020437
[proc 2][Train](7000/10000) average loss: 0.05593607565015554
[proc 2][Train](7000/10000) average regularization: 2.260069475050841e-05
[proc 2] 7000 steps, total: 14.460, sample: 1.702, forward: 4.987, backward: 2.751, update: 5.013
[proc 3][Train](7000/10000) average pos_loss: 0.043213051602244375
[proc 3][Train](7000/10000) average neg_loss: 0.06783108718693256
[proc 3][Train](7000/10000) average loss: 0.05552206937968731
[proc 3][Train](7000/10000) average regularization: 2.2608588937146122e-05
[proc 3] 7000 steps, total: 14.461, sample: 1.693, forward: 4.921, backward: 2.756, update: 4.959
[proc 1][Train](7000/10000) average pos_loss: 0.043219052731990816
[proc 1][Train](7000/10000) average neg_loss: 0.0678526870124042
[proc 1][Train](7000/10000) average loss: 0.05553586979582906
[proc 1][Train](7000/10000) average regularization: 2.2611915097513703e-05
[proc 1] 7000 steps, total: 14.461, sample: 1.689, forward: 4.899, backward: 2.722, update: 4.950
[proc 0][Train](7000/10000) average pos_loss: 0.04345229652151465
[proc 0][Train](7000/10000) average neg_loss: 0.06794574762880802
[proc 0][Train](7000/10000) average loss: 0.05569902217760682
[proc 0][Train](7000/10000) average regularization: 2.25772156027233e-05
[proc 0] 7000 steps, total: 14.461, sample: 1.590, forward: 4.640, backward: 2.645, update: 4.695
[proc 3][Train](8000/10000) average pos_loss: 0.04231075512990355
[proc 3][Train](8000/10000) average neg_loss: 0.0666171038299799
[proc 3][Train](8000/10000) average loss: 0.054463929474353794
[proc 3][Train](8000/10000) average regularization: 2.3087921555998038e-05
[proc 3] 8000 steps, total: 14.452, sample: 1.665, forward: 4.999, backward: 2.813, update: 4.967
[proc 1][Train](8000/10000) average pos_loss: 0.04221481253951788
[proc 1][Train](8000/10000) average neg_loss: 0.06658918461948633
[proc 1][Train](8000/10000) average loss: 0.05440199855342508
[proc 1][Train](8000/10000) average regularization: 2.3091602515705744e-05
[proc 1] 8000 steps, total: 14.452, sample: 1.629, forward: 4.927, backward: 2.656, update: 4.960
[proc 2][Train](8000/10000) average pos_loss: 0.042636044256389144
[proc 2][Train](8000/10000) average neg_loss: 0.067051638122648
[proc 2][Train](8000/10000) average loss: 0.05484384114667773
[proc 2][Train](8000/10000) average regularization: 2.3081970044586342e-05
[proc 2] 8000 steps, total: 14.453, sample: 1.646, forward: 4.950, backward: 2.797, update: 4.991
[proc 0][Train](8000/10000) average pos_loss: 0.042560964096337556
[proc 0][Train](8000/10000) average neg_loss: 0.06674338717758656
[proc 0][Train](8000/10000) average loss: 0.05465217561274767
[proc 0][Train](8000/10000) average regularization: 2.3062786704031167e-05
[proc 0] 8000 steps, total: 14.452, sample: 1.577, forward: 4.652, backward: 2.720, update: 4.690
[proc 2][Train](9000/10000) average pos_loss: 0.04195029674842954
[proc 2][Train](9000/10000) average neg_loss: 0.06598118253052235
[proc 2][Train](9000/10000) average loss: 0.05396573966369033
[proc 2][Train](9000/10000) average regularization: 2.3502674008341272e-05
[proc 2] 9000 steps, total: 14.588, sample: 1.731, forward: 5.043, backward: 2.742, update: 5.065
[proc 0][Train](9000/10000) average pos_loss: 0.041687546379864215
[proc 0][Train](9000/10000) average neg_loss: 0.0659101342484355
[proc 0][Train](9000/10000) average loss: 0.053798840329051016
[proc 0][Train](9000/10000) average regularization: 2.3485017531129414e-05
[proc 0] 9000 steps, total: 14.589, sample: 1.595, forward: 4.636, backward: 2.711, update: 4.674
[proc 1][Train](9000/10000) average pos_loss: 0.04159482636675239
[proc 1][Train](9000/10000) average neg_loss: 0.06566367550939321
[proc 1][Train](9000/10000) average loss: 0.053629250943660736
[proc 1][Train](9000/10000) average regularization: 2.351674840247142e-05
[proc 1] 9000 steps, total: 14.589, sample: 1.689, forward: 4.933, backward: 2.750, update: 4.983
[proc 3][Train](9000/10000) average pos_loss: 0.04152727669477463
[proc 3][Train](9000/10000) average neg_loss: 0.06571175502985716
[proc 3][Train](9000/10000) average loss: 0.05361951586604118
[proc 3][Train](9000/10000) average regularization: 2.3504170938394963e-05
[proc 3] 9000 steps, total: 14.590, sample: 1.660, forward: 4.856, backward: 2.731, update: 4.924
[proc 2][Train](10000/10000) average pos_loss: 0.04133437975868583
[proc 2][Train](10000/10000) average neg_loss: 0.06517552480101585
[proc 2][Train](10000/10000) average loss: 0.05325495221838355
[proc 2][Train](10000/10000) average regularization: 2.3876531047790194e-05
[proc 2] 10000 steps, total: 15.024, sample: 1.895, forward: 5.191, backward: 2.811, update: 5.119
proc 2 takes 148.934 seconds
[proc 1][Train](10000/10000) average pos_loss: 0.04094511000439525
[proc 1][Train](10000/10000) average neg_loss: 0.06487485517188907
[proc 1][Train](10000/10000) average loss: 0.05290998260676861
[proc 1][Train](10000/10000) average regularization: 2.3882113631771062e-05
[proc 1] 10000 steps, total: 15.024, sample: 1.808, forward: 4.965, backward: 2.726, update: 4.995
proc 1 takes 148.952 seconds
[proc 3][Train](10000/10000) average pos_loss: 0.04095587142556906
[proc 3][Train](10000/10000) average neg_loss: 0.06496431176364421
[proc 3][Train](10000/10000) average loss: 0.05296009158715606
[proc 3][Train](10000/10000) average regularization: 2.3875784676420155e-05
[proc 3] 10000 steps, total: 15.024, sample: 1.825, forward: 4.870, backward: 2.708, update: 4.913
proc 3 takes 148.935 seconds
[proc 0][Train](10000/10000) average pos_loss: 0.04109357962012291
[proc 0][Train](10000/10000) average neg_loss: 0.06518707195296884
[proc 0][Train](10000/10000) average loss: 0.053140325792133805
[proc 0][Train](10000/10000) average regularization: 2.38535463813605e-05
[proc 0] 10000 steps, total: 15.025, sample: 1.688, forward: 4.618, backward: 2.676, update: 4.681
proc 0 takes 148.961 seconds
Successfully xmh. training takes 149.49885511398315 seconds
