perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f74b9c9ae50>==========
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 2/1000 [00:00<00:52, 18.86it/s]  1%|▏         | 13/1000 [00:00<00:14, 68.77it/s]  2%|▎         | 25/1000 [00:00<00:10, 89.40it/s]  4%|▍         | 38/1000 [00:00<00:09, 97.31it/s]  5%|▌         | 52/1000 [00:00<00:08, 109.61it/s]  7%|▋         | 66/1000 [00:00<00:07, 119.23it/s]  8%|▊         | 81/1000 [00:00<00:07, 127.94it/s] 10%|▉         | 97/1000 [00:00<00:06, 135.26it/s]Step99:rank0, time: 0.877, per_step: 0.008773
 11%|█▏        | 113/1000 [00:00<00:06, 141.09it/s] 13%|█▎        | 129/1000 [00:01<00:05, 146.26it/s] 15%|█▍        | 146/1000 [00:01<00:05, 150.91it/s] 16%|█▌        | 162/1000 [00:01<00:05, 149.94it/s] 18%|█▊        | 178/1000 [00:01<00:05, 142.96it/s] 19%|█▉        | 193/1000 [00:01<00:05, 135.89it/s]Step199:rank0, time: 0.697, per_step: 0.006905
 21%|██        | 208/1000 [00:01<00:05, 138.77it/s] 22%|██▎       | 225/1000 [00:01<00:05, 146.41it/s] 24%|██▍       | 241/1000 [00:01<00:05, 149.09it/s] 26%|██▌       | 257/1000 [00:01<00:04, 150.47it/s] 27%|██▋       | 274/1000 [00:02<00:04, 153.65it/s] 29%|██▉       | 291/1000 [00:02<00:04, 157.41it/s]Step299:rank0, time: 0.627, per_step: 0.006204
 31%|███       | 307/1000 [00:02<00:04, 156.75it/s] 32%|███▏      | 323/1000 [00:02<00:04, 154.60it/s] 34%|███▍      | 339/1000 [00:02<00:04, 151.51it/s] 36%|███▌      | 356/1000 [00:02<00:04, 155.23it/s] 37%|███▋      | 372/1000 [00:02<00:04, 155.40it/s] 39%|███▉      | 388/1000 [00:02<00:03, 156.01it/s]Step399:rank0, time: 0.644, per_step: 0.006376
 40%|████      | 405/1000 [00:02<00:03, 156.91it/s] 42%|████▏     | 421/1000 [00:02<00:03, 155.37it/s] 44%|████▍     | 438/1000 [00:03<00:03, 158.46it/s] 45%|████▌     | 454/1000 [00:03<00:03, 158.26it/s] 47%|████▋     | 471/1000 [00:03<00:03, 159.56it/s] 49%|████▊     | 487/1000 [00:03<00:03, 159.39it/s]Step499:rank0, time: 0.638, per_step: 0.006320
 50%|█████     | 503/1000 [00:03<00:03, 149.58it/s] 52%|█████▏    | 520/1000 [00:03<00:03, 153.50it/s] 54%|█████▎    | 537/1000 [00:03<00:02, 157.16it/s] 55%|█████▌    | 554/1000 [00:03<00:02, 158.28it/s] 57%|█████▋    | 570/1000 [00:03<00:02, 157.46it/s] 59%|█████▊    | 587/1000 [00:04<00:02, 160.05it/s]Step599:rank0, time: 0.628, per_step: 0.006217
 60%|██████    | 604/1000 [00:04<00:02, 161.47it/s] 62%|██████▏   | 621/1000 [00:04<00:02, 162.79it/s] 64%|██████▍   | 638/1000 [00:04<00:02, 163.52it/s] 66%|██████▌   | 655/1000 [00:04<00:02, 164.10it/s] 67%|██████▋   | 672/1000 [00:04<00:02, 152.38it/s] 69%|██████▉   | 688/1000 [00:04<00:02, 150.54it/s]Step699:rank0, time: 0.650, per_step: 0.006433
 70%|███████   | 704/1000 [00:04<00:01, 151.56it/s] 72%|███████▏  | 720/1000 [00:04<00:01, 153.59it/s] 74%|███████▎  | 736/1000 [00:04<00:01, 154.84it/s] 75%|███████▌  | 753/1000 [00:05<00:01, 157.10it/s] 77%|███████▋  | 770/1000 [00:05<00:01, 158.18it/s] 79%|███████▊  | 787/1000 [00:05<00:01, 159.77it/s]Step799:rank0, time: 0.626, per_step: 0.006200
 80%|████████  | 803/1000 [00:05<00:01, 158.91it/s] 82%|████████▏ | 819/1000 [00:05<00:01, 158.87it/s] 84%|████████▎ | 836/1000 [00:05<00:01, 160.32it/s] 85%|████████▌ | 853/1000 [00:05<00:00, 158.13it/s] 87%|████████▋ | 870/1000 [00:05<00:00, 158.89it/s] 89%|████████▊ | 887/1000 [00:05<00:00, 160.00it/s]Step899:rank0, time: 0.629, per_step: 0.006226
 90%|█████████ | 904/1000 [00:06<00:00, 158.70it/s] 92%|█████████▏| 921/1000 [00:06<00:00, 159.91it/s] 94%|█████████▍| 938/1000 [00:06<00:00, 160.35it/s] 96%|█████████▌| 955/1000 [00:06<00:00, 160.33it/s] 97%|█████████▋| 972/1000 [00:06<00:00, 160.40it/s] 99%|█████████▉| 989/1000 [00:06<00:00, 161.80it/s]Step999:rank0, time: 0.614, per_step: 0.006075
100%|██████████| 1000/1000 [00:06<00:00, 150.93it/s]
Worker 0 pid=1855
Successfully xmh
