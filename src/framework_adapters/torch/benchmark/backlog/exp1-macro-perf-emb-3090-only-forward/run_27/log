perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fefeb17fe50>==========
Worker 0 pid=52563
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:01<24:55,  1.50s/it]  0%|          | 1/1000 [00:01<24:56,  1.50s/it]  3%|▎         | 30/1000 [00:01<00:37, 25.84it/s]  3%|▎         | 26/1000 [00:01<00:43, 22.34it/s]  7%|▋         | 66/1000 [00:01<00:14, 62.63it/s]  6%|▌         | 60/1000 [00:01<00:16, 57.33it/s]Step99:rank0, time: 1.789, per_step: 0.017891
Step99:rank1, time: 1.809, per_step: 0.018086
 11%|█         | 109/1000 [00:01<00:07, 112.58it/s] 10%|█         | 101/1000 [00:01<00:08, 105.01it/s] 16%|█▋        | 163/1000 [00:01<00:04, 181.66it/s] 15%|█▌        | 150/1000 [00:01<00:05, 167.49it/s]Step199:rank0, time: 0.179, per_step: 0.001772
Step199:rank1, time: 0.185, per_step: 0.001829
 23%|██▎       | 231/1000 [00:02<00:02, 275.31it/s] 21%|██▏       | 213/1000 [00:02<00:03, 254.01it/s]Step299:rank0, time: 0.120, per_step: 0.001190
 32%|███▏      | 324/1000 [00:02<00:01, 413.54it/s] 30%|██▉       | 296/1000 [00:02<00:01, 375.46it/s]Step299:rank1, time: 0.124, per_step: 0.001226
Step399:rank0, time: 0.083, per_step: 0.000827
Step399:rank1, time: 0.087, per_step: 0.000861
 46%|████▌     | 461/1000 [00:02<00:00, 635.01it/s] 41%|████      | 412/1000 [00:02<00:01, 557.12it/s]Step499:rank0, time: 0.062, per_step: 0.000618
Step499:rank1, time: 0.066, per_step: 0.000656
Step599:rank0, time: 0.057, per_step: 0.000562
 63%|██████▎   | 632/1000 [00:02<00:00, 901.35it/s] 58%|█████▊    | 579/1000 [00:02<00:00, 833.66it/s]Step599:rank1, time: 0.053, per_step: 0.000525
Step699:rank0, time: 0.051, per_step: 0.000502
Step699:rank1, time: 0.045, per_step: 0.000446
Step799:rank0, time: 0.039, per_step: 0.000388
Step799:rank1, time: 0.040, per_step: 0.000395
 89%|████████▊ | 886/1000 [00:02<00:00, 1329.54it/s] 81%|████████  | 812/1000 [00:02<00:00, 1225.77it/s]Step899:rank0, time: 0.036, per_step: 0.000361
Step899:rank1, time: 0.037, per_step: 0.000368
Step999:rank0, time: 0.035, per_step: 0.000342
100%|██████████| 1000/1000 [00:02<00:00, 409.05it/s]
Step999:rank1, time: 0.037, per_step: 0.000365
100%|██████████| 1000/1000 [00:02<00:00, 403.97it/s]
Worker 1 pid=52564
Successfully xmh
