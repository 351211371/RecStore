perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f1b1c725e50>==========
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:01<22:05,  1.33s/it]  3%|▎         | 30/1000 [00:01<00:33, 28.81it/s]  7%|▋         | 66/1000 [00:01<00:13, 69.05it/s]Step99:rank0, time: 1.617, per_step: 0.016166
 11%|█         | 109/1000 [00:01<00:07, 122.40it/s] 16%|█▋        | 163/1000 [00:01<00:04, 194.87it/s]Step199:rank0, time: 0.178, per_step: 0.001764
 23%|██▎       | 232/1000 [00:01<00:02, 292.83it/s]Step299:rank0, time: 0.120, per_step: 0.001185
 33%|███▎      | 326/1000 [00:01<00:01, 435.34it/s]Step399:rank0, time: 0.084, per_step: 0.000828
 46%|████▌     | 462/1000 [00:02<00:00, 656.89it/s]Step499:rank0, time: 0.063, per_step: 0.000626
Step599:rank0, time: 0.050, per_step: 0.000500
 66%|██████▌   | 662/1000 [00:02<00:00, 998.98it/s]Step699:rank0, time: 0.043, per_step: 0.000427
Step799:rank0, time: 0.038, per_step: 0.000379
Step899:rank0, time: 0.035, per_step: 0.000351
 93%|█████████▎| 931/1000 [00:02<00:00, 1449.90it/s]Step999:rank0, time: 0.034, per_step: 0.000336
100%|██████████| 1000/1000 [00:02<00:00, 443.06it/s]
Worker 0 pid=51954
Successfully xmh
