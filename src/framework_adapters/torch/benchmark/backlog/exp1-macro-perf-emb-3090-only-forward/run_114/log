perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fe39e6c6e50>==========
Worker 0 pid=34498
Worker 1 pid=34499
Worker 2 pid=34500
Worker 3 pid=34501
Worker 4 pid=34502
Worker 5 pid=34503
Worker 6 pid=34510
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:02<38:02,  2.29s/it]  0%|          | 1/1000 [00:02<38:46,  2.33s/it]  0%|          | 1/1000 [00:02<38:59,  2.34s/it]  0%|          | 1/1000 [00:02<39:19,  2.36s/it]  0%|          | 1/1000 [00:02<39:21,  2.36s/it]  1%|          | 7/1000 [00:02<04:13,  3.91it/s]  0%|          | 1/1000 [00:02<40:06,  2.41s/it]  0%|          | 1/1000 [00:02<40:23,  2.43s/it]  1%|          | 6/1000 [00:02<05:05,  3.26it/s]  1%|          | 6/1000 [00:02<05:04,  3.26it/s]  0%|          | 5/1000 [00:02<06:13,  2.66it/s]  0%|          | 5/1000 [00:02<06:16,  2.64it/s]  1%|▏         | 13/1000 [00:02<02:00,  8.22it/s]  0%|          | 1/1000 [00:02<41:36,  2.50s/it]  0%|          | 4/1000 [00:02<08:02,  2.07it/s]  0%|          | 3/1000 [00:02<11:05,  1.50it/s]  1%|          | 11/1000 [00:02<02:25,  6.78it/s]  1%|          | 11/1000 [00:02<02:26,  6.75it/s]  1%|          | 9/1000 [00:02<03:03,  5.41it/s]  1%|          | 10/1000 [00:02<02:42,  6.08it/s]  2%|▏         | 20/1000 [00:02<01:09, 14.20it/s]  1%|          | 8/1000 [00:02<03:24,  4.84it/s]  0%|          | 4/1000 [00:02<08:22,  1.98it/s]  1%|          | 7/1000 [00:02<03:53,  4.25it/s]  2%|▏         | 21/1000 [00:02<01:02, 15.79it/s]  2%|▏         | 19/1000 [00:02<01:10, 13.83it/s]  2%|▏         | 15/1000 [00:02<01:32, 10.63it/s]  2%|▏         | 18/1000 [00:02<01:15, 12.97it/s]  1%|▏         | 14/1000 [00:02<01:37, 10.07it/s]  1%|          | 8/1000 [00:02<03:33,  4.64it/s]  3%|▎         | 26/1000 [00:02<00:51, 19.08it/s]  4%|▎         | 37/1000 [00:02<00:28, 33.98it/s]  4%|▍         | 38/1000 [00:02<00:28, 34.34it/s]  1%|          | 11/1000 [00:02<02:11,  7.54it/s]  2%|▏         | 24/1000 [00:02<00:48, 20.10it/s]  2%|▏         | 24/1000 [00:02<00:47, 20.69it/s]  1%|▏         | 13/1000 [00:02<01:52,  8.75it/s]  4%|▍         | 41/1000 [00:02<00:25, 37.73it/s]  3%|▎         | 27/1000 [00:02<00:46, 21.14it/s]  6%|▌         | 59/1000 [00:02<00:15, 61.12it/s]  6%|▌         | 59/1000 [00:02<00:15, 59.87it/s]  2%|▏         | 17/1000 [00:02<01:12, 13.52it/s]  4%|▍         | 38/1000 [00:02<00:25, 37.58it/s]  4%|▍         | 40/1000 [00:02<00:23, 40.67it/s]  2%|▏         | 21/1000 [00:02<00:57, 16.89it/s]  6%|▌         | 61/1000 [00:02<00:14, 65.05it/s]  4%|▍         | 45/1000 [00:02<00:22, 43.12it/s]  8%|▊         | 81/1000 [00:02<00:10, 88.03it/s]  8%|▊         | 80/1000 [00:02<00:10, 85.25it/s]  3%|▎         | 29/1000 [00:02<00:34, 28.43it/s]  6%|▌         | 56/1000 [00:02<00:15, 61.88it/s]  5%|▌         | 53/1000 [00:03<00:16, 55.88it/s]  9%|▊         | 86/1000 [00:03<00:09, 100.34it/s]Step99:rank4, time: 3.063, per_step: 0.030632
Step99:rank5, time: 3.065, per_step: 0.030652
  7%|▋         | 67/1000 [00:03<00:12, 71.92it/s] 10%|█         | 103/1000 [00:03<00:07, 113.23it/s] 10%|█         | 103/1000 [00:03<00:07, 112.87it/s]  4%|▍         | 45/1000 [00:03<00:18, 50.37it/s]  3%|▎         | 31/1000 [00:03<00:36, 26.39it/s]Step99:rank3, time: 3.120, per_step: 0.031202
  7%|▋         | 73/1000 [00:03<00:11, 83.60it/s]  7%|▋         | 68/1000 [00:03<00:13, 68.53it/s] 11%|█         | 109/1000 [00:03<00:06, 127.85it/s]  9%|▉         | 89/1000 [00:03<00:09, 99.88it/s] 12%|█▎        | 125/1000 [00:03<00:06, 135.89it/s] 13%|█▎        | 126/1000 [00:03<00:06, 137.28it/s]  7%|▋         | 69/1000 [00:03<00:10, 86.77it/s]  5%|▍         | 48/1000 [00:03<00:19, 48.51it/s]Step99:rank6, time: 3.219, per_step: 0.032194
  9%|▉         | 93/1000 [00:03<00:08, 108.23it/s]  9%|▊         | 87/1000 [00:03<00:09, 93.63it/s] 13%|█▎        | 131/1000 [00:03<00:05, 147.90it/s] 11%|█         | 111/1000 [00:03<00:07, 124.90it/s]Step99:rank2, time: 3.282, per_step: 0.032820
 15%|█▍        | 147/1000 [00:03<00:05, 154.77it/s] 15%|█▍        | 149/1000 [00:03<00:05, 158.30it/s]  9%|▉         | 93/1000 [00:03<00:07, 119.04it/s]Step99:rank1, time: 3.304, per_step: 0.033044
  7%|▋         | 67/1000 [00:03<00:12, 73.57it/s]Step99:rank7, time: 3.329, per_step: 0.033292
 11%|█▏        | 113/1000 [00:03<00:06, 128.95it/s] 11%|█         | 107/1000 [00:03<00:07, 117.08it/s] 15%|█▌        | 151/1000 [00:03<00:05, 159.12it/s] 13%|█▎        | 133/1000 [00:03<00:05, 146.64it/s] 17%|█▋        | 169/1000 [00:03<00:04, 170.12it/s] 17%|█▋        | 172/1000 [00:03<00:04, 175.11it/s] 11%|█         | 112/1000 [00:03<00:06, 134.54it/s]  9%|▊         | 86/1000 [00:03<00:09, 96.95it/s] 14%|█▎        | 135/1000 [00:03<00:05, 150.93it/s] 13%|█▎        | 127/1000 [00:03<00:06, 136.36it/s] 16%|█▌        | 155/1000 [00:03<00:05, 164.23it/s] 17%|█▋        | 171/1000 [00:03<00:04, 167.86it/s] 19%|█▉        | 191/1000 [00:03<00:04, 182.54it/s] 19%|█▉        | 193/1000 [00:03<00:04, 183.46it/s] 13%|█▎        | 133/1000 [00:03<00:05, 153.21it/s]Step99:rank0, time: 3.489, per_step: 0.034890
Step199:rank5, time: 0.459, per_step: 0.004543
 10%|█         | 105/1000 [00:03<00:07, 117.16it/s]Step199:rank4, time: 0.466, per_step: 0.004615
 16%|█▌        | 157/1000 [00:03<00:04, 168.99it/s] 15%|█▍        | 147/1000 [00:03<00:05, 151.83it/s] 18%|█▊        | 176/1000 [00:03<00:04, 176.17it/s] 19%|█▉        | 191/1000 [00:03<00:04, 172.44it/s] 22%|██▏       | 216/1000 [00:03<00:04, 195.89it/s] 21%|██▏       | 213/1000 [00:03<00:04, 190.50it/s] 16%|█▌        | 158/1000 [00:03<00:04, 177.92it/s] 12%|█▏        | 124/1000 [00:03<00:06, 133.91it/s]Step199:rank3, time: 0.511, per_step: 0.005063
 18%|█▊        | 180/1000 [00:03<00:04, 183.54it/s] 17%|█▋        | 167/1000 [00:03<00:05, 163.52it/s] 20%|█▉        | 198/1000 [00:03<00:04, 186.18it/s]Step199:rank6, time: 0.468, per_step: 0.004631
 21%|██        | 211/1000 [00:03<00:04, 178.01it/s] 24%|██▍       | 239/1000 [00:03<00:03, 204.61it/s] 24%|██▎       | 235/1000 [00:03<00:03, 196.76it/s] 18%|█▊        | 180/1000 [00:03<00:04, 187.97it/s] 14%|█▍        | 143/1000 [00:03<00:05, 147.64it/s]Step199:rank2, time: 0.464, per_step: 0.004590
 20%|██        | 202/1000 [00:03<00:04, 193.28it/s] 19%|█▊        | 187/1000 [00:03<00:04, 171.75it/s] 22%|██▏       | 220/1000 [00:03<00:04, 194.55it/s]Step199:rank7, time: 0.453, per_step: 0.004487
 23%|██▎       | 230/1000 [00:03<00:04, 181.30it/s] 26%|██▌       | 261/1000 [00:03<00:03, 208.76it/s] 20%|██        | 204/1000 [00:03<00:03, 201.28it/s]Step199:rank1, time: 0.516, per_step: 0.005111
 26%|██▌       | 256/1000 [00:03<00:04, 182.62it/s] 16%|█▌        | 162/1000 [00:03<00:05, 158.55it/s] 22%|██▎       | 225/1000 [00:03<00:03, 201.80it/s] 21%|██        | 207/1000 [00:03<00:04, 177.49it/s] 24%|██▍       | 242/1000 [00:03<00:03, 201.42it/s] 25%|██▌       | 250/1000 [00:03<00:04, 185.31it/s] 28%|██▊       | 285/1000 [00:03<00:03, 215.47it/s] 23%|██▎       | 226/1000 [00:03<00:03, 203.49it/s] 18%|█▊        | 181/1000 [00:03<00:04, 166.70it/s] 28%|██▊       | 278/1000 [00:03<00:03, 191.66it/s] 25%|██▍       | 248/1000 [00:03<00:03, 207.96it/s] 23%|██▎       | 227/1000 [00:03<00:04, 182.45it/s]Step299:rank5, time: 0.465, per_step: 0.004600
 26%|██▋       | 264/1000 [00:03<00:03, 198.29it/s] 27%|██▋       | 270/1000 [00:03<00:03, 187.65it/s] 31%|███       | 308/1000 [00:04<00:03, 203.23it/s] 25%|██▍       | 248/1000 [00:04<00:03, 195.42it/s]Step199:rank0, time: 0.536, per_step: 0.005302
 20%|██        | 200/1000 [00:04<00:04, 172.86it/s]Step299:rank4, time: 0.506, per_step: 0.005005
 30%|███       | 300/1000 [00:04<00:03, 197.44it/s] 27%|██▋       | 271/1000 [00:04<00:03, 211.68it/s] 25%|██▍       | 247/1000 [00:04<00:04, 186.12it/s] 29%|██▊       | 286/1000 [00:04<00:03, 203.95it/s] 29%|██▉       | 290/1000 [00:04<00:03, 189.16it/s] 33%|███▎      | 331/1000 [00:04<00:03, 209.07it/s] 27%|██▋       | 269/1000 [00:04<00:03, 198.40it/s] 22%|██▏       | 220/1000 [00:04<00:04, 178.59it/s] 32%|███▏      | 321/1000 [00:04<00:03, 199.98it/s]Step299:rank3, time: 0.513, per_step: 0.005076
Step299:rank6, time: 0.471, per_step: 0.004666
 30%|██▉       | 295/1000 [00:04<00:03, 218.38it/s] 27%|██▋       | 267/1000 [00:04<00:03, 185.20it/s]Step299:rank2, time: 0.444, per_step: 0.004391
 31%|███       | 312/1000 [00:04<00:03, 198.00it/s] 31%|███       | 309/1000 [00:04<00:03, 208.87it/s] 35%|███▌      | 354/1000 [00:04<00:03, 213.57it/s] 30%|██▉       | 296/1000 [00:04<00:03, 216.62it/s] 24%|██▍       | 241/1000 [00:04<00:04, 185.93it/s] 34%|███▍      | 344/1000 [00:04<00:03, 206.10it/s]Step299:rank7, time: 0.466, per_step: 0.004616
 32%|███▏      | 321/1000 [00:04<00:02, 227.55it/s] 29%|██▊       | 286/1000 [00:04<00:03, 186.06it/s] 33%|███▎      | 331/1000 [00:04<00:03, 211.70it/s] 33%|███▎      | 333/1000 [00:04<00:03, 190.31it/s] 38%|███▊      | 377/1000 [00:04<00:02, 215.97it/s] 32%|███▏      | 320/1000 [00:04<00:03, 221.00it/s] 26%|██▌       | 261/1000 [00:04<00:03, 187.26it/s] 37%|███▋      | 367/1000 [00:04<00:03, 210.50it/s]Step299:rank1, time: 0.525, per_step: 0.005201
 34%|███▍      | 344/1000 [00:04<00:02, 226.85it/s] 31%|███       | 306/1000 [00:04<00:03, 187.89it/s] 35%|███▌      | 354/1000 [00:04<00:03, 214.59it/s] 35%|███▌      | 353/1000 [00:04<00:03, 187.54it/s]Step399:rank5, time: 0.446, per_step: 0.004420
 40%|████      | 400/1000 [00:04<00:02, 218.15it/s] 34%|███▍      | 344/1000 [00:04<00:02, 225.33it/s] 28%|██▊       | 281/1000 [00:04<00:03, 188.71it/s] 39%|███▉      | 390/1000 [00:04<00:02, 213.38it/s] 37%|███▋      | 369/1000 [00:04<00:02, 233.17it/s] 33%|███▎      | 326/1000 [00:04<00:03, 189.64it/s]Step399:rank4, time: 0.461, per_step: 0.004564
 38%|███▊      | 377/1000 [00:04<00:02, 216.34it/s] 37%|███▋      | 373/1000 [00:04<00:03, 189.61it/s] 42%|████▏     | 422/1000 [00:04<00:02, 216.30it/s]Step299:rank0, time: 0.515, per_step: 0.005104
 41%|████      | 412/1000 [00:04<00:02, 214.85it/s] 37%|███▋      | 367/1000 [00:04<00:02, 217.57it/s] 30%|███       | 301/1000 [00:04<00:03, 189.46it/s] 39%|███▉      | 393/1000 [00:04<00:02, 227.19it/s] 35%|███▍      | 346/1000 [00:04<00:03, 191.27it/s]Step399:rank6, time: 0.453, per_step: 0.004489
 40%|████      | 400/1000 [00:04<00:02, 217.67it/s]Step399:rank2, time: 0.432, per_step: 0.004279
 39%|███▉      | 393/1000 [00:04<00:03, 190.34it/s] 44%|████▍     | 444/1000 [00:04<00:02, 216.27it/s] 43%|████▎     | 434/1000 [00:04<00:02, 215.99it/s] 32%|███▏      | 321/1000 [00:04<00:03, 190.08it/s] 39%|███▉      | 389/1000 [00:04<00:02, 212.78it/s]Step399:rank3, time: 0.529, per_step: 0.005233
 37%|███▋      | 366/1000 [00:04<00:03, 191.98it/s] 42%|████▏     | 416/1000 [00:04<00:02, 223.53it/s] 42%|████▏     | 422/1000 [00:04<00:02, 218.08it/s]Step399:rank7, time: 0.466, per_step: 0.004609
 41%|████▏     | 413/1000 [00:04<00:03, 188.79it/s] 47%|████▋     | 469/1000 [00:04<00:02, 223.67it/s] 46%|████▌     | 456/1000 [00:04<00:02, 212.76it/s] 41%|████      | 411/1000 [00:04<00:02, 214.70it/s] 34%|███▍      | 341/1000 [00:04<00:03, 186.70it/s] 39%|███▊      | 386/1000 [00:04<00:03, 192.93it/s] 44%|████▍     | 439/1000 [00:04<00:02, 216.85it/s] 44%|████▍     | 445/1000 [00:04<00:02, 218.91it/s] 43%|████▎     | 433/1000 [00:04<00:02, 190.62it/s] 49%|████▉     | 492/1000 [00:04<00:02, 219.54it/s] 43%|████▎     | 433/1000 [00:04<00:02, 215.80it/s] 48%|████▊     | 478/1000 [00:04<00:02, 211.11it/s]Step399:rank1, time: 0.514, per_step: 0.005092
 36%|███▌      | 361/1000 [00:04<00:03, 188.21it/s]Step499:rank5, time: 0.453, per_step: 0.004487
 41%|████      | 406/1000 [00:04<00:03, 193.48it/s] 46%|████▌     | 461/1000 [00:04<00:02, 216.23it/s] 47%|████▋     | 468/1000 [00:04<00:02, 219.67it/s] 45%|████▌     | 453/1000 [00:04<00:02, 191.98it/s]Step499:rank4, time: 0.457, per_step: 0.004523
 52%|█████▏    | 516/1000 [00:04<00:02, 224.68it/s] 46%|████▌     | 455/1000 [00:04<00:02, 215.66it/s] 50%|█████     | 503/1000 [00:04<00:02, 221.82it/s] 38%|███▊      | 381/1000 [00:04<00:03, 189.00it/s] 43%|████▎     | 426/1000 [00:04<00:02, 193.84it/s] 48%|████▊     | 483/1000 [00:05<00:02, 217.07it/s] 49%|████▉     | 490/1000 [00:05<00:02, 218.89it/s] 48%|████▊     | 475/1000 [00:05<00:02, 199.18it/s] 54%|█████▍    | 539/1000 [00:05<00:02, 220.72it/s] 53%|█████▎    | 526/1000 [00:05<00:02, 223.76it/s]Step499:rank6, time: 0.456, per_step: 0.004515
 48%|████▊     | 478/1000 [00:05<00:02, 217.48it/s]Step399:rank0, time: 0.529, per_step: 0.005236
 40%|████      | 401/1000 [00:05<00:03, 190.15it/s]Step499:rank2, time: 0.468, per_step: 0.004629
 45%|████▍     | 446/1000 [00:05<00:02, 194.60it/s] 50%|█████     | 505/1000 [00:05<00:02, 217.45it/s] 51%|█████     | 512/1000 [00:05<00:02, 218.55it/s] 50%|████▉     | 498/1000 [00:05<00:02, 205.76it/s] 55%|█████▌    | 551/1000 [00:05<00:01, 231.15it/s]Step499:rank7, time: 0.452, per_step: 0.004477
Step499:rank3, time: 0.494, per_step: 0.004888
 56%|█████▌    | 562/1000 [00:05<00:01, 220.89it/s] 50%|█████     | 501/1000 [00:05<00:02, 218.41it/s] 42%|████▏     | 421/1000 [00:05<00:03, 190.66it/s] 47%|████▋     | 466/1000 [00:05<00:02, 194.91it/s] 53%|█████▎    | 527/1000 [00:05<00:02, 218.00it/s] 54%|█████▎    | 535/1000 [00:05<00:02, 219.02it/s] 58%|█████▊    | 576/1000 [00:05<00:01, 235.06it/s] 58%|█████▊    | 585/1000 [00:05<00:01, 222.16it/s] 52%|█████▏    | 519/1000 [00:05<00:02, 195.73it/s] 52%|█████▏    | 523/1000 [00:05<00:02, 216.50it/s] 44%|████▍     | 441/1000 [00:05<00:02, 191.40it/s] 49%|████▊     | 486/1000 [00:05<00:02, 194.99it/s] 55%|█████▍    | 549/1000 [00:05<00:02, 218.29it/s] 56%|█████▌    | 558/1000 [00:05<00:02, 219.63it/s]Step599:rank5, time: 0.452, per_step: 0.004477
 54%|█████▍    | 541/1000 [00:05<00:02, 201.06it/s] 61%|██████    | 608/1000 [00:05<00:01, 220.11it/s] 55%|█████▍    | 547/1000 [00:05<00:02, 221.28it/s]Step499:rank1, time: 0.512, per_step: 0.005070
Step599:rank4, time: 0.427, per_step: 0.004229
 60%|██████    | 600/1000 [00:05<00:01, 228.68it/s] 46%|████▌     | 461/1000 [00:05<00:02, 191.69it/s] 51%|█████     | 506/1000 [00:05<00:02, 195.19it/s] 57%|█████▋    | 572/1000 [00:05<00:01, 218.71it/s] 58%|█████▊    | 581/1000 [00:05<00:01, 220.35it/s] 63%|██████▎   | 631/1000 [00:05<00:01, 220.37it/s] 57%|█████▋    | 573/1000 [00:05<00:01, 230.78it/s] 56%|█████▌    | 562/1000 [00:05<00:02, 199.08it/s] 62%|██████▏   | 623/1000 [00:05<00:01, 223.38it/s] 48%|████▊     | 481/1000 [00:05<00:02, 191.80it/s] 53%|█████▎    | 526/1000 [00:05<00:02, 194.50it/s]Step599:rank6, time: 0.455, per_step: 0.004507
 59%|█████▉    | 594/1000 [00:05<00:01, 210.44it/s] 60%|██████    | 604/1000 [00:05<00:01, 219.11it/s]Step599:rank2, time: 0.470, per_step: 0.004651
 65%|██████▌   | 654/1000 [00:05<00:01, 220.99it/s] 58%|█████▊    | 584/1000 [00:05<00:02, 204.12it/s] 60%|█████▉    | 597/1000 [00:05<00:01, 230.66it/s] 65%|██████▍   | 646/1000 [00:05<00:01, 222.07it/s]Step499:rank0, time: 0.520, per_step: 0.005148
Step599:rank7, time: 0.432, per_step: 0.004281
 50%|█████     | 501/1000 [00:05<00:02, 191.21it/s] 55%|█████▍    | 546/1000 [00:05<00:02, 194.81it/s] 62%|██████▏   | 619/1000 [00:05<00:01, 219.65it/s] 63%|██████▎   | 626/1000 [00:05<00:01, 218.56it/s]Step599:rank3, time: 0.508, per_step: 0.005035
 62%|██████▏   | 624/1000 [00:05<00:01, 241.00it/s] 68%|██████▊   | 677/1000 [00:05<00:01, 219.70it/s] 67%|██████▋   | 669/1000 [00:05<00:01, 220.20it/s] 60%|██████    | 605/1000 [00:05<00:02, 195.87it/s] 52%|█████▏    | 521/1000 [00:05<00:02, 191.26it/s] 57%|█████▋    | 566/1000 [00:05<00:02, 195.31it/s] 64%|██████▍   | 642/1000 [00:05<00:01, 217.00it/s] 65%|██████▍   | 649/1000 [00:05<00:01, 219.44it/s] 70%|██████▉   | 699/1000 [00:05<00:01, 219.16it/s] 65%|██████▍   | 649/1000 [00:05<00:01, 240.54it/s]Step699:rank5, time: 0.457, per_step: 0.004521
 69%|██████▉   | 692/1000 [00:05<00:01, 219.89it/s] 63%|██████▎   | 626/1000 [00:05<00:01, 198.59it/s] 54%|█████▍    | 541/1000 [00:05<00:02, 191.18it/s] 59%|█████▊    | 586/1000 [00:05<00:02, 194.80it/s]Step699:rank4, time: 0.459, per_step: 0.004542
 67%|██████▋   | 667/1000 [00:05<00:01, 224.70it/s] 67%|██████▋   | 671/1000 [00:05<00:01, 219.22it/s]Step599:rank1, time: 0.514, per_step: 0.005088
 72%|███████▏  | 722/1000 [00:05<00:01, 220.02it/s] 67%|██████▋   | 674/1000 [00:05<00:01, 237.35it/s] 65%|██████▍   | 647/1000 [00:05<00:01, 201.24it/s] 72%|███████▏  | 717/1000 [00:05<00:01, 227.64it/s] 56%|█████▌    | 561/1000 [00:05<00:02, 191.55it/s] 61%|██████    | 606/1000 [00:05<00:02, 194.32it/s] 69%|██████▉   | 690/1000 [00:05<00:01, 223.56it/s] 69%|██████▉   | 694/1000 [00:05<00:01, 219.56it/s]Step699:rank6, time: 0.456, per_step: 0.004518
 75%|███████▍  | 747/1000 [00:05<00:01, 228.50it/s]Step699:rank2, time: 0.439, per_step: 0.004350
 70%|██████▉   | 698/1000 [00:05<00:01, 235.16it/s] 74%|███████▍  | 741/1000 [00:06<00:01, 228.31it/s] 67%|██████▋   | 668/1000 [00:06<00:01, 199.33it/s]Step699:rank7, time: 0.417, per_step: 0.004125
 58%|█████▊    | 581/1000 [00:06<00:02, 191.69it/s] 63%|██████▎   | 626/1000 [00:06<00:01, 193.26it/s] 72%|███████▏  | 717/1000 [00:06<00:01, 219.78it/s] 71%|███████▏  | 713/1000 [00:06<00:01, 219.31it/s] 77%|███████▋  | 770/1000 [00:06<00:01, 225.12it/s] 72%|███████▏  | 722/1000 [00:06<00:01, 232.77it/s] 76%|███████▋  | 764/1000 [00:06<00:01, 223.70it/s]Step599:rank0, time: 0.524, per_step: 0.005190
 60%|██████    | 601/1000 [00:06<00:02, 190.95it/s] 65%|██████▍   | 646/1000 [00:06<00:01, 193.75it/s] 74%|███████▍  | 739/1000 [00:06<00:01, 219.40it/s] 74%|███████▎  | 735/1000 [00:06<00:01, 218.89it/s] 69%|██████▉   | 688/1000 [00:06<00:01, 170.80it/s] 79%|███████▉  | 793/1000 [00:06<00:00, 222.73it/s] 75%|███████▍  | 746/1000 [00:06<00:01, 231.07it/s] 79%|███████▊  | 787/1000 [00:06<00:00, 221.73it/s] 62%|██████▏   | 621/1000 [00:06<00:01, 190.45it/s] 67%|██████▋   | 666/1000 [00:06<00:01, 193.90it/s]Step699:rank3, time: 0.560, per_step: 0.005546
Step799:rank5, time: 0.443, per_step: 0.004386
 76%|███████▌  | 762/1000 [00:06<00:01, 220.03it/s] 71%|███████   | 709/1000 [00:06<00:01, 180.33it/s]Step799:rank4, time: 0.447, per_step: 0.004422
 76%|███████▌  | 757/1000 [00:06<00:01, 194.36it/s] 82%|████████▏ | 817/1000 [00:06<00:00, 225.69it/s] 81%|████████  | 810/1000 [00:06<00:00, 220.34it/s] 64%|██████▍   | 641/1000 [00:06<00:01, 191.18it/s] 69%|██████▊   | 686/1000 [00:06<00:01, 193.68it/s] 78%|███████▊  | 785/1000 [00:06<00:00, 219.70it/s] 77%|███████▋  | 770/1000 [00:06<00:01, 201.69it/s] 74%|███████▎  | 735/1000 [00:06<00:01, 199.87it/s] 78%|███████▊  | 778/1000 [00:06<00:01, 198.20it/s]Step699:rank1, time: 0.517, per_step: 0.005118
 84%|████████▍ | 840/1000 [00:06<00:00, 219.62it/s] 83%|████████▎ | 833/1000 [00:06<00:00, 220.00it/s] 66%|██████▌   | 661/1000 [00:06<00:01, 191.46it/s] 71%|███████   | 706/1000 [00:06<00:01, 193.94it/s] 79%|███████▉  | 793/1000 [00:06<00:00, 207.69it/s] 76%|███████▌  | 756/1000 [00:06<00:01, 198.70it/s]Step799:rank6, time: 0.506, per_step: 0.005013
Step799:rank2, time: 0.496, per_step: 0.004907
Step799:rank7, time: 0.491, per_step: 0.004861
 80%|████████  | 803/1000 [00:06<00:00, 211.82it/s] 81%|████████  | 807/1000 [00:06<00:01, 190.21it/s] 86%|████████▋ | 865/1000 [00:06<00:00, 226.47it/s] 86%|████████▌ | 856/1000 [00:06<00:00, 218.42it/s] 73%|███████▎  | 726/1000 [00:06<00:01, 194.76it/s] 68%|██████▊   | 681/1000 [00:06<00:01, 190.88it/s] 82%|████████▏ | 816/1000 [00:06<00:00, 212.90it/s] 78%|███████▊  | 777/1000 [00:06<00:01, 197.90it/s] 82%|████████▎ | 825/1000 [00:06<00:00, 209.92it/s] 83%|████████▎ | 829/1000 [00:06<00:00, 196.10it/s] 89%|████████▉ | 888/1000 [00:06<00:00, 224.18it/s]Step699:rank0, time: 0.523, per_step: 0.005174
 88%|████████▊ | 881/1000 [00:06<00:00, 227.01it/s] 75%|███████▍  | 746/1000 [00:06<00:01, 194.50it/s] 70%|███████   | 701/1000 [00:06<00:01, 191.25it/s] 84%|████████▍ | 839/1000 [00:06<00:00, 217.09it/s]Step899:rank5, time: 0.444, per_step: 0.004396
 80%|███████▉  | 798/1000 [00:06<00:01, 195.79it/s]Step899:rank4, time: 0.424, per_step: 0.004197
Step799:rank3, time: 0.479, per_step: 0.004744
 85%|████████▍ | 847/1000 [00:06<00:00, 211.99it/s] 85%|████████▌ | 851/1000 [00:06<00:00, 201.74it/s] 91%|█████████ | 911/1000 [00:06<00:00, 225.52it/s] 91%|█████████ | 911/1000 [00:06<00:00, 246.13it/s] 77%|███████▋  | 766/1000 [00:06<00:01, 194.25it/s] 72%|███████▏  | 721/1000 [00:06<00:01, 191.51it/s] 86%|████████▌ | 862/1000 [00:06<00:00, 220.61it/s] 82%|████████▏ | 818/1000 [00:06<00:00, 194.90it/s] 87%|████████▋ | 869/1000 [00:06<00:00, 208.91it/s] 87%|████████▋ | 874/1000 [00:06<00:00, 207.24it/s] 94%|█████████▎| 937/1000 [00:06<00:00, 233.84it/s] 79%|███████▊  | 786/1000 [00:06<00:01, 194.81it/s] 74%|███████▍  | 741/1000 [00:06<00:01, 191.79it/s] 94%|█████████▎| 936/1000 [00:06<00:00, 234.78it/s] 89%|████████▊ | 886/1000 [00:06<00:00, 223.48it/s] 84%|████████▍ | 838/1000 [00:06<00:00, 194.76it/s]Step799:rank1, time: 0.514, per_step: 0.005086
 89%|████████▉ | 891/1000 [00:06<00:00, 209.54it/s] 90%|████████▉ | 897/1000 [00:06<00:00, 211.24it/s] 96%|█████████▋| 963/1000 [00:06<00:00, 241.43it/s]Step899:rank7, time: 0.436, per_step: 0.004320
Step899:rank6, time: 0.461, per_step: 0.004569
 76%|███████▌  | 761/1000 [00:06<00:01, 190.88it/s]Step899:rank2, time: 0.472, per_step: 0.004674
 96%|█████████▌| 960/1000 [00:06<00:00, 229.87it/s] 91%|█████████ | 909/1000 [00:06<00:00, 224.82it/s] 81%|████████  | 806/1000 [00:06<00:01, 166.88it/s] 86%|████████▌ | 858/1000 [00:07<00:00, 194.69it/s] 92%|█████████▏| 915/1000 [00:07<00:00, 218.26it/s] 92%|█████████▏| 919/1000 [00:07<00:00, 213.47it/s] 99%|█████████▉| 988/1000 [00:07<00:00, 229.37it/s] 78%|███████▊  | 781/1000 [00:07<00:01, 192.20it/s] 93%|█████████▎| 932/1000 [00:07<00:00, 225.88it/s] 98%|█████████▊| 984/1000 [00:07<00:00, 226.25it/s] 88%|████████▊ | 878/1000 [00:07<00:00, 195.10it/s] 82%|████████▏ | 824/1000 [00:07<00:01, 166.61it/s]Step999:rank5, time: 0.439, per_step: 0.004348
100%|██████████| 1000/1000 [00:07<00:00, 140.52it/s]
 94%|█████████▎| 937/1000 [00:07<00:00, 213.92it/s] 94%|█████████▍| 941/1000 [00:07<00:00, 210.57it/s]Step799:rank0, time: 0.515, per_step: 0.005103
 80%|████████  | 802/1000 [00:07<00:01, 195.59it/s]Step999:rank4, time: 0.469, per_step: 0.004641
100%|██████████| 1000/1000 [00:07<00:00, 139.45it/s]
 96%|█████████▌| 955/1000 [00:07<00:00, 216.84it/s] 90%|████████▉ | 898/1000 [00:07<00:00, 191.78it/s] 85%|████████▍ | 847/1000 [00:07<00:00, 182.15it/s]Step899:rank3, time: 0.517, per_step: 0.005120
 96%|█████████▌| 960/1000 [00:07<00:00, 216.81it/s] 97%|█████████▋| 969/1000 [00:07<00:00, 229.77it/s] 83%|████████▎ | 826/1000 [00:07<00:00, 207.69it/s] 99%|█████████▉| 992/1000 [00:07<00:00, 257.69it/s]Step999:rank7, time: 0.382, per_step: 0.003784
100%|██████████| 1000/1000 [00:07<00:00, 136.64it/s]
 92%|█████████▏| 918/1000 [00:07<00:00, 191.95it/s] 87%|████████▋ | 873/1000 [00:07<00:00, 201.37it/s] 99%|█████████▊| 987/1000 [00:07<00:00, 230.62it/s]100%|█████████▉| 999/1000 [00:07<00:00, 249.42it/s]Step999:rank6, time: 0.398, per_step: 0.003944
100%|██████████| 1000/1000 [00:07<00:00, 136.26it/s]
 85%|████████▍ | 849/1000 [00:07<00:00, 212.93it/s]Step999:rank2, time: 0.412, per_step: 0.004084
100%|██████████| 1000/1000 [00:07<00:00, 135.66it/s]
 94%|█████████▍| 938/1000 [00:07<00:00, 194.17it/s] 89%|████████▉ | 894/1000 [00:07<00:00, 190.89it/s] 87%|████████▋ | 873/1000 [00:07<00:00, 219.06it/s]Step899:rank1, time: 0.559, per_step: 0.005539
 97%|█████████▋| 967/1000 [00:07<00:00, 217.28it/s] 92%|█████████▏| 916/1000 [00:07<00:00, 195.18it/s]Step899:rank0, time: 0.406, per_step: 0.004020
 90%|█████████ | 903/1000 [00:07<00:00, 241.92it/s] 99%|█████████▉| 993/1000 [00:07<00:00, 221.75it/s]Step999:rank3, time: 0.428, per_step: 0.004241
100%|██████████| 1000/1000 [00:07<00:00, 130.66it/s]
 94%|█████████▎| 936/1000 [00:07<00:00, 187.98it/s] 94%|█████████▎| 935/1000 [00:07<00:00, 264.71it/s]Step999:rank0, time: 0.183, per_step: 0.001810
100%|██████████| 1000/1000 [00:07<00:00, 129.30it/s]
 98%|█████████▊| 983/1000 [00:07<00:00, 259.97it/s]Step999:rank1, time: 0.323, per_step: 0.003201
100%|██████████| 1000/1000 [00:07<00:00, 128.31it/s]
Worker 7 pid=34511
Successfully xmh
