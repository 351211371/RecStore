perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f5e9f501e50>==========
Worker 0 pid=24468
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<03:23,  4.92it/s]  0%|          | 1/1000 [00:00<03:23,  4.91it/s]  2%|▏         | 23/1000 [00:00<00:10, 92.87it/s]  2%|▏         | 23/1000 [00:00<00:10, 92.91it/s]  5%|▌         | 51/1000 [00:00<00:05, 161.12it/s]  5%|▌         | 51/1000 [00:00<00:05, 161.13it/s]  8%|▊         | 83/1000 [00:00<00:04, 214.68it/s]  8%|▊         | 83/1000 [00:00<00:04, 214.61it/s]Step99:rank1, time: 0.600, per_step: 0.006000
Step99:rank0, time: 0.578, per_step: 0.005778
 12%|█▏        | 115/1000 [00:00<00:03, 247.11it/s] 12%|█▏        | 115/1000 [00:00<00:03, 247.12it/s] 15%|█▍        | 147/1000 [00:00<00:03, 269.18it/s] 15%|█▍        | 147/1000 [00:00<00:03, 269.26it/s] 18%|█▊        | 182/1000 [00:00<00:02, 292.54it/s] 18%|█▊        | 182/1000 [00:00<00:02, 292.48it/s]Step199:rank1, time: 0.305, per_step: 0.003020
Step199:rank0, time: 0.305, per_step: 0.003020
 22%|██▏       | 217/1000 [00:00<00:02, 307.49it/s] 22%|██▏       | 217/1000 [00:00<00:02, 307.46it/s] 25%|██▌       | 250/1000 [00:01<00:02, 311.72it/s] 25%|██▌       | 250/1000 [00:01<00:02, 311.72it/s] 28%|██▊       | 282/1000 [00:01<00:02, 311.39it/s] 28%|██▊       | 282/1000 [00:01<00:02, 310.82it/s]Step299:rank1, time: 0.309, per_step: 0.003064
Step299:rank0, time: 0.309, per_step: 0.003064
 32%|███▏      | 315/1000 [00:01<00:02, 313.58it/s] 32%|███▏      | 315/1000 [00:01<00:02, 312.28it/s] 35%|███▍      | 347/1000 [00:01<00:02, 309.90it/s] 35%|███▍      | 347/1000 [00:01<00:02, 310.13it/s] 38%|███▊      | 383/1000 [00:01<00:01, 323.58it/s] 38%|███▊      | 383/1000 [00:01<00:01, 323.76it/s]Step399:rank1, time: 0.306, per_step: 0.003034
Step399:rank0, time: 0.306, per_step: 0.003034
 42%|████▏     | 418/1000 [00:01<00:01, 330.76it/s] 42%|████▏     | 418/1000 [00:01<00:01, 330.63it/s] 45%|████▌     | 453/1000 [00:01<00:01, 333.86it/s] 45%|████▌     | 453/1000 [00:01<00:01, 333.94it/s] 49%|████▉     | 489/1000 [00:01<00:01, 340.09it/s] 49%|████▉     | 489/1000 [00:01<00:01, 340.14it/s]Step499:rank1, time: 0.286, per_step: 0.002832
Step499:rank0, time: 0.286, per_step: 0.002833
 52%|█████▎    | 525/1000 [00:01<00:01, 343.76it/s] 52%|█████▎    | 525/1000 [00:01<00:01, 343.69it/s] 56%|█████▌    | 561/1000 [00:01<00:01, 347.05it/s] 56%|█████▌    | 561/1000 [00:01<00:01, 347.13it/s] 60%|█████▉    | 597/1000 [00:02<00:01, 350.24it/s] 60%|█████▉    | 597/1000 [00:02<00:01, 350.27it/s]Step599:rank1, time: 0.282, per_step: 0.002791
Step599:rank0, time: 0.282, per_step: 0.002791
 63%|██████▎   | 633/1000 [00:02<00:01, 347.59it/s] 63%|██████▎   | 633/1000 [00:02<00:01, 347.62it/s] 67%|██████▋   | 670/1000 [00:02<00:00, 351.84it/s] 67%|██████▋   | 670/1000 [00:02<00:00, 351.93it/s]Step699:rank1, time: 0.283, per_step: 0.002802
Step699:rank0, time: 0.283, per_step: 0.002802
 71%|███████   | 706/1000 [00:02<00:00, 352.31it/s] 71%|███████   | 706/1000 [00:02<00:00, 352.33it/s] 74%|███████▍  | 742/1000 [00:02<00:00, 351.34it/s] 74%|███████▍  | 742/1000 [00:02<00:00, 351.42it/s] 78%|███████▊  | 778/1000 [00:02<00:00, 350.25it/s] 78%|███████▊  | 778/1000 [00:02<00:00, 350.27it/s]Step799:rank1, time: 0.287, per_step: 0.002845
Step799:rank0, time: 0.287, per_step: 0.002846
 81%|████████▏ | 814/1000 [00:02<00:00, 339.11it/s] 81%|████████▏ | 814/1000 [00:02<00:00, 339.11it/s] 85%|████████▍ | 848/1000 [00:02<00:00, 336.71it/s] 85%|████████▍ | 848/1000 [00:02<00:00, 336.69it/s] 88%|████████▊ | 882/1000 [00:02<00:00, 329.36it/s] 88%|████████▊ | 882/1000 [00:02<00:00, 329.34it/s]Step899:rank1, time: 0.315, per_step: 0.003116
Step899:rank0, time: 0.315, per_step: 0.003117
 92%|█████████▏| 917/1000 [00:02<00:00, 332.79it/s] 92%|█████████▏| 917/1000 [00:02<00:00, 332.85it/s] 95%|█████████▌| 951/1000 [00:03<00:00, 333.78it/s] 95%|█████████▌| 951/1000 [00:03<00:00, 333.77it/s] 98%|█████████▊| 985/1000 [00:03<00:00, 326.96it/s] 98%|█████████▊| 985/1000 [00:03<00:00, 326.82it/s]Step999:rank1, time: 0.303, per_step: 0.003005
Step999:rank0, time: 0.303, per_step: 0.003005
100%|██████████| 1000/1000 [00:03<00:00, 308.61it/s]100%|██████████| 1000/1000 [00:03<00:00, 308.63it/s]

Worker 1 pid=24469
Successfully xmh
