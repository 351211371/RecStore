perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fe934cd7e50>==========
Worker 0 pid=47068
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<02:46,  6.00it/s]  0%|          | 1/1000 [00:00<04:13,  3.95it/s]  3%|▎         | 26/1000 [00:00<00:10, 91.80it/s]  3%|▎         | 26/1000 [00:00<00:08, 117.15it/s]  5%|▌         | 51/1000 [00:00<00:05, 168.54it/s]  5%|▌         | 51/1000 [00:00<00:06, 144.50it/s]  8%|▊         | 79/1000 [00:00<00:04, 185.68it/s]  8%|▊         | 79/1000 [00:00<00:04, 203.33it/s]Step99:rank1, time: 0.651, per_step: 0.006506
Step99:rank0, time: 0.564, per_step: 0.005639
 10%|█         | 105/1000 [00:00<00:04, 207.95it/s] 11%|█         | 106/1000 [00:00<00:03, 223.67it/s] 13%|█▎        | 129/1000 [00:00<00:04, 214.31it/s] 13%|█▎        | 130/1000 [00:00<00:03, 224.78it/s] 16%|█▌        | 156/1000 [00:00<00:03, 229.20it/s] 16%|█▌        | 157/1000 [00:00<00:03, 236.92it/s] 18%|█▊        | 184/1000 [00:00<00:03, 244.05it/s] 18%|█▊        | 185/1000 [00:00<00:03, 249.58it/s]Step199:rank1, time: 0.392, per_step: 0.003878
Step199:rank0, time: 0.392, per_step: 0.003880
 21%|██        | 210/1000 [00:01<00:03, 247.94it/s] 21%|██        | 211/1000 [00:00<00:03, 251.98it/s] 24%|██▍       | 240/1000 [00:01<00:02, 261.92it/s] 24%|██▍       | 241/1000 [00:01<00:02, 264.77it/s] 27%|██▋       | 270/1000 [00:01<00:02, 272.09it/s] 27%|██▋       | 271/1000 [00:01<00:02, 274.35it/s]Step299:rank1, time: 0.337, per_step: 0.003340
Step299:rank0, time: 0.337, per_step: 0.003339
 30%|███       | 301/1000 [00:01<00:02, 282.36it/s] 30%|███       | 302/1000 [00:01<00:02, 283.63it/s] 33%|███▎      | 332/1000 [00:01<00:02, 288.46it/s] 33%|███▎      | 333/1000 [00:01<00:02, 289.81it/s] 36%|███▋      | 363/1000 [00:01<00:02, 293.08it/s] 36%|███▋      | 364/1000 [00:01<00:02, 294.09it/s] 40%|███▉      | 395/1000 [00:01<00:02, 298.91it/s] 40%|███▉      | 396/1000 [00:01<00:02, 298.92it/s]Step399:rank1, time: 0.327, per_step: 0.003238
Step399:rank0, time: 0.327, per_step: 0.003238
 43%|████▎     | 427/1000 [00:01<00:01, 303.16it/s] 43%|████▎     | 428/1000 [00:01<00:01, 303.73it/s] 46%|████▌     | 460/1000 [00:01<00:01, 308.89it/s] 46%|████▌     | 461/1000 [00:01<00:01, 309.63it/s] 49%|████▉     | 493/1000 [00:01<00:01, 314.63it/s] 49%|████▉     | 494/1000 [00:01<00:01, 315.19it/s]Step499:rank1, time: 0.310, per_step: 0.003065
Step499:rank0, time: 0.310, per_step: 0.003065
 53%|█████▎    | 526/1000 [00:02<00:01, 316.71it/s] 53%|█████▎    | 527/1000 [00:02<00:01, 316.76it/s] 56%|█████▌    | 560/1000 [00:02<00:01, 322.98it/s] 56%|█████▌    | 561/1000 [00:02<00:01, 323.43it/s] 59%|█████▉    | 593/1000 [00:02<00:01, 323.11it/s] 59%|█████▉    | 594/1000 [00:02<00:01, 323.46it/s]Step599:rank1, time: 0.310, per_step: 0.003066
Step599:rank0, time: 0.310, per_step: 0.003069
 63%|██████▎   | 626/1000 [00:02<00:01, 324.90it/s] 63%|██████▎   | 627/1000 [00:02<00:01, 325.13it/s] 66%|██████▌   | 662/1000 [00:02<00:01, 333.14it/s] 66%|██████▋   | 663/1000 [00:02<00:01, 333.37it/s] 70%|██████▉   | 696/1000 [00:02<00:00, 332.37it/s] 70%|██████▉   | 697/1000 [00:02<00:00, 332.50it/s]Step699:rank1, time: 0.291, per_step: 0.002878
Step699:rank0, time: 0.290, per_step: 0.002875
 73%|███████▎  | 732/1000 [00:02<00:00, 338.45it/s] 73%|███████▎  | 733/1000 [00:02<00:00, 338.51it/s] 77%|███████▋  | 769/1000 [00:02<00:00, 344.22it/s] 77%|███████▋  | 769/1000 [00:02<00:00, 344.11it/s]Step799:rank1, time: 0.280, per_step: 0.002770
Step799:rank0, time: 0.280, per_step: 0.002772
 81%|████████  | 806/1000 [00:02<00:00, 350.37it/s] 81%|████████  | 806/1000 [00:02<00:00, 350.30it/s] 84%|████████▍ | 842/1000 [00:03<00:00, 333.37it/s] 84%|████████▍ | 842/1000 [00:02<00:00, 333.53it/s] 88%|████████▊ | 876/1000 [00:03<00:00, 330.17it/s] 88%|████████▊ | 876/1000 [00:03<00:00, 329.95it/s]Step899:rank0, time: 0.310, per_step: 0.003066
Step899:rank1, time: 0.310, per_step: 0.003070
 91%|█████████ | 911/1000 [00:03<00:00, 335.58it/s] 91%|█████████ | 911/1000 [00:03<00:00, 335.37it/s] 95%|█████████▍| 949/1000 [00:03<00:00, 346.34it/s] 95%|█████████▍| 949/1000 [00:03<00:00, 346.25it/s] 99%|█████████▉| 988/1000 [00:03<00:00, 356.62it/s] 99%|█████████▉| 988/1000 [00:03<00:00, 356.54it/s]Step999:rank0, time: 0.268, per_step: 0.002654
100%|██████████| 1000/1000 [00:03<00:00, 295.56it/s]Step999:rank1, time: 0.268, per_step: 0.002654
100%|██████████| 1000/1000 [00:03<00:00, 288.17it/s]

Worker 1 pid=47069
Successfully xmh
