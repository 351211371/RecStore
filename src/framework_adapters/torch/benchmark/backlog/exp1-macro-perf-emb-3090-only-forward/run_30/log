perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f1d3f66ce50>==========
Worker 0 pid=58339
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:01<25:04,  1.51s/it]  2%|▏         | 22/1000 [00:01<00:52, 18.75it/s]  0%|          | 1/1000 [00:01<27:03,  1.63s/it]  1%|          | 9/1000 [00:01<02:21,  6.99it/s]  4%|▎         | 35/1000 [00:01<00:33, 28.70it/s]  2%|▏         | 19/1000 [00:01<00:59, 16.50it/s]  4%|▍         | 45/1000 [00:01<00:25, 37.39it/s]  3%|▎         | 28/1000 [00:01<00:38, 25.52it/s]  6%|▌         | 56/1000 [00:01<00:19, 48.31it/s]  4%|▎         | 37/1000 [00:02<00:27, 35.23it/s]  7%|▋         | 67/1000 [00:02<00:15, 59.05it/s]  5%|▍         | 47/1000 [00:02<00:20, 46.34it/s]  8%|▊         | 85/1000 [00:02<00:11, 83.17it/s]  6%|▌         | 61/1000 [00:02<00:14, 64.85it/s]Step99:rank1, time: 2.295, per_step: 0.022950
 10%|█         | 102/1000 [00:02<00:08, 101.13it/s]  8%|▊         | 79/1000 [00:02<00:10, 89.99it/s] 13%|█▎        | 127/1000 [00:02<00:06, 136.64it/s]  9%|▉         | 92/1000 [00:02<00:09, 99.00it/s] 15%|█▍        | 147/1000 [00:02<00:05, 151.37it/s]Step99:rank0, time: 2.525, per_step: 0.025254
 11%|█         | 108/1000 [00:02<00:07, 113.99it/s] 17%|█▋        | 170/1000 [00:02<00:04, 172.20it/s] 13%|█▎        | 131/1000 [00:02<00:06, 143.74it/s] 20%|█▉        | 198/1000 [00:02<00:04, 199.49it/s]Step199:rank1, time: 0.429, per_step: 0.004244
 15%|█▌        | 151/1000 [00:02<00:05, 158.26it/s] 23%|██▎       | 229/1000 [00:02<00:03, 229.86it/s] 17%|█▋        | 174/1000 [00:02<00:04, 177.70it/s] 28%|██▊       | 282/1000 [00:02<00:02, 307.75it/s]Step299:rank1, time: 0.233, per_step: 0.002311
Step199:rank0, time: 0.441, per_step: 0.004366
 20%|██        | 205/1000 [00:02<00:03, 214.94it/s] 33%|███▎      | 330/1000 [00:03<00:01, 355.02it/s] 25%|██▍       | 249/1000 [00:03<00:02, 279.69it/s] 38%|███▊      | 378/1000 [00:03<00:01, 388.93it/s]Step399:rank1, time: 0.217, per_step: 0.002148
 28%|██▊       | 284/1000 [00:03<00:02, 298.60it/s]Step299:rank0, time: 0.258, per_step: 0.002556
 43%|████▎     | 428/1000 [00:03<00:01, 420.02it/s] 32%|███▏      | 322/1000 [00:03<00:02, 321.78it/s] 48%|████▊     | 482/1000 [00:03<00:01, 452.99it/s]Step499:rank1, time: 0.186, per_step: 0.001845
 36%|███▌      | 362/1000 [00:03<00:01, 340.58it/s] 56%|█████▌    | 558/1000 [00:03<00:00, 532.50it/s]Step599:rank1, time: 0.118, per_step: 0.001173
 40%|███▉      | 397/1000 [00:03<00:01, 336.74it/s]Step399:rank0, time: 0.283, per_step: 0.002801
 64%|██████▍   | 638/1000 [00:03<00:00, 609.54it/s] 45%|████▍     | 447/1000 [00:03<00:01, 383.37it/s]Step699:rank1, time: 0.178, per_step: 0.001760
 70%|███████   | 700/1000 [00:03<00:00, 583.10it/s] 49%|████▉     | 490/1000 [00:03<00:01, 394.98it/s]Step499:rank0, time: 0.209, per_step: 0.002069
 76%|███████▌  | 759/1000 [00:03<00:00, 559.67it/s] 53%|█████▎    | 530/1000 [00:03<00:01, 390.44it/s]Step799:rank1, time: 0.176, per_step: 0.001745
 83%|████████▎ | 827/1000 [00:03<00:00, 592.77it/s] 58%|█████▊    | 581/1000 [00:03<00:00, 424.35it/s]Step599:rank0, time: 0.241, per_step: 0.002388
Step899:rank1, time: 0.132, per_step: 0.001311
 91%|█████████ | 911/1000 [00:03<00:00, 662.69it/s] 62%|██████▏   | 624/1000 [00:04<00:00, 408.91it/s] 98%|█████████▊| 978/1000 [00:04<00:00, 633.29it/s] 67%|██████▋   | 666/1000 [00:04<00:00, 406.72it/s]Step999:rank1, time: 0.174, per_step: 0.001719
100%|██████████| 1000/1000 [00:04<00:00, 241.96it/s]
Step699:rank0, time: 0.216, per_step: 0.002138
 77%|███████▋  | 773/1000 [00:04<00:00, 597.43it/s]Step799:rank0, time: 0.063, per_step: 0.000623
Step899:rank0, time: 0.064, per_step: 0.000631
 93%|█████████▎| 934/1000 [00:04<00:00, 891.94it/s]Step999:rank0, time: 0.059, per_step: 0.000586
100%|██████████| 1000/1000 [00:04<00:00, 229.72it/s]
Worker 1 pid=58340
Successfully xmh
