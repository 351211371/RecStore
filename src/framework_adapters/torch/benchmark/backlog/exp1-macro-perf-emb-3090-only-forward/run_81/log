perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f1d6c316e50>==========
Worker 0 pid=5151
Worker 1 pid=5152
Worker 2 pid=5153
Worker 3 pid=5154
Worker 4 pid=5155
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:02<33:58,  2.04s/it]  0%|          | 1/1000 [00:02<34:56,  2.10s/it]  0%|          | 1/1000 [00:02<35:09,  2.11s/it]  0%|          | 1/1000 [00:02<36:05,  2.17s/it]  1%|          | 6/1000 [00:02<04:33,  3.64it/s]  0%|          | 1/1000 [00:02<36:53,  2.22s/it]  0%|          | 5/1000 [00:02<05:35,  2.96it/s]  0%|          | 1/1000 [00:02<37:05,  2.23s/it]  1%|          | 6/1000 [00:02<04:41,  3.53it/s]  0%|          | 5/1000 [00:02<05:46,  2.87it/s]  1%|          | 10/1000 [00:02<02:30,  6.59it/s]  1%|          | 10/1000 [00:02<02:25,  6.79it/s]  0%|          | 5/1000 [00:02<05:53,  2.81it/s]  0%|          | 5/1000 [00:02<05:57,  2.78it/s]  1%|          | 10/1000 [00:02<02:34,  6.42it/s]  1%|▏         | 14/1000 [00:02<01:37, 10.09it/s]  1%|          | 9/1000 [00:02<02:51,  5.77it/s]  1%|          | 8/1000 [00:02<03:20,  4.95it/s]  2%|▏         | 15/1000 [00:02<01:27, 11.20it/s]  1%|          | 9/1000 [00:02<02:54,  5.67it/s]  2%|▏         | 15/1000 [00:02<01:31, 10.73it/s]  1%|▏         | 13/1000 [00:02<01:47,  9.16it/s]  2%|▏         | 20/1000 [00:02<01:01, 16.04it/s]  1%|          | 12/1000 [00:02<01:56,  8.49it/s]  2%|▏         | 21/1000 [00:02<00:56, 17.25it/s]  1%|▏         | 13/1000 [00:02<01:48,  9.08it/s]  2%|▏         | 20/1000 [00:02<01:03, 15.36it/s]  2%|▎         | 25/1000 [00:02<00:46, 21.09it/s]  2%|▏         | 18/1000 [00:02<01:10, 14.00it/s]  2%|▏         | 17/1000 [00:02<01:12, 13.50it/s]  3%|▎         | 27/1000 [00:02<00:41, 23.54it/s]  2%|▏         | 18/1000 [00:02<01:10, 13.91it/s]  3%|▎         | 26/1000 [00:02<00:44, 21.81it/s]  3%|▎         | 30/1000 [00:02<00:37, 26.21it/s]  2%|▏         | 24/1000 [00:02<00:47, 20.41it/s]  2%|▏         | 22/1000 [00:02<00:52, 18.79it/s]  3%|▎         | 34/1000 [00:02<00:30, 31.52it/s]  2%|▏         | 23/1000 [00:02<00:51, 18.98it/s]  3%|▎         | 32/1000 [00:02<00:34, 27.96it/s]  4%|▎         | 35/1000 [00:02<00:31, 31.03it/s]  3%|▎         | 29/1000 [00:02<00:38, 25.39it/s]  3%|▎         | 27/1000 [00:02<00:40, 24.23it/s]  4%|▍         | 43/1000 [00:02<00:22, 42.86it/s]  3%|▎         | 29/1000 [00:02<00:38, 25.29it/s]  4%|▍         | 38/1000 [00:02<00:28, 33.96it/s]  4%|▍         | 42/1000 [00:02<00:24, 38.61it/s]  5%|▌         | 52/1000 [00:02<00:17, 53.23it/s]  3%|▎         | 33/1000 [00:02<00:31, 30.83it/s]  4%|▎         | 36/1000 [00:02<00:29, 33.04it/s]  4%|▎         | 35/1000 [00:03<00:30, 31.54it/s]  4%|▍         | 45/1000 [00:03<00:23, 40.89it/s]  5%|▍         | 49/1000 [00:03<00:20, 45.63it/s]  6%|▌         | 61/1000 [00:03<00:15, 61.31it/s]  4%|▍         | 42/1000 [00:03<00:24, 38.47it/s]  4%|▍         | 40/1000 [00:03<00:25, 38.15it/s]  4%|▍         | 42/1000 [00:03<00:24, 38.75it/s]  5%|▌         | 52/1000 [00:03<00:19, 47.61it/s]  6%|▌         | 57/1000 [00:03<00:17, 53.49it/s]  7%|▋         | 73/1000 [00:03<00:12, 74.44it/s]  5%|▍         | 47/1000 [00:03<00:21, 45.19it/s]  5%|▍         | 49/1000 [00:03<00:21, 44.73it/s]  5%|▍         | 49/1000 [00:03<00:20, 45.78it/s]  6%|▌         | 60/1000 [00:03<00:17, 55.18it/s]  7%|▋         | 66/1000 [00:03<00:15, 62.06it/s]  8%|▊         | 85/1000 [00:03<00:10, 85.27it/s]  6%|▌         | 55/1000 [00:03<00:17, 53.09it/s]  6%|▌         | 57/1000 [00:03<00:18, 51.74it/s]  6%|▌         | 57/1000 [00:03<00:17, 53.50it/s]  7%|▋         | 69/1000 [00:03<00:14, 63.26it/s]  8%|▊         | 76/1000 [00:03<00:12, 71.12it/s]Step99:rank4, time: 3.400, per_step: 0.034003
 10%|█         | 100/1000 [00:03<00:08, 101.81it/s]  6%|▋         | 65/1000 [00:03<00:15, 58.88it/s]  6%|▋         | 64/1000 [00:03<00:15, 61.26it/s]  7%|▋         | 66/1000 [00:03<00:15, 61.92it/s]  8%|▊         | 80/1000 [00:03<00:12, 73.91it/s]  9%|▊         | 87/1000 [00:03<00:11, 81.43it/s] 11%|█▏        | 114/1000 [00:03<00:07, 111.28it/s]  7%|▋         | 74/1000 [00:03<00:13, 66.81it/s]  7%|▋         | 74/1000 [00:03<00:13, 71.10it/s]  8%|▊         | 76/1000 [00:03<00:12, 71.10it/s]  9%|▉         | 91/1000 [00:03<00:10, 82.87it/s]Step99:rank5, time: 3.579, per_step: 0.035794
 10%|█         | 100/1000 [00:03<00:09, 93.81it/s] 13%|█▎        | 132/1000 [00:03<00:06, 130.26it/s]  8%|▊         | 84/1000 [00:03<00:12, 75.66it/s]  8%|▊         | 85/1000 [00:03<00:11, 80.70it/s]Step99:rank3, time: 3.635, per_step: 0.036354
  9%|▊         | 87/1000 [00:03<00:11, 80.39it/s] 10%|█         | 104/1000 [00:03<00:09, 94.16it/s] 11%|█▏        | 114/1000 [00:03<00:08, 106.75it/s] 15%|█▌        | 153/1000 [00:03<00:05, 152.33it/s] 10%|▉         | 97/1000 [00:03<00:09, 90.41it/s]Step99:rank0, time: 3.732, per_step: 0.037323
  9%|▉         | 94/1000 [00:03<00:11, 76.82it/s]Step99:rank2, time: 3.761, per_step: 0.037610
 10%|█         | 100/1000 [00:03<00:09, 92.74it/s] 12%|█▏        | 118/1000 [00:03<00:08, 106.67it/s] 13%|█▎        | 130/1000 [00:03<00:07, 121.00it/s]Step99:rank1, time: 3.797, per_step: 0.037973
 18%|█▊        | 177/1000 [00:03<00:04, 176.24it/s] 11%|█         | 110/1000 [00:03<00:08, 100.26it/s] 11%|█         | 107/1000 [00:03<00:09, 90.76it/s] 11%|█▏        | 114/1000 [00:03<00:08, 104.00it/s] 14%|█▎        | 136/1000 [00:03<00:06, 127.41it/s] 15%|█▍        | 147/1000 [00:03<00:06, 134.10it/s] 20%|█▉        | 197/1000 [00:03<00:04, 181.59it/s] 12%|█▏        | 124/1000 [00:03<00:07, 110.11it/s]Step199:rank4, time: 0.528, per_step: 0.005227
 12%|█▏        | 121/1000 [00:03<00:08, 103.97it/s] 13%|█▎        | 129/1000 [00:03<00:07, 116.86it/s] 16%|█▌        | 155/1000 [00:03<00:05, 143.87it/s] 17%|█▋        | 166/1000 [00:03<00:05, 149.25it/s] 22%|██▏       | 218/1000 [00:04<00:04, 188.45it/s] 14%|█▍        | 140/1000 [00:04<00:06, 123.22it/s] 14%|█▎        | 137/1000 [00:04<00:07, 118.20it/s] 15%|█▍        | 146/1000 [00:04<00:06, 130.39it/s] 17%|█▋        | 174/1000 [00:04<00:05, 155.63it/s] 19%|█▊        | 186/1000 [00:04<00:04, 163.61it/s] 24%|██▍       | 240/1000 [00:04<00:03, 196.86it/s] 16%|█▌        | 157/1000 [00:04<00:06, 135.88it/s] 15%|█▌        | 154/1000 [00:04<00:06, 132.25it/s]Step199:rank5, time: 0.580, per_step: 0.005741
 16%|█▋        | 164/1000 [00:04<00:05, 143.22it/s] 19%|█▉        | 194/1000 [00:04<00:04, 166.31it/s] 21%|██        | 207/1000 [00:04<00:04, 175.35it/s]Step199:rank3, time: 0.573, per_step: 0.005676
 26%|██▋       | 263/1000 [00:04<00:03, 204.23it/s] 18%|█▊        | 175/1000 [00:04<00:05, 147.82it/s] 17%|█▋        | 172/1000 [00:04<00:05, 143.16it/s] 22%|██▏       | 215/1000 [00:04<00:04, 177.24it/s] 18%|█▊        | 179/1000 [00:04<00:05, 139.70it/s] 23%|██▎       | 229/1000 [00:04<00:04, 186.60it/s] 28%|██▊       | 285/1000 [00:04<00:03, 208.62it/s] 19%|█▉        | 190/1000 [00:04<00:05, 135.50it/s] 19%|█▉        | 192/1000 [00:04<00:05, 158.08it/s]Step299:rank4, time: 0.451, per_step: 0.004461
 24%|██▍       | 240/1000 [00:04<00:03, 198.18it/s] 19%|█▉        | 194/1000 [00:04<00:05, 141.28it/s] 25%|██▌       | 251/1000 [00:04<00:03, 195.98it/s]Step199:rank1, time: 0.613, per_step: 0.006068
Step199:rank0, time: 0.678, per_step: 0.006713
Step199:rank2, time: 0.664, per_step: 0.006573
 31%|███       | 311/1000 [00:04<00:03, 204.85it/s] 21%|██        | 212/1000 [00:04<00:04, 169.01it/s] 21%|██        | 210/1000 [00:04<00:05, 151.42it/s] 26%|██▋       | 263/1000 [00:04<00:03, 204.99it/s] 21%|██▏       | 214/1000 [00:04<00:05, 156.57it/s] 27%|██▋       | 273/1000 [00:04<00:03, 202.38it/s] 33%|███▎      | 333/1000 [00:04<00:03, 207.47it/s] 23%|██▎       | 232/1000 [00:04<00:04, 177.64it/s] 23%|██▎       | 230/1000 [00:04<00:04, 164.41it/s] 28%|██▊       | 285/1000 [00:04<00:03, 207.89it/s] 23%|██▎       | 234/1000 [00:04<00:04, 169.07it/s] 30%|██▉       | 296/1000 [00:04<00:03, 208.01it/s]Step299:rank5, time: 0.462, per_step: 0.004574
 36%|███▌      | 356/1000 [00:04<00:03, 213.20it/s] 25%|██▌       | 252/1000 [00:04<00:04, 183.34it/s] 25%|██▌       | 251/1000 [00:04<00:04, 176.06it/s] 26%|██▌       | 255/1000 [00:04<00:04, 179.61it/s] 32%|███▏      | 319/1000 [00:04<00:03, 212.18it/s]Step299:rank3, time: 0.521, per_step: 0.005156
 38%|███▊      | 379/1000 [00:04<00:02, 217.66it/s] 31%|███       | 306/1000 [00:04<00:03, 174.34it/s] 27%|██▋       | 273/1000 [00:04<00:03, 189.60it/s] 28%|██▊       | 276/1000 [00:04<00:03, 196.51it/s] 28%|██▊       | 276/1000 [00:04<00:03, 187.05it/s]Step399:rank4, time: 0.469, per_step: 0.004641
 40%|████      | 402/1000 [00:04<00:02, 221.16it/s] 33%|███▎      | 328/1000 [00:04<00:03, 185.71it/s] 34%|███▍      | 341/1000 [00:04<00:03, 179.31it/s] 29%|██▉       | 294/1000 [00:04<00:03, 195.24it/s] 30%|██▉       | 298/1000 [00:04<00:03, 201.15it/s]Step299:rank0, time: 0.471, per_step: 0.004661
 30%|██▉       | 297/1000 [00:04<00:03, 193.44it/s]Step299:rank1, time: 0.496, per_step: 0.004907
Step299:rank2, time: 0.493, per_step: 0.004882
 42%|████▎     | 425/1000 [00:04<00:02, 223.45it/s] 35%|███▌      | 353/1000 [00:04<00:03, 202.73it/s] 36%|███▋      | 364/1000 [00:04<00:03, 191.90it/s] 32%|███▏      | 315/1000 [00:04<00:03, 199.20it/s] 32%|███▏      | 319/1000 [00:04<00:03, 203.22it/s] 32%|███▏      | 318/1000 [00:04<00:03, 197.83it/s] 45%|████▍     | 448/1000 [00:05<00:02, 225.04it/s] 38%|███▊      | 376/1000 [00:05<00:02, 208.34it/s] 34%|███▎      | 336/1000 [00:05<00:03, 201.84it/s] 39%|███▊      | 387/1000 [00:05<00:03, 200.62it/s] 34%|███▍      | 340/1000 [00:05<00:03, 205.03it/s] 34%|███▍      | 340/1000 [00:05<00:03, 201.55it/s]Step399:rank5, time: 0.513, per_step: 0.005084
 47%|████▋     | 471/1000 [00:05<00:02, 226.03it/s] 40%|███▉      | 398/1000 [00:05<00:02, 210.56it/s]Step399:rank3, time: 0.445, per_step: 0.004403
 41%|████      | 410/1000 [00:05<00:02, 208.18it/s] 36%|███▌      | 358/1000 [00:05<00:03, 205.23it/s] 36%|███▌      | 362/1000 [00:05<00:03, 207.53it/s] 36%|███▌      | 362/1000 [00:05<00:03, 204.65it/s] 49%|████▉     | 494/1000 [00:05<00:02, 226.94it/s] 42%|████▏     | 421/1000 [00:05<00:02, 213.93it/s] 43%|████▎     | 434/1000 [00:05<00:02, 215.33it/s]Step499:rank4, time: 0.438, per_step: 0.004333
 38%|███▊      | 380/1000 [00:05<00:02, 207.41it/s] 38%|███▊      | 383/1000 [00:05<00:02, 207.88it/s] 38%|███▊      | 384/1000 [00:05<00:02, 206.89it/s] 52%|█████▏    | 517/1000 [00:05<00:02, 227.83it/s]Step399:rank0, time: 0.475, per_step: 0.004705
 45%|████▍     | 446/1000 [00:05<00:02, 222.64it/s]Step399:rank1, time: 0.473, per_step: 0.004685
 46%|████▌     | 457/1000 [00:05<00:02, 218.90it/s] 40%|████      | 402/1000 [00:05<00:02, 208.76it/s] 40%|████      | 405/1000 [00:05<00:02, 208.87it/s]Step399:rank2, time: 0.474, per_step: 0.004698
 40%|████      | 405/1000 [00:05<00:02, 207.77it/s] 54%|█████▍    | 540/1000 [00:05<00:02, 228.13it/s] 47%|████▋     | 473/1000 [00:05<00:02, 233.42it/s] 48%|████▊     | 480/1000 [00:05<00:02, 221.76it/s] 43%|████▎     | 426/1000 [00:05<00:02, 208.82it/s] 42%|████▏     | 424/1000 [00:05<00:02, 209.30it/s] 43%|████▎     | 427/1000 [00:05<00:02, 209.31it/s] 56%|█████▋    | 563/1000 [00:05<00:01, 228.57it/s]Step499:rank5, time: 0.435, per_step: 0.004309
 50%|████▉     | 497/1000 [00:05<00:02, 230.92it/s] 50%|█████     | 503/1000 [00:05<00:02, 223.70it/s] 44%|████▍     | 445/1000 [00:05<00:02, 209.06it/s] 45%|████▍     | 448/1000 [00:05<00:02, 209.33it/s]Step499:rank3, time: 0.421, per_step: 0.004173
 45%|████▍     | 448/1000 [00:05<00:02, 208.23it/s] 59%|█████▊    | 587/1000 [00:05<00:01, 229.08it/s] 53%|█████▎    | 526/1000 [00:05<00:02, 225.11it/s] 52%|█████▏    | 521/1000 [00:05<00:02, 228.53it/s] 47%|████▋     | 470/1000 [00:05<00:02, 209.59it/s]Step599:rank4, time: 0.436, per_step: 0.004313
 47%|████▋     | 471/1000 [00:05<00:02, 211.90it/s] 47%|████▋     | 466/1000 [00:05<00:02, 186.44it/s] 61%|██████    | 610/1000 [00:05<00:01, 228.83it/s] 55%|█████▍    | 549/1000 [00:05<00:01, 225.53it/s] 55%|█████▍    | 547/1000 [00:05<00:01, 235.12it/s] 49%|████▉     | 494/1000 [00:05<00:02, 217.35it/s]Step499:rank0, time: 0.461, per_step: 0.004563
 49%|████▉     | 493/1000 [00:05<00:02, 210.81it/s] 49%|████▉     | 488/1000 [00:05<00:02, 193.51it/s] 63%|██████▎   | 633/1000 [00:05<00:01, 229.10it/s]Step499:rank2, time: 0.473, per_step: 0.004682
 57%|█████▋    | 572/1000 [00:05<00:01, 226.39it/s]Step499:rank1, time: 0.517, per_step: 0.005123
 57%|█████▋    | 571/1000 [00:05<00:01, 231.18it/s] 52%|█████▏    | 516/1000 [00:05<00:02, 217.53it/s] 52%|█████▏    | 515/1000 [00:05<00:02, 211.05it/s] 51%|█████     | 510/1000 [00:05<00:02, 198.60it/s] 66%|██████▌   | 658/1000 [00:05<00:01, 232.89it/s] 60%|█████▉    | 595/1000 [00:05<00:01, 226.33it/s] 60%|█████▉    | 596/1000 [00:05<00:01, 236.44it/s] 54%|█████▍    | 538/1000 [00:05<00:02, 215.25it/s]Step599:rank5, time: 0.441, per_step: 0.004363
Step599:rank3, time: 0.420, per_step: 0.004163
 54%|█████▎    | 537/1000 [00:06<00:02, 200.76it/s] 53%|█████▎    | 531/1000 [00:06<00:02, 189.47it/s] 69%|██████▊   | 686/1000 [00:06<00:01, 245.67it/s] 62%|██████▏   | 618/1000 [00:06<00:01, 222.88it/s] 62%|██████▏   | 620/1000 [00:06<00:01, 236.75it/s] 56%|█████▌    | 560/1000 [00:06<00:02, 206.32it/s]Step699:rank4, time: 0.410, per_step: 0.004059
 71%|███████   | 711/1000 [00:06<00:01, 246.30it/s] 56%|█████▌    | 558/1000 [00:06<00:02, 195.40it/s] 55%|█████▌    | 551/1000 [00:06<00:02, 185.69it/s] 64%|██████▍   | 641/1000 [00:06<00:01, 224.57it/s] 64%|██████▍   | 644/1000 [00:06<00:01, 234.74it/s] 58%|█████▊    | 581/1000 [00:06<00:02, 207.33it/s] 74%|███████▍  | 739/1000 [00:06<00:01, 253.09it/s] 57%|█████▋    | 571/1000 [00:06<00:02, 189.40it/s] 58%|█████▊    | 578/1000 [00:06<00:02, 189.54it/s] 66%|██████▋   | 664/1000 [00:06<00:01, 224.73it/s] 67%|██████▋   | 670/1000 [00:06<00:01, 240.98it/s]Step599:rank0, time: 0.487, per_step: 0.004825
 60%|██████    | 602/1000 [00:06<00:01, 208.04it/s] 76%|███████▋  | 765/1000 [00:06<00:00, 252.92it/s] 59%|█████▉    | 591/1000 [00:06<00:02, 185.61it/s] 69%|██████▊   | 687/1000 [00:06<00:01, 224.41it/s] 70%|██████▉   | 695/1000 [00:06<00:01, 236.16it/s] 62%|██████▏   | 623/1000 [00:06<00:01, 208.05it/s] 60%|█████▉    | 598/1000 [00:06<00:02, 169.73it/s]Step599:rank1, time: 0.546, per_step: 0.005410
Step699:rank3, time: 0.426, per_step: 0.004213
Step599:rank2, time: 0.581, per_step: 0.005751
Step699:rank5, time: 0.447, per_step: 0.004430
 79%|███████▉  | 793/1000 [00:06<00:00, 259.86it/s] 61%|██████    | 610/1000 [00:06<00:02, 184.17it/s] 71%|███████   | 710/1000 [00:06<00:01, 224.80it/s]Step799:rank4, time: 0.374, per_step: 0.003703
 72%|███████▏  | 719/1000 [00:06<00:01, 233.20it/s] 64%|██████▍   | 645/1000 [00:06<00:01, 208.88it/s] 62%|██████▏   | 616/1000 [00:06<00:02, 171.61it/s] 82%|████████▏ | 819/1000 [00:06<00:00, 254.83it/s] 63%|██████▎   | 629/1000 [00:06<00:02, 184.30it/s] 73%|███████▎  | 733/1000 [00:06<00:01, 224.96it/s] 74%|███████▍  | 745/1000 [00:06<00:01, 238.99it/s] 67%|██████▋   | 667/1000 [00:06<00:01, 209.89it/s] 64%|██████▎   | 636/1000 [00:06<00:02, 177.53it/s] 84%|████████▍ | 845/1000 [00:06<00:00, 246.24it/s] 65%|██████▍   | 649/1000 [00:06<00:01, 188.25it/s] 76%|███████▌  | 756/1000 [00:06<00:01, 225.20it/s] 77%|███████▋  | 772/1000 [00:06<00:00, 245.51it/s] 69%|██████▉   | 689/1000 [00:06<00:01, 209.65it/s] 66%|██████▌   | 656/1000 [00:06<00:01, 182.77it/s]Step699:rank0, time: 0.477, per_step: 0.004718
 67%|██████▋   | 670/1000 [00:06<00:01, 192.91it/s] 87%|████████▋ | 870/1000 [00:06<00:00, 241.29it/s] 78%|███████▊  | 779/1000 [00:06<00:00, 225.39it/s] 71%|███████   | 710/1000 [00:06<00:01, 209.12it/s] 80%|███████▉  | 797/1000 [00:06<00:00, 239.85it/s] 68%|██████▊   | 677/1000 [00:06<00:01, 189.83it/s]Step799:rank3, time: 0.415, per_step: 0.004108
Step799:rank5, time: 0.443, per_step: 0.004385
 69%|██████▉   | 691/1000 [00:06<00:01, 196.84it/s] 80%|████████  | 802/1000 [00:06<00:00, 225.41it/s] 90%|████████▉ | 895/1000 [00:06<00:00, 237.70it/s]Step899:rank4, time: 0.435, per_step: 0.004307
 73%|███████▎  | 732/1000 [00:06<00:01, 209.67it/s] 70%|██████▉   | 698/1000 [00:06<00:01, 194.14it/s] 82%|████████▏ | 822/1000 [00:06<00:00, 237.38it/s]Step699:rank1, time: 0.507, per_step: 0.005025
Step699:rank2, time: 0.510, per_step: 0.005050
 71%|███████   | 712/1000 [00:07<00:01, 198.19it/s] 92%|█████████▏| 919/1000 [00:07<00:00, 235.06it/s] 75%|███████▌  | 753/1000 [00:07<00:01, 209.30it/s] 72%|███████▏  | 718/1000 [00:07<00:01, 195.26it/s] 85%|████████▍ | 849/1000 [00:07<00:00, 244.26it/s] 82%|████████▎ | 825/1000 [00:07<00:00, 197.62it/s] 73%|███████▎  | 733/1000 [00:07<00:01, 201.39it/s] 94%|█████████▍| 943/1000 [00:07<00:00, 233.48it/s] 78%|███████▊  | 775/1000 [00:07<00:01, 210.65it/s] 74%|███████▍  | 739/1000 [00:07<00:01, 198.12it/s] 87%|████████▋ | 874/1000 [00:07<00:00, 239.06it/s] 85%|████████▍ | 846/1000 [00:07<00:00, 189.32it/s] 75%|███████▌  | 754/1000 [00:07<00:01, 201.68it/s] 97%|█████████▋| 967/1000 [00:07<00:00, 232.30it/s] 76%|███████▌  | 760/1000 [00:07<00:01, 199.45it/s] 90%|████████▉ | 898/1000 [00:07<00:00, 235.36it/s]Step899:rank3, time: 0.421, per_step: 0.004171
 80%|███████▉  | 797/1000 [00:07<00:00, 210.98it/s] 87%|████████▋ | 869/1000 [00:07<00:00, 199.72it/s]Step799:rank0, time: 0.519, per_step: 0.005138
 78%|███████▊  | 775/1000 [00:07<00:01, 201.56it/s] 78%|███████▊  | 781/1000 [00:07<00:01, 201.30it/s] 99%|█████████▉| 991/1000 [00:07<00:00, 212.17it/s] 92%|█████████▏| 922/1000 [00:07<00:00, 232.96it/s] 89%|████████▉ | 892/1000 [00:07<00:00, 206.12it/s] 82%|████████▏ | 819/1000 [00:07<00:00, 186.81it/s]Step999:rank4, time: 0.479, per_step: 0.004745
100%|██████████| 1000/1000 [00:07<00:00, 134.92it/s]
 80%|███████▉  | 796/1000 [00:07<00:01, 198.73it/s]Step899:rank5, time: 0.529, per_step: 0.005238
Step799:rank2, time: 0.485, per_step: 0.004801
Step799:rank1, time: 0.496, per_step: 0.004908
 80%|████████  | 804/1000 [00:07<00:00, 209.55it/s] 92%|█████████▏| 915/1000 [00:07<00:00, 212.69it/s] 95%|█████████▍| 946/1000 [00:07<00:00, 220.84it/s] 84%|████████▍ | 844/1000 [00:07<00:00, 203.70it/s] 82%|████████▏ | 816/1000 [00:07<00:00, 192.44it/s] 84%|████████▎ | 835/1000 [00:07<00:00, 238.26it/s] 94%|█████████▍| 941/1000 [00:07<00:00, 225.45it/s] 97%|█████████▋| 970/1000 [00:07<00:00, 224.56it/s] 87%|████████▋ | 873/1000 [00:07<00:00, 227.40it/s] 84%|████████▍ | 838/1000 [00:07<00:00, 200.03it/s] 86%|████████▌ | 859/1000 [00:07<00:00, 237.88it/s] 97%|█████████▋| 969/1000 [00:07<00:00, 239.57it/s]Step999:rank3, time: 0.420, per_step: 0.004160
100%|██████████| 1000/1000 [00:07<00:00, 130.05it/s]
 90%|████████▉ | 897/1000 [00:07<00:00, 229.13it/s]Step899:rank0, time: 0.407, per_step: 0.004029
 86%|████████▌ | 861/1000 [00:07<00:00, 205.14it/s] 89%|████████▉ | 891/1000 [00:07<00:00, 260.23it/s]Step899:rank2, time: 0.348, per_step: 0.003441
100%|█████████▉| 996/1000 [00:07<00:00, 247.85it/s] 92%|█████████▏| 921/1000 [00:07<00:00, 229.49it/s]Step999:rank5, time: 0.379, per_step: 0.003749
100%|██████████| 1000/1000 [00:07<00:00, 128.20it/s]
 89%|████████▊ | 887/1000 [00:07<00:00, 219.24it/s] 92%|█████████▏| 919/1000 [00:07<00:00, 262.90it/s] 95%|█████████▌| 953/1000 [00:07<00:00, 252.05it/s]Step899:rank1, time: 0.469, per_step: 0.004639
 95%|█████████▍| 946/1000 [00:07<00:00, 262.50it/s] 91%|█████████ | 909/1000 [00:07<00:00, 209.09it/s] 99%|█████████▉| 990/1000 [00:07<00:00, 285.06it/s]Step999:rank0, time: 0.321, per_step: 0.003180
100%|██████████| 1000/1000 [00:08<00:00, 124.67it/s]
 98%|█████████▊| 977/1000 [00:08<00:00, 276.19it/s] 93%|█████████▎| 931/1000 [00:08<00:00, 206.07it/s]Step999:rank2, time: 0.345, per_step: 0.003411
100%|██████████| 1000/1000 [00:08<00:00, 123.06it/s]
 97%|█████████▋| 967/1000 [00:08<00:00, 249.28it/s]Step999:rank1, time: 0.323, per_step: 0.003200
100%|██████████| 1000/1000 [00:08<00:00, 121.49it/s]
Worker 5 pid=5156
Successfully xmh
