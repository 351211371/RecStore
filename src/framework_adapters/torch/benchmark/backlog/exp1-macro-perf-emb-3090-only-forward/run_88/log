perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fa697ce9e50>==========
Worker 0 pid=26235
Worker 1 pid=26236
Worker 2 pid=26237
Worker 3 pid=26238
Worker 4 pid=26241
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<14:09,  1.18it/s]  0%|          | 1/1000 [00:00<10:50,  1.54it/s]  0%|          | 1/1000 [00:00<11:42,  1.42it/s]  0%|          | 1/1000 [00:00<12:22,  1.35it/s]  0%|          | 1/1000 [00:00<09:46,  1.70it/s]  0%|          | 1/1000 [00:00<13:00,  1.28it/s]  1%|          | 9/1000 [00:00<00:58, 17.00it/s]  1%|          | 10/1000 [00:00<01:01, 16.13it/s]  1%|          | 10/1000 [00:00<01:11, 13.76it/s]  1%|          | 10/1000 [00:00<01:04, 15.42it/s]  1%|          | 10/1000 [00:00<00:57, 17.15it/s]  1%|          | 10/1000 [00:00<01:06, 14.78it/s]  2%|▏         | 22/1000 [00:00<00:23, 41.41it/s]  2%|▏         | 23/1000 [00:01<00:29, 33.29it/s]  2%|▏         | 23/1000 [00:00<00:25, 37.91it/s]  2%|▏         | 23/1000 [00:00<00:24, 39.84it/s]  2%|▏         | 23/1000 [00:00<00:26, 36.55it/s]  2%|▏         | 23/1000 [00:00<00:27, 35.31it/s]  4%|▍         | 38/1000 [00:00<00:13, 69.07it/s]  4%|▍         | 39/1000 [00:01<00:16, 57.62it/s]  4%|▍         | 39/1000 [00:01<00:15, 63.87it/s]  4%|▍         | 39/1000 [00:00<00:14, 66.40it/s]  4%|▍         | 39/1000 [00:01<00:15, 62.07it/s]  4%|▍         | 39/1000 [00:01<00:15, 60.41it/s]  6%|▌         | 56/1000 [00:00<00:09, 95.67it/s]  6%|▌         | 57/1000 [00:01<00:11, 83.14it/s]  6%|▌         | 57/1000 [00:01<00:10, 89.98it/s]  6%|▌         | 57/1000 [00:01<00:10, 92.64it/s]  6%|▌         | 57/1000 [00:01<00:10, 88.06it/s]  6%|▌         | 57/1000 [00:01<00:10, 86.22it/s]  7%|▋         | 73/1000 [00:01<00:08, 115.11it/s]  8%|▊         | 75/1000 [00:01<00:08, 104.45it/s]  8%|▊         | 75/1000 [00:01<00:08, 110.82it/s]  8%|▊         | 75/1000 [00:01<00:08, 113.22it/s]  8%|▊         | 75/1000 [00:01<00:08, 109.03it/s]  8%|▊         | 75/1000 [00:01<00:08, 107.35it/s]  9%|▉         | 91/1000 [00:01<00:06, 132.23it/s]  9%|▉         | 93/1000 [00:01<00:07, 122.75it/s]  9%|▉         | 93/1000 [00:01<00:07, 128.26it/s]  9%|▉         | 93/1000 [00:01<00:06, 130.31it/s]  9%|▉         | 93/1000 [00:01<00:07, 126.75it/s]  9%|▉         | 93/1000 [00:01<00:07, 125.27it/s]Step99:rank2, time: 1.526, per_step: 0.015264
Step99:rank0, time: 1.421, per_step: 0.014209
Step99:rank3, time: 1.288, per_step: 0.012883
Step99:rank1, time: 1.332, per_step: 0.013320
Step99:rank4, time: 1.428, per_step: 0.014277
Step99:rank5, time: 1.486, per_step: 0.014858
 11%|█         | 109/1000 [00:01<00:06, 145.32it/s] 11%|█         | 111/1000 [00:01<00:06, 137.49it/s] 11%|█         | 111/1000 [00:01<00:06, 141.98it/s] 11%|█         | 111/1000 [00:01<00:06, 143.65it/s] 11%|█         | 111/1000 [00:01<00:06, 140.78it/s] 11%|█         | 111/1000 [00:01<00:06, 139.58it/s] 13%|█▎        | 127/1000 [00:01<00:05, 154.35it/s] 13%|█▎        | 129/1000 [00:01<00:05, 148.31it/s] 13%|█▎        | 129/1000 [00:01<00:05, 150.86it/s] 13%|█▎        | 129/1000 [00:01<00:05, 151.79it/s] 13%|█▎        | 129/1000 [00:01<00:05, 153.05it/s] 13%|█▎        | 129/1000 [00:01<00:05, 149.93it/s] 14%|█▍        | 144/1000 [00:01<00:05, 156.58it/s] 15%|█▍        | 146/1000 [00:01<00:05, 152.19it/s] 15%|█▍        | 146/1000 [00:01<00:05, 154.73it/s] 15%|█▍        | 146/1000 [00:01<00:05, 155.64it/s] 15%|█▍        | 146/1000 [00:01<00:05, 154.04it/s] 15%|█▍        | 146/1000 [00:01<00:05, 153.40it/s] 16%|█▋        | 163/1000 [00:01<00:05, 164.10it/s] 16%|█▋        | 164/1000 [00:01<00:05, 158.83it/s] 16%|█▋        | 164/1000 [00:01<00:05, 160.70it/s] 16%|█▋        | 164/1000 [00:01<00:05, 161.37it/s] 16%|█▋        | 164/1000 [00:01<00:05, 160.21it/s] 16%|█▋        | 164/1000 [00:01<00:05, 159.72it/s] 18%|█▊        | 181/1000 [00:01<00:04, 166.73it/s] 18%|█▊        | 182/1000 [00:01<00:04, 164.71it/s] 18%|█▊        | 182/1000 [00:01<00:04, 166.58it/s] 18%|█▊        | 182/1000 [00:01<00:04, 165.70it/s] 18%|█▊        | 182/1000 [00:01<00:04, 166.09it/s] 18%|█▊        | 182/1000 [00:01<00:04, 165.36it/s]Step199:rank2, time: 0.570, per_step: 0.005641
Step199:rank3, time: 0.570, per_step: 0.005640
Step199:rank4, time: 0.570, per_step: 0.005641
 20%|██        | 200/1000 [00:01<00:04, 171.47it/s]Step199:rank0, time: 0.570, per_step: 0.005640
Step199:rank1, time: 0.570, per_step: 0.005640
Step199:rank5, time: 0.570, per_step: 0.005640
 20%|██        | 201/1000 [00:02<00:04, 170.05it/s] 20%|██        | 201/1000 [00:01<00:04, 171.06it/s] 20%|██        | 201/1000 [00:01<00:04, 170.79it/s] 20%|██        | 201/1000 [00:02<00:04, 170.50it/s] 20%|██        | 201/1000 [00:01<00:04, 171.37it/s] 22%|██▏       | 219/1000 [00:01<00:04, 174.24it/s] 22%|██▏       | 220/1000 [00:02<00:04, 173.99it/s] 22%|██▏       | 220/1000 [00:02<00:04, 173.28it/s] 22%|██▏       | 220/1000 [00:01<00:04, 174.26it/s] 22%|██▏       | 220/1000 [00:02<00:04, 173.79it/s] 22%|██▏       | 220/1000 [00:02<00:04, 173.60it/s] 24%|██▎       | 237/1000 [00:02<00:04, 175.61it/s] 24%|██▍       | 238/1000 [00:02<00:04, 174.71it/s] 24%|██▍       | 238/1000 [00:02<00:04, 175.20it/s] 24%|██▍       | 238/1000 [00:02<00:04, 175.08it/s] 24%|██▍       | 238/1000 [00:02<00:04, 174.94it/s] 24%|██▍       | 238/1000 [00:02<00:04, 175.38it/s] 26%|██▌       | 255/1000 [00:02<00:04, 176.87it/s] 26%|██▌       | 257/1000 [00:02<00:04, 176.52it/s] 26%|██▌       | 257/1000 [00:02<00:04, 176.86it/s] 26%|██▌       | 257/1000 [00:02<00:04, 177.00it/s] 26%|██▌       | 257/1000 [00:02<00:04, 176.68it/s] 26%|██▌       | 257/1000 [00:02<00:04, 176.77it/s] 27%|██▋       | 274/1000 [00:02<00:04, 178.16it/s] 28%|██▊       | 276/1000 [00:02<00:04, 177.91it/s] 28%|██▊       | 276/1000 [00:02<00:04, 178.17it/s] 28%|██▊       | 276/1000 [00:02<00:04, 178.24it/s] 28%|██▊       | 276/1000 [00:02<00:04, 178.10it/s] 28%|██▊       | 276/1000 [00:02<00:04, 178.03it/s] 29%|██▉       | 292/1000 [00:02<00:03, 178.03it/s] 29%|██▉       | 294/1000 [00:02<00:03, 177.84it/s] 29%|██▉       | 294/1000 [00:02<00:03, 178.01it/s] 29%|██▉       | 294/1000 [00:02<00:03, 178.09it/s] 29%|██▉       | 294/1000 [00:02<00:03, 177.97it/s] 29%|██▉       | 294/1000 [00:02<00:03, 177.91it/s]Step299:rank0, time: 0.556, per_step: 0.005503
Step299:rank2, time: 0.556, per_step: 0.005505
Step299:rank3, time: 0.556, per_step: 0.005504
Step299:rank1, time: 0.556, per_step: 0.005503
Step299:rank4, time: 0.556, per_step: 0.005505
Step299:rank5, time: 0.556, per_step: 0.005505
 31%|███       | 311/1000 [00:02<00:03, 179.25it/s] 31%|███▏      | 313/1000 [00:02<00:03, 179.11it/s] 31%|███▏      | 313/1000 [00:02<00:03, 179.25it/s] 31%|███▏      | 313/1000 [00:02<00:03, 179.29it/s] 31%|███▏      | 313/1000 [00:02<00:03, 179.21it/s] 31%|███▏      | 313/1000 [00:02<00:03, 179.19it/s] 33%|███▎      | 329/1000 [00:02<00:03, 176.83it/s] 33%|███▎      | 331/1000 [00:02<00:03, 176.86it/s] 33%|███▎      | 331/1000 [00:02<00:03, 176.84it/s] 33%|███▎      | 331/1000 [00:02<00:03, 176.75it/s] 33%|███▎      | 331/1000 [00:02<00:03, 176.88it/s] 33%|███▎      | 331/1000 [00:02<00:03, 176.81it/s] 35%|███▍      | 347/1000 [00:02<00:03, 171.81it/s] 35%|███▍      | 349/1000 [00:02<00:03, 171.59it/s] 35%|███▍      | 349/1000 [00:02<00:03, 171.73it/s] 35%|███▍      | 349/1000 [00:02<00:03, 171.68it/s] 35%|███▍      | 349/1000 [00:02<00:03, 171.75it/s] 35%|███▍      | 349/1000 [00:02<00:03, 171.64it/s] 36%|███▋      | 365/1000 [00:02<00:03, 165.51it/s] 37%|███▋      | 367/1000 [00:02<00:03, 164.14it/s] 37%|███▋      | 367/1000 [00:02<00:03, 164.12it/s] 37%|███▋      | 367/1000 [00:02<00:03, 164.08it/s] 37%|███▋      | 367/1000 [00:02<00:03, 163.58it/s] 37%|███▋      | 367/1000 [00:03<00:03, 163.54it/s] 38%|███▊      | 382/1000 [00:02<00:03, 159.45it/s] 38%|███▊      | 384/1000 [00:03<00:03, 159.71it/s] 38%|███▊      | 384/1000 [00:02<00:03, 159.73it/s] 38%|███▊      | 384/1000 [00:03<00:03, 159.85it/s] 38%|███▊      | 384/1000 [00:03<00:03, 159.80it/s] 38%|███▊      | 384/1000 [00:03<00:03, 159.68it/s]Step399:rank2, time: 0.613, per_step: 0.006073
Step399:rank3, time: 0.613, per_step: 0.006073
Step399:rank0, time: 0.613, per_step: 0.006073
Step399:rank4, time: 0.613, per_step: 0.006073
Step399:rank1, time: 0.613, per_step: 0.006073
 40%|████      | 400/1000 [00:02<00:03, 164.44it/s]Step399:rank5, time: 0.613, per_step: 0.006073
 40%|████      | 402/1000 [00:03<00:03, 164.87it/s] 40%|████      | 402/1000 [00:03<00:03, 164.86it/s] 40%|████      | 402/1000 [00:03<00:03, 164.75it/s] 40%|████      | 402/1000 [00:03<00:03, 164.72it/s] 40%|████      | 402/1000 [00:03<00:03, 164.74it/s] 42%|████▏     | 418/1000 [00:03<00:03, 167.95it/s] 42%|████▏     | 420/1000 [00:03<00:03, 168.29it/s] 42%|████▏     | 420/1000 [00:03<00:03, 168.26it/s] 42%|████▏     | 420/1000 [00:03<00:03, 168.19it/s] 42%|████▏     | 420/1000 [00:03<00:03, 168.16it/s] 42%|████▏     | 420/1000 [00:03<00:03, 168.19it/s] 44%|████▎     | 436/1000 [00:03<00:03, 170.01it/s] 44%|████▍     | 438/1000 [00:03<00:03, 170.26it/s] 44%|████▍     | 438/1000 [00:03<00:03, 170.28it/s] 44%|████▍     | 438/1000 [00:03<00:03, 170.21it/s] 44%|████▍     | 438/1000 [00:03<00:03, 170.19it/s] 44%|████▍     | 438/1000 [00:03<00:03, 170.21it/s] 46%|████▌     | 455/1000 [00:03<00:03, 173.76it/s] 46%|████▌     | 457/1000 [00:03<00:03, 173.90it/s] 46%|████▌     | 457/1000 [00:03<00:03, 173.89it/s] 46%|████▌     | 457/1000 [00:03<00:03, 173.85it/s] 46%|████▌     | 457/1000 [00:03<00:03, 173.84it/s] 46%|████▌     | 457/1000 [00:03<00:03, 173.85it/s] 47%|████▋     | 473/1000 [00:03<00:03, 175.37it/s] 48%|████▊     | 475/1000 [00:03<00:03, 174.63it/s] 48%|████▊     | 475/1000 [00:03<00:03, 174.63it/s] 48%|████▊     | 475/1000 [00:03<00:03, 174.61it/s] 48%|████▊     | 475/1000 [00:03<00:03, 174.61it/s] 48%|████▊     | 475/1000 [00:03<00:03, 174.60it/s] 49%|████▉     | 491/1000 [00:03<00:02, 175.88it/s] 49%|████▉     | 494/1000 [00:03<00:02, 176.28it/s] 49%|████▉     | 494/1000 [00:03<00:02, 176.27it/s] 49%|████▉     | 494/1000 [00:03<00:02, 176.25it/s] 49%|████▉     | 494/1000 [00:03<00:02, 176.24it/s] 49%|████▉     | 494/1000 [00:03<00:02, 176.26it/s]Step499:rank2, time: 0.562, per_step: 0.005561
Step499:rank3, time: 0.562, per_step: 0.005561
Step499:rank0, time: 0.562, per_step: 0.005561
Step499:rank1, time: 0.562, per_step: 0.005560
Step499:rank4, time: 0.562, per_step: 0.005561
Step499:rank5, time: 0.562, per_step: 0.005561
 51%|█████     | 509/1000 [00:03<00:02, 176.71it/s] 51%|█████     | 512/1000 [00:03<00:02, 176.94it/s] 51%|█████     | 512/1000 [00:03<00:02, 176.93it/s] 51%|█████     | 512/1000 [00:03<00:02, 176.92it/s] 51%|█████     | 512/1000 [00:03<00:02, 176.92it/s] 51%|█████     | 512/1000 [00:03<00:02, 176.91it/s] 53%|█████▎    | 527/1000 [00:03<00:02, 170.99it/s] 53%|█████▎    | 530/1000 [00:03<00:02, 169.45it/s] 53%|█████▎    | 530/1000 [00:03<00:02, 169.44it/s] 53%|█████▎    | 530/1000 [00:03<00:02, 169.44it/s] 53%|█████▎    | 530/1000 [00:03<00:02, 169.43it/s] 53%|█████▎    | 530/1000 [00:03<00:02, 169.44it/s] 55%|█████▍    | 545/1000 [00:03<00:02, 171.09it/s] 55%|█████▍    | 548/1000 [00:04<00:02, 171.85it/s] 55%|█████▍    | 548/1000 [00:03<00:02, 171.84it/s] 55%|█████▍    | 548/1000 [00:03<00:02, 171.83it/s] 55%|█████▍    | 548/1000 [00:03<00:02, 171.83it/s] 55%|█████▍    | 548/1000 [00:04<00:02, 171.83it/s] 56%|█████▋    | 564/1000 [00:03<00:02, 174.37it/s] 57%|█████▋    | 567/1000 [00:04<00:02, 174.88it/s] 57%|█████▋    | 567/1000 [00:04<00:02, 174.89it/s] 57%|█████▋    | 567/1000 [00:04<00:02, 174.90it/s] 57%|█████▋    | 567/1000 [00:04<00:02, 174.89it/s] 57%|█████▋    | 567/1000 [00:04<00:02, 174.88it/s] 58%|█████▊    | 582/1000 [00:04<00:02, 175.24it/s] 58%|█████▊    | 585/1000 [00:04<00:02, 175.69it/s] 58%|█████▊    | 585/1000 [00:04<00:02, 175.70it/s] 58%|█████▊    | 585/1000 [00:04<00:02, 175.69it/s] 58%|█████▊    | 585/1000 [00:04<00:02, 175.69it/s] 58%|█████▊    | 585/1000 [00:04<00:02, 175.70it/s]Step599:rank2, time: 0.573, per_step: 0.005669
Step599:rank0, time: 0.573, per_step: 0.005670
Step599:rank3, time: 0.573, per_step: 0.005670
Step599:rank4, time: 0.573, per_step: 0.005670
Step599:rank1, time: 0.573, per_step: 0.005670
Step599:rank5, time: 0.573, per_step: 0.005669
 60%|██████    | 601/1000 [00:04<00:02, 177.43it/s] 60%|██████    | 604/1000 [00:04<00:02, 177.78it/s] 60%|██████    | 604/1000 [00:04<00:02, 177.78it/s] 60%|██████    | 604/1000 [00:04<00:02, 177.77it/s] 60%|██████    | 604/1000 [00:04<00:02, 177.76it/s] 60%|██████    | 604/1000 [00:04<00:02, 177.78it/s] 62%|██████▏   | 620/1000 [00:04<00:02, 178.78it/s] 62%|██████▏   | 622/1000 [00:04<00:02, 177.32it/s] 62%|██████▏   | 622/1000 [00:04<00:02, 177.30it/s] 62%|██████▏   | 622/1000 [00:04<00:02, 177.25it/s] 62%|██████▏   | 622/1000 [00:04<00:02, 177.34it/s] 62%|██████▏   | 622/1000 [00:04<00:02, 177.16it/s] 64%|██████▍   | 638/1000 [00:04<00:02, 176.09it/s] 64%|██████▍   | 640/1000 [00:04<00:02, 176.62it/s] 64%|██████▍   | 640/1000 [00:04<00:02, 176.60it/s] 64%|██████▍   | 640/1000 [00:04<00:02, 176.62it/s] 64%|██████▍   | 640/1000 [00:04<00:02, 176.61it/s] 64%|██████▍   | 640/1000 [00:04<00:02, 176.59it/s] 66%|██████▌   | 656/1000 [00:04<00:01, 177.21it/s] 66%|██████▌   | 658/1000 [00:04<00:01, 177.57it/s] 66%|██████▌   | 658/1000 [00:04<00:01, 177.55it/s] 66%|██████▌   | 658/1000 [00:04<00:01, 177.55it/s] 66%|██████▌   | 658/1000 [00:04<00:01, 177.55it/s] 66%|██████▌   | 658/1000 [00:04<00:01, 177.53it/s] 67%|██████▋   | 674/1000 [00:04<00:01, 177.85it/s] 68%|██████▊   | 676/1000 [00:04<00:01, 178.13it/s] 68%|██████▊   | 676/1000 [00:04<00:01, 178.10it/s] 68%|██████▊   | 676/1000 [00:04<00:01, 178.13it/s] 68%|██████▊   | 676/1000 [00:04<00:01, 178.11it/s] 68%|██████▊   | 676/1000 [00:04<00:01, 178.09it/s] 69%|██████▉   | 692/1000 [00:04<00:01, 175.87it/s] 69%|██████▉   | 694/1000 [00:04<00:01, 176.06it/s] 69%|██████▉   | 694/1000 [00:04<00:01, 176.05it/s] 69%|██████▉   | 694/1000 [00:04<00:01, 176.04it/s] 69%|██████▉   | 694/1000 [00:04<00:01, 176.02it/s] 69%|██████▉   | 694/1000 [00:04<00:01, 175.88it/s]Step699:rank2, time: 0.566, per_step: 0.005602
Step699:rank3, time: 0.566, per_step: 0.005602
Step699:rank1, time: 0.566, per_step: 0.005602
Step699:rank0, time: 0.566, per_step: 0.005602
Step699:rank4, time: 0.566, per_step: 0.005602
Step699:rank5, time: 0.566, per_step: 0.005602
 71%|███████   | 710/1000 [00:04<00:01, 176.98it/s] 71%|███████   | 712/1000 [00:05<00:01, 177.12it/s] 71%|███████   | 712/1000 [00:04<00:01, 177.13it/s] 71%|███████   | 712/1000 [00:04<00:01, 177.13it/s] 71%|███████   | 712/1000 [00:04<00:01, 177.14it/s] 71%|███████▏  | 713/1000 [00:04<00:01, 177.18it/s] 73%|███████▎  | 729/1000 [00:04<00:01, 178.05it/s] 73%|███████▎  | 731/1000 [00:05<00:01, 178.12it/s] 73%|███████▎  | 731/1000 [00:04<00:01, 178.14it/s] 73%|███████▎  | 731/1000 [00:05<00:01, 178.11it/s] 73%|███████▎  | 731/1000 [00:05<00:01, 178.12it/s] 73%|███████▎  | 732/1000 [00:04<00:01, 178.11it/s] 75%|███████▍  | 747/1000 [00:04<00:01, 174.58it/s] 75%|███████▍  | 749/1000 [00:05<00:01, 174.65it/s] 75%|███████▍  | 749/1000 [00:05<00:01, 174.65it/s] 75%|███████▍  | 749/1000 [00:05<00:01, 174.65it/s] 75%|███████▍  | 749/1000 [00:05<00:01, 174.65it/s] 75%|███████▌  | 750/1000 [00:05<00:01, 174.61it/s] 76%|███████▋  | 765/1000 [00:05<00:01, 175.50it/s] 77%|███████▋  | 767/1000 [00:05<00:01, 175.42it/s] 77%|███████▋  | 767/1000 [00:05<00:01, 175.42it/s] 77%|███████▋  | 767/1000 [00:05<00:01, 175.39it/s] 77%|███████▋  | 767/1000 [00:05<00:01, 175.36it/s] 77%|███████▋  | 768/1000 [00:05<00:01, 175.41it/s] 78%|███████▊  | 783/1000 [00:05<00:01, 176.28it/s] 78%|███████▊  | 785/1000 [00:05<00:01, 175.86it/s] 78%|███████▊  | 785/1000 [00:05<00:01, 175.83it/s] 78%|███████▊  | 785/1000 [00:05<00:01, 175.82it/s] 78%|███████▊  | 785/1000 [00:05<00:01, 175.86it/s] 79%|███████▊  | 786/1000 [00:05<00:01, 175.85it/s]Step799:rank3, time: 0.567, per_step: 0.005617
Step799:rank1, time: 0.567, per_step: 0.005617
Step799:rank4, time: 0.567, per_step: 0.005617
Step799:rank2, time: 0.567, per_step: 0.005618
Step799:rank0, time: 0.567, per_step: 0.005617
Step799:rank5, time: 0.567, per_step: 0.005618
 80%|████████  | 801/1000 [00:05<00:01, 176.41it/s] 80%|████████  | 803/1000 [00:05<00:01, 176.53it/s] 80%|████████  | 803/1000 [00:05<00:01, 176.52it/s] 80%|████████  | 803/1000 [00:05<00:01, 176.51it/s] 80%|████████  | 803/1000 [00:05<00:01, 176.51it/s] 80%|████████  | 804/1000 [00:05<00:01, 176.49it/s] 82%|████████▏ | 819/1000 [00:05<00:01, 176.79it/s] 82%|████████▏ | 821/1000 [00:05<00:01, 176.81it/s] 82%|████████▏ | 821/1000 [00:05<00:01, 176.80it/s] 82%|████████▏ | 821/1000 [00:05<00:01, 176.79it/s] 82%|████████▏ | 821/1000 [00:05<00:01, 176.81it/s] 82%|████████▏ | 822/1000 [00:05<00:01, 176.76it/s] 84%|████████▎ | 837/1000 [00:05<00:00, 177.12it/s] 84%|████████▍ | 839/1000 [00:05<00:00, 177.18it/s] 84%|████████▍ | 839/1000 [00:05<00:00, 177.17it/s] 84%|████████▍ | 839/1000 [00:05<00:00, 177.13it/s] 84%|████████▍ | 839/1000 [00:05<00:00, 177.12it/s] 84%|████████▍ | 840/1000 [00:05<00:00, 177.14it/s] 86%|████████▌ | 855/1000 [00:05<00:00, 173.79it/s] 86%|████████▌ | 857/1000 [00:05<00:00, 173.85it/s] 86%|████████▌ | 857/1000 [00:05<00:00, 173.86it/s] 86%|████████▌ | 857/1000 [00:05<00:00, 173.86it/s] 86%|████████▌ | 857/1000 [00:05<00:00, 173.83it/s] 86%|████████▌ | 858/1000 [00:05<00:00, 173.84it/s] 87%|████████▋ | 873/1000 [00:05<00:00, 175.26it/s] 88%|████████▊ | 875/1000 [00:05<00:00, 175.34it/s] 88%|████████▊ | 875/1000 [00:05<00:00, 175.33it/s] 88%|████████▊ | 875/1000 [00:05<00:00, 175.29it/s] 88%|████████▊ | 875/1000 [00:05<00:00, 175.30it/s] 88%|████████▊ | 876/1000 [00:05<00:00, 175.33it/s] 89%|████████▉ | 891/1000 [00:05<00:00, 172.56it/s] 89%|████████▉ | 893/1000 [00:05<00:00, 172.71it/s] 89%|████████▉ | 893/1000 [00:05<00:00, 172.70it/s] 89%|████████▉ | 893/1000 [00:06<00:00, 172.68it/s] 89%|████████▉ | 893/1000 [00:05<00:00, 172.71it/s] 89%|████████▉ | 894/1000 [00:05<00:00, 172.71it/s]Step899:rank1, time: 0.575, per_step: 0.005693
Step899:rank3, time: 0.575, per_step: 0.005694
Step899:rank4, time: 0.575, per_step: 0.005694
Step899:rank2, time: 0.575, per_step: 0.005694
Step899:rank0, time: 0.575, per_step: 0.005694
Step899:rank5, time: 0.575, per_step: 0.005693
 91%|█████████ | 909/1000 [00:05<00:00, 174.61it/s] 91%|█████████ | 911/1000 [00:05<00:00, 174.62it/s] 91%|█████████ | 911/1000 [00:06<00:00, 174.62it/s] 91%|█████████ | 911/1000 [00:06<00:00, 174.59it/s] 91%|█████████ | 911/1000 [00:06<00:00, 174.61it/s] 91%|█████████ | 912/1000 [00:06<00:00, 174.64it/s] 93%|█████████▎| 928/1000 [00:05<00:00, 176.68it/s] 93%|█████████▎| 930/1000 [00:06<00:00, 176.85it/s] 93%|█████████▎| 930/1000 [00:06<00:00, 176.84it/s] 93%|█████████▎| 930/1000 [00:06<00:00, 176.82it/s] 93%|█████████▎| 930/1000 [00:06<00:00, 176.84it/s] 93%|█████████▎| 931/1000 [00:06<00:00, 176.86it/s] 95%|█████████▍| 946/1000 [00:06<00:00, 174.11it/s] 95%|█████████▍| 948/1000 [00:06<00:00, 172.70it/s] 95%|█████████▍| 948/1000 [00:06<00:00, 172.65it/s] 95%|█████████▍| 948/1000 [00:06<00:00, 172.62it/s] 95%|█████████▍| 948/1000 [00:06<00:00, 172.70it/s] 95%|█████████▍| 949/1000 [00:06<00:00, 172.73it/s] 96%|█████████▋| 964/1000 [00:06<00:00, 174.55it/s] 97%|█████████▋| 967/1000 [00:06<00:00, 175.23it/s] 97%|█████████▋| 967/1000 [00:06<00:00, 175.23it/s] 97%|█████████▋| 967/1000 [00:06<00:00, 175.22it/s] 97%|█████████▋| 967/1000 [00:06<00:00, 175.24it/s] 97%|█████████▋| 968/1000 [00:06<00:00, 175.29it/s] 98%|█████████▊| 983/1000 [00:06<00:00, 177.16it/s] 99%|█████████▊| 986/1000 [00:06<00:00, 177.50it/s] 99%|█████████▊| 986/1000 [00:06<00:00, 177.48it/s] 99%|█████████▊| 986/1000 [00:06<00:00, 177.48it/s] 99%|█████████▊| 986/1000 [00:06<00:00, 177.47it/s] 99%|█████████▊| 987/1000 [00:06<00:00, 177.46it/s]Step999:rank1, time: 0.562, per_step: 0.005563
Step999:rank3, time: 0.562, per_step: 0.005563
Step999:rank4, time: 0.562, per_step: 0.005563
Step999:rank2, time: 0.562, per_step: 0.005563
Step999:rank0, time: 0.562, per_step: 0.005563
100%|██████████| 1000/1000 [00:06<00:00, 152.67it/s]100%|██████████| 1000/1000 [00:06<00:00, 150.19it/s]Step999:rank5, time: 0.562, per_step: 0.005564
100%|██████████| 1000/1000 [00:06<00:00, 154.83it/s]100%|██████████| 1000/1000 [00:06<00:00, 156.39it/s]100%|██████████| 1000/1000 [00:06<00:00, 153.59it/s]100%|██████████| 1000/1000 [00:06<00:00, 151.77it/s]





Worker 5 pid=26246
Successfully xmh
