perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f0adddf0e50>==========
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 4/1000 [00:00<00:25, 39.17it/s]  3%|▎         | 26/1000 [00:00<00:06, 144.00it/s]  5%|▍         | 49/1000 [00:00<00:05, 182.03it/s]  8%|▊         | 76/1000 [00:00<00:04, 215.14it/s]Step99:rank0, time: 0.495, per_step: 0.004954
 10%|█         | 105/1000 [00:00<00:03, 241.13it/s] 14%|█▎        | 137/1000 [00:00<00:03, 265.60it/s] 17%|█▋        | 171/1000 [00:00<00:02, 288.38it/s]Step199:rank0, time: 0.302, per_step: 0.002987
 21%|██        | 207/1000 [00:00<00:02, 310.69it/s] 25%|██▍       | 246/1000 [00:00<00:02, 334.02it/s] 29%|██▊       | 287/1000 [00:01<00:01, 356.56it/s]Step299:rank0, time: 0.253, per_step: 0.002500
 33%|███▎      | 330/1000 [00:01<00:01, 376.91it/s] 38%|███▊      | 376/1000 [00:01<00:01, 401.03it/s]Step399:rank0, time: 0.223, per_step: 0.002209
 42%|████▏     | 423/1000 [00:01<00:01, 420.60it/s] 47%|████▋     | 472/1000 [00:01<00:01, 439.59it/s]Step499:rank0, time: 0.207, per_step: 0.002046
 52%|█████▏    | 522/1000 [00:01<00:01, 457.32it/s] 57%|█████▋    | 574/1000 [00:01<00:00, 473.79it/s]Step599:rank0, time: 0.195, per_step: 0.001928
 63%|██████▎   | 628/1000 [00:01<00:00, 492.11it/s] 68%|██████▊   | 683/1000 [00:01<00:00, 508.12it/s]Step699:rank0, time: 0.183, per_step: 0.001814
 74%|███████▍  | 739/1000 [00:01<00:00, 522.39it/s] 79%|███████▉  | 793/1000 [00:02<00:00, 526.21it/s]Step799:rank0, time: 0.183, per_step: 0.001816
 85%|████████▌ | 850/1000 [00:02<00:00, 527.72it/s]Step899:rank0, time: 0.184, per_step: 0.001825
 91%|█████████ | 906/1000 [00:02<00:00, 536.42it/s] 96%|█████████▌| 960/1000 [00:02<00:00, 536.32it/s]Step999:rank0, time: 0.183, per_step: 0.001812
100%|██████████| 1000/1000 [00:02<00:00, 416.19it/s]
Worker 0 pid=52111
Successfully xmh
