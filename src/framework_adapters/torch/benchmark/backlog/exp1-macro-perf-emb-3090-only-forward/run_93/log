perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fa1f182de50>==========
Worker 0 pid=40757
Worker 1 pid=40758
Worker 2 pid=40759
Worker 3 pid=40766
Worker 4 pid=40767
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:02<34:03,  2.05s/it]  0%|          | 1/1000 [00:02<34:26,  2.07s/it]  0%|          | 1/1000 [00:02<35:39,  2.14s/it]  3%|▎         | 33/1000 [00:02<00:45, 21.33it/s]  1%|▏         | 13/1000 [00:02<02:01,  8.13it/s]  0%|          | 1/1000 [00:02<36:29,  2.19s/it]  1%|          | 7/1000 [00:02<03:57,  4.19it/s]  7%|▋         | 67/1000 [00:02<00:19, 48.26it/s]  4%|▎         | 37/1000 [00:02<00:34, 27.53it/s]  1%|▏         | 13/1000 [00:02<02:07,  7.76it/s]  0%|          | 1/1000 [00:02<38:48,  2.33s/it]  2%|▏         | 22/1000 [00:02<01:00, 16.11it/s]Step99:rank1, time: 2.361, per_step: 0.023611
 10%|█         | 100/1000 [00:02<00:11, 78.54it/s]  6%|▋         | 65/1000 [00:02<00:17, 53.86it/s]  3%|▎         | 32/1000 [00:02<00:43, 22.05it/s]  1%|          | 7/1000 [00:02<04:17,  3.86it/s]  0%|          | 1/1000 [00:02<40:43,  2.45s/it]  4%|▍         | 38/1000 [00:02<00:30, 31.11it/s]  8%|▊         | 84/1000 [00:02<00:12, 70.96it/s] 13%|█▎        | 128/1000 [00:02<00:08, 98.64it/s]  6%|▌         | 55/1000 [00:02<00:21, 43.16it/s]  0%|          | 5/1000 [00:02<06:23,  2.59it/s]  2%|▎         | 25/1000 [00:02<00:56, 17.20it/s]  6%|▌         | 62/1000 [00:02<00:16, 58.04it/s]Step99:rank5, time: 2.591, per_step: 0.025905
 10%|█         | 104/1000 [00:02<00:09, 91.02it/s]  8%|▊         | 76/1000 [00:02<00:14, 63.29it/s]  9%|▊         | 86/1000 [00:02<00:10, 86.40it/s]  2%|▏         | 16/1000 [00:02<01:34, 10.41it/s]  5%|▌         | 51/1000 [00:02<00:23, 40.80it/s] 15%|█▌        | 153/1000 [00:02<00:07, 109.41it/s] 12%|█▎        | 125/1000 [00:02<00:07, 112.48it/s] 10%|▉         | 98/1000 [00:02<00:10, 86.51it/s]Step99:rank4, time: 2.745, per_step: 0.027454
Step99:rank3, time: 2.753, per_step: 0.027529
  4%|▎         | 37/1000 [00:02<00:33, 29.16it/s]  8%|▊         | 78/1000 [00:02<00:13, 68.64it/s] 10%|█         | 105/1000 [00:02<00:08, 101.97it/s] 18%|█▊        | 175/1000 [00:02<00:06, 127.09it/s] 13%|█▎        | 127/1000 [00:02<00:07, 121.84it/s]Step99:rank0, time: 2.836, per_step: 0.028363
  6%|▌         | 60/1000 [00:02<00:17, 52.94it/s] 10%|█         | 104/1000 [00:02<00:09, 96.84it/s] 14%|█▍        | 145/1000 [00:02<00:07, 117.39it/s] 13%|█▎        | 130/1000 [00:02<00:06, 131.09it/s] 20%|█▉        | 197/1000 [00:02<00:05, 143.47it/s]Step199:rank1, time: 0.546, per_step: 0.005408
 15%|█▌        | 153/1000 [00:02<00:05, 149.02it/s]  8%|▊         | 83/1000 [00:02<00:11, 78.08it/s] 13%|█▎        | 130/1000 [00:02<00:06, 124.63it/s] 17%|█▋        | 166/1000 [00:02<00:06, 135.47it/s] 16%|█▌        | 156/1000 [00:02<00:05, 158.75it/s] 22%|██▏       | 219/1000 [00:02<00:04, 158.60it/s] 18%|█▊        | 182/1000 [00:03<00:04, 180.05it/s]Step99:rank2, time: 3.043, per_step: 0.030428
 10%|█         | 105/1000 [00:03<00:08, 102.10it/s] 16%|█▌        | 156/1000 [00:03<00:05, 150.58it/s] 19%|█▊        | 186/1000 [00:03<00:05, 150.16it/s] 18%|█▊        | 181/1000 [00:03<00:04, 179.36it/s] 24%|██▍       | 241/1000 [00:03<00:04, 172.12it/s]Step199:rank4, time: 0.358, per_step: 0.003547
Step199:rank5, time: 0.550, per_step: 0.005442
 21%|██        | 211/1000 [00:03<00:03, 205.23it/s]Step199:rank3, time: 0.409, per_step: 0.004050
 13%|█▎        | 126/1000 [00:03<00:07, 122.44it/s] 18%|█▊        | 183/1000 [00:03<00:04, 176.35it/s] 21%|██        | 207/1000 [00:03<00:04, 164.00it/s] 20%|██        | 205/1000 [00:03<00:04, 194.27it/s] 26%|██▋       | 263/1000 [00:03<00:04, 177.88it/s]Step199:rank0, time: 0.390, per_step: 0.003859
 24%|██▎       | 237/1000 [00:03<00:03, 210.14it/s] 15%|█▍        | 149/1000 [00:03<00:05, 145.19it/s] 21%|██        | 209/1000 [00:03<00:04, 195.49it/s] 23%|██▎       | 228/1000 [00:03<00:04, 174.25it/s] 23%|██▎       | 229/1000 [00:03<00:03, 206.07it/s] 28%|██▊       | 285/1000 [00:03<00:03, 186.59it/s] 27%|██▋       | 266/1000 [00:03<00:03, 230.52it/s] 17%|█▋        | 172/1000 [00:03<00:05, 164.79it/s] 24%|██▎       | 236/1000 [00:03<00:03, 213.81it/s] 25%|██▍       | 249/1000 [00:03<00:04, 183.38it/s]Step299:rank1, time: 0.477, per_step: 0.004722
 26%|██▌       | 257/1000 [00:03<00:03, 224.43it/s] 31%|███       | 307/1000 [00:03<00:03, 194.54it/s] 29%|██▉       | 292/1000 [00:03<00:02, 237.29it/s] 20%|█▉        | 195/1000 [00:03<00:04, 180.69it/s] 26%|██▋       | 263/1000 [00:03<00:03, 227.95it/s] 27%|██▋       | 270/1000 [00:03<00:03, 190.26it/s] 28%|██▊       | 285/1000 [00:03<00:02, 239.93it/s]Step199:rank2, time: 0.453, per_step: 0.004483
Step299:rank4, time: 0.394, per_step: 0.003898
 33%|███▎      | 329/1000 [00:03<00:03, 200.70it/s]Step299:rank3, time: 0.386, per_step: 0.003826
 32%|███▏      | 318/1000 [00:03<00:02, 239.29it/s] 22%|██▏       | 218/1000 [00:03<00:04, 192.70it/s] 29%|██▉       | 290/1000 [00:03<00:02, 238.90it/s] 29%|██▉       | 291/1000 [00:03<00:03, 194.94it/s] 31%|███       | 311/1000 [00:03<00:02, 244.95it/s]Step299:rank0, time: 0.378, per_step: 0.003746
 35%|███▌      | 351/1000 [00:03<00:03, 205.29it/s]Step299:rank5, time: 0.484, per_step: 0.004794
 24%|██▍       | 241/1000 [00:03<00:03, 202.61it/s] 34%|███▍      | 344/1000 [00:03<00:02, 240.75it/s] 32%|███▏      | 317/1000 [00:03<00:02, 246.21it/s] 31%|███       | 312/1000 [00:03<00:03, 198.26it/s] 34%|███▍      | 338/1000 [00:03<00:02, 250.36it/s] 37%|███▋      | 373/1000 [00:03<00:03, 208.12it/s] 26%|██▋       | 264/1000 [00:03<00:03, 209.38it/s] 34%|███▍      | 345/1000 [00:03<00:02, 253.35it/s] 37%|███▋      | 370/1000 [00:03<00:02, 241.55it/s] 33%|███▎      | 333/1000 [00:03<00:03, 201.03it/s] 36%|███▋      | 364/1000 [00:03<00:02, 247.21it/s] 40%|███▉      | 395/1000 [00:03<00:02, 210.52it/s]Step399:rank1, time: 0.463, per_step: 0.004585
 29%|██▊       | 287/1000 [00:03<00:03, 214.57it/s] 37%|███▋      | 372/1000 [00:03<00:02, 257.51it/s] 40%|███▉      | 395/1000 [00:03<00:02, 242.79it/s] 35%|███▌      | 354/1000 [00:03<00:03, 202.78it/s]Step399:rank4, time: 0.410, per_step: 0.004055
 39%|███▉      | 390/1000 [00:03<00:02, 244.58it/s] 42%|████▏     | 417/1000 [00:03<00:02, 211.33it/s]Step299:rank2, time: 0.439, per_step: 0.004345
Step399:rank3, time: 0.402, per_step: 0.003983
 31%|███       | 310/1000 [00:03<00:03, 218.38it/s] 40%|███▉      | 399/1000 [00:03<00:02, 259.66it/s]Step399:rank0, time: 0.374, per_step: 0.003699
 42%|████▏     | 420/1000 [00:03<00:02, 242.10it/s] 38%|███▊      | 375/1000 [00:03<00:03, 201.21it/s] 42%|████▏     | 415/1000 [00:04<00:02, 237.93it/s] 44%|████▍     | 439/1000 [00:04<00:02, 211.55it/s] 33%|███▎      | 333/1000 [00:04<00:03, 221.28it/s] 44%|████▍     | 445/1000 [00:04<00:02, 240.48it/s] 40%|███▉      | 396/1000 [00:04<00:02, 201.62it/s]Step399:rank5, time: 0.490, per_step: 0.004854
 43%|████▎     | 426/1000 [00:04<00:02, 238.64it/s] 44%|████▍     | 440/1000 [00:04<00:02, 236.30it/s] 46%|████▌     | 461/1000 [00:04<00:02, 212.70it/s] 36%|███▌      | 356/1000 [00:04<00:02, 223.04it/s] 42%|████▏     | 417/1000 [00:04<00:02, 203.08it/s] 47%|████▋     | 470/1000 [00:04<00:02, 240.72it/s] 45%|████▌     | 454/1000 [00:04<00:02, 247.87it/s] 46%|████▋     | 464/1000 [00:04<00:02, 235.16it/s] 48%|████▊     | 483/1000 [00:04<00:02, 212.88it/s] 38%|███▊      | 379/1000 [00:04<00:02, 224.23it/s] 44%|████▍     | 438/1000 [00:04<00:02, 204.16it/s] 50%|████▉     | 495/1000 [00:04<00:02, 241.09it/s]Step499:rank1, time: 0.467, per_step: 0.004622
Step499:rank4, time: 0.416, per_step: 0.004120
 48%|████▊     | 481/1000 [00:04<00:02, 252.11it/s] 49%|████▉     | 488/1000 [00:04<00:02, 234.46it/s] 50%|█████     | 505/1000 [00:04<00:02, 213.93it/s]Step399:rank2, time: 0.440, per_step: 0.004354
 40%|████      | 402/1000 [00:04<00:02, 224.50it/s]Step499:rank3, time: 0.433, per_step: 0.004291
Step499:rank0, time: 0.405, per_step: 0.004010
 46%|████▌     | 459/1000 [00:04<00:02, 204.41it/s] 52%|█████▏    | 520/1000 [00:04<00:01, 240.34it/s] 51%|█████     | 509/1000 [00:04<00:01, 258.66it/s] 51%|█████▏    | 513/1000 [00:04<00:02, 236.16it/s] 53%|█████▎    | 527/1000 [00:04<00:02, 214.32it/s] 42%|████▎     | 425/1000 [00:04<00:02, 225.16it/s] 48%|████▊     | 480/1000 [00:04<00:02, 205.16it/s] 55%|█████▍    | 545/1000 [00:04<00:01, 241.01it/s] 54%|█████▎    | 537/1000 [00:04<00:01, 263.63it/s] 54%|█████▎    | 537/1000 [00:04<00:01, 236.80it/s] 55%|█████▍    | 549/1000 [00:04<00:02, 215.11it/s] 45%|████▍     | 448/1000 [00:04<00:02, 224.94it/s]Step499:rank5, time: 0.484, per_step: 0.004789
 50%|█████     | 501/1000 [00:04<00:02, 205.62it/s] 57%|█████▋    | 570/1000 [00:04<00:01, 240.99it/s] 56%|█████▋    | 565/1000 [00:04<00:01, 267.59it/s] 56%|█████▌    | 561/1000 [00:04<00:01, 236.14it/s] 57%|█████▋    | 571/1000 [00:04<00:01, 215.77it/s] 47%|████▋     | 471/1000 [00:04<00:02, 225.65it/s] 52%|█████▏    | 522/1000 [00:04<00:02, 205.96it/s] 60%|█████▉    | 595/1000 [00:04<00:01, 241.18it/s] 59%|█████▉    | 593/1000 [00:04<00:01, 270.16it/s]Step599:rank4, time: 0.415, per_step: 0.004109
 58%|█████▊    | 585/1000 [00:04<00:01, 236.30it/s] 59%|█████▉    | 593/1000 [00:04<00:01, 215.73it/s]Step599:rank0, time: 0.363, per_step: 0.003589
Step599:rank1, time: 0.463, per_step: 0.004584
 49%|████▉     | 494/1000 [00:04<00:02, 226.08it/s]Step599:rank3, time: 0.421, per_step: 0.004173
 54%|█████▍    | 543/1000 [00:04<00:02, 206.28it/s]Step499:rank2, time: 0.443, per_step: 0.004382
 62%|██████▏   | 620/1000 [00:04<00:01, 241.67it/s] 62%|██████▏   | 621/1000 [00:04<00:01, 271.75it/s] 61%|██████    | 609/1000 [00:04<00:01, 236.83it/s] 62%|██████▏   | 615/1000 [00:04<00:01, 216.07it/s] 52%|█████▏    | 517/1000 [00:04<00:02, 226.31it/s] 56%|█████▋    | 564/1000 [00:04<00:02, 206.33it/s] 64%|██████▍   | 645/1000 [00:04<00:01, 242.47it/s] 65%|██████▍   | 649/1000 [00:04<00:01, 269.31it/s] 63%|██████▎   | 633/1000 [00:04<00:01, 233.76it/s] 64%|██████▎   | 637/1000 [00:04<00:01, 214.25it/s] 54%|█████▍    | 540/1000 [00:04<00:02, 225.91it/s] 58%|█████▊    | 585/1000 [00:05<00:02, 206.31it/s] 67%|██████▋   | 670/1000 [00:05<00:01, 242.53it/s] 68%|██████▊   | 677/1000 [00:05<00:01, 257.79it/s] 66%|██████▌   | 657/1000 [00:05<00:01, 224.60it/s] 66%|██████▌   | 659/1000 [00:05<00:01, 205.05it/s]Step599:rank5, time: 0.496, per_step: 0.004914
 56%|█████▋    | 563/1000 [00:05<00:01, 218.72it/s] 61%|██████    | 606/1000 [00:05<00:01, 199.06it/s] 70%|██████▉   | 695/1000 [00:05<00:01, 241.68it/s]Step699:rank0, time: 0.385, per_step: 0.003811
 70%|███████   | 705/1000 [00:05<00:01, 262.81it/s] 68%|██████▊   | 680/1000 [00:05<00:01, 224.97it/s] 68%|██████▊   | 681/1000 [00:05<00:01, 207.73it/s]Step699:rank4, time: 0.444, per_step: 0.004395
 59%|█████▊    | 586/1000 [00:05<00:01, 220.62it/s] 63%|██████▎   | 627/1000 [00:05<00:01, 201.31it/s]Step699:rank3, time: 0.443, per_step: 0.004388
 73%|███████▎  | 733/1000 [00:05<00:00, 267.47it/s]Step699:rank1, time: 0.482, per_step: 0.004771
 72%|███████▏  | 720/1000 [00:05<00:01, 221.05it/s]Step599:rank2, time: 0.455, per_step: 0.004509
 70%|███████   | 703/1000 [00:05<00:01, 209.76it/s] 70%|███████   | 705/1000 [00:05<00:01, 216.81it/s] 61%|██████    | 609/1000 [00:05<00:01, 221.62it/s] 65%|██████▍   | 648/1000 [00:05<00:01, 202.97it/s] 76%|███████▌  | 760/1000 [00:05<00:00, 266.82it/s] 74%|███████▍  | 744/1000 [00:05<00:01, 225.57it/s] 72%|███████▎  | 725/1000 [00:05<00:01, 211.90it/s] 73%|███████▎  | 733/1000 [00:05<00:01, 231.75it/s] 63%|██████▎   | 632/1000 [00:05<00:01, 223.35it/s] 67%|██████▋   | 669/1000 [00:05<00:01, 203.92it/s] 79%|███████▉  | 788/1000 [00:05<00:00, 268.60it/s] 77%|███████▋  | 768/1000 [00:05<00:01, 228.10it/s] 76%|███████▌  | 757/1000 [00:05<00:01, 233.04it/s]Step799:rank0, time: 0.367, per_step: 0.003634
 66%|██████▌   | 655/1000 [00:05<00:01, 224.73it/s] 75%|███████▍  | 747/1000 [00:05<00:01, 187.31it/s] 69%|██████▉   | 690/1000 [00:05<00:01, 204.40it/s] 82%|████████▏ | 816/1000 [00:05<00:00, 270.24it/s] 80%|███████▉  | 795/1000 [00:05<00:00, 238.06it/s]Step699:rank5, time: 0.487, per_step: 0.004817
Step799:rank4, time: 0.407, per_step: 0.004031
 78%|███████▊  | 781/1000 [00:05<00:00, 234.81it/s] 68%|██████▊   | 678/1000 [00:05<00:01, 224.47it/s] 77%|███████▋  | 769/1000 [00:05<00:01, 195.03it/s] 71%|███████   | 711/1000 [00:05<00:01, 204.65it/s] 84%|████████▍ | 844/1000 [00:05<00:00, 271.46it/s] 82%|████████▎ | 825/1000 [00:05<00:00, 253.46it/s]Step799:rank3, time: 0.428, per_step: 0.004238
 81%|████████  | 806/1000 [00:05<00:00, 236.76it/s] 79%|███████▉  | 791/1000 [00:05<00:01, 201.53it/s] 73%|███████▎  | 732/1000 [00:05<00:01, 204.82it/s]Step699:rank2, time: 0.486, per_step: 0.004808
 70%|███████   | 701/1000 [00:05<00:01, 198.68it/s]Step799:rank1, time: 0.509, per_step: 0.005043
 87%|████████▋ | 872/1000 [00:05<00:00, 271.29it/s] 85%|████████▌ | 851/1000 [00:05<00:00, 251.53it/s] 83%|████████▎ | 831/1000 [00:05<00:00, 237.93it/s] 81%|████████▏ | 814/1000 [00:05<00:00, 207.15it/s] 75%|███████▌  | 753/1000 [00:05<00:01, 205.37it/s] 72%|███████▏  | 723/1000 [00:05<00:01, 204.12it/s]Step899:rank0, time: 0.365, per_step: 0.003609
 90%|█████████ | 900/1000 [00:05<00:00, 272.76it/s] 88%|████████▊ | 877/1000 [00:05<00:00, 248.59it/s] 86%|████████▌ | 855/1000 [00:05<00:00, 236.09it/s] 84%|████████▎ | 836/1000 [00:05<00:00, 209.47it/s] 77%|███████▋  | 774/1000 [00:05<00:01, 206.30it/s] 75%|███████▍  | 746/1000 [00:05<00:01, 209.86it/s]Step899:rank4, time: 0.390, per_step: 0.003861
 93%|█████████▎| 928/1000 [00:05<00:00, 264.66it/s] 90%|█████████ | 903/1000 [00:05<00:00, 249.21it/s] 88%|████████▊ | 879/1000 [00:06<00:00, 233.26it/s] 86%|████████▌ | 858/1000 [00:06<00:00, 211.78it/s] 80%|███████▉  | 795/1000 [00:06<00:00, 206.12it/s]Step799:rank5, time: 0.484, per_step: 0.004792
 77%|███████▋  | 769/1000 [00:06<00:01, 214.34it/s] 96%|█████████▌| 955/1000 [00:06<00:00, 265.93it/s] 93%|█████████▎| 931/1000 [00:06<00:00, 257.73it/s]Step899:rank3, time: 0.427, per_step: 0.004229
 90%|█████████ | 903/1000 [00:06<00:00, 233.38it/s] 88%|████████▊ | 880/1000 [00:06<00:00, 213.51it/s] 79%|███████▉  | 792/1000 [00:06<00:00, 217.43it/s] 98%|█████████▊| 983/1000 [00:06<00:00, 268.70it/s] 82%|████████▏ | 816/1000 [00:06<00:01, 180.90it/s] 96%|█████████▌| 959/1000 [00:06<00:00, 263.86it/s]Step799:rank2, time: 0.448, per_step: 0.004439
 93%|█████████▎| 927/1000 [00:06<00:00, 235.21it/s]Step899:rank1, time: 0.458, per_step: 0.004532
 90%|█████████ | 902/1000 [00:06<00:00, 215.16it/s]Step999:rank0, time: 0.378, per_step: 0.003744
100%|██████████| 1000/1000 [00:06<00:00, 160.41it/s]
 82%|████████▏ | 817/1000 [00:06<00:00, 226.06it/s] 84%|████████▎ | 837/1000 [00:06<00:00, 185.61it/s] 99%|█████████▊| 986/1000 [00:06<00:00, 253.52it/s] 96%|█████████▌| 955/1000 [00:06<00:00, 246.67it/s] 92%|█████████▏| 924/1000 [00:06<00:00, 208.83it/s]Step999:rank4, time: 0.390, per_step: 0.003863
100%|██████████| 1000/1000 [00:06<00:00, 157.17it/s]
 84%|████████▍ | 845/1000 [00:06<00:00, 241.02it/s] 86%|████████▌ | 862/1000 [00:06<00:00, 202.60it/s] 98%|█████████▊| 981/1000 [00:06<00:00, 248.33it/s] 95%|█████████▍| 949/1000 [00:06<00:00, 217.30it/s] 88%|████████▊ | 877/1000 [00:06<00:00, 263.26it/s]Step999:rank3, time: 0.385, per_step: 0.003813
100%|██████████| 1000/1000 [00:06<00:00, 154.26it/s]
 88%|████████▊ | 883/1000 [00:06<00:00, 200.71it/s] 97%|█████████▋| 972/1000 [00:06<00:00, 220.81it/s]Step899:rank2, time: 0.357, per_step: 0.003535
 90%|█████████ | 904/1000 [00:06<00:00, 261.55it/s]Step899:rank5, time: 0.546, per_step: 0.005402
 90%|█████████ | 904/1000 [00:06<00:00, 185.04it/s]Step999:rank1, time: 0.425, per_step: 0.004209
100%|██████████| 1000/1000 [00:06<00:00, 150.49it/s]
 95%|█████████▌| 953/1000 [00:06<00:00, 327.95it/s]Step999:rank2, time: 0.154, per_step: 0.001529
100%|██████████| 1000/1000 [00:06<00:00, 149.00it/s]
100%|█████████▉| 996/1000 [00:06<00:00, 382.08it/s]Step999:rank5, time: 0.131, per_step: 0.001297
100%|██████████| 1000/1000 [00:06<00:00, 148.47it/s]
Worker 5 pid=40768
Successfully xmh
