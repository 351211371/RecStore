perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f7cba4cfe50>==========
Worker 0 pid=54638
Worker 1 pid=54639
Worker 2 pid=54640
Worker 3 pid=54641
Worker 4 pid=54642
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<13:24,  1.24it/s]  0%|          | 1/1000 [00:00<09:17,  1.79it/s]  0%|          | 1/1000 [00:00<12:01,  1.39it/s]  0%|          | 1/1000 [00:00<10:36,  1.57it/s]  0%|          | 1/1000 [00:00<09:18,  1.79it/s]  0%|          | 1/1000 [00:00<09:26,  1.76it/s]  1%|          | 9/1000 [00:00<00:57, 17.29it/s]  1%|          | 9/1000 [00:00<01:03, 15.67it/s]  1%|          | 9/1000 [00:00<00:56, 17.40it/s]  1%|          | 9/1000 [00:00<01:16, 12.92it/s]  1%|          | 9/1000 [00:00<01:10, 14.15it/s]  1%|          | 9/1000 [00:00<00:57, 17.38it/s]  2%|▏         | 19/1000 [00:01<00:34, 28.15it/s]  2%|▏         | 19/1000 [00:00<00:32, 30.31it/s]  2%|▏         | 19/1000 [00:00<00:29, 32.88it/s]  2%|▏         | 19/1000 [00:00<00:27, 35.51it/s]  2%|▏         | 19/1000 [00:00<00:27, 35.69it/s]  2%|▏         | 19/1000 [00:00<00:27, 35.71it/s]  3%|▎         | 31/1000 [00:01<00:19, 49.23it/s]  3%|▎         | 31/1000 [00:01<00:20, 46.40it/s]  3%|▎         | 31/1000 [00:00<00:17, 55.87it/s]  3%|▎         | 31/1000 [00:00<00:17, 55.83it/s]  3%|▎         | 31/1000 [00:00<00:18, 52.44it/s]  3%|▎         | 31/1000 [00:00<00:17, 55.61it/s]  4%|▍         | 43/1000 [00:01<00:15, 62.53it/s]  4%|▍         | 43/1000 [00:01<00:13, 68.68it/s]  4%|▍         | 43/1000 [00:00<00:13, 72.00it/s]  4%|▍         | 43/1000 [00:00<00:13, 71.77it/s]  4%|▍         | 43/1000 [00:01<00:14, 65.43it/s]  4%|▍         | 43/1000 [00:00<00:13, 71.95it/s]  6%|▌         | 56/1000 [00:01<00:12, 78.40it/s]  6%|▌         | 56/1000 [00:01<00:10, 87.06it/s]  6%|▌         | 56/1000 [00:01<00:11, 84.09it/s]  6%|▌         | 56/1000 [00:01<00:11, 81.12it/s]  6%|▌         | 56/1000 [00:01<00:10, 87.04it/s]  6%|▌         | 56/1000 [00:01<00:10, 86.85it/s]  7%|▋         | 70/1000 [00:01<00:09, 95.83it/s]  7%|▋         | 70/1000 [00:01<00:09, 98.35it/s]  7%|▋         | 70/1000 [00:01<00:09, 93.41it/s]  7%|▋         | 70/1000 [00:01<00:09, 100.83it/s]  7%|▋         | 70/1000 [00:01<00:09, 100.84it/s]  7%|▋         | 70/1000 [00:01<00:09, 100.67it/s]  8%|▊         | 83/1000 [00:01<00:09, 101.78it/s]  8%|▊         | 83/1000 [00:01<00:08, 103.62it/s]  8%|▊         | 83/1000 [00:01<00:08, 107.50it/s]  8%|▊         | 83/1000 [00:01<00:08, 107.49it/s]  8%|▊         | 83/1000 [00:01<00:08, 105.58it/s]  8%|▊         | 83/1000 [00:01<00:08, 107.34it/s] 10%|▉         | 95/1000 [00:01<00:08, 106.36it/s] 10%|▉         | 95/1000 [00:01<00:08, 104.95it/s] 10%|▉         | 95/1000 [00:01<00:08, 109.07it/s] 10%|▉         | 95/1000 [00:01<00:08, 109.13it/s] 10%|▉         | 95/1000 [00:01<00:08, 109.11it/s] 10%|▉         | 95/1000 [00:01<00:08, 107.75it/s]Step99:rank5, time: 1.707, per_step: 0.017072
Step99:rank4, time: 1.622, per_step: 0.016215
Step99:rank1, time: 1.507, per_step: 0.015070
Step99:rank2, time: 1.433, per_step: 0.014331
Step99:rank0, time: 1.426, per_step: 0.014257
Step99:rank3, time: 1.425, per_step: 0.014247
 11%|█         | 110/1000 [00:01<00:07, 116.16it/s] 11%|█         | 110/1000 [00:01<00:07, 117.21it/s] 11%|█         | 110/1000 [00:01<00:07, 119.39it/s] 11%|█         | 110/1000 [00:01<00:07, 119.36it/s] 11%|█         | 110/1000 [00:01<00:07, 118.31it/s] 11%|█         | 110/1000 [00:01<00:07, 119.30it/s] 12%|█▏        | 123/1000 [00:01<00:07, 116.26it/s] 12%|█▏        | 123/1000 [00:01<00:07, 118.51it/s] 12%|█▏        | 123/1000 [00:01<00:07, 118.48it/s] 12%|█▏        | 123/1000 [00:01<00:07, 117.79it/s] 12%|█▏        | 123/1000 [00:01<00:07, 116.97it/s] 12%|█▏        | 123/1000 [00:01<00:07, 118.50it/s] 14%|█▎        | 137/1000 [00:01<00:07, 122.51it/s] 14%|█▎        | 137/1000 [00:01<00:07, 121.97it/s] 14%|█▎        | 137/1000 [00:01<00:07, 121.37it/s] 14%|█▎        | 137/1000 [00:01<00:07, 120.79it/s] 14%|█▎        | 137/1000 [00:01<00:07, 122.44it/s] 14%|█▎        | 137/1000 [00:01<00:07, 122.14it/s] 15%|█▌        | 152/1000 [00:01<00:06, 126.34it/s] 15%|█▌        | 152/1000 [00:01<00:06, 126.71it/s] 15%|█▌        | 152/1000 [00:02<00:06, 125.50it/s] 15%|█▌        | 152/1000 [00:01<00:06, 125.88it/s] 15%|█▌        | 152/1000 [00:01<00:06, 126.66it/s] 15%|█▌        | 152/1000 [00:01<00:06, 126.06it/s] 17%|█▋        | 166/1000 [00:02<00:06, 128.90it/s] 17%|█▋        | 167/1000 [00:02<00:06, 129.02it/s] 17%|█▋        | 167/1000 [00:01<00:06, 129.86it/s] 17%|█▋        | 167/1000 [00:02<00:06, 129.57it/s] 17%|█▋        | 167/1000 [00:01<00:06, 130.14it/s] 17%|█▋        | 167/1000 [00:01<00:06, 129.83it/s] 18%|█▊        | 181/1000 [00:02<00:06, 133.29it/s] 18%|█▊        | 182/1000 [00:02<00:06, 133.83it/s] 18%|█▊        | 182/1000 [00:02<00:06, 134.02it/s] 18%|█▊        | 182/1000 [00:02<00:06, 134.24it/s] 18%|█▊        | 182/1000 [00:02<00:06, 133.98it/s] 18%|█▊        | 182/1000 [00:02<00:06, 133.34it/s] 20%|█▉        | 195/1000 [00:02<00:06, 120.57it/s] 20%|█▉        | 196/1000 [00:02<00:06, 121.18it/s] 20%|█▉        | 196/1000 [00:02<00:06, 121.01it/s] 20%|█▉        | 196/1000 [00:02<00:06, 120.76it/s] 20%|█▉        | 196/1000 [00:02<00:06, 121.11it/s] 20%|█▉        | 196/1000 [00:02<00:06, 121.22it/s]Step199:rank2, time: 0.777, per_step: 0.007697
Step199:rank1, time: 0.777, per_step: 0.007697
Step199:rank4, time: 0.777, per_step: 0.007698
Step199:rank0, time: 0.777, per_step: 0.007697
Step199:rank5, time: 0.778, per_step: 0.007699
Step199:rank3, time: 0.778, per_step: 0.007698
 21%|██        | 212/1000 [00:02<00:05, 131.84it/s] 21%|██▏       | 213/1000 [00:02<00:05, 132.38it/s] 21%|██▏       | 213/1000 [00:02<00:05, 132.21it/s] 21%|██▏       | 213/1000 [00:02<00:05, 131.99it/s] 21%|██▏       | 213/1000 [00:02<00:05, 132.28it/s] 21%|██▏       | 213/1000 [00:02<00:05, 132.36it/s] 23%|██▎       | 228/1000 [00:02<00:05, 139.15it/s] 23%|██▎       | 229/1000 [00:02<00:05, 139.51it/s] 23%|██▎       | 229/1000 [00:02<00:05, 139.26it/s] 23%|██▎       | 229/1000 [00:02<00:05, 139.38it/s] 23%|██▎       | 229/1000 [00:02<00:05, 139.46it/s] 23%|██▎       | 229/1000 [00:02<00:05, 139.54it/s] 24%|██▍       | 244/1000 [00:02<00:05, 140.48it/s] 24%|██▍       | 244/1000 [00:02<00:05, 140.13it/s] 24%|██▍       | 244/1000 [00:02<00:05, 140.21it/s] 24%|██▍       | 244/1000 [00:02<00:05, 140.35it/s] 24%|██▍       | 244/1000 [00:02<00:05, 140.22it/s] 24%|██▍       | 244/1000 [00:02<00:05, 139.32it/s] 26%|██▌       | 259/1000 [00:02<00:05, 138.42it/s] 26%|██▌       | 259/1000 [00:02<00:05, 138.31it/s] 26%|██▌       | 259/1000 [00:02<00:05, 138.58it/s] 26%|██▌       | 259/1000 [00:02<00:05, 138.42it/s] 26%|██▌       | 259/1000 [00:02<00:05, 138.44it/s] 26%|██▌       | 259/1000 [00:02<00:05, 138.53it/s] 27%|██▋       | 273/1000 [00:02<00:05, 137.90it/s] 27%|██▋       | 273/1000 [00:02<00:05, 137.80it/s] 27%|██▋       | 273/1000 [00:02<00:05, 137.73it/s] 27%|██▋       | 273/1000 [00:02<00:05, 137.82it/s] 27%|██▋       | 273/1000 [00:02<00:05, 137.88it/s] 27%|██▋       | 274/1000 [00:02<00:05, 138.06it/s] 29%|██▊       | 287/1000 [00:03<00:05, 136.87it/s] 29%|██▊       | 287/1000 [00:02<00:05, 136.84it/s] 29%|██▊       | 287/1000 [00:02<00:05, 136.90it/s] 29%|██▊       | 287/1000 [00:02<00:05, 136.87it/s] 29%|██▊       | 287/1000 [00:02<00:05, 135.56it/s] 29%|██▉       | 288/1000 [00:02<00:05, 134.67it/s]Step299:rank5, time: 0.694, per_step: 0.006875
Step299:rank4, time: 0.695, per_step: 0.006877
Step299:rank1, time: 0.695, per_step: 0.006877
Step299:rank0, time: 0.695, per_step: 0.006877
Step299:rank3, time: 0.695, per_step: 0.006876
Step299:rank2, time: 0.695, per_step: 0.006880
 30%|███       | 302/1000 [00:03<00:05, 139.09it/s] 30%|███       | 302/1000 [00:02<00:05, 139.16it/s] 30%|███       | 302/1000 [00:02<00:05, 139.10it/s] 30%|███       | 302/1000 [00:02<00:05, 139.08it/s] 30%|███       | 303/1000 [00:02<00:04, 140.11it/s] 30%|███       | 304/1000 [00:03<00:04, 140.70it/s] 32%|███▏      | 318/1000 [00:03<00:04, 144.97it/s] 32%|███▏      | 318/1000 [00:03<00:04, 145.02it/s] 32%|███▏      | 318/1000 [00:03<00:04, 144.99it/s] 32%|███▏      | 318/1000 [00:03<00:04, 144.94it/s] 32%|███▏      | 319/1000 [00:03<00:04, 145.68it/s] 32%|███▏      | 320/1000 [00:03<00:04, 145.75it/s] 33%|███▎      | 333/1000 [00:03<00:04, 145.19it/s] 33%|███▎      | 333/1000 [00:03<00:04, 145.21it/s] 33%|███▎      | 333/1000 [00:03<00:04, 145.23it/s] 33%|███▎      | 333/1000 [00:03<00:04, 145.20it/s] 33%|███▎      | 334/1000 [00:03<00:04, 145.77it/s] 34%|███▎      | 335/1000 [00:03<00:04, 143.81it/s] 35%|███▍      | 348/1000 [00:03<00:04, 146.12it/s] 35%|███▍      | 348/1000 [00:03<00:04, 145.94it/s] 35%|███▍      | 348/1000 [00:03<00:04, 145.92it/s] 35%|███▍      | 348/1000 [00:03<00:04, 145.91it/s] 35%|███▍      | 349/1000 [00:03<00:04, 142.21it/s] 35%|███▌      | 350/1000 [00:03<00:04, 142.30it/s] 36%|███▋      | 363/1000 [00:03<00:04, 145.22it/s] 36%|███▋      | 363/1000 [00:03<00:04, 145.19it/s] 36%|███▋      | 363/1000 [00:03<00:04, 145.13it/s] 36%|███▋      | 363/1000 [00:03<00:04, 145.16it/s] 37%|███▋      | 366/1000 [00:03<00:04, 147.92it/s] 37%|███▋      | 367/1000 [00:03<00:04, 149.03it/s] 38%|███▊      | 382/1000 [00:03<00:03, 156.38it/s] 38%|███▊      | 382/1000 [00:03<00:03, 156.32it/s] 38%|███▊      | 382/1000 [00:03<00:03, 156.33it/s] 38%|███▊      | 382/1000 [00:03<00:03, 156.34it/s] 38%|███▊      | 385/1000 [00:03<00:03, 158.17it/s] 39%|███▊      | 386/1000 [00:03<00:03, 159.04it/s]Step399:rank0, time: 0.626, per_step: 0.006198
Step399:rank5, time: 0.626, per_step: 0.006201
Step399:rank3, time: 0.626, per_step: 0.006199
Step399:rank4, time: 0.626, per_step: 0.006200
Step399:rank1, time: 0.626, per_step: 0.006201
Step399:rank2, time: 0.626, per_step: 0.006200
 40%|████      | 401/1000 [00:03<00:03, 164.46it/s] 40%|████      | 401/1000 [00:03<00:03, 164.41it/s] 40%|████      | 401/1000 [00:03<00:03, 164.42it/s] 40%|████      | 401/1000 [00:03<00:03, 164.44it/s] 40%|████      | 404/1000 [00:03<00:03, 165.66it/s] 40%|████      | 405/1000 [00:03<00:03, 165.48it/s] 42%|████▏     | 418/1000 [00:03<00:03, 163.59it/s] 42%|████▏     | 418/1000 [00:03<00:03, 163.55it/s] 42%|████▏     | 418/1000 [00:03<00:03, 163.60it/s] 42%|████▏     | 418/1000 [00:03<00:03, 163.26it/s] 42%|████▏     | 421/1000 [00:03<00:03, 164.23it/s] 42%|████▏     | 422/1000 [00:03<00:03, 164.91it/s] 44%|████▎     | 437/1000 [00:03<00:03, 168.91it/s] 44%|████▎     | 437/1000 [00:03<00:03, 168.82it/s] 44%|████▎     | 437/1000 [00:03<00:03, 168.82it/s] 44%|████▎     | 437/1000 [00:03<00:03, 168.79it/s] 44%|████▍     | 440/1000 [00:03<00:03, 169.49it/s] 44%|████▍     | 441/1000 [00:03<00:03, 169.93it/s] 46%|████▌     | 456/1000 [00:03<00:03, 173.69it/s] 46%|████▌     | 456/1000 [00:04<00:03, 173.61it/s] 46%|████▌     | 456/1000 [00:03<00:03, 173.59it/s] 46%|████▌     | 456/1000 [00:03<00:03, 173.59it/s] 46%|████▌     | 459/1000 [00:03<00:03, 174.07it/s] 46%|████▌     | 460/1000 [00:04<00:03, 174.49it/s] 48%|████▊     | 475/1000 [00:03<00:02, 176.78it/s] 48%|████▊     | 475/1000 [00:04<00:02, 176.74it/s] 48%|████▊     | 475/1000 [00:03<00:02, 176.75it/s] 48%|████▊     | 475/1000 [00:04<00:02, 176.71it/s] 48%|████▊     | 478/1000 [00:03<00:02, 177.04it/s] 48%|████▊     | 479/1000 [00:04<00:02, 177.31it/s] 49%|████▉     | 493/1000 [00:04<00:03, 163.60it/s] 49%|████▉     | 493/1000 [00:04<00:03, 163.63it/s] 49%|████▉     | 493/1000 [00:04<00:03, 163.62it/s] 49%|████▉     | 493/1000 [00:04<00:03, 163.35it/s] 50%|████▉     | 496/1000 [00:04<00:03, 162.50it/s] 50%|████▉     | 497/1000 [00:04<00:03, 161.45it/s]Step499:rank4, time: 0.597, per_step: 0.005915
Step499:rank1, time: 0.598, per_step: 0.005916
Step499:rank5, time: 0.598, per_step: 0.005917
Step499:rank3, time: 0.598, per_step: 0.005917
Step499:rank2, time: 0.597, per_step: 0.005915
Step499:rank0, time: 0.598, per_step: 0.005922
 51%|█████     | 510/1000 [00:04<00:03, 161.28it/s] 51%|█████     | 510/1000 [00:04<00:03, 161.30it/s] 51%|█████     | 510/1000 [00:04<00:03, 161.27it/s] 51%|█████     | 510/1000 [00:04<00:03, 161.11it/s] 51%|█████▏    | 513/1000 [00:04<00:03, 160.64it/s] 51%|█████▏    | 514/1000 [00:04<00:03, 160.87it/s] 53%|█████▎    | 527/1000 [00:04<00:02, 158.81it/s] 53%|█████▎    | 527/1000 [00:04<00:02, 158.82it/s] 53%|█████▎    | 527/1000 [00:04<00:02, 158.81it/s] 53%|█████▎    | 527/1000 [00:04<00:02, 158.72it/s] 53%|█████▎    | 530/1000 [00:04<00:02, 158.40it/s] 53%|█████▎    | 531/1000 [00:04<00:02, 158.49it/s] 54%|█████▍    | 543/1000 [00:04<00:02, 157.11it/s] 54%|█████▍    | 543/1000 [00:04<00:02, 157.14it/s] 54%|█████▍    | 543/1000 [00:04<00:02, 157.13it/s] 54%|█████▍    | 543/1000 [00:04<00:02, 157.05it/s] 55%|█████▍    | 546/1000 [00:04<00:02, 156.85it/s] 55%|█████▍    | 547/1000 [00:04<00:02, 156.96it/s] 56%|█████▌    | 560/1000 [00:04<00:02, 158.28it/s] 56%|█████▌    | 560/1000 [00:04<00:02, 158.27it/s] 56%|█████▌    | 560/1000 [00:04<00:02, 158.27it/s] 56%|█████▌    | 560/1000 [00:04<00:02, 158.22it/s] 56%|█████▋    | 563/1000 [00:04<00:02, 158.03it/s] 56%|█████▋    | 563/1000 [00:04<00:02, 157.44it/s] 58%|█████▊    | 576/1000 [00:04<00:02, 150.54it/s] 58%|█████▊    | 576/1000 [00:04<00:02, 150.56it/s] 58%|█████▊    | 576/1000 [00:04<00:02, 150.53it/s] 58%|█████▊    | 576/1000 [00:04<00:02, 150.11it/s] 58%|█████▊    | 579/1000 [00:04<00:02, 149.32it/s] 58%|█████▊    | 579/1000 [00:04<00:02, 148.87it/s] 59%|█████▉    | 592/1000 [00:05<00:02, 139.71it/s] 59%|█████▉    | 592/1000 [00:04<00:02, 139.72it/s] 59%|█████▉    | 592/1000 [00:04<00:02, 139.81it/s] 59%|█████▉    | 592/1000 [00:04<00:02, 139.70it/s] 60%|█████▉    | 595/1000 [00:04<00:02, 138.76it/s] 60%|█████▉    | 595/1000 [00:04<00:02, 138.64it/s]Step599:rank4, time: 0.692, per_step: 0.006848
Step599:rank5, time: 0.692, per_step: 0.006847
Step599:rank3, time: 0.692, per_step: 0.006847
Step599:rank1, time: 0.692, per_step: 0.006848
Step599:rank2, time: 0.692, per_step: 0.006848
Step599:rank0, time: 0.692, per_step: 0.006848
 61%|██████    | 607/1000 [00:05<00:02, 142.28it/s] 61%|██████    | 607/1000 [00:04<00:02, 142.29it/s] 61%|██████    | 607/1000 [00:04<00:02, 142.37it/s] 61%|██████    | 607/1000 [00:04<00:02, 142.27it/s] 61%|██████    | 611/1000 [00:05<00:02, 143.39it/s] 61%|██████    | 611/1000 [00:04<00:02, 143.28it/s] 62%|██████▏   | 622/1000 [00:05<00:02, 143.13it/s] 62%|██████▏   | 622/1000 [00:05<00:02, 143.15it/s] 62%|██████▏   | 622/1000 [00:04<00:02, 143.21it/s] 62%|██████▏   | 622/1000 [00:04<00:02, 143.17it/s] 63%|██████▎   | 627/1000 [00:05<00:02, 145.90it/s] 63%|██████▎   | 627/1000 [00:04<00:02, 145.83it/s] 64%|██████▍   | 641/1000 [00:05<00:02, 155.39it/s] 64%|██████▍   | 641/1000 [00:05<00:02, 155.16it/s] 64%|██████▍   | 641/1000 [00:05<00:02, 155.22it/s] 64%|██████▍   | 641/1000 [00:05<00:02, 155.15it/s] 65%|██████▍   | 646/1000 [00:05<00:02, 157.20it/s] 65%|██████▍   | 646/1000 [00:05<00:02, 157.12it/s] 66%|██████▌   | 660/1000 [00:05<00:02, 163.49it/s] 66%|██████▌   | 660/1000 [00:05<00:02, 163.36it/s] 66%|██████▌   | 660/1000 [00:05<00:02, 163.33it/s] 66%|██████▌   | 660/1000 [00:05<00:02, 163.34it/s] 66%|██████▌   | 662/1000 [00:05<00:02, 157.48it/s] 66%|██████▌   | 662/1000 [00:05<00:02, 157.45it/s] 68%|██████▊   | 677/1000 [00:05<00:02, 154.83it/s] 68%|██████▊   | 677/1000 [00:05<00:02, 154.80it/s] 68%|██████▊   | 677/1000 [00:05<00:02, 154.82it/s] 68%|██████▊   | 677/1000 [00:05<00:02, 154.68it/s] 68%|██████▊   | 678/1000 [00:05<00:02, 155.48it/s] 68%|██████▊   | 678/1000 [00:05<00:02, 155.44it/s] 69%|██████▉   | 693/1000 [00:05<00:01, 155.35it/s] 69%|██████▉   | 694/1000 [00:05<00:01, 155.48it/s] 69%|██████▉   | 694/1000 [00:05<00:01, 155.90it/s] 69%|██████▉   | 694/1000 [00:05<00:01, 155.48it/s] 69%|██████▉   | 694/1000 [00:05<00:01, 155.89it/s] 69%|██████▉   | 694/1000 [00:05<00:01, 155.46it/s]Step699:rank4, time: 0.626, per_step: 0.006197
Step699:rank5, time: 0.626, per_step: 0.006197
Step699:rank1, time: 0.626, per_step: 0.006197
Step699:rank3, time: 0.626, per_step: 0.006198
Step699:rank2, time: 0.626, per_step: 0.006197
Step699:rank0, time: 0.626, per_step: 0.006197
 71%|███████   | 709/1000 [00:05<00:01, 156.17it/s] 71%|███████   | 710/1000 [00:05<00:01, 156.33it/s] 71%|███████   | 710/1000 [00:05<00:01, 156.33it/s] 71%|███████   | 710/1000 [00:05<00:01, 156.64it/s] 71%|███████   | 710/1000 [00:05<00:01, 156.31it/s] 71%|███████   | 710/1000 [00:05<00:01, 156.66it/s] 73%|███████▎  | 726/1000 [00:05<00:01, 158.87it/s] 73%|███████▎  | 727/1000 [00:05<00:01, 158.96it/s] 73%|███████▎  | 727/1000 [00:05<00:01, 159.26it/s] 73%|███████▎  | 727/1000 [00:05<00:01, 158.95it/s] 73%|███████▎  | 727/1000 [00:05<00:01, 159.27it/s] 73%|███████▎  | 727/1000 [00:05<00:01, 158.97it/s] 74%|███████▍  | 742/1000 [00:05<00:01, 158.25it/s] 74%|███████▍  | 743/1000 [00:05<00:01, 158.48it/s] 74%|███████▍  | 743/1000 [00:05<00:01, 158.26it/s] 74%|███████▍  | 743/1000 [00:05<00:01, 158.27it/s] 74%|███████▍  | 743/1000 [00:05<00:01, 158.27it/s] 74%|███████▍  | 743/1000 [00:05<00:01, 158.46it/s] 76%|███████▌  | 759/1000 [00:05<00:01, 160.41it/s] 76%|███████▌  | 760/1000 [00:05<00:01, 160.62it/s] 76%|███████▌  | 760/1000 [00:05<00:01, 160.45it/s] 76%|███████▌  | 760/1000 [00:06<00:01, 160.42it/s] 76%|███████▌  | 760/1000 [00:05<00:01, 160.46it/s] 76%|███████▌  | 760/1000 [00:05<00:01, 160.61it/s] 78%|███████▊  | 776/1000 [00:05<00:01, 158.07it/s] 78%|███████▊  | 777/1000 [00:06<00:01, 158.09it/s] 78%|███████▊  | 777/1000 [00:05<00:01, 158.10it/s] 78%|███████▊  | 777/1000 [00:06<00:01, 158.18it/s] 78%|███████▊  | 777/1000 [00:05<00:01, 158.10it/s] 78%|███████▊  | 777/1000 [00:05<00:01, 158.17it/s] 79%|███████▉  | 792/1000 [00:06<00:01, 154.32it/s] 79%|███████▉  | 793/1000 [00:06<00:01, 152.86it/s] 79%|███████▉  | 793/1000 [00:06<00:01, 152.84it/s] 79%|███████▉  | 793/1000 [00:06<00:01, 152.86it/s] 79%|███████▉  | 793/1000 [00:06<00:01, 152.77it/s] 79%|███████▉  | 793/1000 [00:06<00:01, 152.78it/s]Step799:rank5, time: 0.669, per_step: 0.006625
Step799:rank4, time: 0.669, per_step: 0.006625
Step799:rank1, time: 0.669, per_step: 0.006625
Step799:rank3, time: 0.669, per_step: 0.006625
Step799:rank2, time: 0.669, per_step: 0.006626
Step799:rank0, time: 0.669, per_step: 0.006623
 81%|████████  | 808/1000 [00:06<00:01, 142.44it/s] 81%|████████  | 809/1000 [00:06<00:01, 143.07it/s] 81%|████████  | 809/1000 [00:06<00:01, 143.03it/s] 81%|████████  | 809/1000 [00:06<00:01, 143.06it/s] 81%|████████  | 809/1000 [00:06<00:01, 143.02it/s] 81%|████████  | 809/1000 [00:06<00:01, 143.03it/s] 82%|████████▎ | 825/1000 [00:06<00:01, 149.62it/s] 83%|████████▎ | 826/1000 [00:06<00:01, 150.09it/s] 83%|████████▎ | 826/1000 [00:06<00:01, 150.08it/s] 83%|████████▎ | 826/1000 [00:06<00:01, 150.09it/s] 83%|████████▎ | 826/1000 [00:06<00:01, 150.10it/s] 83%|████████▎ | 826/1000 [00:06<00:01, 150.07it/s] 84%|████████▍ | 843/1000 [00:06<00:01, 152.54it/s] 84%|████████▍ | 843/1000 [00:06<00:01, 152.52it/s] 84%|████████▍ | 843/1000 [00:06<00:01, 152.51it/s] 84%|████████▍ | 843/1000 [00:06<00:01, 152.53it/s] 84%|████████▍ | 843/1000 [00:06<00:01, 152.61it/s] 84%|████████▍ | 843/1000 [00:06<00:01, 152.14it/s] 86%|████████▌ | 861/1000 [00:06<00:00, 159.79it/s] 86%|████████▌ | 861/1000 [00:06<00:00, 159.60it/s] 86%|████████▌ | 861/1000 [00:06<00:00, 159.58it/s] 86%|████████▌ | 861/1000 [00:06<00:00, 159.54it/s] 86%|████████▌ | 861/1000 [00:06<00:00, 159.58it/s] 86%|████████▌ | 861/1000 [00:06<00:00, 159.58it/s] 88%|████████▊ | 880/1000 [00:06<00:00, 167.25it/s] 88%|████████▊ | 880/1000 [00:06<00:00, 167.07it/s] 88%|████████▊ | 880/1000 [00:06<00:00, 167.09it/s] 88%|████████▊ | 880/1000 [00:06<00:00, 167.06it/s] 88%|████████▊ | 880/1000 [00:06<00:00, 167.04it/s] 88%|████████▊ | 880/1000 [00:06<00:00, 167.07it/s] 90%|████████▉ | 899/1000 [00:06<00:00, 173.28it/s] 90%|████████▉ | 899/1000 [00:06<00:00, 173.19it/s] 90%|████████▉ | 899/1000 [00:06<00:00, 173.15it/s] 90%|████████▉ | 899/1000 [00:06<00:00, 173.14it/s] 90%|████████▉ | 899/1000 [00:06<00:00, 173.16it/s] 90%|████████▉ | 899/1000 [00:06<00:00, 173.07it/s]Step899:rank3, time: 0.573, per_step: 0.005676
Step899:rank4, time: 0.573, per_step: 0.005678
Step899:rank5, time: 0.573, per_step: 0.005678
Step899:rank1, time: 0.574, per_step: 0.005679
Step899:rank2, time: 0.573, per_step: 0.005678
Step899:rank0, time: 0.573, per_step: 0.005677
 92%|█████████▏| 919/1000 [00:06<00:00, 178.69it/s] 92%|█████████▏| 919/1000 [00:06<00:00, 178.61it/s] 92%|█████████▏| 919/1000 [00:07<00:00, 178.60it/s] 92%|█████████▏| 919/1000 [00:06<00:00, 178.58it/s] 92%|█████████▏| 919/1000 [00:06<00:00, 178.62it/s] 92%|█████████▏| 919/1000 [00:06<00:00, 178.48it/s] 94%|█████████▎| 937/1000 [00:07<00:00, 170.93it/s] 94%|█████████▎| 937/1000 [00:07<00:00, 170.93it/s] 94%|█████████▎| 937/1000 [00:06<00:00, 170.91it/s] 94%|█████████▎| 937/1000 [00:06<00:00, 170.93it/s] 94%|█████████▎| 937/1000 [00:06<00:00, 170.88it/s] 94%|█████████▎| 937/1000 [00:06<00:00, 170.87it/s] 96%|█████████▌| 955/1000 [00:07<00:00, 168.82it/s] 96%|█████████▌| 955/1000 [00:07<00:00, 168.81it/s] 96%|█████████▌| 955/1000 [00:07<00:00, 168.80it/s] 96%|█████████▌| 955/1000 [00:07<00:00, 168.76it/s] 96%|█████████▌| 955/1000 [00:07<00:00, 168.81it/s] 96%|█████████▌| 955/1000 [00:07<00:00, 168.82it/s] 97%|█████████▋| 974/1000 [00:07<00:00, 172.84it/s] 97%|█████████▋| 974/1000 [00:07<00:00, 172.85it/s] 97%|█████████▋| 974/1000 [00:07<00:00, 172.85it/s] 97%|█████████▋| 974/1000 [00:07<00:00, 172.86it/s] 97%|█████████▋| 974/1000 [00:07<00:00, 172.85it/s] 97%|█████████▋| 974/1000 [00:07<00:00, 172.80it/s] 99%|█████████▉| 992/1000 [00:07<00:00, 163.69it/s] 99%|█████████▉| 992/1000 [00:07<00:00, 163.65it/s] 99%|█████████▉| 992/1000 [00:07<00:00, 163.68it/s] 99%|█████████▉| 992/1000 [00:07<00:00, 163.67it/s] 99%|█████████▉| 992/1000 [00:07<00:00, 163.67it/s] 99%|█████████▉| 992/1000 [00:07<00:00, 163.06it/s]Step999:rank5, time: 0.599, per_step: 0.005928
Step999:rank4, time: 0.599, per_step: 0.005928
Step999:rank3, time: 0.599, per_step: 0.005930
Step999:rank1, time: 0.599, per_step: 0.005928
Step999:rank0, time: 0.599, per_step: 0.005928
Step999:rank2, time: 0.599, per_step: 0.005928
100%|██████████| 1000/1000 [00:07<00:00, 134.41it/s]100%|██████████| 1000/1000 [00:07<00:00, 137.44it/s]100%|██████████| 1000/1000 [00:07<00:00, 132.91it/s]100%|██████████| 1000/1000 [00:07<00:00, 135.95it/s]100%|██████████| 1000/1000 [00:07<00:00, 137.31it/s]100%|██████████| 1000/1000 [00:07<00:00, 137.42it/s]





Worker 5 pid=54643
Successfully xmh
