Setting the default backend to "pytorch". You can change it in the ~/.dgl/config.json file or export the DGLBACKEND environment variable.  Valid options are: pytorch, mxnet, tensorflow (all lowercase)
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
ARGS:  Namespace(adversarial_temperature=1.0, async_update=False, batch_size=1000, batch_size_eval=16, data_files=None, data_path='data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=-1, format='built_in', gamma=16.0, gpu=[-1], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=False, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=0, num_proc=1, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='ckpts/TransE_l1_FB15k_9', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 1.019 seconds
[proc 0][Train](1000/10000) average pos_loss: 0.30669538129121066
[proc 0][Train](1000/10000) average neg_loss: 0.3141761496812105
[proc 0][Train](1000/10000) average loss: 0.3104357652068138
[proc 0][Train](1000/10000) average regularization: 9.021348022770325e-06
[proc 0] 1000 steps, total: 28.035, sample: 1.159, forward: 6.871, backward: 17.588, update: 2.411
[proc 0][Train](2000/10000) average pos_loss: 0.10432796104997397
[proc 0][Train](2000/10000) average neg_loss: 0.13860281006246805
[proc 0][Train](2000/10000) average loss: 0.12146538545936346
[proc 0][Train](2000/10000) average regularization: 1.3171311765290738e-05
[proc 0] 2000 steps, total: 25.877, sample: 1.027, forward: 6.217, backward: 16.182, update: 2.445
[proc 0][Train](3000/10000) average pos_loss: 0.0804684936106205
[proc 0][Train](3000/10000) average neg_loss: 0.11291044142097234
[proc 0][Train](3000/10000) average loss: 0.09668946734815836
[proc 0][Train](3000/10000) average regularization: 1.5111334471839654e-05
[proc 0] 3000 steps, total: 26.117, sample: 1.014, forward: 6.346, backward: 16.300, update: 2.452
[proc 0][Train](4000/10000) average pos_loss: 0.07022252640128136
[proc 0][Train](4000/10000) average neg_loss: 0.10133554685115814
[proc 0][Train](4000/10000) average loss: 0.08577903658151627
[proc 0][Train](4000/10000) average regularization: 1.6366577099688585e-05
[proc 0] 4000 steps, total: 25.276, sample: 0.950, forward: 6.072, backward: 15.933, update: 2.315
[proc 0][Train](5000/10000) average pos_loss: 0.0643390320725739
[proc 0][Train](5000/10000) average neg_loss: 0.09424802070111037
[proc 0][Train](5000/10000) average loss: 0.07929352622479201
[proc 0][Train](5000/10000) average regularization: 1.727647726693249e-05
[proc 0] 5000 steps, total: 25.452, sample: 0.972, forward: 6.087, backward: 16.057, update: 2.331
[proc 0][Train](6000/10000) average pos_loss: 0.06044894456863403
[proc 0][Train](6000/10000) average neg_loss: 0.0895601735636592
[proc 0][Train](6000/10000) average loss: 0.07500455903634429
[proc 0][Train](6000/10000) average regularization: 1.800708635164483e-05
[proc 0] 6000 steps, total: 25.702, sample: 1.047, forward: 6.165, backward: 16.177, update: 2.309
[proc 0][Train](7000/10000) average pos_loss: 0.057607240237295625
[proc 0][Train](7000/10000) average neg_loss: 0.08599367300421
[proc 0][Train](7000/10000) average loss: 0.07180045676231385
[proc 0][Train](7000/10000) average regularization: 1.8598923126774024e-05
[proc 0] 7000 steps, total: 25.724, sample: 0.968, forward: 6.193, backward: 16.262, update: 2.295
[proc 0][Train](8000/10000) average pos_loss: 0.055310818441212176
[proc 0][Train](8000/10000) average neg_loss: 0.08313352797925472
[proc 0][Train](8000/10000) average loss: 0.06922217324003577
[proc 0][Train](8000/10000) average regularization: 1.9115862151011243e-05
[proc 0] 8000 steps, total: 25.453, sample: 0.979, forward: 6.158, backward: 16.008, update: 2.303
[proc 0][Train](9000/10000) average pos_loss: 0.05355772619694471
[proc 0][Train](9000/10000) average neg_loss: 0.08094648565351963
[proc 0][Train](9000/10000) average loss: 0.06725210586190224
[proc 0][Train](9000/10000) average regularization: 1.9553745800294566e-05
[proc 0] 9000 steps, total: 25.330, sample: 0.958, forward: 6.090, backward: 16.005, update: 2.273
[proc 0][Train](10000/10000) average pos_loss: 0.052127012442797424
[proc 0][Train](10000/10000) average neg_loss: 0.0790765362046659
[proc 0][Train](10000/10000) average loss: 0.06560177434235812
[proc 0][Train](10000/10000) average regularization: 1.9940466199841466e-05
[proc 0] 10000 steps, total: 25.868, sample: 1.049, forward: 6.233, backward: 16.258, update: 2.324
proc 0 takes 258.836 seconds
Successfully xmh. training takes 258.8359742164612 seconds
DGL backend not selected or invalid.  Assuming PyTorch for now.
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[0]Test average MRR: 0.5076359171714594
[0]Test average MR: 52.64777132603139
[0]Test average HITS@1: 0.3641042135734963
[0]Test average HITS@3: 0.6058302720455045
[0]Test average HITS@10: 0.7422000643293664
testing takes 341.172 seconds
