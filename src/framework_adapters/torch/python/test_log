WARNING: Logging before InitGoogleLogging() is written to STDERR
W20240103 22:07:23.643913 2924616 IPCTensor.h:350] NewIPCTensor: full_emb [20000, 3]0x100000002000
xmh:  {'test_cache': 'KnownLocalCachedEmbedding', 'cache_ratio': 0.1, 'kForwardItersPerStep': 1, 'BackwardMode': 'CppAsync', 'L': 10, 'nr_background_threads': 32}
========== Running Test with routine <bound method TestShardedCache.routine_cache_helper of <__main__.TestShardedCache object at 0x7f112ab43e10>> {'test_cache': 'KnownLocalCachedEmbedding', 'cache_ratio': 0.1, 'kForwardItersPerStep': 1, 'BackwardMode': 'CppAsync', 'L': 10, 'nr_background_threads': 32}==========
INFO [2924616 test_emb.py:115] Worker 0 pid=2924975
INFO [2924616 test_emb.py:115] Worker 1 pid=2924976
INFO [2924975 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [2924975 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [2924976 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [2924976 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
WARNING: Logging before InitGoogleLogging() is written to STDERR
E20240103 22:07:27.273937 2924975 IPCTensor.h:329] IPCTensor full_emb already exists
WARNING: Logging before InitGoogleLogging() is written to STDERR
E20240103 22:07:27.274029 2924976 IPCTensor.h:329] IPCTensor full_emb already exists
INFO [2924976 test_emb.py:128] emb.data_ptr=0x100000002000
INFO [2924975 test_emb.py:128] emb.data_ptr=0x100000002000
rank 0 start initing emb
  0%|          | 0/10000 [00:00<?, ?it/s] 62%|██████▏   | 6188/10000 [00:00<00:00, 61870.32it/s]100%|██████████| 10000/10000 [00:00<00:00, 62320.00it/s]
E20240103 22:07:28.889832 2924976 IPCTensor.h:367] Called NewIPCGPUTensor: embedding_cache_1 [1000, 3] 1
W20240103 22:07:28.889870 2924976 IPCTensor.h:389] NewIPCGPUTensor: embedding_cache_1 [1000, 3] 1
E20240103 22:07:28.889909 2924975 IPCTensor.h:367] Called NewIPCGPUTensor: embedding_cache_0 [1000, 3] 0
W20240103 22:07:28.889947 2924975 IPCTensor.h:389] NewIPCGPUTensor: embedding_cache_0 [1000, 3] 0
W20240103 22:07:28.890017 2924976 IPCTensor.h:350] NewIPCTensor: input_keys_1 [100000]0x1000000400a0
W20240103 22:07:28.890084 2924975 IPCTensor.h:350] NewIPCTensor: input_keys_0 [100000]0x1000001050a0
W20240103 22:07:28.890089 2924976 IPCTensor.h:350] NewIPCTensor: input_keys_neg_1 [100000]0x1000001ca0a0
E20240103 22:07:28.890123 2924976 IPCTensor.h:367] Called NewIPCGPUTensor: backward_grads_1 [100000, 3] 1
W20240103 22:07:28.890129 2924976 IPCTensor.h:389] NewIPCGPUTensor: backward_grads_1 [100000, 3] 1
W20240103 22:07:28.890152 2924975 IPCTensor.h:350] NewIPCTensor: input_keys_neg_0 [100000]0x1000002900f0
E20240103 22:07:28.890172 2924976 IPCTensor.h:367] Called NewIPCGPUTensor: backward_grads_neg_1 [100000, 3] 1
W20240103 22:07:28.890178 2924976 IPCTensor.h:389] NewIPCGPUTensor: backward_grads_neg_1 [100000, 3] 1
E20240103 22:07:28.890187 2924975 IPCTensor.h:367] Called NewIPCGPUTensor: backward_grads_0 [100000, 3] 0
W20240103 22:07:28.890193 2924975 IPCTensor.h:389] NewIPCGPUTensor: backward_grads_0 [100000, 3] 0
E20240103 22:07:28.890239 2924975 IPCTensor.h:367] Called NewIPCGPUTensor: backward_grads_neg_0 [100000, 3] 0
W20240103 22:07:28.890246 2924975 IPCTensor.h:389] NewIPCGPUTensor: backward_grads_neg_0 [100000, 3] 0
weight.shape torch.Size([20000, 3])
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240103 22:07:28.893908 2924976 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000003581e0
------------json------------
{
            "num_gpus": 2,
            "L": 10,
            "kForwardItersPerStep": 1,
            "clr": 2,
            "BackwardMode": "CppAsync",
            "nr_background_threads": 32
        }
weight.shape torch.Size([20000, 3])
New CachedEmbedding, name=full_emb, shape=(20000, 3), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1000), (1000, 2000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240103 22:07:28.894160 2924975 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_0 [100000]0x10000041d1e0
W20240103 22:07:28.894239 2924975 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000005a71e0
W20240103 22:07:28.894279 2924975 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000066c1e0
W20240103 22:07:28.894316 2924975 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_3 [100000]0x1000007311e0
W20240103 22:07:28.894349 2924975 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_4 [100000]0x1000007f61e0
W20240103 22:07:28.894385 2924975 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000008bb1e0
W20240103 22:07:28.894419 2924975 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000009801e0
W20240103 22:07:28.894457 2924975 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000a451e0
W20240103 22:07:28.894495 2924975 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_8 [100000]0x100000b0a1e0
W20240103 22:07:28.894529 2924975 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_9 [100000]0x100000bcf1e0
W20240103 22:07:28.894565 2924975 IPCTensor.h:350] NewIPCTensor: step_r0 [10]0x100000c941e0
W20240103 22:07:28.894600 2924975 IPCTensor.h:350] NewIPCTensor: circle_buffer_end_r0 [1]0x100000c961e0
W20240103 22:07:28.894629 2924975 IPCTensor.h:350] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100000c981e0
W20240103 22:07:28.894173 2924976 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_1 [100000]0x1000004e21e0
W20240103 22:07:28.894850 2924976 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000c9a1e0
W20240103 22:07:28.894975 2924976 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000d5f1e0
W20240103 22:07:28.895099 2924976 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000e241e0
W20240103 22:07:28.895222 2924976 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000ee91e0
W20240103 22:07:28.895346 2924976 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000fae1e0
W20240103 22:07:28.895473 2924976 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_7 [100000]0x1000010731e0
W20240103 22:07:28.895608 2924976 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_8 [100000]0x1000011381e0
W20240103 22:07:28.895735 2924976 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_9 [100000]0x1000011fd1e0
W20240103 22:07:28.895889 2924976 IPCTensor.h:350] NewIPCTensor: step_r1 [10]0x1000012c21e0
W20240103 22:07:28.896014 2924976 IPCTensor.h:350] NewIPCTensor: circle_buffer_end_r1 [1]0x1000012c41e0
W20240103 22:07:28.896132 2924976 IPCTensor.h:350] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000012c61e0
W20240103 22:07:28.896731 2924975 kg_controller.cc:62] KGCacheController, config={
            "num_gpus": 2,
            "L": 10,
            "kForwardItersPerStep": 1,
            "clr": 2,
            "BackwardMode": "CppAsync",
            "nr_background_threads": 32
        }
W20240103 22:07:28.896926 2924975 kg_controller.cc:159] Init GradProcessingBase done
W20240103 22:07:28.901196 2924975 kg_controller.cc:816] after init GradAsyncProcessing
W20240103 22:07:30.382720 2925451 kg_controller.cc:585] Detect new sample comes, old_end0, new_end1
  0%|          | 0/1000 [00:00<?, ?it/s]========== Step 0 ========== 
  0%|          | 0/1000 [00:00<?, ?it/s]========== Step 0 ========== 
  0%|          | 1/1000 [00:01<24:02,  1.44s/it]  0%|          | 1/1000 [00:01<23:51,  1.43s/it]========== Step 1 ========== 
========== Step 1 ========== 
W20240103 22:07:32.004030 2925451 kg_controller.cc:585] Detect new sample comes, old_end1, new_end2
INFO [2924975 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [2924976 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
========== Step 2 ========== 
  0%|          | 3/1000 [00:01<06:53,  2.41it/s]========== Step 3 ========== 
  0%|          | 3/1000 [00:01<06:50,  2.43it/s]========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
W20240103 22:07:32.213164 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=5, pq.top=5
  0%|          | 5/1000 [00:01<03:49,  4.33it/s]========== Step 5 ========== 
  0%|          | 5/1000 [00:01<03:48,  4.36it/s]========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
  1%|          | 7/1000 [00:01<02:43,  6.06it/s]========== Step 7 ========== 
  1%|          | 7/1000 [00:01<02:42,  6.09it/s]========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
  1%|          | 9/1000 [00:01<02:13,  7.43it/s]========== Step 9 ========== 
  1%|          | 9/1000 [00:01<02:12,  7.45it/s]========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
  1%|          | 11/1000 [00:02<01:58,  8.36it/s]========== Step 11 ========== 
  1%|          | 11/1000 [00:02<01:58,  8.38it/s]========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
  1%|▏         | 13/1000 [00:02<01:51,  8.86it/s]  1%|▏         | 13/1000 [00:02<01:51,  8.88it/s]========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240103 22:07:33.031427 2925451 kg_controller.cc:585] Detect new sample comes, old_end4, new_end5
  2%|▏         | 15/1000 [00:02<01:47,  9.15it/s]========== Step 15 ========== 
  2%|▏         | 15/1000 [00:02<01:47,  9.16it/s]========== Step 15 ========== 
W20240103 22:07:33.213006 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=16, pq.top=16
========== Step 16 ========== 
========== Step 16 ========== 
  2%|▏         | 17/1000 [00:02<01:46,  9.27it/s]========== Step 17 ========== 
  2%|▏         | 17/1000 [00:02<01:45,  9.28it/s]========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
  2%|▏         | 19/1000 [00:02<01:46,  9.24it/s]========== Step 19 ========== 
  2%|▏         | 19/1000 [00:02<01:46,  9.25it/s]========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
  2%|▏         | 21/1000 [00:03<01:46,  9.16it/s]========== Step 21 ========== 
  2%|▏         | 21/1000 [00:03<01:46,  9.16it/s]========== Step 21 ========== 
  2%|▏         | 22/1000 [00:03<01:47,  9.09it/s]========== Step 22 ========== 
  2%|▏         | 22/1000 [00:03<01:47,  9.09it/s]========== Step 22 ========== 
  2%|▏         | 23/1000 [00:03<01:48,  9.00it/s]========== Step 23 ========== 
  2%|▏         | 23/1000 [00:03<01:48,  9.00it/s]========== Step 23 ========== 
  2%|▏         | 24/1000 [00:03<01:49,  8.94it/s]========== Step 24 ========== 
  2%|▏         | 24/1000 [00:03<01:49,  8.95it/s]W20240103 22:07:34.125609 2925451 kg_controller.cc:585] Detect new sample comes, old_end4, new_end5
========== Step 24 ========== 
W20240103 22:07:34.213002 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=25, pq.top=25
  2%|▎         | 25/1000 [00:03<01:49,  8.91it/s]========== Step 25 ========== 
  2%|▎         | 25/1000 [00:03<01:49,  8.91it/s]========== Step 25 ========== 
  3%|▎         | 26/1000 [00:03<01:50,  8.82it/s]========== Step 26 ========== 
  3%|▎         | 26/1000 [00:03<01:50,  8.83it/s]========== Step 26 ========== 
  3%|▎         | 27/1000 [00:03<01:51,  8.75it/s]========== Step 27 ========== 
  3%|▎         | 27/1000 [00:03<01:51,  8.75it/s]========== Step 27 ========== 
  3%|▎         | 28/1000 [00:04<01:51,  8.68it/s]========== Step 28 ========== 
  3%|▎         | 28/1000 [00:04<01:51,  8.68it/s]========== Step 28 ========== 
  3%|▎         | 29/1000 [00:04<01:52,  8.63it/s]========== Step 29 ========== 
  3%|▎         | 29/1000 [00:04<01:52,  8.63it/s]========== Step 29 ========== 
  3%|▎         | 30/1000 [00:04<01:53,  8.55it/s]========== Step 30 ========== 
  3%|▎         | 30/1000 [00:04<01:53,  8.55it/s]========== Step 30 ========== 
  3%|▎         | 31/1000 [00:04<01:54,  8.48it/s]========== Step 31 ========== 
  3%|▎         | 31/1000 [00:04<01:54,  8.48it/s]========== Step 31 ========== 
  3%|▎         | 32/1000 [00:04<01:55,  8.36it/s]========== Step 32 ========== 
  3%|▎         | 32/1000 [00:04<01:55,  8.36it/s]========== Step 32 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | Mean                      | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBackwardAsync      | 20.459 ms                 | 23.119 ms                 |
+---------------------------+---------------------------+---------------------------+
  3%|▎         | 33/1000 [00:04<01:56,  8.31it/s]========== Step 33 ========== 
  3%|▎         | 33/1000 [00:04<01:56,  8.31it/s]========== Step 33 ========== 
W20240103 22:07:35.193528 2925451 kg_controller.cc:585] Detect new sample comes, old_end3, new_end4
W20240103 22:07:35.252363 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=34, pq.top=34
  3%|▎         | 34/1000 [00:04<01:55,  8.33it/s]  3%|▎         | 34/1000 [00:04<01:55,  8.33it/s]========== Step 34 ========== 
========== Step 34 ========== 
  4%|▎         | 35/1000 [00:04<01:57,  8.23it/s]  4%|▎         | 35/1000 [00:04<01:57,  8.23it/s]========== Step 35 ========== 
========== Step 35 ========== 
  4%|▎         | 36/1000 [00:04<01:57,  8.23it/s]========== Step 36 ========== 
  4%|▎         | 36/1000 [00:04<01:57,  8.23it/s]========== Step 36 ========== 
  4%|▎         | 37/1000 [00:05<01:57,  8.21it/s]========== Step 37 ========== 
  4%|▎         | 37/1000 [00:05<01:57,  8.21it/s]========== Step 37 ========== 
  4%|▍         | 38/1000 [00:05<01:58,  8.11it/s]========== Step 38 ========== 
  4%|▍         | 38/1000 [00:05<01:58,  8.11it/s]========== Step 38 ========== 
  4%|▍         | 39/1000 [00:05<01:59,  8.06it/s]========== Step 39 ========== 
  4%|▍         | 39/1000 [00:05<01:59,  8.06it/s]========== Step 39 ========== 
  4%|▍         | 40/1000 [00:05<01:58,  8.13it/s]========== Step 40 ========== 
  4%|▍         | 40/1000 [00:05<01:58,  8.13it/s]========== Step 40 ========== 
  4%|▍         | 41/1000 [00:05<01:57,  8.13it/s]========== Step 41 ========== 
  4%|▍         | 41/1000 [00:05<01:57,  8.13it/s]========== Step 41 ========== 
W20240103 22:07:36.252007 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=42, pq.top=42
  4%|▍         | 42/1000 [00:05<01:57,  8.13it/s]========== Step 42 ========== 
  4%|▍         | 42/1000 [00:05<01:57,  8.13it/s]========== Step 42 ========== 
W20240103 22:07:36.300958 2925451 kg_controller.cc:585] Detect new sample comes, old_end2, new_end3
  4%|▍         | 43/1000 [00:05<02:05,  7.60it/s]========== Step 43 ========== 
  4%|▍         | 43/1000 [00:05<02:05,  7.60it/s]========== Step 43 ========== 
  4%|▍         | 44/1000 [00:06<02:14,  7.09it/s]========== Step 44 ========== 
  4%|▍         | 44/1000 [00:06<02:14,  7.08it/s]========== Step 44 ========== 
  4%|▍         | 45/1000 [00:06<02:19,  6.87it/s]========== Step 45 ========== 
  4%|▍         | 45/1000 [00:06<02:19,  6.87it/s]========== Step 45 ========== 
  5%|▍         | 46/1000 [00:06<02:22,  6.70it/s]  5%|▍         | 46/1000 [00:06<02:22,  6.70it/s]========== Step 46 ========== 
========== Step 46 ========== 
  5%|▍         | 47/1000 [00:06<02:24,  6.61it/s]========== Step 47 ========== 
  5%|▍         | 47/1000 [00:06<02:24,  6.61it/s]========== Step 47 ========== 
  5%|▍         | 48/1000 [00:06<02:27,  6.47it/s]========== Step 48 ========== 
  5%|▍         | 48/1000 [00:06<02:27,  6.47it/s]========== Step 48 ========== 
W20240103 22:07:37.311065 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=49, pq.top=49
  5%|▍         | 49/1000 [00:06<02:27,  6.45it/s]========== Step 49 ========== 
  5%|▍         | 49/1000 [00:06<02:27,  6.45it/s]========== Step 49 ========== 
W20240103 22:07:37.403687 2925451 kg_controller.cc:585] Detect new sample comes, old_end9, new_end0
  5%|▌         | 50/1000 [00:07<02:27,  6.43it/s]========== Step 50 ========== 
  5%|▌         | 50/1000 [00:06<02:27,  6.43it/s]========== Step 50 ========== 
  5%|▌         | 51/1000 [00:07<02:27,  6.43it/s]========== Step 51 ========== 
  5%|▌         | 51/1000 [00:07<02:27,  6.43it/s]========== Step 51 ========== 
  5%|▌         | 52/1000 [00:07<02:27,  6.43it/s]========== Step 52 ========== 
  5%|▌         | 52/1000 [00:07<02:27,  6.43it/s]========== Step 52 ========== 
  5%|▌         | 53/1000 [00:07<02:27,  6.42it/s]========== Step 53 ========== 
  5%|▌         | 53/1000 [00:07<02:27,  6.42it/s]========== Step 53 ========== 
  5%|▌         | 54/1000 [00:07<02:27,  6.43it/s]========== Step 54 ========== 
  5%|▌         | 54/1000 [00:07<02:27,  6.43it/s]========== Step 54 ========== 
W20240103 22:07:38.311005 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=55, pq.top=55
  6%|▌         | 55/1000 [00:07<02:23,  6.58it/s]========== Step 55 ========== 
  6%|▌         | 55/1000 [00:07<02:23,  6.58it/s]========== Step 55 ========== 
  6%|▌         | 56/1000 [00:07<02:15,  6.95it/s]========== Step 56 ========== 
  6%|▌         | 56/1000 [00:07<02:15,  6.95it/s]========== Step 56 ========== 
W20240103 22:07:38.451773 2925451 kg_controller.cc:585] Detect new sample comes, old_end6, new_end7
  6%|▌         | 57/1000 [00:08<02:10,  7.24it/s]========== Step 57 ========== 
  6%|▌         | 57/1000 [00:08<02:10,  7.24it/s]========== Step 57 ========== 
  6%|▌         | 58/1000 [00:08<02:06,  7.47it/s]========== Step 58 ========== 
  6%|▌         | 58/1000 [00:08<02:06,  7.47it/s]========== Step 58 ========== 
  6%|▌         | 59/1000 [00:08<02:02,  7.67it/s]========== Step 59 ========== 
  6%|▌         | 59/1000 [00:08<02:02,  7.67it/s]========== Step 59 ========== 
  6%|▌         | 60/1000 [00:08<02:00,  7.79it/s]========== Step 60 ========== 
  6%|▌         | 60/1000 [00:08<02:00,  7.79it/s]========== Step 60 ========== 
  6%|▌         | 61/1000 [00:08<02:03,  7.59it/s]========== Step 61 ========== 
  6%|▌         | 61/1000 [00:08<02:03,  7.59it/s]========== Step 61 ========== 
  6%|▌         | 62/1000 [00:08<02:02,  7.67it/s]  6%|▌         | 62/1000 [00:08<02:02,  7.67it/s]========== Step 62 ========== 
========== Step 62 ========== 
W20240103 22:07:39.311007 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=63, pq.top=63
  6%|▋         | 63/1000 [00:08<02:00,  7.79it/s]========== Step 63 ========== 
  6%|▋         | 63/1000 [00:08<02:00,  7.79it/s]========== Step 63 ========== 
  6%|▋         | 64/1000 [00:08<01:58,  7.88it/s]========== Step 64 ========== 
  6%|▋         | 64/1000 [00:08<01:58,  7.88it/s]========== Step 64 ========== 
W20240103 22:07:39.460158 2925451 kg_controller.cc:585] Detect new sample comes, old_end4, new_end5
  6%|▋         | 65/1000 [00:09<01:57,  7.95it/s]========== Step 65 ========== 
  6%|▋         | 65/1000 [00:09<01:57,  7.95it/s]========== Step 65 ========== 
  7%|▋         | 66/1000 [00:09<01:57,  7.92it/s]========== Step 66 ========== 
  7%|▋         | 66/1000 [00:09<01:57,  7.92it/s]========== Step 66 ========== 
  7%|▋         | 67/1000 [00:09<02:02,  7.61it/s]========== Step 67 ========== 
  7%|▋         | 67/1000 [00:09<02:02,  7.61it/s]========== Step 67 ========== 
  7%|▋         | 68/1000 [00:09<02:01,  7.67it/s]  7%|▋         | 68/1000 [00:09<02:01,  7.66it/s]========== Step 68 ========== 
========== Step 68 ========== 
  7%|▋         | 69/1000 [00:09<01:59,  7.79it/s]========== Step 69 ========== 
  7%|▋         | 69/1000 [00:09<01:59,  7.79it/s]========== Step 69 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | Mean                      | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBackwardAsync      | 21.406 ms                 | 25.976 ms                 |
+---------------------------+---------------------------+---------------------------+
  7%|▋         | 70/1000 [00:09<01:58,  7.86it/s]========== Step 70 ========== 
  7%|▋         | 70/1000 [00:09<01:58,  7.86it/s]========== Step 70 ========== 
W20240103 22:07:40.311009 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=71, pq.top=71
  7%|▋         | 71/1000 [00:09<01:57,  7.88it/s]========== Step 71 ========== 
  7%|▋         | 71/1000 [00:09<01:57,  7.88it/s]========== Step 71 ========== 
  7%|▋         | 72/1000 [00:09<01:59,  7.80it/s]========== Step 72 ========== 
  7%|▋         | 72/1000 [00:09<01:59,  7.80it/s]========== Step 72 ========== 
W20240103 22:07:40.489082 2925451 kg_controller.cc:585] Detect new sample comes, old_end2, new_end3
  7%|▋         | 73/1000 [00:10<02:02,  7.56it/s]  7%|▋         | 73/1000 [00:10<02:02,  7.57it/s]========== Step 73 ========== 
========== Step 73 ========== 
  7%|▋         | 74/1000 [00:10<02:03,  7.51it/s]  7%|▋         | 74/1000 [00:10<02:03,  7.51it/s]========== Step 74 ========== 
========== Step 74 ========== 
  8%|▊         | 75/1000 [00:10<02:02,  7.56it/s]========== Step 75 ========== 
  8%|▊         | 75/1000 [00:10<02:02,  7.56it/s]========== Step 75 ========== 
  8%|▊         | 76/1000 [00:10<02:01,  7.61it/s]========== Step 76 ========== 
  8%|▊         | 76/1000 [00:10<02:01,  7.60it/s]========== Step 76 ========== 
  8%|▊         | 77/1000 [00:10<02:01,  7.57it/s]========== Step 77 ========== 
  8%|▊         | 77/1000 [00:10<02:01,  7.57it/s]========== Step 77 ========== 
  8%|▊         | 78/1000 [00:10<02:00,  7.67it/s]========== Step 78 ========== 
  8%|▊         | 78/1000 [00:10<02:00,  7.67it/s]========== Step 78 ========== 
W20240103 22:07:41.342885 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=79, pq.top=79
  8%|▊         | 79/1000 [00:10<01:59,  7.74it/s]========== Step 79 ========== 
  8%|▊         | 79/1000 [00:10<01:59,  7.74it/s]========== Step 79 ========== 
  8%|▊         | 80/1000 [00:10<01:58,  7.74it/s]========== Step 80 ========== 
  8%|▊         | 80/1000 [00:10<01:58,  7.74it/s]========== Step 80 ========== 
W20240103 22:07:41.540688 2925451 kg_controller.cc:585] Detect new sample comes, old_end0, new_end1
  8%|▊         | 81/1000 [00:11<01:57,  7.81it/s]========== Step 81 ========== 
  8%|▊         | 81/1000 [00:11<01:57,  7.81it/s]========== Step 81 ========== 
  8%|▊         | 82/1000 [00:11<01:56,  7.86it/s]========== Step 82 ========== 
  8%|▊         | 82/1000 [00:11<01:56,  7.86it/s]========== Step 82 ========== 
  8%|▊         | 83/1000 [00:11<01:57,  7.80it/s]========== Step 83 ========== 
  8%|▊         | 83/1000 [00:11<01:57,  7.80it/s]========== Step 83 ========== 
  8%|▊         | 84/1000 [00:11<01:56,  7.86it/s]========== Step 84 ========== 
  8%|▊         | 84/1000 [00:11<01:56,  7.86it/s]========== Step 84 ========== 
  8%|▊         | 85/1000 [00:11<01:56,  7.83it/s]========== Step 85 ========== 
  8%|▊         | 85/1000 [00:11<01:56,  7.83it/s]========== Step 85 ========== 
  9%|▊         | 86/1000 [00:11<01:59,  7.67it/s]========== Step 86 ========== 
  9%|▊         | 86/1000 [00:11<01:59,  7.67it/s]========== Step 86 ========== 
W20240103 22:07:42.370488 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=87, pq.top=87
  9%|▊         | 87/1000 [00:11<01:58,  7.70it/s]========== Step 87 ========== 
  9%|▊         | 87/1000 [00:11<01:58,  7.70it/s]========== Step 87 ========== 
  9%|▉         | 88/1000 [00:12<01:57,  7.76it/s]========== Step 88 ========== 
  9%|▉         | 88/1000 [00:11<01:57,  7.76it/s]========== Step 88 ========== 
W20240103 22:07:42.567354 2925451 kg_controller.cc:585] Detect new sample comes, old_end8, new_end9
  9%|▉         | 89/1000 [00:12<01:57,  7.73it/s]========== Step 89 ========== 
  9%|▉         | 89/1000 [00:12<01:57,  7.72it/s]========== Step 89 ========== 
  9%|▉         | 90/1000 [00:12<01:57,  7.75it/s]  9%|▉         | 90/1000 [00:12<01:57,  7.75it/s]========== Step 90 ========== 
========== Step 90 ========== 
  9%|▉         | 91/1000 [00:12<01:59,  7.61it/s]========== Step 91 ========== 
  9%|▉         | 91/1000 [00:12<01:59,  7.60it/s]========== Step 91 ========== 
  9%|▉         | 92/1000 [00:12<01:59,  7.61it/s]  9%|▉         | 92/1000 [00:12<01:59,  7.61it/s]========== Step 92 ========== 
========== Step 92 ========== 
  9%|▉         | 93/1000 [00:12<01:56,  7.78it/s]========== Step 93 ========== 
  9%|▉         | 93/1000 [00:12<01:56,  7.78it/s]========== Step 93 ========== 
  9%|▉         | 94/1000 [00:12<01:55,  7.87it/s]========== Step 94 ========== 
  9%|▉         | 94/1000 [00:12<01:55,  7.87it/s]========== Step 94 ========== 
W20240103 22:07:43.398398 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=95, pq.top=95
 10%|▉         | 95/1000 [00:12<01:55,  7.81it/s]========== Step 95 ========== 
 10%|▉         | 95/1000 [00:12<01:55,  7.81it/s]========== Step 95 ========== 
 10%|▉         | 96/1000 [00:13<01:54,  7.88it/s]========== Step 96 ========== 
 10%|▉         | 96/1000 [00:13<01:54,  7.87it/s]========== Step 96 ========== 
W20240103 22:07:43.594857 2925451 kg_controller.cc:585] Detect new sample comes, old_end6, new_end7
 10%|▉         | 97/1000 [00:13<01:54,  7.92it/s]========== Step 97 ========== 
 10%|▉         | 97/1000 [00:13<01:53,  7.92it/s]========== Step 97 ========== 
 10%|▉         | 98/1000 [00:13<01:52,  7.99it/s]========== Step 98 ========== 
 10%|▉         | 98/1000 [00:13<01:52,  7.99it/s]========== Step 98 ========== 
 10%|▉         | 99/1000 [00:13<01:52,  8.01it/s]========== Step 99 ========== 
 10%|▉         | 99/1000 [00:13<01:52,  8.01it/s]========== Step 99 ========== 
ERROR [2924975 utils.py:53] Timer: Rank0
BlockToStepN: 62.415 ms
AfterBackward: 31.097 ms
Forward: 221.283 us
Backward: 3.910 ms
Optimize: 212.741 us

 10%|█         | 100/1000 [00:13<01:51,  8.04it/s]========== Step 100 ========== 
ERROR [2924976 utils.py:53] Timer: Rank1
BlockToStepN: 62.353 ms
AfterBackward: 26.186 ms
Forward: 563.452 us
Backward: 4.095 ms
Optimize: 423.472 us

 10%|█         | 100/1000 [00:13<01:52,  8.03it/s]========== Step 100 ========== 
 10%|█         | 101/1000 [00:13<01:51,  8.06it/s]========== Step 101 ========== 
 10%|█         | 101/1000 [00:13<01:51,  8.06it/s]========== Step 101 ========== 
 10%|█         | 102/1000 [00:13<01:51,  8.05it/s]========== Step 102 ========== 
 10%|█         | 102/1000 [00:13<01:51,  8.05it/s]========== Step 102 ========== 
W20240103 22:07:44.398007 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=103, pq.top=103
 10%|█         | 103/1000 [00:13<01:52,  8.00it/s]========== Step 103 ========== 
 10%|█         | 103/1000 [00:13<01:52,  8.00it/s]========== Step 103 ========== 
 10%|█         | 104/1000 [00:14<01:52,  7.98it/s]========== Step 104 ========== 
 10%|█         | 104/1000 [00:14<01:52,  7.98it/s]========== Step 104 ========== 
W20240103 22:07:44.600781 2925451 kg_controller.cc:585] Detect new sample comes, old_end4, new_end5
 10%|█         | 105/1000 [00:14<01:52,  7.95it/s]========== Step 105 ========== 
 10%|█         | 105/1000 [00:14<01:52,  7.95it/s]========== Step 105 ========== 
 11%|█         | 106/1000 [00:14<01:52,  7.95it/s]========== Step 106 ========== 
 11%|█         | 106/1000 [00:14<01:52,  7.95it/s]========== Step 106 ========== 
 11%|█         | 107/1000 [00:14<01:52,  7.96it/s]========== Step 107 ========== 
 11%|█         | 107/1000 [00:14<01:52,  7.96it/s]========== Step 107 ========== 
 11%|█         | 108/1000 [00:14<01:51,  7.98it/s]========== Step 108 ========== 
 11%|█         | 108/1000 [00:14<01:51,  7.98it/s]========== Step 108 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | Mean                      | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBackwardAsync      | 21.488 ms                 | 26.530 ms                 |
+---------------------------+---------------------------+---------------------------+
 11%|█         | 109/1000 [00:14<01:51,  7.96it/s]========== Step 109 ========== 
 11%|█         | 109/1000 [00:14<01:51,  7.96it/s]========== Step 109 ========== 
 11%|█         | 110/1000 [00:14<01:51,  7.95it/s]========== Step 110 ========== 
 11%|█         | 110/1000 [00:14<01:51,  7.95it/s]========== Step 110 ========== 
W20240103 22:07:45.403491 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=111, pq.top=111
 11%|█         | 111/1000 [00:14<01:52,  7.92it/s]========== Step 111 ========== 
 11%|█         | 111/1000 [00:14<01:52,  7.92it/s]========== Step 111 ========== 
 11%|█         | 112/1000 [00:15<01:51,  7.93it/s]========== Step 112 ========== 
 11%|█         | 112/1000 [00:15<01:52,  7.93it/s]========== Step 112 ========== 
W20240103 22:07:45.609019 2925451 kg_controller.cc:585] Detect new sample comes, old_end2, new_end3
 11%|█▏        | 113/1000 [00:15<01:52,  7.90it/s]========== Step 113 ========== 
 11%|█▏        | 113/1000 [00:15<01:52,  7.90it/s]========== Step 113 ========== 
 11%|█▏        | 114/1000 [00:15<01:51,  7.94it/s]========== Step 114 ========== 
 11%|█▏        | 114/1000 [00:15<01:51,  7.94it/s]========== Step 114 ========== 
 12%|█▏        | 115/1000 [00:15<01:51,  7.92it/s]========== Step 115 ========== 
 12%|█▏        | 115/1000 [00:15<01:51,  7.92it/s]========== Step 115 ========== 
 12%|█▏        | 116/1000 [00:15<01:51,  7.91it/s]========== Step 116 ========== 
 12%|█▏        | 116/1000 [00:15<01:51,  7.92it/s]========== Step 116 ========== 
 12%|█▏        | 117/1000 [00:15<01:51,  7.92it/s]========== Step 117 ========== 
 12%|█▏        | 117/1000 [00:15<01:51,  7.92it/s]========== Step 117 ========== 
 12%|█▏        | 118/1000 [00:15<01:51,  7.90it/s]========== Step 118 ========== 
 12%|█▏        | 118/1000 [00:15<01:51,  7.91it/s]========== Step 118 ========== 
W20240103 22:07:46.417863 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=119, pq.top=119
 12%|█▏        | 119/1000 [00:15<01:52,  7.85it/s]========== Step 119 ========== 
 12%|█▏        | 119/1000 [00:15<01:52,  7.84it/s]========== Step 119 ========== 
 12%|█▏        | 120/1000 [00:16<01:51,  7.86it/s]========== Step 120 ========== 
 12%|█▏        | 120/1000 [00:16<01:51,  7.86it/s]========== Step 120 ========== 
W20240103 22:07:46.613719 2925451 kg_controller.cc:585] Detect new sample comes, old_end0, new_end1
 12%|█▏        | 121/1000 [00:16<01:51,  7.87it/s]========== Step 121 ========== 
 12%|█▏        | 121/1000 [00:16<01:51,  7.87it/s]========== Step 121 ========== 
 12%|█▏        | 122/1000 [00:16<01:53,  7.74it/s]========== Step 122 ========== 
 12%|█▏        | 122/1000 [00:16<01:53,  7.74it/s]========== Step 122 ========== 
 12%|█▏        | 123/1000 [00:16<01:52,  7.81it/s]========== Step 123 ========== 
 12%|█▏        | 123/1000 [00:16<01:52,  7.81it/s]========== Step 123 ========== 
 12%|█▏        | 124/1000 [00:16<01:52,  7.82it/s]========== Step 124 ========== 
 12%|█▏        | 124/1000 [00:16<01:52,  7.82it/s]========== Step 124 ========== 
 12%|█▎        | 125/1000 [00:16<01:51,  7.85it/s]========== Step 125 ========== 
 12%|█▎        | 125/1000 [00:16<01:51,  7.85it/s]========== Step 125 ========== 
 13%|█▎        | 126/1000 [00:16<01:51,  7.87it/s]========== Step 126 ========== 
 13%|█▎        | 126/1000 [00:16<01:51,  7.87it/s]========== Step 126 ========== 
W20240103 22:07:47.438887 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=127, pq.top=127
 13%|█▎        | 127/1000 [00:16<01:51,  7.83it/s]========== Step 127 ========== 
 13%|█▎        | 127/1000 [00:16<01:51,  7.83it/s]========== Step 127 ========== 
 13%|█▎        | 128/1000 [00:17<01:51,  7.83it/s]========== Step 128 ========== 
 13%|█▎        | 128/1000 [00:17<01:51,  7.83it/s]W20240103 22:07:47.637323 2925451 kg_controller.cc:585] Detect new sample comes, old_end8, new_end9
========== Step 128 ========== 
 13%|█▎        | 129/1000 [00:17<01:51,  7.79it/s]========== Step 129 ========== 
 13%|█▎        | 129/1000 [00:17<01:51,  7.79it/s]========== Step 129 ========== 
 13%|█▎        | 130/1000 [00:17<01:51,  7.81it/s]========== Step 130 ========== 
 13%|█▎        | 130/1000 [00:17<01:51,  7.81it/s]========== Step 130 ========== 
 13%|█▎        | 131/1000 [00:17<01:50,  7.84it/s]========== Step 131 ========== 
 13%|█▎        | 131/1000 [00:17<01:50,  7.84it/s]========== Step 131 ========== 
 13%|█▎        | 132/1000 [00:17<01:51,  7.81it/s]========== Step 132 ========== 
 13%|█▎        | 132/1000 [00:17<01:51,  7.81it/s]========== Step 132 ========== 
 13%|█▎        | 133/1000 [00:17<01:51,  7.81it/s]========== Step 133 ========== 
 13%|█▎        | 133/1000 [00:17<01:51,  7.81it/s]========== Step 133 ========== 
 13%|█▎        | 134/1000 [00:17<01:50,  7.84it/s]========== Step 134 ========== 
 13%|█▎        | 134/1000 [00:17<01:50,  7.84it/s]========== Step 134 ========== 
W20240103 22:07:48.463073 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=135, pq.top=135
 14%|█▎        | 135/1000 [00:17<01:50,  7.83it/s]========== Step 135 ========== 
 14%|█▎        | 135/1000 [00:17<01:50,  7.83it/s]========== Step 135 ========== 
 14%|█▎        | 136/1000 [00:18<01:50,  7.85it/s]========== Step 136 ========== 
 14%|█▎        | 136/1000 [00:18<01:50,  7.85it/s]========== Step 136 ========== 
W20240103 22:07:48.659212 2925451 kg_controller.cc:585] Detect new sample comes, old_end6, new_end7
 14%|█▎        | 137/1000 [00:18<01:49,  7.87it/s]========== Step 137 ========== 
 14%|█▎        | 137/1000 [00:18<01:49,  7.87it/s]========== Step 137 ========== 
 14%|█▍        | 138/1000 [00:18<01:50,  7.83it/s]========== Step 138 ========== 
 14%|█▍        | 138/1000 [00:18<01:50,  7.84it/s]========== Step 138 ========== 
 14%|█▍        | 139/1000 [00:18<01:49,  7.87it/s]========== Step 139 ========== 
 14%|█▍        | 139/1000 [00:18<01:49,  7.87it/s]========== Step 139 ========== 
 14%|█▍        | 140/1000 [00:18<01:48,  7.91it/s]========== Step 140 ========== 
 14%|█▍        | 140/1000 [00:18<01:48,  7.91it/s]========== Step 140 ========== 
 14%|█▍        | 141/1000 [00:18<01:49,  7.88it/s]========== Step 141 ========== 
 14%|█▍        | 141/1000 [00:18<01:49,  7.87it/s]========== Step 141 ========== 
 14%|█▍        | 142/1000 [00:18<01:48,  7.87it/s]========== Step 142 ========== 
 14%|█▍        | 142/1000 [00:18<01:48,  7.87it/s]========== Step 142 ========== 
W20240103 22:07:49.478667 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=143, pq.top=143
 14%|█▍        | 143/1000 [00:18<01:49,  7.85it/s]========== Step 143 ========== 
 14%|█▍        | 143/1000 [00:18<01:49,  7.85it/s]========== Step 143 ========== 
 14%|█▍        | 144/1000 [00:19<01:48,  7.87it/s]========== Step 144 ========== 
 14%|█▍        | 144/1000 [00:19<01:48,  7.87it/s]========== Step 144 ========== 
W20240103 22:07:49.674827 2925451 kg_controller.cc:585] Detect new sample comes, old_end4, new_end5
 14%|█▍        | 145/1000 [00:19<01:48,  7.89it/s]========== Step 145 ========== 
 14%|█▍        | 145/1000 [00:19<01:48,  7.89it/s]========== Step 145 ========== 
 15%|█▍        | 146/1000 [00:19<01:48,  7.90it/s]========== Step 146 ========== 
 15%|█▍        | 146/1000 [00:19<01:48,  7.90it/s]========== Step 146 ========== 
 15%|█▍        | 147/1000 [00:19<01:48,  7.89it/s]========== Step 147 ========== 
 15%|█▍        | 147/1000 [00:19<01:48,  7.89it/s]========== Step 147 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | Mean                      | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBackwardAsync      | 21.662 ms                 | 26.530 ms                 |
+---------------------------+---------------------------+---------------------------+
 15%|█▍        | 148/1000 [00:19<01:47,  7.90it/s]========== Step 148 ========== 
 15%|█▍        | 148/1000 [00:19<01:47,  7.90it/s]========== Step 148 ========== 
 15%|█▍        | 149/1000 [00:19<01:47,  7.89it/s]========== Step 149 ========== 
 15%|█▍        | 149/1000 [00:19<01:47,  7.89it/s]========== Step 149 ========== 
 15%|█▌        | 150/1000 [00:19<01:47,  7.90it/s]========== Step 150 ========== 
 15%|█▌        | 150/1000 [00:19<01:47,  7.90it/s]========== Step 150 ========== 
W20240103 22:07:50.491439 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=151, pq.top=151
 15%|█▌        | 151/1000 [00:20<01:48,  7.83it/s]========== Step 151 ========== 
 15%|█▌        | 151/1000 [00:19<01:48,  7.83it/s]========== Step 151 ========== 
 15%|█▌        | 152/1000 [00:20<01:49,  7.75it/s] 15%|█▌        | 152/1000 [00:20<01:49,  7.75it/s]========== Step 152 ========== 
========== Step 152 ========== 
W20240103 22:07:50.696388 2925451 kg_controller.cc:585] Detect new sample comes, old_end2, new_end3
 15%|█▌        | 153/1000 [00:20<01:51,  7.63it/s]========== Step 153 ========== 
 15%|█▌        | 153/1000 [00:20<01:51,  7.63it/s]========== Step 153 ========== 
 15%|█▌        | 154/1000 [00:20<01:49,  7.70it/s]========== Step 154 ========== 
 15%|█▌        | 154/1000 [00:20<01:49,  7.70it/s]========== Step 154 ========== 
 16%|█▌        | 155/1000 [00:20<01:48,  7.76it/s] 16%|█▌        | 155/1000 [00:20<01:48,  7.76it/s]========== Step 155 ========== 
========== Step 155 ========== 
 16%|█▌        | 156/1000 [00:20<01:48,  7.80it/s]========== Step 156 ========== 
 16%|█▌        | 156/1000 [00:20<01:48,  7.80it/s]========== Step 156 ========== 
 16%|█▌        | 157/1000 [00:20<01:46,  7.88it/s] 16%|█▌        | 157/1000 [00:20<01:46,  7.88it/s]========== Step 157 ========== 
========== Step 157 ========== 
 16%|█▌        | 158/1000 [00:20<01:46,  7.89it/s]========== Step 158 ========== 
 16%|█▌        | 158/1000 [00:20<01:46,  7.89it/s]========== Step 158 ========== 
W20240103 22:07:51.520253 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=159, pq.top=159
 16%|█▌        | 159/1000 [00:21<01:47,  7.85it/s]========== Step 159 ========== 
 16%|█▌        | 159/1000 [00:21<01:47,  7.85it/s]========== Step 159 ========== 
 16%|█▌        | 160/1000 [00:21<01:47,  7.80it/s]========== Step 160 ========== 
 16%|█▌        | 160/1000 [00:21<01:47,  7.80it/s]========== Step 160 ========== 
W20240103 22:07:51.721561 2925451 kg_controller.cc:585] Detect new sample comes, old_end0, new_end1
 16%|█▌        | 161/1000 [00:21<01:48,  7.73it/s] 16%|█▌        | 161/1000 [00:21<01:48,  7.73it/s]========== Step 161 ========== 
========== Step 161 ========== 
 16%|█▌        | 162/1000 [00:21<01:48,  7.70it/s]========== Step 162 ========== 
 16%|█▌        | 162/1000 [00:21<01:48,  7.70it/s]========== Step 162 ========== 
 16%|█▋        | 163/1000 [00:21<01:50,  7.58it/s]========== Step 163 ========== 
 16%|█▋        | 163/1000 [00:21<01:50,  7.58it/s]========== Step 163 ========== 
 16%|█▋        | 164/1000 [00:21<01:51,  7.48it/s]========== Step 164 ========== 
 16%|█▋        | 164/1000 [00:21<01:51,  7.48it/s]========== Step 164 ========== 
 16%|█▋        | 165/1000 [00:21<01:51,  7.49it/s]========== Step 165 ========== 
 16%|█▋        | 165/1000 [00:21<01:51,  7.49it/s]========== Step 165 ========== 
W20240103 22:07:52.520011 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=166, pq.top=166
 17%|█▋        | 166/1000 [00:21<01:50,  7.54it/s]========== Step 166 ========== 
 17%|█▋        | 166/1000 [00:21<01:50,  7.54it/s]========== Step 166 ========== 
 17%|█▋        | 167/1000 [00:22<01:49,  7.59it/s]========== Step 167 ========== 
 17%|█▋        | 167/1000 [00:22<01:49,  7.58it/s]========== Step 167 ========== 
 17%|█▋        | 168/1000 [00:22<01:48,  7.65it/s]========== Step 168 ========== 
 17%|█▋        | 168/1000 [00:22<01:48,  7.65it/s]========== Step 168 ========== 
W20240103 22:07:52.781049 2925451 kg_controller.cc:585] Detect new sample comes, old_end8, new_end9
 17%|█▋        | 169/1000 [00:22<01:50,  7.54it/s] 17%|█▋        | 169/1000 [00:22<01:50,  7.53it/s]========== Step 169 ========== 
========== Step 169 ========== 
 17%|█▋        | 170/1000 [00:22<01:50,  7.52it/s]========== Step 170 ========== 
 17%|█▋        | 170/1000 [00:22<01:50,  7.52it/s]========== Step 170 ========== 
 17%|█▋        | 171/1000 [00:22<01:48,  7.62it/s]========== Step 171 ========== 
 17%|█▋        | 171/1000 [00:22<01:48,  7.62it/s]========== Step 171 ========== 
 17%|█▋        | 172/1000 [00:22<01:47,  7.69it/s]========== Step 172 ========== 
 17%|█▋        | 172/1000 [00:22<01:47,  7.69it/s]========== Step 172 ========== 
 17%|█▋        | 173/1000 [00:22<01:46,  7.74it/s]========== Step 173 ========== 
 17%|█▋        | 173/1000 [00:22<01:46,  7.74it/s]========== Step 173 ========== 
W20240103 22:07:53.520006 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=174, pq.top=174
 17%|█▋        | 174/1000 [00:23<01:46,  7.76it/s]========== Step 174 ========== 
 17%|█▋        | 174/1000 [00:22<01:46,  7.76it/s]========== Step 174 ========== 
 18%|█▊        | 175/1000 [00:23<01:45,  7.80it/s]========== Step 175 ========== 
 18%|█▊        | 175/1000 [00:23<01:45,  7.80it/s]========== Step 175 ========== 
 18%|█▊        | 176/1000 [00:23<01:45,  7.82it/s]========== Step 176 ========== 
 18%|█▊        | 176/1000 [00:23<01:45,  7.82it/s]========== Step 176 ========== 
W20240103 22:07:53.815975 2925451 kg_controller.cc:585] Detect new sample comes, old_end6, new_end7
 18%|█▊        | 177/1000 [00:23<01:45,  7.83it/s]========== Step 177 ========== 
 18%|█▊        | 177/1000 [00:23<01:45,  7.83it/s]========== Step 177 ========== 
 18%|█▊        | 178/1000 [00:23<01:44,  7.83it/s]========== Step 178 ========== 
 18%|█▊        | 178/1000 [00:23<01:44,  7.83it/s]========== Step 178 ========== 
 18%|█▊        | 179/1000 [00:23<01:44,  7.84it/s]========== Step 179 ========== 
 18%|█▊        | 179/1000 [00:23<01:44,  7.84it/s]========== Step 179 ========== 
 18%|█▊        | 180/1000 [00:23<01:43,  7.89it/s]========== Step 180 ========== 
 18%|█▊        | 180/1000 [00:23<01:43,  7.89it/s]========== Step 180 ========== 
 18%|█▊        | 181/1000 [00:23<01:43,  7.90it/s]========== Step 181 ========== 
 18%|█▊        | 181/1000 [00:23<01:43,  7.90it/s]========== Step 181 ========== 
W20240103 22:07:54.520004 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=182, pq.top=182
 18%|█▊        | 182/1000 [00:24<01:43,  7.87it/s]========== Step 182 ========== 
 18%|█▊        | 182/1000 [00:24<01:43,  7.87it/s]========== Step 182 ========== 
 18%|█▊        | 183/1000 [00:24<01:44,  7.85it/s]========== Step 183 ========== 
 18%|█▊        | 183/1000 [00:24<01:43,  7.86it/s]========== Step 183 ========== 
 18%|█▊        | 184/1000 [00:24<01:44,  7.80it/s]========== Step 184 ========== 
 18%|█▊        | 184/1000 [00:24<01:44,  7.80it/s]W20240103 22:07:54.835393 2925451 kg_controller.cc:585] Detect new sample comes, old_end4, new_end5
========== Step 184 ========== 
 18%|█▊        | 185/1000 [00:24<01:44,  7.80it/s]========== Step 185 ========== 
 18%|█▊        | 185/1000 [00:24<01:44,  7.80it/s]========== Step 185 ========== 
 19%|█▊        | 186/1000 [00:24<01:44,  7.80it/s]========== Step 186 ========== 
 19%|█▊        | 186/1000 [00:24<01:44,  7.80it/s]========== Step 186 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | Mean                      | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBackwardAsync      | 21.750 ms                 | 25.976 ms                 |
+---------------------------+---------------------------+---------------------------+
 19%|█▊        | 187/1000 [00:24<01:44,  7.79it/s]========== Step 187 ========== 
 19%|█▊        | 187/1000 [00:24<01:44,  7.79it/s]========== Step 187 ========== 
 19%|█▉        | 188/1000 [00:24<01:44,  7.78it/s]========== Step 188 ========== 
 19%|█▉        | 188/1000 [00:24<01:44,  7.78it/s]========== Step 188 ========== 
 19%|█▉        | 189/1000 [00:24<01:44,  7.77it/s]========== Step 189 ========== 
 19%|█▉        | 189/1000 [00:24<01:44,  7.77it/s]========== Step 189 ========== 
W20240103 22:07:55.536677 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=190, pq.top=190
 19%|█▉        | 190/1000 [00:25<01:44,  7.78it/s]========== Step 190 ========== 
 19%|█▉        | 190/1000 [00:25<01:44,  7.78it/s]========== Step 190 ========== 
 19%|█▉        | 191/1000 [00:25<01:43,  7.78it/s]========== Step 191 ========== 
 19%|█▉        | 191/1000 [00:25<01:43,  7.78it/s]========== Step 191 ========== 
 19%|█▉        | 192/1000 [00:25<01:44,  7.75it/s]========== Step 192 ========== 
 19%|█▉        | 192/1000 [00:25<01:44,  7.75it/s]========== Step 192 ========== 
W20240103 22:07:55.865396 2925451 kg_controller.cc:585] Detect new sample comes, old_end2, new_end3
 19%|█▉        | 193/1000 [00:25<01:44,  7.73it/s]========== Step 193 ========== 
 19%|█▉        | 193/1000 [00:25<01:44,  7.74it/s]========== Step 193 ========== 
 19%|█▉        | 194/1000 [00:25<01:43,  7.79it/s]========== Step 194 ========== 
 19%|█▉        | 194/1000 [00:25<01:43,  7.79it/s]========== Step 194 ========== 
 20%|█▉        | 195/1000 [00:25<01:46,  7.59it/s] 20%|█▉        | 195/1000 [00:25<01:46,  7.59it/s]========== Step 195 ========== 
========== Step 195 ========== 
 20%|█▉        | 196/1000 [00:25<01:45,  7.62it/s]========== Step 196 ========== 
 20%|█▉        | 196/1000 [00:25<01:45,  7.62it/s]========== Step 196 ========== 
 20%|█▉        | 197/1000 [00:25<01:44,  7.68it/s]========== Step 197 ========== 
 20%|█▉        | 197/1000 [00:25<01:44,  7.68it/s]========== Step 197 ========== 
W20240103 22:07:56.577641 2924975 kg_controller.cc:688] Sleep in <BlockToStepN>, step_no=198, pq.top=198
 20%|█▉        | 198/1000 [00:26<01:44,  7.70it/s]========== Step 198 ========== 
 20%|█▉        | 198/1000 [00:26<01:44,  7.70it/s]========== Step 198 ========== 
 20%|█▉        | 199/1000 [00:26<01:43,  7.74it/s]========== Step 199 ========== 
 20%|█▉        | 199/1000 [00:26<01:43,  7.74it/s]========== Step 199 ========== 
 20%|█▉        | 199/1000 [00:26<01:45,  7.59it/s]
Process Process-1:
Traceback (most recent call last):
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/test_emb.py", line 338, in <module>
 20%|█▉        | 199/1000 [00:26<01:45,  7.59it/s]
    test.test_known_sharded_cache()
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/test_emb.py", line 332, in test_known_sharded_cache
    self.main_routine(self.routine_cache_helper, args)
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/test_emb.py", line 121, in main_routine
    each.join()
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/popen_fork.py", line 43, in wait
    return self.poll(os.WNOHANG if timeout == 0.0 else 0)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/popen_fork.py", line 27, in poll
    pid, sts = os.waitpid(self.pid, flag)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Process Process-2:
Traceback (most recent call last):
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/test_emb.py", line 66, in worker_main
    routine(worker_id, num_workers, emb_context, args)
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/test_emb.py", line 235, in routine_cache_helper
    std_loss.backward()
  File "/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/test_emb.py", line 66, in worker_main
    routine(worker_id, num_workers, emb_context, args)
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/test_emb.py", line 226, in routine_cache_helper
    input_keys = next(test_perf_sampler)
                 ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/controller_process.py", line 116, in __next__
    self.ids_circle_buffer.push(self.sampler_iter_num, entity_id)
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/controller_process.py", line 67, in push
    while (self.circle_buffer_end[0] != self.circle_buffer_old_end[0]):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Exception ignored in atexit callback: <function _exit_function at 0x7f11e1147060>
Traceback (most recent call last):
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/util.py", line 357, in _exit_function
    p.join()
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/popen_fork.py", line 43, in wait
    return self.poll(os.WNOHANG if timeout == 0.0 else 0)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/popen_fork.py", line 27, in poll
    pid, sts = os.waitpid(self.pid, flag)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt: 
