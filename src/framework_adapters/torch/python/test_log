WARNING: Logging before InitGoogleLogging() is written to STDERR
W20240105 14:15:23.842386 1086818 IPCTensor.h:350] NewIPCTensor: full_emb [20000, 3]0x100000002000
xmh:  {'test_cache': 'KnownLocalCachedEmbedding', 'cache_ratio': 0.1, 'kForwardItersPerStep': 1, 'BackwardMode': 'CppAsync', 'L': 10, 'nr_background_threads': 32}
========== Running Test with routine <bound method TestShardedCache.routine_cache_helper of <__main__.TestShardedCache object at 0x7f15b56b3550>> {'test_cache': 'KnownLocalCachedEmbedding', 'cache_ratio': 0.1, 'kForwardItersPerStep': 1, 'BackwardMode': 'CppAsync', 'L': 10, 'nr_background_threads': 32}==========
INFO [1086818 test_emb.py:115] Worker 0 pid=1087183
INFO [1086818 test_emb.py:115] Worker 1 pid=1087184
INFO [1087184 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [1087183 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [1087184 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [1087183 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
WARNING: Logging before InitGoogleLogging() is written to STDERR
E20240105 14:15:27.304447 1087183 IPCTensor.h:329] IPCTensor full_emb already exists
WARNING: Logging before InitGoogleLogging() is written to STDERR
E20240105 14:15:27.316165 1087184 IPCTensor.h:329] IPCTensor full_emb already exists
INFO [1087183 test_emb.py:128] emb.data_ptr=0x100000002000
INFO [1087184 test_emb.py:128] emb.data_ptr=0x100000002000
rank 0 start initing emb
  0%|          | 0/10000 [00:00<?, ?it/s] 86%|████████▋ | 8649/10000 [00:00<00:00, 86484.10it/s]100%|██████████| 10000/10000 [00:00<00:00, 86716.69it/s]
E20240105 14:15:28.696161 1087183 IPCTensor.h:367] Called NewIPCGPUTensor: embedding_cache_0 [1000, 3] 0
W20240105 14:15:28.696203 1087183 IPCTensor.h:389] NewIPCGPUTensor: embedding_cache_0 [1000, 3] 0
W20240105 14:15:28.696342 1087183 IPCTensor.h:350] NewIPCTensor: input_keys_0 [100000]0x10000003f050
W20240105 14:15:28.696403 1087183 IPCTensor.h:350] NewIPCTensor: input_keys_neg_0 [100000]0x100000104050
E20240105 14:15:28.696435 1087183 IPCTensor.h:367] Called NewIPCGPUTensor: backward_grads_0 [100000, 3] 0
W20240105 14:15:28.696441 1087183 IPCTensor.h:389] NewIPCGPUTensor: backward_grads_0 [100000, 3] 0
E20240105 14:15:28.696482 1087183 IPCTensor.h:367] Called NewIPCGPUTensor: backward_grads_neg_0 [100000, 3] 0
W20240105 14:15:28.696488 1087183 IPCTensor.h:389] NewIPCGPUTensor: backward_grads_neg_0 [100000, 3] 0
E20240105 14:15:28.697212 1087184 IPCTensor.h:367] Called NewIPCGPUTensor: embedding_cache_1 [1000, 3] 1
W20240105 14:15:28.697248 1087184 IPCTensor.h:389] NewIPCGPUTensor: embedding_cache_1 [1000, 3] 1
W20240105 14:15:28.697407 1087184 IPCTensor.h:350] NewIPCTensor: input_keys_1 [100000]0x1000001cc140
W20240105 14:15:28.697525 1087184 IPCTensor.h:350] NewIPCTensor: input_keys_neg_1 [100000]0x100000291140
E20240105 14:15:28.697580 1087184 IPCTensor.h:367] Called NewIPCGPUTensor: backward_grads_1 [100000, 3] 1
W20240105 14:15:28.697590 1087184 IPCTensor.h:389] NewIPCGPUTensor: backward_grads_1 [100000, 3] 1
E20240105 14:15:28.697655 1087184 IPCTensor.h:367] Called NewIPCGPUTensor: backward_grads_neg_1 [100000, 3] 1
W20240105 14:15:28.697664 1087184 IPCTensor.h:389] NewIPCGPUTensor: backward_grads_neg_1 [100000, 3] 1
weight.shape torch.Size([20000, 3])
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240105 14:15:28.715755 1087184 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000003581e0
W20240105 14:15:28.715848 1087184 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000041d1e0
W20240105 14:15:28.715894 1087184 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_2 [100000]0x1000004e21e0
W20240105 14:15:28.715937 1087184 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_3 [100000]0x1000005a71e0
W20240105 14:15:28.715971 1087184 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_4 [100000]0x10000066c1e0
W20240105 14:15:28.716025 1087184 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_5 [100000]0x1000007311e0
W20240105 14:15:28.716063 1087184 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_6 [100000]0x1000007f61e0
W20240105 14:15:28.716104 1087184 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_7 [100000]0x1000008bb1e0
W20240105 14:15:28.716142 1087184 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_8 [100000]0x1000009801e0
W20240105 14:15:28.716174 1087184 IPCTensor.h:350] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000a451e0
W20240105 14:15:28.716209 1087184 IPCTensor.h:350] NewIPCTensor: step_r1 [10]0x100000b0a1e0
W20240105 14:15:28.716245 1087184 IPCTensor.h:350] NewIPCTensor: circle_buffer_end_r1 [1]0x100000b0c1e0
W20240105 14:15:28.716279 1087184 IPCTensor.h:350] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000b0e1e0
------------json------------
{
            "num_gpus": 2,
            "L": 10,
            "kForwardItersPerStep": 1,
            "clr": 2,
            "BackwardMode": "CppAsync",
            "nr_background_threads": 32
        }
weight.shape torch.Size([20000, 3])
New CachedEmbedding, name=full_emb, shape=(20000, 3), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1000), (1000, 2000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240105 14:15:28.722309 1087183 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000b101e0
W20240105 14:15:28.722384 1087183 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_1 [100000]0x100000bd51e0
W20240105 14:15:28.722420 1087183 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_2 [100000]0x100000c9a1e0
W20240105 14:15:28.722453 1087183 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000d5f1e0
W20240105 14:15:28.722486 1087183 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000e241e0
W20240105 14:15:28.722517 1087183 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_5 [100000]0x100000ee91e0
W20240105 14:15:28.722546 1087183 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_6 [100000]0x100000fae1e0
W20240105 14:15:28.722581 1087183 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_7 [100000]0x1000010731e0
W20240105 14:15:28.722611 1087183 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_8 [100000]0x1000011381e0
W20240105 14:15:28.722642 1087183 IPCTensor.h:350] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000011fd1e0
W20240105 14:15:28.722674 1087183 IPCTensor.h:350] NewIPCTensor: step_r0 [10]0x1000012c21e0
W20240105 14:15:28.722703 1087183 IPCTensor.h:350] NewIPCTensor: circle_buffer_end_r0 [1]0x1000012c41e0
W20240105 14:15:28.722729 1087183 IPCTensor.h:350] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000012c61e0
W20240105 14:15:28.723269 1087183 kg_controller.cc:62] KGCacheController, config={
            "num_gpus": 2,
            "L": 10,
            "kForwardItersPerStep": 1,
            "clr": 2,
            "BackwardMode": "CppAsync",
            "nr_background_threads": 32
        }
W20240105 14:15:28.723451 1087183 kg_controller.cc:159] Init GradProcessingBase done
W20240105 14:15:28.728785 1087183 kg_controller.cc:820] after init GradAsyncProcessing
W20240105 14:15:29.172487 1087884 kg_controller.cc:589] Detect new sample comes, old_end0, new_end1
E20240105 14:15:29.176026 1087884 parallel_pq.h:288] node is nullptr
  0%|          | 0/1000 [00:00<?, ?it/s]========== Step 0 ========== 
  0%|          | 0/1000 [00:00<?, ?it/s]========== Step 0 ========== 
E20240105 14:15:30.176044 1087884 parallel_pq.h:288] node is nullptr
free(): unaligned chunk detected in tcache 2
*** Aborted at 1704435330 (Unix time, try 'date -d @1704435330') ***
*** Signal 6 (SIGABRT) (0x3e8001096cf) received by PID 1087183 (pthread TID 0x7f80afff0740) (linux TID 1087183) (maybe from PID 1087183, UID 1000) (code: -6), stack trace: ***
    @ 00000000008ccde0 folly::symbolizer::(anonymous namespace)::innerSignalHandler(int, siginfo_t*, void*)
                       /home/xieminhui/RecStore/third_party/folly/folly/experimental/symbolizer/SignalHandler.cpp:449
    @ 00000000008ccec6 folly::symbolizer::(anonymous namespace)::signalHandler(int, siginfo_t*, void*)
                       /home/xieminhui/RecStore/third_party/folly/folly/experimental/symbolizer/SignalHandler.cpp:470
    @ 000000000004251f (unknown)
    @ 00000000000969fc pthread_kill
    @ 0000000000042475 raise
    @ 00000000000287f2 abort
    @ 0000000000089675 (unknown)
    @ 00000000000a0cfb (unknown)
    @ 00000000000a2e3e (unknown)
    @ 00000000000a5452 free
    @ 00000000006a3073 base::StdDelayedRecycle::Recycle(void*)
                       /home/xieminhui/RecStore/src/memory/malloc.h:96
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 00000000006c00df recstore::ParallelPq<recstore::AsyncGradElement*>::adjustPriority(recstore::AsyncGradElement* const&)
                       /home/xieminhui/RecStore/src/framework_adapters/torch/parallel_pq.h:304
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 00000000006b33c5 recstore::ParallelPq<recstore::AsyncGradElement*>::PushOrUpdate(recstore::AsyncGradElement* const&)
                       /home/xieminhui/RecStore/src/framework_adapters/torch/parallel_pq.h:178
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 0000000000722600 recstore::GradAsyncProcessing::ProcessBackwardAsync(std::vector<at::Tensor, std::allocator<at::Tensor> > const&, std::vector<at::Tensor, std::allocator<at::Tensor> > const&, int) [clone ._omp_fn.0]
                       /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc:749
    @ 0000000000014a15 GOMP_parallel
    @ 00000000006a7ec5 recstore::GradAsyncProcessing::ProcessBackwardAsync(std::vector<at::Tensor, std::allocator<at::Tensor> > const&, std::vector<at::Tensor, std::allocator<at::Tensor> > const&, int)
                       /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc:731
    @ 00000000006a6962 recstore::GradAsyncProcessing::ProcessOneStep(long)
                       /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc:557
    @ 00000000006a85a1 recstore::KGCacheController::ProcessOneStep(long)
                       /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc:832
    @ 00000000007184e0 void std::__invoke_impl<void, void (recstore::KGCacheController::* const&)(long), recstore::KGCacheController&, long&>(std::__invoke_memfun_ref, void (recstore::KGCacheController::* const&)(long), recstore::KGCacheController&, long&)
                       /usr/include/c++/11/bits/invoke.h:67
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 0000000000713d9a std::__invoke_result<void (recstore::KGCacheController::* const&)(long), recstore::KGCacheController&, long&>::type std::__invoke<void (recstore::KGCacheController::* const&)(long), recstore::KGCacheController&, long&>(void (recstore::KGCacheController::* const&)(long), recstore::KGCacheController&, long&)
                       /usr/include/c++/11/bits/invoke.h:96
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 000000000070f9b6 decltype (__invoke((*this)._M_pmf, (forward<recstore::KGCacheController&>)({parm#1}), (forward<long&>)({parm#1}))) std::_Mem_fn_base<void (recstore::KGCacheController::*)(long), true>::operator()<recstore::KGCacheController&, long&>(recstore::KGCacheController&, long&) const
                       /usr/include/c++/11/functional:131
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 0000000000709095 std::enable_if<std::is_member_pointer<std::decay<void (recstore::KGCacheController::*&)(long)>::type>::value, std::invoke_result<void (recstore::KGCacheController::*&)(long), recstore::KGCacheController&, long&>::type>::type c10::guts::invoke<void (recstore::KGCacheController::*&)(long), recstore::KGCacheController&, long&>(void (recstore::KGCacheController::*&)(long), recstore::KGCacheController&, long&)
                       /home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/include/c10/util/C++17.h:195
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 00000000006fe837 torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>::operator()(c10::intrusive_ptr<recstore::KGCacheController, c10::detail::intrusive_target_default_null_type<recstore::KGCacheController> >, long)
                       /home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/include/torch/custom_class_detail.h:83
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 00000000006f46e8 c10::guts::infer_function_traits_t::return_type torch::detail::call_torchbind_method_from_stack<torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>, false, 0ul, 1ul>(torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>&, std::vector<c10::IValue, std::allocator<c10::IValue> >&, std::integer_sequence<unsigned long, 0ul, 1ul>)
                       /home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/include/torch/custom_class_detail.h:139
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 00000000006e37b4 c10::guts::infer_function_traits_t::return_type torch::detail::call_torchbind_method_from_stack<torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>, false>(torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>&, std::vector<c10::IValue, std::allocator<c10::IValue> >&)
                       /home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/include/torch/custom_class_detail.h:153
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 00000000006d58de torch::detail::BoxedProxy<void, torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)> >::operator()(std::vector<c10::IValue, std::allocator<c10::IValue> >&, torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>&)
                       /home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/include/torch/custom_class_detail.h:174
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 00000000006c2b55 torch::class_<recstore::KGCacheController>::defineMethod<torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)> >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::initializer_list<torch::arg>)::{lambda(std::vector<c10::IValue, std::allocator<c10::IValue> >&)#1}::operator()(std::vector<c10::IValue, std::allocator<c10::IValue> >&)
                       /home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/include/torch/custom_class.h:407
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 000000000070912e void std::__invoke_impl<void, torch::class_<recstore::KGCacheController>::defineMethod<torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)> >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::initializer_list<torch::arg>)::{lambda(std::vector<c10::IValue, std::allocator<c10::IValue> >&)#1}&, std::vector<c10::IValue, std::allocator<c10::IValue> >&>(std::__invoke_other, torch::class_<recstore::KGCacheController>::defineMethod<torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)> >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::initializer_list<torch::arg>)::{lambda(std::vector<c10::IValue, std::allocator<c10::IValue> >&)#1}&, std::vector<c10::IValue, std::allocator<c10::IValue> >&)
                       /usr/include/c++/11/bits/invoke.h:61
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 00000000006fe8f8 std::enable_if<is_invocable_r_v<void, torch::class_<recstore::KGCacheController>::defineMethod<torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)> >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::initializer_list<torch::arg>)::{lambda(std::vector<c10::IValue, std::allocator<c10::IValue> >&)#1}&, std::vector<c10::IValue, std::allocator<c10::IValue> >&>, void>::type std::__invoke_r<void, torch::class_<recstore::KGCacheController>::defineMethod<torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)> >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::initializer_list<torch::arg>)::{lambda(std::vector<c10::IValue, std::allocator<c10::IValue> >&)#1}&, std::vector<c10::IValue, std::allocator<c10::IValue> >&>(torch::class_<recstore::KGCacheController>::defineMethod<torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)> >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::initializer_list<torch::arg>)::{lambda(std::vector<c10::IValue, std::allocator<c10::IValue> >&)#1}&, std::vector<c10::IValue, std::allocator<c10::IValue> >&)
                       /usr/include/c++/11/bits/invoke.h:111
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 00000000006f47b2 std::_Function_handler<void (std::vector<c10::IValue, std::allocator<c10::IValue> >&), torch::class_<recstore::KGCacheController>::defineMethod<torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)> >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::detail::WrapMethod<void (recstore::KGCacheController::*)(long)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::initializer_list<torch::arg>)::{lambda(std::vector<c10::IValue, std::allocator<c10::IValue> >&)#1}>::_M_invoke(std::_Any_data const&, std::vector<c10::IValue, std::allocator<c10::IValue> >&)
                       /usr/include/c++/11/bits/std_function.h:290
                       -> /home/xieminhui/RecStore/src/framework_adapters/torch/kg_controller.cc
    @ 000000000064fb30 std::function<void (std::vector<c10::IValue, std::allocator<c10::IValue> >&)>::operator()(std::vector<c10::IValue, std::allocator<c10::IValue> >&) const
                       /usr/include/c++/11/bits/std_function.h:590
                       -> /tmp/tmpxft_001068c3_00000000-6_recstore.compute_86.cudafe1.cpp
    @ 0000000000643e89 torch::jit::BuiltinOpFunction::run(std::vector<c10::IValue, std::allocator<c10::IValue> >&)
                       /home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/include/ATen/core/builtin_function.h:31
                       -> /tmp/tmpxft_001068c3_00000000-6_recstore.compute_86.cudafe1.cpp
    @ 00000000008126a3 torch::jit::runAndInsertCall(torch::jit::Function&, torch::jit::tuple_slice const&, pybind11::kwargs const&, c10::optional<c10::IValue>, std::function<torch::jit::Value* (torch::jit::Graph&, torch::jit::MatchedSchema const&)> const&)
                       /home/xieminhui/pytorch/torch/csrc/jit/python/pybind_utils.h:965
                       -> /home/xieminhui/pytorch/torch/csrc/jit/python/python_custom_class.cpp
    @ 0000000000812cc2 torch::jit::invokeScriptMethodFromPython(torch::jit::Method&, torch::jit::tuple_slice const&, pybind11::kwargs const&)
                       /home/xieminhui/pytorch/torch/csrc/jit/python/pybind_utils.h:1095
                       -> /home/xieminhui/pytorch/torch/csrc/jit/python/python_custom_class.cpp
    @ 000000000089d51c pybind11::cpp_function::initialize<torch::jit::initJitScriptBindings(_object*)::{lambda(pybind11::args, pybind11::kwargs)#68}, pybind11::object, pybind11::args, pybind11::kwargs, pybind11::name, pybind11::is_method, pybind11::sibling>(torch::jit::initJitScriptBindings(_object*)::{lambda(pybind11::args, pybind11::kwargs)#68}&&, pybind11::object (*)(pybind11::args, pybind11::kwargs), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&)
                       /home/xieminhui/pytorch/torch/csrc/jit/python/script_init.cpp:1508
    @ 0000000000357419 pybind11::cpp_function::dispatcher(_object*, _object*, _object*)
                       /home/xieminhui/pytorch/torch/include/pybind11/pybind11.h:929
                       -> /home/xieminhui/pytorch/torch/csrc/autograd/generated/python_functions_0.cpp
    @ 0000000000525f06 cfunction_call
                       /usr/local/src/conda/python-3.11.5/Objects/methodobject.c:542
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 0000000000502d53 _PyObject_MakeTpCall
                       /usr/local/src/conda/python-3.11.5/Objects/call.c:214
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 0000000000554171 method_vectorcall
                       /usr/local/src/conda/python-3.11.5/Objects/classobject.c:89
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 000000000046fd31 slot_tp_call.cold
                       /usr/local/src/conda/python-3.11.5/Objects/typeobject.c:7626
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 0000000000502d53 _PyObject_MakeTpCall
                       /usr/local/src/conda/python-3.11.5/Objects/call.c:214
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 000000000050f024 _PyEval_EvalFrameDefault
                       /usr/local/src/conda/python-3.11.5/Python/ceval.c:4774
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 0000000000535102 _PyFunction_Vectorcall
                       /usr/local/src/conda/python-3.11.5/Include/internal/pycore_ceval.h:73
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 0000000000512d59 _PyEval_EvalFrameDefault
                       /usr/local/src/conda/python-3.11.5/Python/ceval.c:7357
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 00000000005c82cd _PyEval_Vector
                       /usr/local/src/conda/python-3.11.5/Include/internal/pycore_ceval.h:73
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 00000000005c79ce PyEval_EvalCode
                       /usr/local/src/conda/python-3.11.5/Python/ceval.c:1154
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 00000000005e8806 run_eval_code_obj
                       /usr/local/src/conda/python-3.11.5/Python/pythonrun.c:1712
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 00000000005e4e3f run_mod
                       /usr/local/src/conda/python-3.11.5/Python/pythonrun.c:1733
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 00000000005d713e PyRun_StringFlags
                       /usr/local/src/conda/python-3.11.5/Python/pythonrun.c:1603
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 00000000005d700a PyRun_SimpleStringFlags
                       /usr/local/src/conda/python-3.11.5/Python/pythonrun.c:487
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 00000000005f30e7 Py_RunMain
                       /usr/local/src/conda/python-3.11.5/Modules/main.c:255
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 00000000005b6e18 Py_BytesMain
                       /usr/local/src/conda/python-3.11.5/Modules/main.c:734
                       -> /croot/python-split_1694437901252/work/build-static/<artificial>
    @ 0000000000029d8f (unknown)
    @ 0000000000029e3f __libc_start_main
    @ 00000000005b6c6e (unknown)
[W tensorpipe_agent.cpp:725] RPC agent for worker1 encountered error when reading incoming request from worker0: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
  0%|          | 0/1000 [00:02<?, ?it/s]
Process Process-2:
Traceback (most recent call last):
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/test_emb.py", line 66, in worker_main
    routine(worker_id, num_workers, emb_context, args)
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/test_emb.py", line 283, in routine_cache_helper
    kg_cache_controller.AfterBackward()
  File "/home/xieminhui/RecStore/src/framework_adapters/torch/python/controller_process.py", line 329, in AfterBackward
    dist.barrier()
  File "/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 3335, in barrier
    work.wait()
RuntimeError: [/home/xieminhui/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [127.0.1.1]:7084
join all processes done
/home/xieminhui/miniconda3/lib/python3.11/multiprocessing/resource_tracker.py:224: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
